{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-05T21:51:22.108277Z", "invocation_id": "8e945316-b16e-4ccf-8a82-dd9ad4c45dd2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T21:51:13.832718Z", "completed_at": "2025-04-05T21:51:13.850236Z"}, {"name": "execute", "started_at": "2025-04-05T21:51:13.865263Z", "completed_at": "2025-04-05T21:51:15.981529Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.1618330478668213, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.bdt_transformations.ntn_processed_universal_task_database", "compiled": true, "compiled_code": "\nselect \n\t\"ID\" as page_id,\n\t(\"CONTENT\" -> 'parent') as parent,\n    (\"CONTENT\" -> 'created_by') as created_by,\n    (\"CONTENT\" -> 'last_edited_by') as last_edited_by,\n    (\"CONTENT\" ->> 'created_time')::timestamptz as created_time,\n\t(\"CONTENT\" ->> 'last_edited_time')::timestamptz as last_edited_time,\n\t(\"CONTENT\" -> 'icon') as emoji,\n\t(\"CONTENT\" ->> 'url')::varchar as url,\n    (\"CONTENT\" ->> 'cover')::varchar as cover,\n\t(\"CONTENT\" ->> 'object')::varchar as object,\n    (\"CONTENT\" ->> 'in_trash')::varchar as in_trash,\n\t(\"CONTENT\" ->> 'public_url')::varchar as public_url,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'cQuD'\n        LIMIT 1\n    ) as tempo_decorrido,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3EtXq'\n        LIMIT 1\n    ) as solicitante,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3AnD%7B'\n        LIMIT 1\n    ) as peso,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'RZok'\n        LIMIT 1\n    ) as entrou_em_a_fazer_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'W%3EOG'\n        LIMIT 1\n    ) as clientes_teste,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%5CE%7CT'\n        LIMIT 1\n    ) as sla,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'bxha'\n        LIMIT 1\n    ) as release_appcenter,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'DvWV'\n        LIMIT 1\n    ) as sprint,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'kOr%5C'\n        LIMIT 1\n    ) as entrou_em_a_testar_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3CUw_'\n        LIMIT 1\n    ) as customer_id,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'jl%3FW'\n        LIMIT 1\n    ) as status,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'jqsw'\n        LIMIT 1\n    ) as etapa_atualizada_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'R%5BbO'\n        LIMIT 1\n    ) as area,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%60%7CVU'\n        LIMIT 1\n    ) as branch,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'gmhw'\n        LIMIT 1\n    ) as responsavel,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%5E%3A%7BY'\n        LIMIT 1\n    ) as atualizado_por,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'rqJ'''\n        LIMIT 1\n    ) as prioridade,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'xJBR'\n        LIMIT 1\n    ) as atualizado_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'zr%40c'\n        LIMIT 1\n    ) as entrou_em_finalizado_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'I%5EJJ'\n        LIMIT 1\n    ) as bloqueando,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'uJTd'\n        LIMIT 1\n    ) as link_externo,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '_i%7CT'\n        LIMIT 1\n    ) as modulo_do_sistema,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'z%7DO~'\n        LIMIT 1\n    ) as entrou_em_testando_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'AM%7D%40'\n        LIMIT 1\n    ) as justificativa,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'Y%5BHF'\n        LIMIT 1\n    ) as dias_ate_o_sla,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'rvEg'\n        LIMIT 1\n    ) as projetos,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'k%7BC%60'\n        LIMIT 1\n    ) as nome_do_cliente,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'MMDE'\n        LIMIT 1\n    ) as entered_correction_at,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'BT%5E%7C'\n        LIMIT 1\n    ) as item_filho,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'ytoL'\n        LIMIT 1\n    ) as id_da_tarefa,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'tklV'\n        LIMIT 1\n    ) as inicio_do_sla,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'bY%3Bi'\n        LIMIT 1\n    ) as dias_de_desenvolvimento,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'ILQ%3B'\n        LIMIT 1\n    ) as integrado,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'RIPB'\n        LIMIT 1\n    ) as entrou_em_aprovado_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'dT%3BM'\n        LIMIT 1\n    ) as entrou_em_fazendo_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'title'\n        LIMIT 1\n    ) as titulo,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'xy%60%7D'\n        LIMIT 1\n    ) as melhoria,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'isqN'\n        LIMIT 1\n    ) as entrou_em_aguardando_versao_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'wV%5D%7B'\n        LIMIT 1\n    ) as atraso,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'JDHn'\n        LIMIT 1\n    ) as integracao,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'j%5D%3DA'\n        LIMIT 1\n    ) as dias_ate_a_conclusao,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3C_%40%60'\n        LIMIT 1\n    ) as dias_ate_o_desenvolvimento,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3Ady%60'\n        LIMIT 1\n    ) as id_dos_clientes_teste,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '3E6J'\n        LIMIT 1\n    ) as etapa,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'Y%7DF%7C'\n        LIMIT 1\n    ) as prazo,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%5DQTb'\n        LIMIT 1\n    ) as ambiente,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%40%60v%3C'\n        LIMIT 1\n    ) as criado_por,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3El~P'\n        LIMIT 1\n    ) as item_pai,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'TT%40f'\n        LIMIT 1\n    ) as criado_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%5BkYo'\n        LIMIT 1\n    ) as bloqueado_por,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'eWnA'\n        LIMIT 1\n    ) as duracao_da_tarefa,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = '%3Bn%3ES'\n        LIMIT 1\n    ) as dias_na_etapa,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'n%3AJ%5D'\n        LIMIT 1\n    ) as entrou_em_backlog_em,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'NKa%3D'\n        LIMIT 1\n    ) as okr,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'ooSm'\n        LIMIT 1\n    ) as id_da_pagina,\n    (\n        SELECT value\n        FROM jsonb_each(\"CONTENT\" -> 'properties')\n        WHERE value ->> 'id' = 'gOo%3A'\n        LIMIT 1\n    ) as tester\nfrom \"bendito_intelligence_dev\".\"notion\".\"ntn_raw_universal_task_database\"\nWHERE \"SUCCESS\" = TRUE", "relation_name": "\"bendito_intelligence_dev\".\"notion\".\"ntn_processed_universal_task_database\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T21:51:13.823535Z", "completed_at": "2025-04-05T21:51:13.837100Z"}, {"name": "execute", "started_at": "2025-04-05T21:51:13.837738Z", "completed_at": "2025-04-05T21:51:16.897463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0778422355651855, "adapter_response": {"_message": "SELECT 69", "code": "SELECT", "rows_affected": 69}, "message": "SELECT 69", "failures": null, "unique_id": "model.bdt_transformations.ntn_curated_enum_database_properties", "compiled": true, "compiled_code": "\nselect distinct\n\t\"CONTENT\" -> 'parent' ->> 'database_id' as database_id,\n\t'ntn_raw_universal_task_database' as database_name,\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->'value'->>'id' as \"property_id\",\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->>'key' as \"property_name\",\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->'value'->>'type' as \"property_type\"\nfrom \"bendito_intelligence_dev\".\"notion\".\"ntn_raw_universal_task_database\"\nunion all\nselect distinct\n\t\"CONTENT\" -> 'parent' ->> 'database_id' as database_id,\n\t'ntn_raw_action_items' as database_name,\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->'value'->>'id' as \"property_id\",\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->>'key' as \"property_name\",\n\tto_jsonb(jsonb_each(\"CONTENT\"->'properties'))->'value'->>'type' as \"property_type\"\nfrom \"bendito_intelligence_dev\".\"notion\".\"ntn_raw_action_items\"", "relation_name": "\"bendito_intelligence_dev\".\"notion\".\"ntn_curated_enum_database_properties\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T21:51:15.996534Z", "completed_at": "2025-04-05T21:51:16.000463Z"}, {"name": "execute", "started_at": "2025-04-05T21:51:16.003581Z", "completed_at": "2025-04-05T21:51:18.313773Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.324105978012085, "adapter_response": {"_message": "SELECT 40", "code": "SELECT", "rows_affected": 40}, "message": "SELECT 40", "failures": null, "unique_id": "model.bdt_transformations.ntn_curated_users", "compiled": true, "compiled_code": "\nwith unique_person as\n(\n\tselect distinct jsonb_array_elements(solicitante->'people') as person\n\tfrom  \"bendito_intelligence_dev\".\"notion\".\"ntn_processed_universal_task_database\"\n\tunion all\n\tselect distinct jsonb_array_elements(tester->'people')\n\tfrom  \"bendito_intelligence_dev\".\"notion\".\"ntn_processed_universal_task_database\"\n\tunion all\n\tselect distinct jsonb_array_elements(responsavel->'people')\n\tfrom  \"bendito_intelligence_dev\".\"notion\".\"ntn_processed_universal_task_database\"\n)\nselect distinct\n\tperson ->>'id' as id,\n\tperson ->>'name' as name,\n\tperson -> 'person' ->> 'email' as email,\n\tperson ->>'avatar_url' as avatar\nfrom unique_person", "relation_name": "\"bendito_intelligence_dev\".\"notion\".\"ntn_curated_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T21:51:15.992008Z", "completed_at": "2025-04-05T21:51:16.000120Z"}, {"name": "execute", "started_at": "2025-04-05T21:51:16.000780Z", "completed_at": "2025-04-05T21:51:20.701506Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.712335824966431, "adapter_response": {"_message": "SELECT 1492", "code": "SELECT", "rows_affected": 1492}, "message": "SELECT 1492", "failures": null, "unique_id": "model.bdt_transformations.ntn_curated_universal_task_database", "compiled": true, "compiled_code": "\nselect\n\tpage_id as page_id,\n\temoji ->> 'emoji' as emoji,\n\tcreated_by ->> 'id' as created_by,\n\tlast_edited_by ->> 'id' as last_edited_by,\n\tcreated_time as created_time,\n\tlast_edited_time as last_edited_time,\n\turl as url,\n\tcover as cover,\n\t\"object\" as \"object\",\n\tparent ->> 'database_id' as parent,\n\tin_trash as in_trash,\n\tpublic_url as public_url,\n\t(tempo_decorrido -> 'formula' -> 'number' )::int as tempo_decorrido,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(solicitante_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(solicitante->'people') = 'array' \n                THEN solicitante->'people'\n                ELSE '[]'::jsonb\n            END\n        ) AS solicitante_item\n    ) as solicitante,\n\t(peso ->> 'number')::int2 as peso,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(clientes_teste_item->'formula'->>'string'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(clientes_teste->'rollup'->'array') = 'array' \n                THEN clientes_teste->'rollup'->'array'\n                ELSE '[]'::jsonb\n            END\n        ) AS clientes_teste_item\n    ) as clientes_teste,\n\tsla -> 'formula' ->> 'string' as sla,\n\trelease_appcenter ->> 'rich_text' as release_appcenter,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(sprint_number->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(sprint->'multi_select') = 'array' \n                THEN sprint->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS sprint_number\n    ) as sprint,\n\t(entrou_em_a_testar_em -> 'date' ->> 'start')::timestamptz as entrou_em_a_testar_em,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(customer->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(customer_id->'multi_select') = 'array' \n                THEN solicitante->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS customer\n    ) as customer_id,\n\tstatus -> 'select' ->> 'name' as status,\n\t(etapa_atualizada_em -> 'date' ->> 'start')::timestamptz as etapa_atualizada_em,\n\tarea -> 'select' ->>'name' as area,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(branch_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(branch->'multi_select') = 'array' \n                THEN branch->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS branch_item\n    ) as branch,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(responsavel_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(responsavel->'people') = 'array' \n                THEN responsavel->'people'\n                ELSE '[]'::jsonb\n            END\n        ) AS responsavel_item\n    ) as responsavel,\n\tatualizado_por -> 'last_edited_by' ->> 'id' as atualizado_por,\n\tprioridade -> 'select' -> 'name' as prioridade,\n\t(atualizado_em ->> 'last_edited_time')::timestamptz as atualizado_em,\n\tentrou_em_finalizado_em -> 'date' ->> 'start' as entrou_em_finalizado_em,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(bloqueando_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(bloqueando->'relation') = 'array' \n                THEN bloqueando->'people'\n                ELSE '[]'::jsonb\n            END\n        ) AS bloqueando_item\n    ) as bloqueando,\n\tlink_externo ->> 'url' as link_externo,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(modulo_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(modulo_do_sistema->'multi_select') = 'array' \n                THEN modulo_do_sistema->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS modulo_item\n    )  as modulo_do_sistema,\n\t(entrou_em_testando_em -> 'date' ->> 'start')::timestamptz as entrou_em_testando_em,\n\tjustificativa -> 'select' ->> 'name' as justificativa,\n\t(dias_ate_o_sla -> 'formula' ->> 'number')::int2 as dias_ate_o_sla,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(projetos_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(projetos->'relation') = 'array' \n                THEN projetos->'relation'\n                ELSE '[]'::jsonb\n            END\n        ) AS projetos_item\n    ) as projetos,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(nome_do_cliente_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(nome_do_cliente->'multi_select') = 'array' \n                THEN nome_do_cliente->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS nome_do_cliente_item\n    ) as nome_do_cliente,\n\t(entrou_em_a_fazer_em -> 'date' ->> 'start')::timestamptz as entrou_em_a_fazer_em,\n\tentered_correction_at -> 'date' -> 'start' as entered_correction_at,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(item_filho_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(item_filho->'relation') = 'array' \n                THEN item_filho->'relation'\n                ELSE '[]'::jsonb\n            END\n        ) AS item_filho_item\n    ) as item_filho,\n\tid_da_tarefa -> 'formula' ->> 'string' as id_da_tarefa,\n\tinicio_do_sla -> 'date' ->> 'start' as inicio_do_sla,\n\t(dias_de_desenvolvimento -> 'formula' ->> 'number')::int2 as dias_de_desenvolvimento,\n\t(integrado -> 'checkbox')::bool as integrado,\n\t(entrou_em_aprovado_em -> 'date' ->> 'start')::timestamptz as entrou_em_aprovado_em,\n\t(entrou_em_fazendo_em -> 'date' ->> 'start')::timestamptz as entrou_em_fazendo_em,\n\t(SELECT titulo_item->'text'->'content'\n    FROM jsonb_array_elements( titulo->'title') AS titulo_item\n    LIMIT 1\n    ) as titulo,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(melhoria_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(melhoria->'relation') = 'array' \n                THEN melhoria->'relation'\n                ELSE '[]'::jsonb\n            END\n        ) AS melhoria_item\n    ) as melhoria,\n\t(entrou_em_aguardando_versao_em -> 'date' ->> 'start')::timestamptz as entrou_em_aguardando_versao_em,\n\t(atraso ->> 'number')::int2 as atraso,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(integracao_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(integracao->'multi_select') = 'array' \n                THEN integracao->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS integracao_item\n    ) as integracao,\n\t(dias_ate_a_conclusao -> 'formula' ->> 'number')::int2 as dias_ate_a_conclusao,\n\t(dias_ate_o_desenvolvimento -> 'formula' ->> 'number')::int2 as dias_ate_o_desenvolvimento,\n\t--id_dos_clientes_teste as id_dos_clientes_teste,\n\tetapa -> 'select' ->> 'name' as etapa,\n\t(prazo -> 'date' ->> 'start'):: timestamptz as prazo,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(ambiente_item->>'name'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(ambiente->'multi_select') = 'array' \n                THEN ambiente->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS ambiente_item\n    ) as ambiente,\n\tcriado_por -> 'created_by' ->> 'id' as criado_por,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(item_pai_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(item_pai->'multi_select') = 'array' \n                THEN item_pai->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS item_pai_item\n    ) as item_pai,\n\t(criado_em ->> 'created_time')::timestamptz as criado_em,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(bloqueado_por_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(bloqueado_por->'multi_select') = 'array' \n                THEN bloqueado_por->'multi_select'\n                ELSE '[]'::jsonb\n            END\n        ) AS bloqueado_por_item\n    ) as bloqueado_por,\n\tarray[ (duracao_da_tarefa -> 'formula' -> 'date' ->>'start')::timestamptz, (duracao_da_tarefa -> 'formula' -> 'date' ->>'end')::timestamptz ] as duracao_da_tarefa,\n\t(dias_na_etapa -> 'formula' ->> 'number')::int2 as dias_na_etapa,\n\t(entrou_em_backlog_em -> 'date' ->> 'start')::timestamptz as entrou_em_backlog_em,\n\tokr-> 'select' ->> 'name' as okr,\n\t(id_da_pagina -> 'unique_id' ->> 'number')::int2 as id_da_pagina,\n\t(SELECT \n        COALESCE(\n            jsonb_agg(tester_item->>'id'),\n            '[]'::jsonb\n        )\n        FROM jsonb_array_elements(\n            CASE \n                WHEN jsonb_typeof(tester->'people') = 'array' \n                THEN tester->'people'\n                ELSE '[]'::jsonb\n            END\n        ) AS tester_item\n    ) as tester\nfrom \"bendito_intelligence_dev\".\"notion\".\"ntn_processed_universal_task_database\"", "relation_name": "\"bendito_intelligence_dev\".\"notion\".\"ntn_curated_universal_task_database\"", "batch_results": null}], "elapsed_time": 13.183776617050171, "args": {"print": true, "cache_selected_only": false, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "static_parser": true, "state_modified_compare_vars": false, "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {"target_schema": "notion"}, "log_file_max_bytes": 10485760, "use_colors": true, "write_json": true, "log_format": "default", "profiles_dir": "/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt", "project_dir": "/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt", "strict_mode": false, "state_modified_compare_more_unrendered_values": false, "defer": false, "show_resource_report": false, "invocation_command": "dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models notion --vars {\"target_schema\": \"notion\"}", "version_check": true, "introspect": true, "log_format_file": "debug", "require_nested_cumulative_type_params": false, "log_level_file": "debug", "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "send_anonymous_usage_stats": true, "require_resource_names_without_spaces": false, "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse_file_diff": true, "printer_width": 80, "log_path": "/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs", "populate_cache": true, "use_colors_file": true, "favor_state": false, "empty": false, "select": ["notion"], "which": "run", "exclude": []}}