[0m14:34:56.529611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109267110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109266d80>]}


============================== 14:34:56.532516 | 2527845e-8618-4bba-831f-7cc4f5184c78 ==============================
[0m14:34:56.532516 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:34:56.532876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:56.631436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5baa0>]}
[0m14:34:56.658368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e4920>]}
[0m14:34:56.659162 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:34:56.751816 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:34:56.752368 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:34:56.752574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109292930>]}
[0m14:34:57.069658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bdt_transformations.bitrix
- models.bdt_transformations.notion
[0m14:34:57.072240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6d700>]}
[0m14:34:57.089531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:34:57.091247 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:34:57.101498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e80aa0>]}
[0m14:34:57.101829 [info ] [MainThread]: Found 433 macros
[0m14:34:57.102055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2527845e-8618-4bba-831f-7cc4f5184c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e241a0>]}
[0m14:34:57.102371 [warn ] [MainThread]: The selection criterion 'bitrix' does not match any enabled nodes
[0m14:34:57.102921 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:34:57.103208 [debug] [MainThread]: Command end result
[0m14:34:57.112401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:34:57.113384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:34:57.115017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:34:57.145194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6528586, "process_in_blocks": "0", "process_kernel_time": 0.166319, "process_mem_max_rss": "106053632", "process_out_blocks": "0", "process_user_time": 1.112716}
[0m14:34:57.145579 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:57.145527 after 0.65 seconds
[0m14:34:57.145821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b751f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096978f0>]}
[0m14:34:57.146036 [debug] [MainThread]: Flushing usage events
[0m14:34:57.836886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:55.359255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070366f0>]}


============================== 14:37:55.362309 | 1b680223-4108-473b-9afc-bd205cff094f ==============================
[0m14:37:55.362309 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:37:55.362670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:55.372266 [info ] [MainThread]: dbt version: 1.9.4
[0m14:37:55.372555 [info ] [MainThread]: python version: 3.12.3
[0m14:37:55.372709 [info ] [MainThread]: python path: /Users/cauemausec/Documents/code/workspace/env/bin/python3.12
[0m14:37:55.372856 [info ] [MainThread]: os info: macOS-14.7.4-arm64-arm-64bit
[0m14:37:55.411498 [info ] [MainThread]: Using profiles dir at /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt
[0m14:37:55.411815 [info ] [MainThread]: Using profiles.yml file at /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/profiles.yml
[0m14:37:55.411976 [info ] [MainThread]: Using dbt_project.yml file at /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/dbt_project.yml
[0m14:37:55.412383 [info ] [MainThread]: adapter type: postgres
[0m14:37:55.412664 [info ] [MainThread]: adapter version: 1.9.0
[0m14:37:55.461782 [info ] [MainThread]: Configuration:
[0m14:37:55.462197 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:37:55.462359 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:37:55.462505 [info ] [MainThread]: Required dependencies:
[0m14:37:55.462715 [debug] [MainThread]: Executing "git --help"
[0m14:37:55.479804 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:37:55.480464 [debug] [MainThread]: STDERR: "b''"
[0m14:37:55.480685 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:37:55.480881 [info ] [MainThread]: Connection:
[0m14:37:55.481076 [info ] [MainThread]:   host: ep-royal-snow-a5l2z05g.us-east-2.aws.neon.tech
[0m14:37:55.481222 [info ] [MainThread]:   port: 5432
[0m14:37:55.481355 [info ] [MainThread]:   user: bendito_home_owner
[0m14:37:55.481483 [info ] [MainThread]:   database: bendito_intelligence_dev
[0m14:37:55.481606 [info ] [MainThread]:   schema: transformed
[0m14:37:55.481731 [info ] [MainThread]:   connect_timeout: 10
[0m14:37:55.481861 [info ] [MainThread]:   role: None
[0m14:37:55.481987 [info ] [MainThread]:   search_path: None
[0m14:37:55.482113 [info ] [MainThread]:   keepalives_idle: 0
[0m14:37:55.482237 [info ] [MainThread]:   sslmode: None
[0m14:37:55.482358 [info ] [MainThread]:   sslcert: None
[0m14:37:55.482481 [info ] [MainThread]:   sslkey: None
[0m14:37:55.482596 [info ] [MainThread]:   sslrootcert: None
[0m14:37:55.482712 [info ] [MainThread]:   application_name: dbt
[0m14:37:55.482829 [info ] [MainThread]:   retries: 1
[0m14:37:55.483443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:55.540997 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:37:55.566243 [debug] [MainThread]: Using postgres connection "debug"
[0m14:37:55.566533 [debug] [MainThread]: On debug: select 1 as id
[0m14:37:55.566691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:56.834500 [debug] [MainThread]: SQL status: SELECT 1 in 1.268 seconds
[0m14:37:56.836593 [debug] [MainThread]: On debug: Close
[0m14:37:56.837366 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:37:56.837769 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:37:56.842401 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5219626, "process_in_blocks": "0", "process_kernel_time": 0.182456, "process_mem_max_rss": "115310592", "process_out_blocks": "0", "process_user_time": 0.817209}
[0m14:37:56.843124 [debug] [MainThread]: Command `dbt debug` succeeded at 14:37:56.842989 after 1.52 seconds
[0m14:37:56.843528 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:37:56.843938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef4830>]}
[0m14:37:56.844522 [debug] [MainThread]: Flushing usage events
[0m14:37:57.485318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:02.403059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036b40>]}


============================== 14:38:02.405876 | e40123ec-4e5f-40eb-8cac-0637a87c1b53 ==============================
[0m14:38:02.405876 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:38:02.406326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile --models bitrix', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:02.505835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e40123ec-4e5f-40eb-8cac-0637a87c1b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036d80>]}
[0m14:38:02.532744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e40123ec-4e5f-40eb-8cac-0637a87c1b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044da840>]}
[0m14:38:02.533613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:02.593588 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:38:02.633665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:38:02.633986 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://bitrix/t_processed_deal_stage.sql
[0m14:38:02.634162 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://bitrix/t_processed_dealcategory.sql
[0m14:38:02.634313 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://bitrix/t_processed_activity.sql
[0m14:38:02.756868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bdt_transformations.bitrix
- models.bdt_transformations.notion
[0m14:38:02.759562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e40123ec-4e5f-40eb-8cac-0637a87c1b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb6120>]}
[0m14:38:02.786161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:38:02.788611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:38:02.799898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e40123ec-4e5f-40eb-8cac-0637a87c1b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d77200>]}
[0m14:38:02.800226 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:38:02.800408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e40123ec-4e5f-40eb-8cac-0637a87c1b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6a630>]}
[0m14:38:02.800717 [warn ] [MainThread]: The selection criterion 'bitrix' does not match any enabled nodes
[0m14:38:02.801302 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:38:02.801573 [debug] [MainThread]: Command end result
[0m14:38:02.810634 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:38:02.811506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:38:02.813109 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:38:02.814230 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.44899982, "process_in_blocks": "0", "process_kernel_time": 0.154903, "process_mem_max_rss": "113344512", "process_out_blocks": "0", "process_user_time": 0.986128}
[0m14:38:02.814484 [debug] [MainThread]: Command `dbt compile` succeeded at 14:38:02.814435 after 0.45 seconds
[0m14:38:02.814691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62d50>]}
[0m14:38:02.814883 [debug] [MainThread]: Flushing usage events
[0m14:38:03.415488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:07.220274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111885d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3a900>]}


============================== 14:39:07.223848 | 8b1b6ccb-16e7-46dd-96fe-4a622c8da296 ==============================
[0m14:39:07.223848 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:39:07.224329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --models bitrix', 'send_anonymous_usage_stats': 'True'}
[0m14:39:07.336004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d14680>]}
[0m14:39:07.363683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107515a90>]}
[0m14:39:07.364522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:07.424265 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:39:07.456384 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:39:07.456742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116634d0>]}
[0m14:39:07.871350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m14:39:07.873986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d9130>]}
[0m14:39:07.899420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:39:07.901506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:39:07.914144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11294c380>]}
[0m14:39:07.914475 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:39:07.914658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f7c50>]}
[0m14:39:07.915454 [info ] [MainThread]: 
[0m14:39:07.915638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:07.915906 [info ] [MainThread]: 
[0m14:39:07.916270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:07.918204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev_transformed_transformed'
[0m14:39:07.978077 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_transformed"
[0m14:39:07.978380 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: BEGIN
[0m14:39:07.978544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:09.404191 [debug] [ThreadPool]: SQL status: BEGIN in 1.425 seconds
[0m14:39:09.405042 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_transformed"
[0m14:39:09.405400 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_transformed_transformed"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformed_transformed'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformed_transformed'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformed_transformed'
  
[0m14:39:09.577844 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.172 seconds
[0m14:39:09.580036 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: ROLLBACK
[0m14:39:09.732790 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: Close
[0m14:39:09.739387 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:09.739771 [debug] [MainThread]: On master: BEGIN
[0m14:39:09.740045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:10.959925 [debug] [MainThread]: SQL status: BEGIN in 1.220 seconds
[0m14:39:10.960411 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:10.960763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:11.169735 [debug] [MainThread]: SQL status: SELECT 0 in 0.208 seconds
[0m14:39:11.172023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1b6ccb-16e7-46dd-96fe-4a622c8da296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112893ec0>]}
[0m14:39:11.172734 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:11.322424 [debug] [MainThread]: On master: Close
[0m14:39:11.328967 [debug] [Thread-1 (]: Began running node model.bdt_transformations.t_processed_activity
[0m14:39:11.329385 [debug] [Thread-2 (]: Began running node model.bdt_transformations.t_processed_deal_stage
[0m14:39:11.329772 [debug] [Thread-3 (]: Began running node model.bdt_transformations.t_processed_dealcategory
[0m14:39:11.330173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_transformed_transformed, now model.bdt_transformations.t_processed_activity)
[0m14:39:11.330608 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.t_processed_deal_stage'
[0m14:39:11.331299 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.t_processed_dealcategory'
[0m14:39:11.331717 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.t_processed_activity
[0m14:39:11.332041 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.t_processed_deal_stage
[0m14:39:11.332326 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.t_processed_dealcategory
[0m14:39:11.339814 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_activity"
[0m14:39:11.341915 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:11.343689 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:11.345142 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.t_processed_activity
[0m14:39:11.345563 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.t_processed_dealcategory
[0m14:39:11.346203 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.t_processed_activity
[0m14:39:11.346444 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.t_processed_deal_stage
[0m14:39:11.346913 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.t_processed_dealcategory
[0m14:39:11.347710 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.t_processed_deal_stage
[0m14:39:11.348639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:11.348902 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_activity' was properly closed.
[0m14:39:11.349113 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_deal_stage' was properly closed.
[0m14:39:11.349300 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_dealcategory' was properly closed.
[0m14:39:11.349917 [debug] [MainThread]: Command end result
[0m14:39:11.363043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:39:11.363973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:39:11.368234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:39:11.368546 [debug] [MainThread]: Excluded node 't_processed_activity' from results
[0m14:39:11.368715 [debug] [MainThread]: Excluded node 't_processed_dealcategory' from results
[0m14:39:11.368864 [debug] [MainThread]: Excluded node 't_processed_deal_stage' from results
[0m14:39:11.370620 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.196539, "process_in_blocks": "0", "process_kernel_time": 0.226075, "process_mem_max_rss": "124567552", "process_out_blocks": "0", "process_user_time": 1.391737}
[0m14:39:11.371000 [debug] [MainThread]: Command `dbt compile` succeeded at 14:39:11.370924 after 4.20 seconds
[0m14:39:11.371228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3a900>]}
[0m14:39:11.371447 [debug] [MainThread]: Flushing usage events
[0m14:39:11.971511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:16.690483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e96cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e96a50>]}


============================== 14:39:16.693649 | 68cd4bb1-7ee5-4f95-834b-595e41848e01 ==============================
[0m14:39:16.693649 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:39:16.693994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models bitrix', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:39:16.781038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74b00>]}
[0m14:39:16.808808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c2840>]}
[0m14:39:16.809579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:16.873825 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:39:16.922334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:16.922611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:16.925330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m14:39:16.935297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cea20>]}
[0m14:39:16.962491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:39:16.964672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:39:16.976457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0cad0>]}
[0m14:39:16.976715 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:39:16.976887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1c7a0>]}
[0m14:39:16.977643 [info ] [MainThread]: 
[0m14:39:16.977833 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:16.977969 [info ] [MainThread]: 
[0m14:39:16.978208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:16.980133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m14:39:17.009106 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m14:39:17.009418 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m14:39:17.009579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:18.270775 [debug] [ThreadPool]: SQL status: SELECT 62 in 1.261 seconds
[0m14:39:18.273234 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m14:39:18.274464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_transformed_transformed)
[0m14:39:18.276337 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "transformed_transformed"
"
[0m14:39:18.282186 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_transformed"
[0m14:39:18.282588 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_transformed: BEGIN
[0m14:39:18.282823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:19.516114 [debug] [ThreadPool]: SQL status: BEGIN in 1.233 seconds
[0m14:39:19.516689 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_transformed"
[0m14:39:19.516936 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_transformed_transformed"} */
create schema if not exists "transformed_transformed"
[0m14:39:19.684773 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.168 seconds
[0m14:39:19.685612 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_transformed: COMMIT
[0m14:39:19.685845 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_transformed"
[0m14:39:19.686033 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_transformed: COMMIT
[0m14:39:19.844008 [debug] [ThreadPool]: SQL status: COMMIT in 0.158 seconds
[0m14:39:19.844941 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_transformed: Close
[0m14:39:19.846693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_transformed_transformed, now list_bendito_intelligence_dev_transformed_transformed)
[0m14:39:19.852222 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_transformed"
[0m14:39:19.852549 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: BEGIN
[0m14:39:19.852791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:21.083170 [debug] [ThreadPool]: SQL status: BEGIN in 1.230 seconds
[0m14:39:21.083964 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_transformed"
[0m14:39:21.084377 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_transformed_transformed"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformed_transformed'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformed_transformed'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformed_transformed'
  
[0m14:39:21.236749 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.152 seconds
[0m14:39:21.238739 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: ROLLBACK
[0m14:39:21.389837 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_transformed: Close
[0m14:39:21.396727 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:21.397313 [debug] [MainThread]: On master: BEGIN
[0m14:39:21.397634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:22.627277 [debug] [MainThread]: SQL status: BEGIN in 1.230 seconds
[0m14:39:22.627662 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:22.627973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:22.789540 [debug] [MainThread]: SQL status: SELECT 0 in 0.161 seconds
[0m14:39:22.790532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109321760>]}
[0m14:39:22.790854 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:22.940427 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:22.940911 [debug] [MainThread]: On master: BEGIN
[0m14:39:23.243828 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m14:39:23.244540 [debug] [MainThread]: On master: COMMIT
[0m14:39:23.244830 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:23.245047 [debug] [MainThread]: On master: COMMIT
[0m14:39:23.394884 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m14:39:23.395297 [debug] [MainThread]: On master: Close
[0m14:39:23.398497 [debug] [Thread-1 (]: Began running node model.bdt_transformations.t_processed_activity
[0m14:39:23.398831 [debug] [Thread-2 (]: Began running node model.bdt_transformations.t_processed_deal_stage
[0m14:39:23.399405 [debug] [Thread-3 (]: Began running node model.bdt_transformations.t_processed_dealcategory
[0m14:39:23.399196 [info ] [Thread-1 (]: 1 of 3 START sql table model transformed_transformed.t_processed_activity ...... [RUN]
[0m14:39:23.399732 [info ] [Thread-2 (]: 2 of 3 START sql table model transformed_transformed.t_processed_deal_stage .... [RUN]
[0m14:39:23.400114 [info ] [Thread-3 (]: 3 of 3 START sql table model transformed_transformed.t_processed_dealcategory .. [RUN]
[0m14:39:23.400404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_transformed_transformed, now model.bdt_transformations.t_processed_activity)
[0m14:39:23.400680 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.t_processed_deal_stage'
[0m14:39:23.400923 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.t_processed_dealcategory'
[0m14:39:23.401121 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.t_processed_activity
[0m14:39:23.401304 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.t_processed_deal_stage
[0m14:39:23.401478 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.t_processed_dealcategory
[0m14:39:23.405886 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_activity"
[0m14:39:23.407384 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:23.408741 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:23.409331 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.t_processed_activity
[0m14:39:23.415207 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.t_processed_deal_stage
[0m14:39:23.433305 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:23.434672 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.t_processed_activity"
[0m14:39:23.434932 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.t_processed_dealcategory
[0m14:39:23.436734 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:23.437396 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:23.437644 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.t_processed_activity"
[0m14:39:23.437869 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:23.438065 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: BEGIN
[0m14:39:23.438249 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: BEGIN
[0m14:39:23.438418 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: BEGIN
[0m14:39:23.438590 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:39:23.438754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:23.438940 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:39:24.669199 [debug] [Thread-1 (]: SQL status: BEGIN in 1.230 seconds
[0m14:39:24.669593 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.t_processed_activity"
[0m14:39:24.669841 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_activity"} */

  
    

  create  table "bendito_intelligence_dev"."transformed_transformed"."t_processed_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
FROM bitrix.t_raw_activity
  );
  
[0m14:39:24.670771 [debug] [Thread-2 (]: SQL status: BEGIN in 1.232 seconds
[0m14:39:24.671113 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:24.671362 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_deal_stage"} */

  
    

  create  table "bendito_intelligence_dev"."transformed_transformed"."t_processed_deal_stage__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.t_raw_deal_stage
  );
  
[0m14:39:24.685253 [debug] [Thread-3 (]: SQL status: BEGIN in 1.247 seconds
[0m14:39:24.685568 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:24.685798 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_dealcategory"} */

  
    

  create  table "bendito_intelligence_dev"."transformed_transformed"."t_processed_dealcategory__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.t_raw_dealcategory
  );
  
[0m14:39:24.858724 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.187 seconds
[0m14:39:24.866226 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.180 seconds
[0m14:39:24.866113 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:24.869323 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:24.869880 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."transformed_transformed"."t_processed_deal_stage__dbt_tmp" rename to "t_processed_deal_stage"
[0m14:39:24.870214 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."transformed_transformed"."t_processed_dealcategory__dbt_tmp" rename to "t_processed_dealcategory"
[0m14:39:25.022257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m14:39:25.029284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m14:39:25.042960 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: COMMIT
[0m14:39:25.041605 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: COMMIT
[0m14:39:25.043539 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:25.043890 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:25.044150 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: COMMIT
[0m14:39:25.044387 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: COMMIT
[0m14:39:25.202458 [debug] [Thread-2 (]: SQL status: COMMIT in 0.158 seconds
[0m14:39:25.209358 [debug] [Thread-3 (]: SQL status: COMMIT in 0.165 seconds
[0m14:39:25.208956 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."transformed_transformed"."t_processed_deal_stage__dbt_backup"
[0m14:39:25.212035 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."transformed_transformed"."t_processed_dealcategory__dbt_backup"
[0m14:39:25.216838 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.t_processed_deal_stage"
[0m14:39:25.217442 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.t_processed_dealcategory"
[0m14:39:25.217741 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_deal_stage"} */
drop table if exists "bendito_intelligence_dev"."transformed_transformed"."t_processed_deal_stage__dbt_backup" cascade
[0m14:39:25.218027 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_dealcategory"} */
drop table if exists "bendito_intelligence_dev"."transformed_transformed"."t_processed_dealcategory__dbt_backup" cascade
[0m14:39:25.371524 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.153 seconds
[0m14:39:25.372253 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.154 seconds
[0m14:39:25.375862 [debug] [Thread-3 (]: On model.bdt_transformations.t_processed_dealcategory: Close
[0m14:39:25.377695 [debug] [Thread-2 (]: On model.bdt_transformations.t_processed_deal_stage: Close
[0m14:39:25.381726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f18320>]}
[0m14:39:25.382206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0f620>]}
[0m14:39:25.382998 [info ] [Thread-3 (]: 3 of 3 OK created sql table model transformed_transformed.t_processed_dealcategory  [[32mSELECT 4[0m in 1.98s]
[0m14:39:25.383577 [info ] [Thread-2 (]: 2 of 3 OK created sql table model transformed_transformed.t_processed_deal_stage  [[32mSELECT 11[0m in 1.98s]
[0m14:39:25.384135 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.t_processed_dealcategory
[0m14:39:25.384599 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.t_processed_deal_stage
[0m14:39:25.565558 [debug] [Thread-1 (]: SQL status: SELECT 1833 in 0.895 seconds
[0m14:39:25.568272 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.t_processed_activity"
[0m14:39:25.568648 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_activity"} */
alter table "bendito_intelligence_dev"."transformed_transformed"."t_processed_activity__dbt_tmp" rename to "t_processed_activity"
[0m14:39:25.718615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m14:39:25.721696 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: COMMIT
[0m14:39:25.722486 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.t_processed_activity"
[0m14:39:25.722871 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: COMMIT
[0m14:39:25.875201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m14:39:25.879707 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."transformed_transformed"."t_processed_activity__dbt_backup"
[0m14:39:25.880427 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.t_processed_activity"
[0m14:39:25.880773 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.t_processed_activity"} */
drop table if exists "bendito_intelligence_dev"."transformed_transformed"."t_processed_activity__dbt_backup" cascade
[0m14:39:26.031814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.151 seconds
[0m14:39:26.033614 [debug] [Thread-1 (]: On model.bdt_transformations.t_processed_activity: Close
[0m14:39:26.034459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cd4bb1-7ee5-4f95-834b-595e41848e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa7ec0>]}
[0m14:39:26.035051 [info ] [Thread-1 (]: 1 of 3 OK created sql table model transformed_transformed.t_processed_activity . [[32mSELECT 1833[0m in 2.63s]
[0m14:39:26.035555 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.t_processed_activity
[0m14:39:26.036720 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:26.037001 [debug] [MainThread]: On master: BEGIN
[0m14:39:26.037236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:27.258589 [debug] [MainThread]: SQL status: BEGIN in 1.221 seconds
[0m14:39:27.258963 [debug] [MainThread]: On master: COMMIT
[0m14:39:27.259156 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:27.259332 [debug] [MainThread]: On master: COMMIT
[0m14:39:27.410110 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m14:39:27.410539 [debug] [MainThread]: On master: Close
[0m14:39:27.411027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:27.411256 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_activity' was properly closed.
[0m14:39:27.411460 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_deal_stage' was properly closed.
[0m14:39:27.411672 [debug] [MainThread]: Connection 'model.bdt_transformations.t_processed_dealcategory' was properly closed.
[0m14:39:27.411949 [info ] [MainThread]: 
[0m14:39:27.412223 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.43 seconds (10.43s).
[0m14:39:27.412939 [debug] [MainThread]: Command end result
[0m14:39:27.427205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:39:27.428426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:39:27.432884 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:39:27.433163 [info ] [MainThread]: 
[0m14:39:27.433408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:27.433598 [info ] [MainThread]: 
[0m14:39:27.433804 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:39:27.435854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.780506, "process_in_blocks": "0", "process_kernel_time": 0.214766, "process_mem_max_rss": "123518976", "process_out_blocks": "0", "process_user_time": 1.157984}
[0m14:39:27.436280 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:27.436213 after 10.78 seconds
[0m14:39:27.436645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b02c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3770>]}
[0m14:39:27.436913 [debug] [MainThread]: Flushing usage events
[0m14:39:28.045763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:38.272843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e76bd0>]}


============================== 17:12:38.275565 | 45a5e6a2-5a71-4566-95ee-7852320a9334 ==============================
[0m17:12:38.275565 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:38.275911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:38.365977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105323d40>]}
[0m17:12:38.391429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cae10>]}
[0m17:12:38.392088 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:38.487607 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:38.517639 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:12:38.517969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4c9b0>]}
[0m17:12:38.911039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m17:12:38.913393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1bdd0>]}
[0m17:12:38.937792 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:12:38.939664 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:12:38.951921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b4d0>]}
[0m17:12:38.952235 [info ] [MainThread]: Found 4 models, 433 macros
[0m17:12:38.952410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c48290>]}
[0m17:12:38.953302 [info ] [MainThread]: 
[0m17:12:38.953510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:12:38.953653 [info ] [MainThread]: 
[0m17:12:38.953922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:38.955775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:12:39.020740 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:12:39.021017 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:12:39.021177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:40.258289 [debug] [ThreadPool]: SQL status: SELECT 63 in 1.237 seconds
[0m17:12:40.260052 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:12:40.260954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_transformed_bitrix)
[0m17:12:40.261678 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "transformed_bitrix"
"
[0m17:12:40.266406 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_bitrix"
[0m17:12:40.266714 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_bitrix: BEGIN
[0m17:12:40.266951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:41.483731 [debug] [ThreadPool]: SQL status: BEGIN in 1.217 seconds
[0m17:12:41.484686 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_bitrix"
[0m17:12:41.485110 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_transformed_bitrix"} */
create schema if not exists "transformed_bitrix"
[0m17:12:41.663581 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.178 seconds
[0m17:12:41.668161 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_bitrix: COMMIT
[0m17:12:41.669139 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_transformed_bitrix"
[0m17:12:41.669611 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_bitrix: COMMIT
[0m17:12:41.820220 [debug] [ThreadPool]: SQL status: COMMIT in 0.150 seconds
[0m17:12:41.822619 [debug] [ThreadPool]: On create_bendito_intelligence_dev_transformed_bitrix: Close
[0m17:12:41.825623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_transformed_bitrix, now list_bendito_intelligence_dev_transformed_bitrix)
[0m17:12:41.833941 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_bitrix"
[0m17:12:41.834431 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: BEGIN
[0m17:12:41.834808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:43.087424 [debug] [ThreadPool]: SQL status: BEGIN in 1.252 seconds
[0m17:12:43.089627 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_bitrix"
[0m17:12:43.090739 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_transformed_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformed_bitrix'
  
[0m17:12:43.260700 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.169 seconds
[0m17:12:43.266069 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: ROLLBACK
[0m17:12:43.427430 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: Close
[0m17:12:43.437934 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:43.438544 [debug] [MainThread]: On master: BEGIN
[0m17:12:43.438972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:44.671768 [debug] [MainThread]: SQL status: BEGIN in 1.232 seconds
[0m17:12:44.674183 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:44.675049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:44.852945 [debug] [MainThread]: SQL status: SELECT 0 in 0.177 seconds
[0m17:12:44.858873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a956a0>]}
[0m17:12:44.859921 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:45.010632 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:45.012554 [debug] [MainThread]: On master: BEGIN
[0m17:12:45.313377 [debug] [MainThread]: SQL status: BEGIN in 0.300 seconds
[0m17:12:45.315666 [debug] [MainThread]: On master: COMMIT
[0m17:12:45.316804 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:45.317709 [debug] [MainThread]: On master: COMMIT
[0m17:12:45.468174 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m17:12:45.468965 [debug] [MainThread]: On master: Close
[0m17:12:45.473736 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:12:45.474149 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:12:45.474548 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:12:45.474934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_transformed_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:12:45.475253 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:12:45.475638 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:12:45.476113 [info ] [Thread-3 (]: 1 of 2 START sql incremental model transformed_bitrix.btx_processed_deal_stage . [RUN]
[0m17:12:45.476439 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:12:45.476780 [info ] [Thread-4 (]: 2 of 2 START sql incremental model transformed_bitrix.btx_processed_dealcategory  [RUN]
[0m17:12:45.477057 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:12:45.477376 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:12:45.484735 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:12:45.485375 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m17:12:45.488467 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:12:45.488841 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:12:45.489505 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:12:45.492136 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:12:45.495250 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:12:45.495859 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:12:45.496692 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:12:45.497095 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:12:45.497333 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:12:45.532000 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:12:45.534004 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:12:45.534565 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:12:45.534789 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:12:45.534969 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:45.535273 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:12:45.535473 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:12:45.535646 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:46.752478 [debug] [Thread-4 (]: SQL status: BEGIN in 1.217 seconds
[0m17:12:46.752881 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:12:46.753170 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."transformed_bitrix"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.t_raw_dealcategory
  );
  
  
[0m17:12:46.758440 [debug] [Thread-3 (]: SQL status: BEGIN in 1.223 seconds
[0m17:12:46.758740 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:12:46.759028 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."transformed_bitrix"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.t_raw_deal_stage
  );
  
  
[0m17:12:46.914924 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "bitrix.t_raw_dealcategory" does not exist
LINE 20: FROM bitrix.t_raw_dealcategory
              ^

[0m17:12:46.917565 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: ROLLBACK
[0m17:12:46.920740 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "bitrix.t_raw_deal_stage" does not exist
LINE 20: FROM bitrix.t_raw_deal_stage
              ^

[0m17:12:46.924302 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: ROLLBACK
[0m17:12:47.068575 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:12:47.076353 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:12:47.079421 [debug] [Thread-4 (]: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "bitrix.t_raw_dealcategory" does not exist
  LINE 20: FROM bitrix.t_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m17:12:47.081642 [debug] [Thread-3 (]: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "bitrix.t_raw_deal_stage" does not exist
  LINE 20: FROM bitrix.t_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m17:12:47.082145 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbb140>]}
[0m17:12:47.082407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a5e6a2-5a71-4566-95ee-7852320a9334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c01be0>]}
[0m17:12:47.082912 [error] [Thread-4 (]: 2 of 2 ERROR creating sql incremental model transformed_bitrix.btx_processed_dealcategory  [[31mERROR[0m in 1.59s]
[0m17:12:47.083379 [error] [Thread-3 (]: 1 of 2 ERROR creating sql incremental model transformed_bitrix.btx_processed_deal_stage  [[31mERROR[0m in 1.60s]
[0m17:12:47.083760 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:12:47.084086 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:12:47.084392 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_dealcategory' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "bitrix.t_raw_dealcategory" does not exist
  LINE 20: FROM bitrix.t_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql.
[0m17:12:47.085093 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_stage' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "bitrix.t_raw_deal_stage" does not exist
  LINE 20: FROM bitrix.t_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql.
[0m17:12:47.085857 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:47.086100 [debug] [MainThread]: On master: BEGIN
[0m17:12:47.086293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:48.345560 [debug] [MainThread]: SQL status: BEGIN in 1.258 seconds
[0m17:12:48.347877 [debug] [MainThread]: On master: COMMIT
[0m17:12:48.348881 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:48.350062 [debug] [MainThread]: On master: COMMIT
[0m17:12:48.502872 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:12:48.505266 [debug] [MainThread]: On master: Close
[0m17:12:48.506697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:48.507201 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m17:12:48.507628 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m17:12:48.508023 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m17:12:48.508395 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:12:48.509111 [info ] [MainThread]: 
[0m17:12:48.509739 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 9.56 seconds (9.56s).
[0m17:12:48.510914 [debug] [MainThread]: Command end result
[0m17:12:48.534437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:12:48.536423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:12:48.541570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:12:48.541813 [info ] [MainThread]: 
[0m17:12:48.542066 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:12:48.542282 [info ] [MainThread]: 
[0m17:12:48.542542 [error] [MainThread]:   Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "bitrix.t_raw_dealcategory" does not exist
  LINE 20: FROM bitrix.t_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m17:12:48.542751 [info ] [MainThread]: 
[0m17:12:48.542985 [error] [MainThread]:   Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "bitrix.t_raw_deal_stage" does not exist
  LINE 20: FROM bitrix.t_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m17:12:48.543180 [info ] [MainThread]: 
[0m17:12:48.543395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m17:12:48.582322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.344008, "process_in_blocks": "0", "process_kernel_time": 0.22893, "process_mem_max_rss": "124387328", "process_out_blocks": "0", "process_user_time": 1.543143}
[0m17:12:48.582816 [debug] [MainThread]: Command `dbt run` failed at 17:12:48.582742 after 10.34 seconds
[0m17:12:48.583153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100aded50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fe0f0>]}
[0m17:12:48.583468 [debug] [MainThread]: Flushing usage events
[0m17:12:49.211073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:58.492894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a96ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a96b70>]}


============================== 17:15:58.495808 | 08907238-2f80-4afd-b425-e7098330370d ==============================
[0m17:15:58.495808 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:58.496164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:58.575543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104874890>]}
[0m17:15:58.600472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b1af0>]}
[0m17:15:58.601476 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:58.663502 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:15:58.709081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:15:58.709439 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m17:15:58.709644 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m17:15:58.709834 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m17:15:58.822049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m17:15:58.824456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a08950>]}
[0m17:15:58.850729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:15:58.852932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:15:58.864601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e510d0>]}
[0m17:15:58.864918 [info ] [MainThread]: Found 4 models, 433 macros
[0m17:15:58.865096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9f020>]}
[0m17:15:58.865885 [info ] [MainThread]: 
[0m17:15:58.866080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:58.866223 [info ] [MainThread]: 
[0m17:15:58.866474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:58.868392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:15:58.906127 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:15:58.906435 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:15:58.906617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:00.163329 [debug] [ThreadPool]: SQL status: SELECT 64 in 1.257 seconds
[0m17:16:00.165074 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:16:00.166405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_transformed_bitrix)
[0m17:16:00.172034 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_bitrix"
[0m17:16:00.172377 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: BEGIN
[0m17:16:00.172627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:01.392526 [debug] [ThreadPool]: SQL status: BEGIN in 1.220 seconds
[0m17:16:01.393351 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_transformed_bitrix"
[0m17:16:01.393741 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_transformed_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformed_bitrix'
  
[0m17:16:01.545200 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.150 seconds
[0m17:16:01.550173 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: ROLLBACK
[0m17:16:01.700016 [debug] [ThreadPool]: On list_bendito_intelligence_dev_transformed_bitrix: Close
[0m17:16:01.712679 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:01.713377 [debug] [MainThread]: On master: BEGIN
[0m17:16:01.713768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:02.933629 [debug] [MainThread]: SQL status: BEGIN in 1.219 seconds
[0m17:16:02.935808 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:02.936793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:03.105338 [debug] [MainThread]: SQL status: SELECT 0 in 0.167 seconds
[0m17:16:03.110175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701af30>]}
[0m17:16:03.111326 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:03.262164 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:03.266796 [debug] [MainThread]: On master: BEGIN
[0m17:16:03.566257 [debug] [MainThread]: SQL status: BEGIN in 0.298 seconds
[0m17:16:03.568699 [debug] [MainThread]: On master: COMMIT
[0m17:16:03.569873 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:03.570846 [debug] [MainThread]: On master: COMMIT
[0m17:16:03.720252 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m17:16:03.722566 [debug] [MainThread]: On master: Close
[0m17:16:03.730626 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:16:03.731283 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:16:03.732107 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:16:03.732633 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:16:03.733230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_transformed_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:16:03.733847 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:16:03.734560 [info ] [Thread-3 (]: 1 of 2 START sql incremental model transformed_bitrix.btx_processed_deal_stage . [RUN]
[0m17:16:03.735220 [info ] [Thread-4 (]: 2 of 2 START sql incremental model transformed_bitrix.btx_processed_dealcategory  [RUN]
[0m17:16:03.735696 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:16:03.736106 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:16:03.736625 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:16:03.737122 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m17:16:03.745148 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:16:03.748087 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:16:03.748482 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:16:03.748804 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:16:03.751352 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:16:03.753310 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:16:03.754138 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:16:03.754759 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:16:03.755146 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:16:03.755722 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:16:03.803913 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:16:03.805141 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:16:03.805633 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:16:03.805845 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:16:03.806033 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:16:03.806211 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:16:03.806383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:16:03.806546 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:16:05.015841 [debug] [Thread-3 (]: SQL status: BEGIN in 1.206 seconds
[0m17:16:05.017594 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:16:05.018449 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."transformed_bitrix"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m17:16:05.026840 [debug] [Thread-4 (]: SQL status: BEGIN in 1.220 seconds
[0m17:16:05.027814 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:16:05.028440 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."transformed_bitrix"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m17:16:05.215858 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.187 seconds
[0m17:16:05.216481 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.197 seconds
[0m17:16:05.240284 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:16:05.241379 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:16:05.241700 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:16:05.241976 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:16:05.242229 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:16:05.242469 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:16:05.391671 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m17:16:05.392413 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m17:16:05.395491 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:16:05.396377 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:16:05.400031 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484f7d0>]}
[0m17:16:05.400511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08907238-2f80-4afd-b425-e7098330370d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddc9b0>]}
[0m17:16:05.401332 [info ] [Thread-3 (]: 1 of 2 OK created sql incremental model transformed_bitrix.btx_processed_deal_stage  [[32mSELECT 11[0m in 1.66s]
[0m17:16:05.401964 [info ] [Thread-4 (]: 2 of 2 OK created sql incremental model transformed_bitrix.btx_processed_dealcategory  [[32mSELECT 4[0m in 1.66s]
[0m17:16:05.402536 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:16:05.403022 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:16:05.404548 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:05.404895 [debug] [MainThread]: On master: BEGIN
[0m17:16:05.405195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:06.661395 [debug] [MainThread]: SQL status: BEGIN in 1.255 seconds
[0m17:16:06.664749 [debug] [MainThread]: On master: COMMIT
[0m17:16:06.665311 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:06.665790 [debug] [MainThread]: On master: COMMIT
[0m17:16:06.817326 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:16:06.819848 [debug] [MainThread]: On master: Close
[0m17:16:06.821794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:06.822561 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m17:16:06.822999 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m17:16:06.823340 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m17:16:06.823653 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:16:06.824178 [info ] [MainThread]: 
[0m17:16:06.824620 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m17:16:06.825612 [debug] [MainThread]: Command end result
[0m17:16:06.843899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:16:06.845607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:16:06.850039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:16:06.850317 [info ] [MainThread]: 
[0m17:16:06.850570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:06.850776 [info ] [MainThread]: 
[0m17:16:06.851006 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:16:06.853100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.394784, "process_in_blocks": "0", "process_kernel_time": 0.217879, "process_mem_max_rss": "127942656", "process_out_blocks": "0", "process_user_time": 1.251658}
[0m17:16:06.853482 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:06.853414 after 8.40 seconds
[0m17:16:06.853772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026fed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a50a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a31100>]}
[0m17:16:06.854048 [debug] [MainThread]: Flushing usage events
[0m17:16:07.470659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:43.313538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c090d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108887020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108886c60>]}


============================== 17:36:43.316166 | 582c31ed-5c7d-425e-a28a-638cc6ddbb0e ==============================
[0m17:36:43.316166 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:36:43.316509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:43.343972 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "bdt_transformations", target "dev" invalid: 'schema' is a required property
[0m17:36:43.345153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06344621, "process_in_blocks": "0", "process_kernel_time": 0.106101, "process_mem_max_rss": "95535104", "process_out_blocks": "0", "process_user_time": 0.648565}
[0m17:36:43.345423 [debug] [MainThread]: Command `dbt run` failed at 17:36:43.345371 after 0.06 seconds
[0m17:36:43.345616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104533170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824a6f0>]}
[0m17:36:43.345814 [debug] [MainThread]: Flushing usage events
[0m17:36:44.028503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:10.019529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106033140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106032d50>]}


============================== 17:39:10.022281 | c0a73845-e291-4524-bae7-35feb6e7a7a6 ==============================
[0m17:39:10.022281 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:10.022621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:10.049752 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "bdt_transformations", target "dev" invalid: 'schema' is a required property
[0m17:39:10.051237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.063632086, "process_in_blocks": "0", "process_kernel_time": 0.108124, "process_mem_max_rss": "96026624", "process_out_blocks": "0", "process_user_time": 0.649845}
[0m17:39:10.051508 [debug] [MainThread]: Command `dbt run` failed at 17:39:10.051453 after 0.06 seconds
[0m17:39:10.051701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a66d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b09b0>]}
[0m17:39:10.051892 [debug] [MainThread]: Flushing usage events
[0m17:39:10.675218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:10.467510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d130e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a36de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a36a80>]}


============================== 17:51:10.470680 | e93cb27f-2007-4b1e-a8f5-f0ae741479b0 ==============================
[0m17:51:10.470680 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:51:10.471047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:10.570032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a36db0>]}
[0m17:51:10.595629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a36930>]}
[0m17:51:10.596337 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:51:10.653044 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:51:10.683080 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:51:10.683398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121764530>]}
[0m17:51:11.102416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m17:51:11.105117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217a5ac0>]}
[0m17:51:11.131975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:51:11.134300 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:51:11.146969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217c5100>]}
[0m17:51:11.147305 [info ] [MainThread]: Found 4 models, 433 macros
[0m17:51:11.147539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122046810>]}
[0m17:51:11.148578 [info ] [MainThread]: 
[0m17:51:11.148855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:11.149015 [info ] [MainThread]: 
[0m17:51:11.149269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:11.151081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:51:11.212080 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:51:11.212376 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:51:11.212538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:12.474136 [debug] [ThreadPool]: SQL status: SELECT 65 in 1.261 seconds
[0m17:51:12.475807 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:51:12.476608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_processed_bitrix)
[0m17:51:12.477058 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "processed_bitrix"
"
[0m17:51:12.481676 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_bitrix"
[0m17:51:12.482004 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_bitrix: BEGIN
[0m17:51:12.482266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:13.722233 [debug] [ThreadPool]: SQL status: BEGIN in 1.240 seconds
[0m17:51:13.722729 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_bitrix"
[0m17:51:13.723055 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_processed_bitrix"} */
create schema if not exists "processed_bitrix"
[0m17:51:13.879328 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.156 seconds
[0m17:51:13.880088 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_bitrix: COMMIT
[0m17:51:13.880283 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_bitrix"
[0m17:51:13.880437 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_bitrix: COMMIT
[0m17:51:14.032244 [debug] [ThreadPool]: SQL status: COMMIT in 0.151 seconds
[0m17:51:14.033512 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_bitrix: Close
[0m17:51:14.035834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_processed_bitrix, now list_bendito_intelligence_dev_processed_bitrix)
[0m17:51:14.043500 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_processed_bitrix"
[0m17:51:14.044075 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_bitrix: BEGIN
[0m17:51:14.044453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:15.268448 [debug] [ThreadPool]: SQL status: BEGIN in 1.223 seconds
[0m17:51:15.270885 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_processed_bitrix"
[0m17:51:15.271948 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_processed_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'processed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'processed_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'processed_bitrix'
  
[0m17:51:15.426642 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.153 seconds
[0m17:51:15.432150 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_bitrix: ROLLBACK
[0m17:51:15.581062 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_bitrix: Close
[0m17:51:15.589812 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:15.590518 [debug] [MainThread]: On master: BEGIN
[0m17:51:15.590903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:16.951084 [debug] [MainThread]: SQL status: BEGIN in 1.360 seconds
[0m17:51:16.953449 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:16.954505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:17.130742 [debug] [MainThread]: SQL status: SELECT 0 in 0.175 seconds
[0m17:51:17.132546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122129f70>]}
[0m17:51:17.133132 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:17.289952 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:17.290559 [debug] [MainThread]: On master: BEGIN
[0m17:51:17.599753 [debug] [MainThread]: SQL status: BEGIN in 0.308 seconds
[0m17:51:17.601971 [debug] [MainThread]: On master: COMMIT
[0m17:51:17.602755 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:17.604275 [debug] [MainThread]: On master: COMMIT
[0m17:51:17.762231 [debug] [MainThread]: SQL status: COMMIT in 0.157 seconds
[0m17:51:17.762822 [debug] [MainThread]: On master: Close
[0m17:51:17.766758 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:51:17.767270 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:51:17.767845 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:51:17.768244 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:51:17.768616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_processed_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:51:17.769047 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:51:17.769509 [info ] [Thread-3 (]: 1 of 2 START sql incremental model processed_bitrix.btx_processed_deal_stage ... [RUN]
[0m17:51:17.769943 [info ] [Thread-4 (]: 2 of 2 START sql incremental model processed_bitrix.btx_processed_dealcategory . [RUN]
[0m17:51:17.770246 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:51:17.770501 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:51:17.770835 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:51:17.771150 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m17:51:17.776874 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:51:17.779149 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:51:17.779442 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:51:17.779692 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:51:17.781878 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:51:17.785163 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:51:17.785972 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:51:17.786563 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:51:17.786982 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:51:17.793863 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:51:17.821625 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:51:17.822024 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:51:17.822651 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:51:17.822905 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:51:17.823096 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:51:17.823288 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:51:17.823470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:51:17.823642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:51:19.035252 [debug] [Thread-4 (]: SQL status: BEGIN in 1.211 seconds
[0m17:51:19.035665 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:51:19.035946 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."processed_bitrix"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m17:51:19.071402 [debug] [Thread-3 (]: SQL status: BEGIN in 1.248 seconds
[0m17:51:19.071704 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:51:19.071987 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."processed_bitrix"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m17:51:19.196277 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.159 seconds
[0m17:51:19.221853 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:51:19.222591 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:51:19.222928 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:51:19.236832 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.164 seconds
[0m17:51:19.238909 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:51:19.239349 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:51:19.239694 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:51:19.375991 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m17:51:19.382443 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:51:19.387229 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0f650>]}
[0m17:51:19.388517 [info ] [Thread-4 (]: 2 of 2 OK created sql incremental model processed_bitrix.btx_processed_dealcategory  [[32mSELECT 4[0m in 1.61s]
[0m17:51:19.389300 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:51:19.392484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m17:51:19.393470 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:51:19.394453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93cb27f-2007-4b1e-a8f5-f0ae741479b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12212ba40>]}
[0m17:51:19.395206 [info ] [Thread-3 (]: 1 of 2 OK created sql incremental model processed_bitrix.btx_processed_deal_stage  [[32mSELECT 11[0m in 1.62s]
[0m17:51:19.395986 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:51:19.397450 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.397833 [debug] [MainThread]: On master: BEGIN
[0m17:51:19.398150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:20.629413 [debug] [MainThread]: SQL status: BEGIN in 1.231 seconds
[0m17:51:20.631966 [debug] [MainThread]: On master: COMMIT
[0m17:51:20.633084 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:20.634035 [debug] [MainThread]: On master: COMMIT
[0m17:51:20.785384 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:51:20.786503 [debug] [MainThread]: On master: Close
[0m17:51:20.787465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:20.787799 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m17:51:20.788085 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m17:51:20.788351 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m17:51:20.788612 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:51:20.789020 [info ] [MainThread]: 
[0m17:51:20.789375 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m17:51:20.790221 [debug] [MainThread]: Command end result
[0m17:51:20.810332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:51:20.811769 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:51:20.815654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:51:20.815912 [info ] [MainThread]: 
[0m17:51:20.816175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:20.816371 [info ] [MainThread]: 
[0m17:51:20.816568 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:51:20.818059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.386646, "process_in_blocks": "0", "process_kernel_time": 0.243619, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 1.597571}
[0m17:51:20.818342 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:20.818287 after 10.39 seconds
[0m17:51:20.818576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201da720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224e7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224e4b30>]}
[0m17:51:20.818814 [debug] [MainThread]: Flushing usage events
[0m17:51:21.594870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:22.821745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022d3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10247d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463eba0>]}


============================== 18:16:22.824583 | b80ec948-ac8c-44e3-957c-f68ae069b964 ==============================
[0m18:16:22.824583 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:16:22.824933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix', 'send_anonymous_usage_stats': 'True'}
[0m18:16:22.920149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463c3e0>]}
[0m18:16:22.945368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104315c40>]}
[0m18:16:22.946008 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:16:23.003196 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:16:23.051091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m18:16:23.051436 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m18:16:23.051645 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m18:16:23.051835 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m18:16:23.052018 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m18:16:23.160428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m18:16:23.163178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bf8c0>]}
[0m18:16:23.189180 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:16:23.191348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:16:23.202804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105404f80>]}
[0m18:16:23.203091 [info ] [MainThread]: Found 4 models, 433 macros
[0m18:16:23.203272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052beb10>]}
[0m18:16:23.204033 [info ] [MainThread]: 
[0m18:16:23.204235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:23.204382 [info ] [MainThread]: 
[0m18:16:23.204620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:23.206446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m18:16:23.233919 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m18:16:23.234144 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:16:23.234306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:24.518172 [debug] [ThreadPool]: SQL status: SELECT 59 in 1.283 seconds
[0m18:16:24.523271 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m18:16:24.525349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_processed_)
[0m18:16:24.527743 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "processed_"
"
[0m18:16:24.536730 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_"
[0m18:16:24.537201 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_: BEGIN
[0m18:16:24.537518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:25.782575 [debug] [ThreadPool]: SQL status: BEGIN in 1.244 seconds
[0m18:16:25.784146 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_"
[0m18:16:25.784657 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_processed_"} */
create schema if not exists "processed_"
[0m18:16:25.942840 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.157 seconds
[0m18:16:25.947714 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_: COMMIT
[0m18:16:25.948828 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_processed_"
[0m18:16:25.949339 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_: COMMIT
[0m18:16:26.101230 [debug] [ThreadPool]: SQL status: COMMIT in 0.151 seconds
[0m18:16:26.103074 [debug] [ThreadPool]: On create_bendito_intelligence_dev_processed_: Close
[0m18:16:26.106153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_processed_, now list_bendito_intelligence_dev_processed_)
[0m18:16:26.113755 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_processed_"
[0m18:16:26.114262 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_: BEGIN
[0m18:16:26.114588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:27.332187 [debug] [ThreadPool]: SQL status: BEGIN in 1.217 seconds
[0m18:16:27.333691 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_processed_"
[0m18:16:27.334301 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_processed_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'processed_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'processed_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'processed_'
  
[0m18:16:27.504179 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.169 seconds
[0m18:16:27.509539 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_: ROLLBACK
[0m18:16:27.658849 [debug] [ThreadPool]: On list_bendito_intelligence_dev_processed_: Close
[0m18:16:27.668976 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:27.669383 [debug] [MainThread]: On master: BEGIN
[0m18:16:27.669608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:28.890893 [debug] [MainThread]: SQL status: BEGIN in 1.221 seconds
[0m18:16:28.893332 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:28.894535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:29.064538 [debug] [MainThread]: SQL status: SELECT 0 in 0.169 seconds
[0m18:16:29.068918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e5df0>]}
[0m18:16:29.070227 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:29.221703 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:29.224948 [debug] [MainThread]: On master: BEGIN
[0m18:16:29.527355 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m18:16:29.528872 [debug] [MainThread]: On master: COMMIT
[0m18:16:29.529747 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:29.530542 [debug] [MainThread]: On master: COMMIT
[0m18:16:29.711563 [debug] [MainThread]: SQL status: COMMIT in 0.179 seconds
[0m18:16:29.713821 [debug] [MainThread]: On master: Close
[0m18:16:29.721008 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m18:16:29.721657 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m18:16:29.722241 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m18:16:29.722675 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m18:16:29.723186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_processed_, now model.bdt_transformations.btx_processed_activity)
[0m18:16:29.723775 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m18:16:29.724500 [info ] [Thread-3 (]: 1 of 2 START sql incremental model processed_.btx_processed_deal_stage ......... [RUN]
[0m18:16:29.725100 [info ] [Thread-4 (]: 2 of 2 START sql incremental model processed_.btx_processed_dealcategory ....... [RUN]
[0m18:16:29.725556 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m18:16:29.725998 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m18:16:29.726585 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m18:16:29.727111 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m18:16:29.735059 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m18:16:29.737992 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m18:16:29.738367 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m18:16:29.738689 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m18:16:29.741138 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:16:29.743274 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:16:29.743857 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m18:16:29.744262 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m18:16:29.745127 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m18:16:29.745433 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m18:16:29.782543 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:16:29.783346 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:16:29.784040 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:16:29.784257 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m18:16:29.784464 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:16:29.784685 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:16:29.784953 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m18:16:29.785140 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:16:31.016206 [debug] [Thread-4 (]: SQL status: BEGIN in 1.231 seconds
[0m18:16:31.019366 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:16:31.020170 [debug] [Thread-3 (]: SQL status: BEGIN in 1.235 seconds
[0m18:16:31.020671 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."processed_"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM raw.btx_raw_dealcategory
  );
  
  
[0m18:16:31.021054 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:16:31.021511 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."processed_"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM raw.btx_raw_deal_stage
  );
  
  
[0m18:16:31.174835 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_dealcategory" does not exist
LINE 20: FROM raw.btx_raw_dealcategory
              ^

[0m18:16:31.176517 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_deal_stage" does not exist
LINE 20: FROM raw.btx_raw_deal_stage
              ^

[0m18:16:31.177787 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: ROLLBACK
[0m18:16:31.178659 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: ROLLBACK
[0m18:16:31.330374 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m18:16:31.331640 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m18:16:31.346942 [debug] [Thread-3 (]: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m18:16:31.348843 [debug] [Thread-4 (]: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m18:16:31.352421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053825a0>]}
[0m18:16:31.352778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec948-ac8c-44e3-957c-f68ae069b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103988e90>]}
[0m18:16:31.353610 [error] [Thread-4 (]: 2 of 2 ERROR creating sql incremental model processed_.btx_processed_dealcategory  [[31mERROR[0m in 1.62s]
[0m18:16:31.354297 [error] [Thread-3 (]: 1 of 2 ERROR creating sql incremental model processed_.btx_processed_deal_stage  [[31mERROR[0m in 1.62s]
[0m18:16:31.354913 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m18:16:31.355389 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m18:16:31.355870 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_dealcategory' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql.
[0m18:16:31.357034 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_stage' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql.
[0m18:16:31.358384 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:31.358706 [debug] [MainThread]: On master: BEGIN
[0m18:16:31.358976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:32.577651 [debug] [MainThread]: SQL status: BEGIN in 1.218 seconds
[0m18:16:32.579762 [debug] [MainThread]: On master: COMMIT
[0m18:16:32.580440 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:32.580996 [debug] [MainThread]: On master: COMMIT
[0m18:16:32.731330 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m18:16:32.732986 [debug] [MainThread]: On master: Close
[0m18:16:32.734499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:32.735091 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m18:16:32.735579 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m18:16:32.736591 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m18:16:32.737084 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m18:16:32.737726 [info ] [MainThread]: 
[0m18:16:32.738304 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m18:16:32.739517 [debug] [MainThread]: Command end result
[0m18:16:32.761227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:16:32.763210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:16:32.769218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m18:16:32.769595 [info ] [MainThread]: 
[0m18:16:32.769914 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:16:32.770152 [info ] [MainThread]: 
[0m18:16:32.770491 [error] [MainThread]:   Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m18:16:32.770741 [info ] [MainThread]: 
[0m18:16:32.770985 [error] [MainThread]:   Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m18:16:32.771189 [info ] [MainThread]: 
[0m18:16:32.771428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m18:16:32.773751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.987318, "process_in_blocks": "0", "process_kernel_time": 0.236225, "process_mem_max_rss": "127287296", "process_out_blocks": "0", "process_user_time": 1.269833}
[0m18:16:32.774217 [debug] [MainThread]: Command `dbt run` failed at 18:16:32.774144 after 9.99 seconds
[0m18:16:32.774604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002aad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541ec90>]}
[0m18:16:32.774930 [debug] [MainThread]: Flushing usage events
[0m18:16:33.443430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:49.214611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105616ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064af1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aede0>]}


============================== 21:17:49.218275 | fdfb7260-25c3-441a-8e94-4f7bd7e5254e ==============================
[0m21:17:49.218275 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:17:49.218821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:49.248570 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "bdt_transformations", target "dev" invalid: 'schema' is a required property
[0m21:17:49.249955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07186413, "process_in_blocks": "0", "process_kernel_time": 0.109314, "process_mem_max_rss": "95780864", "process_out_blocks": "0", "process_user_time": 0.661944}
[0m21:17:49.250236 [debug] [MainThread]: Command `dbt run` failed at 21:17:49.250181 after 0.07 seconds
[0m21:17:49.250451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105990dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102116db0>]}
[0m21:17:49.250670 [debug] [MainThread]: Flushing usage events
[0m21:17:49.867865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:15.604191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111327dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112336cf0>]}


============================== 21:18:15.607077 | c9cab088-9821-4ed3-b491-3a80efd7a2e2 ==============================
[0m21:18:15.607077 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:18:15.607548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:15.702372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112336ed0>]}
[0m21:18:15.729609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271b500>]}
[0m21:18:15.730378 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:18:15.789010 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m21:18:15.823100 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:18:15.823456 [debug] [MainThread]: previous checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m21:18:15.823623 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:18:15.823826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbd310>]}
[0m21:18:16.246028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m21:18:16.248872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a39c70>]}
[0m21:18:16.276706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:18:16.279357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:18:16.289346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac4e30>]}
[0m21:18:16.289655 [info ] [MainThread]: Found 4 models, 433 macros
[0m21:18:16.289834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442f1a0>]}
[0m21:18:16.290918 [info ] [MainThread]: 
[0m21:18:16.291118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:16.291269 [info ] [MainThread]: 
[0m21:18:16.291529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:18:16.293373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:18:16.293653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:18:16.347815 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:18:16.348135 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:18:16.348355 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:18:16.348551 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:18:16.348727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:16.348884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:17.619282 [debug] [ThreadPool]: SQL status: SELECT 60 in 1.270 seconds
[0m21:18:17.619957 [debug] [ThreadPool]: SQL status: SELECT 60 in 1.271 seconds
[0m21:18:17.622130 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:18:17.623738 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:18:17.625000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_bitrix)
[0m21:18:17.625443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_)
[0m21:18:17.625992 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_bitrix"
"
[0m21:18:17.626697 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_"
"
[0m21:18:17.632160 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:18:17.633807 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:18:17.634315 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m21:18:17.634865 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: BEGIN
[0m21:18:17.635189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:17.635469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:18.878568 [debug] [ThreadPool]: SQL status: BEGIN in 1.243 seconds
[0m21:18:18.880820 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:18:18.881807 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_"} */
create schema if not exists "bitrix_"
[0m21:18:18.888701 [debug] [ThreadPool]: SQL status: BEGIN in 1.253 seconds
[0m21:18:18.889293 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:18:18.889790 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_bitrix"} */
create schema if not exists "bitrix_bitrix"
[0m21:18:19.057465 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.174 seconds
[0m21:18:19.061893 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m21:18:19.062530 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.172 seconds
[0m21:18:19.063187 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:18:19.064616 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m21:18:19.065148 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m21:18:19.065615 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:18:19.066150 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m21:18:19.219173 [debug] [ThreadPool]: SQL status: COMMIT in 0.152 seconds
[0m21:18:19.220752 [debug] [ThreadPool]: SQL status: COMMIT in 0.155 seconds
[0m21:18:19.222250 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: Close
[0m21:18:19.222752 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: Close
[0m21:18:19.225802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_bitrix, now list_bendito_intelligence_dev_bitrix_bitrix)
[0m21:18:19.226634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_, now list_bendito_intelligence_dev_bitrix_)
[0m21:18:19.234872 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:18:19.238832 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:18:19.239241 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m21:18:19.239560 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: BEGIN
[0m21:18:19.239866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:19.240151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:20.469136 [debug] [ThreadPool]: SQL status: BEGIN in 1.228 seconds
[0m21:18:20.470908 [debug] [ThreadPool]: SQL status: BEGIN in 1.231 seconds
[0m21:18:20.472132 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:18:20.472867 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:18:20.473447 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_'
  
[0m21:18:20.474044 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_bitrix'
  
[0m21:18:20.659769 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.185 seconds
[0m21:18:20.660315 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.186 seconds
[0m21:18:20.661754 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: ROLLBACK
[0m21:18:20.662857 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: ROLLBACK
[0m21:18:20.810359 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: Close
[0m21:18:20.810804 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: Close
[0m21:18:20.815840 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:20.816261 [debug] [MainThread]: On master: BEGIN
[0m21:18:20.816586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:22.052141 [debug] [MainThread]: SQL status: BEGIN in 1.235 seconds
[0m21:18:22.054649 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:22.056100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:18:22.237704 [debug] [MainThread]: SQL status: SELECT 0 in 0.180 seconds
[0m21:18:22.241884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140a1c10>]}
[0m21:18:22.242950 [debug] [MainThread]: On master: ROLLBACK
[0m21:18:22.392285 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:22.393612 [debug] [MainThread]: On master: BEGIN
[0m21:18:22.693484 [debug] [MainThread]: SQL status: BEGIN in 0.298 seconds
[0m21:18:22.695560 [debug] [MainThread]: On master: COMMIT
[0m21:18:22.696653 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:22.697591 [debug] [MainThread]: On master: COMMIT
[0m21:18:22.849678 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m21:18:22.852647 [debug] [MainThread]: On master: Close
[0m21:18:22.858880 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m21:18:22.859507 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m21:18:22.859968 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:22.860379 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:22.860831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m21:18:22.861478 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix_bitrix.btx_processed_deal .................. [RUN]
[0m21:18:22.862006 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix_.btx_processed_deal_stage ............ [RUN]
[0m21:18:22.862462 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix_.btx_processed_dealcategory .......... [RUN]
[0m21:18:22.862840 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m21:18:22.863221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_, now model.bdt_transformations.btx_processed_deal)
[0m21:18:22.863682 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m21:18:22.864108 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m21:18:22.871541 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m21:18:22.871888 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m21:18:22.872185 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:22.872478 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:22.875541 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m21:18:22.877538 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:22.879363 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:22.879946 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m21:18:22.880712 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m21:18:22.886975 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:22.918624 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:22.912142 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m21:18:22.922163 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:22.924696 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:22.925318 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:22.925553 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m21:18:22.925778 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:22.926340 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:22.926565 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:22.926748 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m21:18:22.926938 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m21:18:22.927112 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:18:22.927280 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:18:24.165873 [debug] [Thread-3 (]: SQL status: BEGIN in 1.239 seconds
[0m21:18:24.166345 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:24.166666 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM raw.btx_raw_deal_stage
  );
  
  
[0m21:18:24.167018 [debug] [Thread-4 (]: SQL status: BEGIN in 1.240 seconds
[0m21:18:24.167450 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:24.167827 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM raw.btx_raw_dealcategory
  );
  
  
[0m21:18:24.168446 [debug] [Thread-2 (]: SQL status: BEGIN in 1.243 seconds
[0m21:18:24.168719 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:24.169358 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix_bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m21:18:24.321605 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_deal_stage" does not exist
LINE 20: FROM raw.btx_raw_deal_stage
              ^

[0m21:18:24.323592 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_dealcategory" does not exist
LINE 20: FROM raw.btx_raw_dealcategory
              ^

[0m21:18:24.324298 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m21:18:24.328713 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: ROLLBACK
[0m21:18:24.329523 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: ROLLBACK
[0m21:18:24.330112 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m21:18:24.479143 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m21:18:24.481151 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m21:18:24.482595 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m21:18:24.499360 [debug] [Thread-3 (]: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m21:18:24.501183 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:18:24.504626 [debug] [Thread-4 (]: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m21:18:24.505419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147c2d20>]}
[0m21:18:24.505789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147b3800>]}
[0m21:18:24.506184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cab088-9821-4ed3-b491-3a80efd7a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ecb00>]}
[0m21:18:24.506749 [error] [Thread-3 (]: 2 of 3 ERROR creating sql incremental model bitrix_.btx_processed_deal_stage ... [[31mERROR[0m in 1.64s]
[0m21:18:24.507383 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix_bitrix.btx_processed_deal ......... [[31mERROR[0m in 1.64s]
[0m21:18:24.507991 [error] [Thread-4 (]: 3 of 3 ERROR creating sql incremental model bitrix_.btx_processed_dealcategory . [[31mERROR[0m in 1.64s]
[0m21:18:24.508558 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:24.509026 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m21:18:24.509470 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:24.509941 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_stage' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql.
[0m21:18:24.510996 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m21:18:24.511384 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_dealcategory' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql.
[0m21:18:24.512682 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:24.512993 [debug] [MainThread]: On master: BEGIN
[0m21:18:24.513242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:25.750556 [debug] [MainThread]: SQL status: BEGIN in 1.237 seconds
[0m21:18:25.752989 [debug] [MainThread]: On master: COMMIT
[0m21:18:25.754023 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:25.754945 [debug] [MainThread]: On master: COMMIT
[0m21:18:25.906484 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m21:18:25.913546 [debug] [MainThread]: On master: Close
[0m21:18:25.915276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:25.916225 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m21:18:25.916835 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m21:18:25.917290 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m21:18:25.917684 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m21:18:25.918319 [info ] [MainThread]: 
[0m21:18:25.918853 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 9.63 seconds (9.63s).
[0m21:18:25.920148 [debug] [MainThread]: Command end result
[0m21:18:25.942264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:18:25.943853 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:18:25.948629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m21:18:25.948889 [info ] [MainThread]: 
[0m21:18:25.949166 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:18:25.949388 [info ] [MainThread]: 
[0m21:18:25.949657 [error] [MainThread]:   Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m21:18:25.949862 [info ] [MainThread]: 
[0m21:18:25.950096 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:18:25.950300 [info ] [MainThread]: 
[0m21:18:25.950537 [error] [MainThread]:   Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m21:18:25.950731 [info ] [MainThread]: 
[0m21:18:25.950948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:18:25.952910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.386391, "process_in_blocks": "0", "process_kernel_time": 0.238237, "process_mem_max_rss": "127926272", "process_out_blocks": "0", "process_user_time": 1.692858}
[0m21:18:25.953282 [debug] [MainThread]: Command `dbt run` failed at 21:18:25.953214 after 10.39 seconds
[0m21:18:25.953571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112336db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a99820>]}
[0m21:18:25.953838 [debug] [MainThread]: Flushing usage events
[0m21:18:26.560065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:38.939621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108689be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c32f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c32b70>]}


============================== 21:19:38.942993 | c0828059-69e3-4a36-a6a0-9c1f8bbf8654 ==============================
[0m21:19:38.942993 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:19:38.943397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:39.047351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921bb30>]}
[0m21:19:39.075139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ba630>]}
[0m21:19:39.076306 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:19:39.137083 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m21:19:39.189104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:39.189384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:39.192279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m21:19:39.202229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923fb60>]}
[0m21:19:39.230860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:19:39.232748 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:19:39.243857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfb7d0>]}
[0m21:19:39.244165 [info ] [MainThread]: Found 4 models, 433 macros
[0m21:19:39.244340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6810>]}
[0m21:19:39.245140 [info ] [MainThread]: 
[0m21:19:39.245330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:39.245473 [info ] [MainThread]: 
[0m21:19:39.245735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:39.247755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:19:39.248036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:19:39.278965 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:19:39.279260 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:19:39.279453 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:19:39.279641 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:19:39.279851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:39.280084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:40.529176 [debug] [ThreadPool]: SQL status: SELECT 62 in 1.249 seconds
[0m21:19:40.529764 [debug] [ThreadPool]: SQL status: SELECT 62 in 1.250 seconds
[0m21:19:40.531221 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:19:40.532256 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:19:40.533694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix_)
[0m21:19:40.534097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix_bitrix)
[0m21:19:40.538688 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:19:40.540006 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:19:40.540278 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: BEGIN
[0m21:19:40.540499 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m21:19:40.540703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:40.540894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:41.747187 [debug] [ThreadPool]: SQL status: BEGIN in 1.206 seconds
[0m21:19:41.747576 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:19:41.747792 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_bitrix'
  
[0m21:19:41.759590 [debug] [ThreadPool]: SQL status: BEGIN in 1.219 seconds
[0m21:19:41.759816 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:19:41.760005 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_'
  
[0m21:19:41.907727 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.160 seconds
[0m21:19:41.909170 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: ROLLBACK
[0m21:19:41.913723 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.153 seconds
[0m21:19:41.914933 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: ROLLBACK
[0m21:19:42.059876 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: Close
[0m21:19:42.063821 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: Close
[0m21:19:42.067152 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:42.067532 [debug] [MainThread]: On master: BEGIN
[0m21:19:42.067756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:43.278327 [debug] [MainThread]: SQL status: BEGIN in 1.210 seconds
[0m21:19:43.279065 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:43.279513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:43.433394 [debug] [MainThread]: SQL status: SELECT 0 in 0.153 seconds
[0m21:19:43.436219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109295760>]}
[0m21:19:43.437074 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:43.592282 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:43.592959 [debug] [MainThread]: On master: BEGIN
[0m21:19:43.893280 [debug] [MainThread]: SQL status: BEGIN in 0.300 seconds
[0m21:19:43.894319 [debug] [MainThread]: On master: COMMIT
[0m21:19:43.894876 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:43.895298 [debug] [MainThread]: On master: COMMIT
[0m21:19:44.044695 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m21:19:44.045357 [debug] [MainThread]: On master: Close
[0m21:19:44.048482 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m21:19:44.048846 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m21:19:44.049172 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m21:19:44.049488 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m21:19:44.049832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_, now model.bdt_transformations.btx_processed_activity)
[0m21:19:44.050252 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix_bitrix.btx_processed_deal .................. [RUN]
[0m21:19:44.050626 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix_.btx_processed_deal_stage ............ [RUN]
[0m21:19:44.051086 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix_.btx_processed_dealcategory .......... [RUN]
[0m21:19:44.051408 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m21:19:44.051678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_bitrix, now model.bdt_transformations.btx_processed_deal)
[0m21:19:44.052006 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m21:19:44.052302 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m21:19:44.057169 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m21:19:44.057496 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m21:19:44.057735 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m21:19:44.057949 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m21:19:44.060202 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m21:19:44.062735 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:19:44.064208 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:19:44.064622 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m21:19:44.065376 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m21:19:44.071757 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m21:19:44.071993 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m21:19:44.088570 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m21:19:44.105694 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:19:44.106578 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:19:44.107766 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:19:44.108008 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m21:19:44.108196 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:19:44.108472 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:19:44.108662 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m21:19:44.108913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:19:44.109225 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:19:44.109539 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m21:19:44.109778 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:19:45.326862 [debug] [Thread-2 (]: SQL status: BEGIN in 1.218 seconds
[0m21:19:45.327376 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:19:45.327945 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix_bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m21:19:45.339279 [debug] [Thread-4 (]: SQL status: BEGIN in 1.231 seconds
[0m21:19:45.339671 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:19:45.339956 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM raw.btx_raw_dealcategory
  );
  
  
[0m21:19:45.340486 [debug] [Thread-3 (]: SQL status: BEGIN in 1.231 seconds
[0m21:19:45.340710 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:19:45.340944 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM raw.btx_raw_deal_stage
  );
  
  
[0m21:19:45.477249 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m21:19:45.477650 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m21:19:45.489293 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_dealcategory" does not exist
LINE 20: FROM raw.btx_raw_dealcategory
              ^

[0m21:19:45.489658 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: ROLLBACK
[0m21:19:45.492631 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.btx_raw_deal_stage" does not exist
LINE 20: FROM raw.btx_raw_deal_stage
              ^

[0m21:19:45.492972 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: ROLLBACK
[0m21:19:45.625340 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m21:19:45.632009 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:19:45.633569 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a15bd70>]}
[0m21:19:45.634049 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix_bitrix.btx_processed_deal ......... [[31mERROR[0m in 1.58s]
[0m21:19:45.634431 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m21:19:45.634805 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m21:19:45.639543 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m21:19:45.641688 [debug] [Thread-4 (]: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m21:19:45.642042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efaf60>]}
[0m21:19:45.642735 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m21:19:45.642471 [error] [Thread-4 (]: 3 of 3 ERROR creating sql incremental model bitrix_.btx_processed_dealcategory . [[31mERROR[0m in 1.59s]
[0m21:19:45.643178 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m21:19:45.644475 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_dealcategory' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql.
[0m21:19:45.645582 [debug] [Thread-3 (]: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m21:19:45.645891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0828059-69e3-4a36-a6a0-9c1f8bbf8654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a081eb0>]}
[0m21:19:45.646244 [error] [Thread-3 (]: 2 of 3 ERROR creating sql incremental model bitrix_.btx_processed_deal_stage ... [[31mERROR[0m in 1.59s]
[0m21:19:45.646563 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m21:19:45.646848 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_stage' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql.
[0m21:19:45.647687 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:45.647887 [debug] [MainThread]: On master: BEGIN
[0m21:19:45.648057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:46.852626 [debug] [MainThread]: SQL status: BEGIN in 1.204 seconds
[0m21:19:46.853139 [debug] [MainThread]: On master: COMMIT
[0m21:19:46.853418 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:46.853662 [debug] [MainThread]: On master: COMMIT
[0m21:19:47.003285 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m21:19:47.003957 [debug] [MainThread]: On master: Close
[0m21:19:47.004643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:47.004886 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m21:19:47.005104 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m21:19:47.005309 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m21:19:47.005519 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m21:19:47.005880 [info ] [MainThread]: 
[0m21:19:47.006210 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m21:19:47.007025 [debug] [MainThread]: Command end result
[0m21:19:47.021745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:19:47.024127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:19:47.027799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m21:19:47.028023 [info ] [MainThread]: 
[0m21:19:47.028238 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:19:47.028416 [info ] [MainThread]: 
[0m21:19:47.028632 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:19:47.028806 [info ] [MainThread]: 
[0m21:19:47.029016 [error] [MainThread]:   Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  relation "raw.btx_raw_dealcategory" does not exist
  LINE 20: FROM raw.btx_raw_dealcategory
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m21:19:47.029183 [info ] [MainThread]: 
[0m21:19:47.029373 [error] [MainThread]:   Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  relation "raw.btx_raw_deal_stage" does not exist
  LINE 20: FROM raw.btx_raw_deal_stage
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m21:19:47.029535 [info ] [MainThread]: 
[0m21:19:47.029709 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:19:47.031670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.126068, "process_in_blocks": "0", "process_kernel_time": 0.223911, "process_mem_max_rss": "124125184", "process_out_blocks": "0", "process_user_time": 1.113574}
[0m21:19:47.032047 [debug] [MainThread]: Command `dbt run` failed at 21:19:47.031989 after 8.13 seconds
[0m21:19:47.032304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024badb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d50770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c329f0>]}
[0m21:19:47.032536 [debug] [MainThread]: Flushing usage events
[0m21:19:47.763723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:27.582630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067575c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a32f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a32b10>]}


============================== 21:21:27.585724 | 80611702-6361-4f86-8958-b41a0fa2ed9b ==============================
[0m21:21:27.585724 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:21:27.586113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:21:27.686656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e92b0>]}
[0m21:21:27.712123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5cbf0>]}
[0m21:21:27.712796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:21:27.771352 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m21:21:27.819521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:21:27.819874 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m21:21:27.820079 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m21:21:27.820270 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m21:21:27.923291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m21:21:27.925648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107722630>]}
[0m21:21:27.950673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:21:27.952995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:21:27.964425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107804ce0>]}
[0m21:21:27.964706 [info ] [MainThread]: Found 4 models, 433 macros
[0m21:21:27.964884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ae690>]}
[0m21:21:27.965635 [info ] [MainThread]: 
[0m21:21:27.965826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:21:27.965970 [info ] [MainThread]: 
[0m21:21:27.966210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:27.968067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:21:27.968368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:21:27.996703 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:21:27.996939 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:21:27.997158 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:21:27.997347 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:21:27.997526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:27.997680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:29.253624 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.256 seconds
[0m21:21:29.255338 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:21:29.326160 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.329 seconds
[0m21:21:29.328099 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:21:29.329220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_bitrix)
[0m21:21:29.329716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_)
[0m21:21:29.330257 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_bitrix"
"
[0m21:21:29.330732 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_"
"
[0m21:21:29.338396 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:21:29.340253 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:21:29.340565 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m21:21:29.340840 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: BEGIN
[0m21:21:29.341098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:29.341346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:30.572110 [debug] [ThreadPool]: SQL status: BEGIN in 1.231 seconds
[0m21:21:30.572969 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:21:30.573335 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_"} */
create schema if not exists "bitrix_"
[0m21:21:30.603693 [debug] [ThreadPool]: SQL status: BEGIN in 1.262 seconds
[0m21:21:30.606614 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:21:30.607389 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_bitrix"} */
create schema if not exists "bitrix_bitrix"
[0m21:21:30.731135 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.157 seconds
[0m21:21:30.734854 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m21:21:30.735483 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m21:21:30.735970 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m21:21:30.768857 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.158 seconds
[0m21:21:30.773937 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m21:21:30.774551 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m21:21:30.775020 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m21:21:30.885494 [debug] [ThreadPool]: SQL status: COMMIT in 0.149 seconds
[0m21:21:30.886124 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: Close
[0m21:21:30.926539 [debug] [ThreadPool]: SQL status: COMMIT in 0.151 seconds
[0m21:21:30.926914 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: Close
[0m21:21:30.927915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_, now list_bendito_intelligence_dev_bitrix_bitrix)
[0m21:21:30.928302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_bitrix, now list_bendito_intelligence_dev_bitrix_)
[0m21:21:30.931979 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:21:30.933139 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:21:30.933359 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m21:21:30.933558 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: BEGIN
[0m21:21:30.933743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:30.933916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:32.149119 [debug] [ThreadPool]: SQL status: BEGIN in 1.214 seconds
[0m21:21:32.152145 [debug] [ThreadPool]: SQL status: BEGIN in 1.218 seconds
[0m21:21:32.152750 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m21:21:32.153273 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m21:21:32.153742 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_'
  
[0m21:21:32.154218 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_bitrix'
  
[0m21:21:32.305939 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.151 seconds
[0m21:21:32.307395 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.153 seconds
[0m21:21:32.310976 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: ROLLBACK
[0m21:21:32.313626 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: ROLLBACK
[0m21:21:32.464873 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: Close
[0m21:21:32.466502 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: Close
[0m21:21:32.478131 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:32.478799 [debug] [MainThread]: On master: BEGIN
[0m21:21:32.479182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:33.727730 [debug] [MainThread]: SQL status: BEGIN in 1.248 seconds
[0m21:21:33.729874 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:33.730726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:33.883952 [debug] [MainThread]: SQL status: SELECT 0 in 0.152 seconds
[0m21:21:33.886587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078afdd0>]}
[0m21:21:33.887717 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:34.035932 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.036794 [debug] [MainThread]: On master: BEGIN
[0m21:21:34.334417 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m21:21:34.343370 [debug] [MainThread]: On master: COMMIT
[0m21:21:34.344408 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.345459 [debug] [MainThread]: On master: COMMIT
[0m21:21:34.495103 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m21:21:34.500071 [debug] [MainThread]: On master: Close
[0m21:21:34.506460 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m21:21:34.507075 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m21:21:34.507587 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m21:21:34.508097 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m21:21:34.508627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m21:21:34.509381 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix_bitrix.btx_processed_deal .................. [RUN]
[0m21:21:34.510147 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix_.btx_processed_deal_stage ............ [RUN]
[0m21:21:34.511047 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix_.btx_processed_dealcategory .......... [RUN]
[0m21:21:34.511681 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m21:21:34.512178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_, now model.bdt_transformations.btx_processed_deal)
[0m21:21:34.512680 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m21:21:34.513120 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m21:21:34.521412 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m21:21:34.521834 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m21:21:34.522244 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m21:21:34.522584 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m21:21:34.526195 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m21:21:34.528304 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:21:34.528892 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m21:21:34.530858 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:21:34.531925 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m21:21:34.540052 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m21:21:34.540386 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m21:21:34.559574 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m21:21:34.575945 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:21:34.577898 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:21:34.579119 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:21:34.579416 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:21:34.579634 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:21:34.579827 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m21:21:34.580031 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m21:21:34.580207 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m21:21:34.580394 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:21:34.580591 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:21:34.580748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:35.818880 [debug] [Thread-2 (]: SQL status: BEGIN in 1.237 seconds
[0m21:21:35.821683 [debug] [Thread-3 (]: SQL status: BEGIN in 1.241 seconds
[0m21:21:35.822501 [debug] [Thread-4 (]: SQL status: BEGIN in 1.242 seconds
[0m21:21:35.823155 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:21:35.823808 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:21:35.824369 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:21:35.825421 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix_bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m21:21:35.826519 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m21:21:35.827057 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m21:21:35.978701 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m21:21:35.980143 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m21:21:35.988505 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.161 seconds
[0m21:21:36.000088 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.172 seconds
[0m21:21:36.001778 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:21:36.002708 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:21:36.003027 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:21:36.003290 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:21:36.003483 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:21:36.003658 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:21:36.130877 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m21:21:36.139818 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:21:36.141151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c74b60>]}
[0m21:21:36.141603 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix_bitrix.btx_processed_deal ......... [[31mERROR[0m in 1.63s]
[0m21:21:36.141936 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m21:21:36.142212 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m21:21:36.153993 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m21:21:36.155124 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m21:21:36.155581 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m21:21:36.156407 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m21:21:36.156843 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047df860>]}
[0m21:21:36.157300 [info ] [Thread-3 (]: 2 of 3 OK created sql incremental model bitrix_.btx_processed_deal_stage ....... [[32mSELECT 0[0m in 1.64s]
[0m21:21:36.157620 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80611702-6361-4f86-8958-b41a0fa2ed9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4b740>]}
[0m21:21:36.157894 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m21:21:36.158261 [info ] [Thread-4 (]: 3 of 3 OK created sql incremental model bitrix_.btx_processed_dealcategory ..... [[32mSELECT 0[0m in 1.64s]
[0m21:21:36.158727 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m21:21:36.159721 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:36.159887 [debug] [MainThread]: On master: BEGIN
[0m21:21:36.160023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:37.383790 [debug] [MainThread]: SQL status: BEGIN in 1.224 seconds
[0m21:21:37.384863 [debug] [MainThread]: On master: COMMIT
[0m21:21:37.385555 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:37.386200 [debug] [MainThread]: On master: COMMIT
[0m21:21:37.537052 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m21:21:37.538093 [debug] [MainThread]: On master: Close
[0m21:21:37.539195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:37.539693 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m21:21:37.540382 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m21:21:37.541214 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m21:21:37.541799 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m21:21:37.542388 [info ] [MainThread]: 
[0m21:21:37.542921 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m21:21:37.544238 [debug] [MainThread]: Command end result
[0m21:21:37.562951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:21:37.564711 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:21:37.569966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m21:21:37.570265 [info ] [MainThread]: 
[0m21:21:37.570552 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:21:37.570801 [info ] [MainThread]: 
[0m21:21:37.571092 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m21:21:37.571329 [info ] [MainThread]: 
[0m21:21:37.571576 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:21:37.573629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.031555, "process_in_blocks": "0", "process_kernel_time": 0.237554, "process_mem_max_rss": "126615552", "process_out_blocks": "0", "process_user_time": 1.288687}
[0m21:21:37.573989 [debug] [MainThread]: Command `dbt run` failed at 21:21:37.573922 after 10.03 seconds
[0m21:21:37.574289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102696db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af2810>]}
[0m21:21:37.574537 [debug] [MainThread]: Flushing usage events
[0m21:21:38.228308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:10:06.392519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b416d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904ab70>]}


============================== 22:10:06.395563 | 47f7ae77-352c-48dc-ae05-04377a9efe2a ==============================
[0m22:10:06.395563 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:10:06.395898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:06.480533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945b1d0>]}
[0m22:10:06.505769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107623e00>]}
[0m22:10:06.506447 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:10:06.562784 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:10:06.610338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:10:06.610601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:10:06.613261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m22:10:06.622917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957f740>]}
[0m22:10:06.648330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:10:06.650645 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:10:06.661392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc3860>]}
[0m22:10:06.661683 [info ] [MainThread]: Found 4 models, 433 macros
[0m22:10:06.661857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cce6f0>]}
[0m22:10:06.662663 [info ] [MainThread]: 
[0m22:10:06.662857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:06.663004 [info ] [MainThread]: 
[0m22:10:06.663257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:06.665200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:10:06.665556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:10:06.694619 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:10:06.694855 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:10:06.695076 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:10:06.695271 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:10:06.695465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:06.695618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:07.990844 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.295 seconds
[0m22:10:07.992209 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.297 seconds
[0m22:10:07.995814 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:10:07.998005 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:10:07.999688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_)
[0m22:10:08.000227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now create_bendito_intelligence_dev_bitrix_bitrix)
[0m22:10:08.001023 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_"
"
[0m22:10:08.001595 [debug] [ThreadPool]: Creating schema "database: "bendito_intelligence_dev"
schema: "bitrix_bitrix"
"
[0m22:10:08.008451 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m22:10:08.010387 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m22:10:08.010776 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: BEGIN
[0m22:10:08.011105 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m22:10:08.011448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:08.011785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:09.244306 [debug] [ThreadPool]: SQL status: BEGIN in 1.231 seconds
[0m22:10:09.246068 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m22:10:09.247188 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_"} */
create schema if not exists "bitrix_"
[0m22:10:09.250123 [debug] [ThreadPool]: SQL status: BEGIN in 1.238 seconds
[0m22:10:09.250532 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m22:10:09.250905 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "create_bendito_intelligence_dev_bitrix_bitrix"} */
create schema if not exists "bitrix_bitrix"
[0m22:10:09.413727 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.166 seconds
[0m22:10:09.414788 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.163 seconds
[0m22:10:09.419859 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m22:10:09.421643 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m22:10:09.422251 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_"
[0m22:10:09.422738 [debug] [ThreadPool]: Using postgres connection "create_bendito_intelligence_dev_bitrix_bitrix"
[0m22:10:09.423210 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: COMMIT
[0m22:10:09.423647 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: COMMIT
[0m22:10:09.573527 [debug] [ThreadPool]: SQL status: COMMIT in 0.149 seconds
[0m22:10:09.575110 [debug] [ThreadPool]: SQL status: COMMIT in 0.151 seconds
[0m22:10:09.576197 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_: Close
[0m22:10:09.577044 [debug] [ThreadPool]: On create_bendito_intelligence_dev_bitrix_bitrix: Close
[0m22:10:09.579056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_bitrix, now list_bendito_intelligence_dev_bitrix_)
[0m22:10:09.585288 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m22:10:09.586021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bendito_intelligence_dev_bitrix_, now list_bendito_intelligence_dev_bitrix_bitrix)
[0m22:10:09.586426 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: BEGIN
[0m22:10:09.588564 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m22:10:09.588913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:09.589221 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: BEGIN
[0m22:10:09.589694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:10.822883 [debug] [ThreadPool]: SQL status: BEGIN in 1.233 seconds
[0m22:10:10.825167 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m22:10:10.826243 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_'
  
[0m22:10:10.831071 [debug] [ThreadPool]: SQL status: BEGIN in 1.241 seconds
[0m22:10:10.831895 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_bitrix"
[0m22:10:10.832458 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_bitrix'
  
[0m22:10:11.002008 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.175 seconds
[0m22:10:11.003251 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.170 seconds
[0m22:10:11.008384 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: ROLLBACK
[0m22:10:11.010245 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: ROLLBACK
[0m22:10:11.161540 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_bitrix: Close
[0m22:10:11.163497 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: Close
[0m22:10:11.172058 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:11.172777 [debug] [MainThread]: On master: BEGIN
[0m22:10:11.173222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:12.417538 [debug] [MainThread]: SQL status: BEGIN in 1.244 seconds
[0m22:10:12.421555 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:12.422313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:12.589659 [debug] [MainThread]: SQL status: SELECT 0 in 0.166 seconds
[0m22:10:12.593913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbb0e0>]}
[0m22:10:12.595050 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:12.747412 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:12.748477 [debug] [MainThread]: On master: BEGIN
[0m22:10:13.051430 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m22:10:13.053698 [debug] [MainThread]: On master: COMMIT
[0m22:10:13.054647 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:13.055216 [debug] [MainThread]: On master: COMMIT
[0m22:10:13.207638 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m22:10:13.210228 [debug] [MainThread]: On master: Close
[0m22:10:13.218139 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:10:13.218809 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:10:13.219373 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:10:13.219804 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:10:13.220381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_, now model.bdt_transformations.btx_processed_activity)
[0m22:10:13.221129 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix_bitrix.btx_processed_deal .................. [RUN]
[0m22:10:13.221865 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix_.btx_processed_deal_stage ............ [RUN]
[0m22:10:13.222527 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix_.btx_processed_dealcategory .......... [RUN]
[0m22:10:13.223033 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:10:13.223462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_bitrix, now model.bdt_transformations.btx_processed_deal)
[0m22:10:13.223925 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:10:13.224376 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m22:10:13.231086 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:10:13.234884 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:10:13.235285 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:10:13.235607 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:10:13.238324 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:10:13.240412 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:10:13.242249 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:10:13.243537 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:10:13.243835 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:10:13.250409 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:10:13.250668 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:10:13.277883 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:10:13.279836 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:10:13.286057 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:10:13.286952 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:10:13.287206 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:10:13.287415 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:10:13.287586 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:10:13.287768 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:10:13.287936 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:10:13.288103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:10:13.288271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:10:13.288432 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:10:14.533941 [debug] [Thread-2 (]: SQL status: BEGIN in 1.245 seconds
[0m22:10:14.535652 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:10:14.537190 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix_bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m22:10:14.544452 [debug] [Thread-4 (]: SQL status: BEGIN in 1.256 seconds
[0m22:10:14.545407 [debug] [Thread-3 (]: SQL status: BEGIN in 1.257 seconds
[0m22:10:14.546322 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:10:14.547070 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:10:14.547811 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m22:10:14.548447 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m22:10:14.694902 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m22:10:14.696822 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m22:10:14.734748 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.185 seconds
[0m22:10:14.736101 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.187 seconds
[0m22:10:14.760033 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:10:14.761640 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:10:14.762179 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:10:14.762546 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:10:14.762868 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:10:14.763232 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:10:14.848351 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:10:14.862016 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:10:14.864595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957f920>]}
[0m22:10:14.865417 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix_bitrix.btx_processed_deal ......... [[31mERROR[0m in 1.64s]
[0m22:10:14.866047 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:10:14.866631 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m22:10:14.916511 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m22:10:14.917299 [debug] [Thread-3 (]: SQL status: COMMIT in 0.153 seconds
[0m22:10:14.920164 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:10:14.921243 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:10:14.922412 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a154ad0>]}
[0m22:10:14.923327 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f7ae77-352c-48dc-ae05-04377a9efe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a155220>]}
[0m22:10:14.924253 [info ] [Thread-4 (]: 3 of 3 OK created sql incremental model bitrix_.btx_processed_dealcategory ..... [[32mSELECT 4[0m in 1.70s]
[0m22:10:14.925009 [info ] [Thread-3 (]: 2 of 3 OK created sql incremental model bitrix_.btx_processed_deal_stage ....... [[32mSELECT 11[0m in 1.70s]
[0m22:10:14.925699 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:10:14.926291 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:10:14.927962 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:14.928319 [debug] [MainThread]: On master: BEGIN
[0m22:10:14.928616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:16.167970 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m22:10:16.170527 [debug] [MainThread]: On master: COMMIT
[0m22:10:16.171403 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:16.172365 [debug] [MainThread]: On master: COMMIT
[0m22:10:16.330242 [debug] [MainThread]: SQL status: COMMIT in 0.157 seconds
[0m22:10:16.334029 [debug] [MainThread]: On master: Close
[0m22:10:16.336058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:16.337745 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m22:10:16.338482 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m22:10:16.338936 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m22:10:16.339356 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:10:16.339979 [info ] [MainThread]: 
[0m22:10:16.340534 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 9.68 seconds (9.68s).
[0m22:10:16.342393 [debug] [MainThread]: Command end result
[0m22:10:16.363058 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:10:16.366231 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:10:16.371360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:10:16.371639 [info ] [MainThread]: 
[0m22:10:16.371929 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:10:16.372159 [info ] [MainThread]: 
[0m22:10:16.372451 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:10:16.372668 [info ] [MainThread]: 
[0m22:10:16.372901 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:10:16.375141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.019917, "process_in_blocks": "0", "process_kernel_time": 0.247003, "process_mem_max_rss": "123813888", "process_out_blocks": "0", "process_user_time": 1.28091}
[0m22:10:16.375548 [debug] [MainThread]: Command `dbt run` failed at 22:10:16.375477 after 10.02 seconds
[0m22:10:16.375872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba2f00>]}
[0m22:10:16.376157 [debug] [MainThread]: Flushing usage events
[0m22:10:17.067911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:08.186735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ce570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112832bd0>]}


============================== 22:16:08.189725 | a7c9bc7f-5983-4a89-9448-01c6fa498922 ==============================
[0m22:16:08.189725 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:16:08.190072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:08.270477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34800>]}
[0m22:16:08.295435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116682f0>]}
[0m22:16:08.296430 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:16:08.353533 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:16:08.399602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:08.400004 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m22:16:08.506792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m22:16:08.509250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136249b0>]}
[0m22:16:08.535153 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:16:08.536998 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:16:08.547568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113600890>]}
[0m22:16:08.547846 [info ] [MainThread]: Found 4 models, 433 macros
[0m22:16:08.548028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2b470>]}
[0m22:16:08.548824 [info ] [MainThread]: 
[0m22:16:08.549036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:08.549187 [info ] [MainThread]: 
[0m22:16:08.549444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:08.551444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:16:08.578786 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:16:08.579042 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:16:08.579204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:09.915850 [debug] [ThreadPool]: SQL status: SELECT 60 in 1.336 seconds
[0m22:16:09.919392 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:16:09.921872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix_)
[0m22:16:09.929952 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m22:16:09.930509 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: BEGIN
[0m22:16:09.930850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:11.224410 [debug] [ThreadPool]: SQL status: BEGIN in 1.293 seconds
[0m22:16:11.227120 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix_"
[0m22:16:11.228351 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix_"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix_'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix_'
  
[0m22:16:11.382179 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.152 seconds
[0m22:16:11.387380 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: ROLLBACK
[0m22:16:11.538212 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix_: Close
[0m22:16:11.551822 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:11.552497 [debug] [MainThread]: On master: BEGIN
[0m22:16:11.552880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:12.792201 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m22:16:12.794661 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:12.795588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:16:12.953035 [debug] [MainThread]: SQL status: SELECT 0 in 0.156 seconds
[0m22:16:12.958494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b6390>]}
[0m22:16:12.959641 [debug] [MainThread]: On master: ROLLBACK
[0m22:16:13.110904 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:13.111492 [debug] [MainThread]: On master: BEGIN
[0m22:16:13.414808 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m22:16:13.415908 [debug] [MainThread]: On master: COMMIT
[0m22:16:13.416483 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:13.416941 [debug] [MainThread]: On master: COMMIT
[0m22:16:13.570670 [debug] [MainThread]: SQL status: COMMIT in 0.153 seconds
[0m22:16:13.572107 [debug] [MainThread]: On master: Close
[0m22:16:13.578214 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:16:13.579061 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:16:13.580188 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:16:13.580796 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:16:13.581508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix_, now model.bdt_transformations.btx_processed_activity)
[0m22:16:13.582344 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix_.btx_processed_deal ........................ [RUN]
[0m22:16:13.583016 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix_.btx_processed_deal_stage ............ [RUN]
[0m22:16:13.583531 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix_.btx_processed_dealcategory .......... [RUN]
[0m22:16:13.583919 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:16:13.584385 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:16:13.584844 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:16:13.585283 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m22:16:13.593132 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:16:13.593513 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:16:13.593852 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:16:13.594193 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:16:13.597615 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:16:13.599842 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:13.601655 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:13.602398 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:16:13.603426 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:16:13.603732 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:16:13.610375 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:16:13.646651 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:13.647374 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:16:13.650046 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:13.650297 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp221613624786"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m22:16:13.650615 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp221613648545"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m22:16:13.650857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:16:13.651099 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:16:13.651326 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:16:13.651687 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:16:13.651871 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:16:14.890368 [debug] [Thread-4 (]: SQL status: SELECT 5 in 1.239 seconds
[0m22:16:14.899093 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:14.899413 [debug] [Thread-2 (]: SQL status: BEGIN in 1.247 seconds
[0m22:16:14.899731 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:16:14.900248 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:16:14.900840 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix_"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m22:16:14.907977 [debug] [Thread-3 (]: SQL status: SELECT 5 in 1.257 seconds
[0m22:16:14.909970 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:14.910221 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:16:15.048238 [debug] [Thread-4 (]: SQL status: BEGIN in 0.148 seconds
[0m22:16:15.048661 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.048933 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp221613648545'
        
      order by ordinal_position

  
[0m22:16:15.053518 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m22:16:15.053945 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m22:16:15.060644 [debug] [Thread-3 (]: SQL status: BEGIN in 0.150 seconds
[0m22:16:15.061004 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.061246 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp221613624786'
        
      order by ordinal_position

  
[0m22:16:15.208135 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:16:15.218898 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:16:15.221774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7ef90>]}
[0m22:16:15.222229 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.173 seconds
[0m22:16:15.222648 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.161 seconds
[0m22:16:15.223351 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix_.btx_processed_deal ............... [[31mERROR[0m in 1.64s]
[0m22:16:15.228918 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.231284 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.231780 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:16:15.232109 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix_'
        
      order by ordinal_position

  
[0m22:16:15.232437 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix_'
        
      order by ordinal_position

  
[0m22:16:15.232853 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m22:16:15.390681 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.157 seconds
[0m22:16:15.391323 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.158 seconds
[0m22:16:15.397965 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.400182 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.400508 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix_'
        
      order by ordinal_position

  
[0m22:16:15.400820 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix_'
        
      order by ordinal_position

  
[0m22:16:15.551671 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.150 seconds
[0m22:16:15.560069 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.159 seconds
[0m22:16:15.570157 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.572157 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.573200 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.573587 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp221613624786" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix_"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp221613624786"
    )
  
[0m22:16:15.573946 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.574515 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp221613648545" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix_"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp221613648545"
    )
  
[0m22:16:15.739104 [debug] [Thread-4 (]: SQL status: INSERT 0 5 in 0.163 seconds
[0m22:16:15.740511 [debug] [Thread-3 (]: SQL status: INSERT 0 5 in 0.166 seconds
[0m22:16:15.756632 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:16:15.757972 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:16:15.758290 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:16:15.758535 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:16:15.758763 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:16:15.759032 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:16:15.911406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m22:16:15.914927 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:16:15.915590 [debug] [Thread-3 (]: SQL status: COMMIT in 0.156 seconds
[0m22:16:15.916507 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:16:15.917228 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0f7d0>]}
[0m22:16:15.918152 [info ] [Thread-4 (]: 3 of 3 OK created sql incremental model bitrix_.btx_processed_dealcategory ..... [[32mINSERT 0 5[0m in 2.33s]
[0m22:16:15.918820 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c9bc7f-5983-4a89-9448-01c6fa498922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f6690>]}
[0m22:16:15.919496 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:16:15.920247 [info ] [Thread-3 (]: 2 of 3 OK created sql incremental model bitrix_.btx_processed_deal_stage ....... [[32mINSERT 0 5[0m in 2.33s]
[0m22:16:15.921153 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:16:15.923144 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:15.923558 [debug] [MainThread]: On master: BEGIN
[0m22:16:15.923852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:17.167596 [debug] [MainThread]: SQL status: BEGIN in 1.243 seconds
[0m22:16:17.170220 [debug] [MainThread]: On master: COMMIT
[0m22:16:17.171251 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:17.172320 [debug] [MainThread]: On master: COMMIT
[0m22:16:17.323575 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m22:16:17.325650 [debug] [MainThread]: On master: Close
[0m22:16:17.327789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:17.328675 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m22:16:17.329481 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m22:16:17.329929 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m22:16:17.330322 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:16:17.330964 [info ] [MainThread]: 
[0m22:16:17.331531 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m22:16:17.332969 [debug] [MainThread]: Command end result
[0m22:16:17.353831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:16:17.355608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:16:17.360568 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:16:17.360867 [info ] [MainThread]: 
[0m22:16:17.361161 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:16:17.361399 [info ] [MainThread]: 
[0m22:16:17.361696 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:16:17.361929 [info ] [MainThread]: 
[0m22:16:17.362176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:16:17.364112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.211304, "process_in_blocks": "0", "process_kernel_time": 0.23744, "process_mem_max_rss": "128794624", "process_out_blocks": "0", "process_user_time": 1.310472}
[0m22:16:17.364492 [debug] [MainThread]: Command `dbt run` failed at 22:16:17.364428 after 9.21 seconds
[0m22:16:17.364789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112832cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e1130>]}
[0m22:16:17.365066 [debug] [MainThread]: Flushing usage events
[0m22:16:18.295763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:43.322360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad32f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad32bd0>]}


============================== 22:19:43.326086 | 8cd0043a-6fb1-4338-8e94-8d898289ef05 ==============================
[0m22:19:43.326086 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:19:43.326523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m22:19:43.423253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad33200>]}
[0m22:19:43.450520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad17680>]}
[0m22:19:43.451294 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:19:43.511919 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:19:43.543013 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:19:43.543334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f5f5c0>]}
[0m22:19:43.956568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m22:19:43.959281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcc4440>]}
[0m22:19:43.985292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:19:43.987527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:19:43.999128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d47b530>]}
[0m22:19:43.999412 [info ] [MainThread]: Found 4 models, 433 macros
[0m22:19:43.999590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd8e7e0>]}
[0m22:19:44.000532 [info ] [MainThread]: 
[0m22:19:44.000766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:44.000929 [info ] [MainThread]: 
[0m22:19:44.001217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:19:44.003087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:19:44.057718 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:19:44.057982 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:19:44.058145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:45.295944 [debug] [ThreadPool]: SQL status: SELECT 60 in 1.238 seconds
[0m22:19:45.296965 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:19:45.297831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m22:19:45.301161 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:19:45.301403 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m22:19:45.301572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:46.522219 [debug] [ThreadPool]: SQL status: BEGIN in 1.220 seconds
[0m22:19:46.524503 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:19:46.525804 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m22:19:46.677807 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.151 seconds
[0m22:19:46.679065 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m22:19:46.828076 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m22:19:46.832776 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:46.833109 [debug] [MainThread]: On master: BEGIN
[0m22:19:46.833358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:48.050599 [debug] [MainThread]: SQL status: BEGIN in 1.216 seconds
[0m22:19:48.052851 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:48.054151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:19:48.208162 [debug] [MainThread]: SQL status: SELECT 0 in 0.152 seconds
[0m22:19:48.213774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd8dfa0>]}
[0m22:19:48.215355 [debug] [MainThread]: On master: ROLLBACK
[0m22:19:48.371204 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:48.372085 [debug] [MainThread]: On master: BEGIN
[0m22:19:48.668369 [debug] [MainThread]: SQL status: BEGIN in 0.295 seconds
[0m22:19:48.670558 [debug] [MainThread]: On master: COMMIT
[0m22:19:48.671701 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:48.672239 [debug] [MainThread]: On master: COMMIT
[0m22:19:48.820724 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m22:19:48.823287 [debug] [MainThread]: On master: Close
[0m22:19:48.831433 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:19:48.832050 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:19:48.832584 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:19:48.833055 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:19:48.833698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m22:19:48.834426 [info ] [Thread-2 (]: 1 of 3 START sql table model bitrix.btx_processed_deal ......................... [RUN]
[0m22:19:48.835030 [info ] [Thread-3 (]: 2 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m22:19:48.835568 [info ] [Thread-4 (]: 3 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m22:19:48.836012 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:19:48.836522 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:19:48.836965 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:19:48.837389 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m22:19:48.844156 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:19:48.845586 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:19:48.845975 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:19:48.846422 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:19:48.849876 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:19:48.852483 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:19:48.854467 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:19:48.855075 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:19:48.856033 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:19:48.856330 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:19:48.856600 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:19:48.889350 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:19:48.899172 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:19:48.901134 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:19:48.902281 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:19:48.902518 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:19:48.902712 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:19:48.902892 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:19:48.903072 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:19:48.903246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:48.903415 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:19:48.903585 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:19:48.903847 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:50.113733 [debug] [Thread-4 (]: SQL status: BEGIN in 1.209 seconds
[0m22:19:50.116118 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:19:50.116883 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory
  );
  
  
[0m22:19:50.122527 [debug] [Thread-3 (]: SQL status: BEGIN in 1.218 seconds
[0m22:19:50.123408 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:19:50.124181 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
  );
  
  
[0m22:19:50.134507 [debug] [Thread-2 (]: SQL status: BEGIN in 1.231 seconds
[0m22:19:50.136032 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:19:50.137504 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE'):: as title,
  ("CONTENT"->>'STAGE_ID'):: as stage_id,
  ("CONTENT"->>'CATEGORY_ID'):: as category_id,
  ("CONTENT"->>'OPPORTUNITY'):: as opportunity,
  ("CONTENT"->>'COMPANY_ID'):: as company_id,
  ("CONTENT"->>'CONTACT_ID'):: as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID'):: as assigned_by_id,
  ("CONTENT"->>'CLOSED'):: as closed,
  ("CONTENT"->>'CLOSEDATE'):: as close_date,
  ("CONTENT"->>'DATE_CREATE'):: as date_create,
  ("CONTENT"->>'DATE_MODIFY'):: as date_modify,
  ("CONTENT"->>'BEGINDATE'):: as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED'):: as opened,
  ("CONTENT"->>'IS_NEW'):: as is_new,
  ("CONTENT"->>'LEAD_ID'):: as lead_id,
  ("CONTENT"->>'TYPE_ID'):: as type_id,
  ("CONTENT"->>'COMMENTS'):: as comments,
  ("CONTENT"->>'QUOTE_ID'):: as quote_id,
  ("CONTENT"->>'ORIGIN_ID'):: as origin_id,
  ("CONTENT"->>'SOURCE_ID'):: as source_id,
  ("CONTENT"->>'TAX_VALUE'):: as tax_value,
  ("CONTENT"->>'MOVED_TIME'):: as moved_time,
  ("CONTENT"->>'UTM_MEDIUM'):: as utm_medium,
  ("CONTENT"->>'UTM_SOURCE'):: as utm_source,
  ("CONTENT"->>'UTM_TERM'):: as utm_term,
  ("CONTENT"->>'CURRENCY_ID'):: as currency_id,
  ("CONTENT"->>'LOCATION_ID'):: as location_id,
  ("CONTENT"->>'MOVED_BY_ID'):: as moved_by_id,
  ("CONTENT"->>'PROBABILITY'):: as probability,
  ("CONTENT"->>'UTM_CONTENT'):: as utm_content,
  ("CONTENT"->>'IS_RECURRING'):: as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID'):: as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN'):: as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID'):: as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION'):: as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO'):: as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID'):: as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME'):: as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY'):: as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID'):: as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY'):: as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER'):: as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH'):: as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656'):: as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318'):: as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676'):: as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531'):: as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277'):: as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494'):: as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470'):: as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377'):: as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133'):: as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735'):: as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227'):: as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995'):: as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652'):: as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628'):: as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801'):: as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061'):: as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488'):: as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804'):: as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185'):: as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978'):: as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608'):: as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720'):: as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126'):: as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124'):: as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190'):: as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370'):: as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036'):: as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367'):: as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245'):: as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568'):: as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157'):: as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025'):: as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622'):: as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264'):: as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810'):: as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070'):: as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791'):: as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811'):: as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215'):: as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445'):: as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266'):: as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322'):: as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220'):: as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164'):: as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734'):: as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497'):: as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106'):: as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554'):: as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055'):: as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643'):: as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374'):: as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514'):: as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838'):: as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723'):: as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502'):: as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050'):: as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428'):: as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394'):: as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620'):: as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20'):: as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD'):: as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F'):: as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC'):: as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580'):: as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848'):: as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541'):: as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488'):: as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689'):: as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411'):: as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239'):: as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103'):: as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944'):: as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827'):: as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832'):: as uf_crm_deal_1722632496832
  
FROM bitrix.btx_raw_deal
  );
  
[0m22:19:50.290115 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                   ^

[0m22:19:50.290505 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m22:19:50.294205 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.169 seconds
[0m22:19:50.294493 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.177 seconds
[0m22:19:50.305772 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:19:50.306748 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:19:50.307001 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:19:50.307221 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:19:50.307427 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:19:50.307625 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:19:50.441187 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:19:50.450914 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:19:50.453004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dac36b0>]}
[0m22:19:50.453715 [error] [Thread-2 (]: 1 of 3 ERROR creating sql table model bitrix.btx_processed_deal ................ [[31mERROR[0m in 1.61s]
[0m22:19:50.454203 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:19:50.454624 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m22:19:50.455965 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m22:19:50.457474 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:19:50.457806 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m22:19:50.458362 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:19:50.458725 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da17dd0>]}
[0m22:19:50.459533 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd0043a-6fb1-4338-8e94-8d898289ef05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da175c0>]}
[0m22:19:50.459242 [info ] [Thread-4 (]: 3 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mSELECT 5[0m in 1.62s]
[0m22:19:50.460083 [info ] [Thread-3 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mSELECT 5[0m in 1.62s]
[0m22:19:50.460553 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:19:50.460938 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:19:50.461878 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:50.462103 [debug] [MainThread]: On master: BEGIN
[0m22:19:50.462299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:51.695793 [debug] [MainThread]: SQL status: BEGIN in 1.233 seconds
[0m22:19:51.699559 [debug] [MainThread]: On master: COMMIT
[0m22:19:51.700389 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:51.700891 [debug] [MainThread]: On master: COMMIT
[0m22:19:51.852758 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m22:19:51.853692 [debug] [MainThread]: On master: Close
[0m22:19:51.854845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:51.855254 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m22:19:51.855615 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m22:19:51.855940 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m22:19:51.856247 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:19:51.856754 [info ] [MainThread]: 
[0m22:19:51.857183 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m22:19:51.858301 [debug] [MainThread]: Command end result
[0m22:19:51.878096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:19:51.879837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:19:51.884584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:19:51.884871 [info ] [MainThread]: 
[0m22:19:51.885141 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:19:51.885357 [info ] [MainThread]: 
[0m22:19:51.885616 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "as"
  LINE 19:   ("CONTENT"->>'TITLE'):: as title,
                                     ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m22:19:51.885831 [info ] [MainThread]: 
[0m22:19:51.886044 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:19:51.887832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.60325, "process_in_blocks": "0", "process_kernel_time": 0.227896, "process_mem_max_rss": "126205952", "process_out_blocks": "0", "process_user_time": 1.583282}
[0m22:19:51.888176 [debug] [MainThread]: Command `dbt run` failed at 22:19:51.888118 after 8.60 seconds
[0m22:19:51.888438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189eb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac011f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dadae70>]}
[0m22:19:51.888700 [debug] [MainThread]: Flushing usage events
[0m22:19:52.797734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:14.680809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114832d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114832a20>]}


============================== 00:07:14.683932 | b1cf9bbc-2824-4e9e-aa49-0c775f49c95e ==============================
[0m00:07:14.683932 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:07:14.684293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:07:14.771878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d97c80>]}
[0m00:07:14.799514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114861880>]}
[0m00:07:14.800273 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:07:14.860036 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:07:14.911159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m00:07:14.911540 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_processed_product.sql
[0m00:07:14.911758 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m00:07:14.911959 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m00:07:14.912147 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m00:07:15.024932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m00:07:15.027696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115703980>]}
[0m00:07:15.054351 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:07:15.056494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:07:15.068336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160517c0>]}
[0m00:07:15.068663 [info ] [MainThread]: Found 5 models, 433 macros
[0m00:07:15.068859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154742c0>]}
[0m00:07:15.069844 [info ] [MainThread]: 
[0m00:07:15.070230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:07:15.070595 [info ] [MainThread]: 
[0m00:07:15.071176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:15.073777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:07:15.102720 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:07:15.102982 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:07:15.103156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:16.348207 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.245 seconds
[0m00:07:16.351427 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:07:16.353859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:07:16.363181 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:07:16.363628 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:07:16.363945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:17.570916 [debug] [ThreadPool]: SQL status: BEGIN in 1.207 seconds
[0m00:07:17.571996 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:07:17.572545 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:07:17.737507 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.164 seconds
[0m00:07:17.742918 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:07:17.892959 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:07:17.902575 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:17.903216 [debug] [MainThread]: On master: BEGIN
[0m00:07:17.903577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:19.165521 [debug] [MainThread]: SQL status: BEGIN in 1.261 seconds
[0m00:07:19.168297 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:19.169140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:07:19.333724 [debug] [MainThread]: SQL status: SELECT 0 in 0.163 seconds
[0m00:07:19.338019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157ca990>]}
[0m00:07:19.339018 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:19.496074 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:19.498595 [debug] [MainThread]: On master: BEGIN
[0m00:07:19.810932 [debug] [MainThread]: SQL status: BEGIN in 0.311 seconds
[0m00:07:19.813343 [debug] [MainThread]: On master: COMMIT
[0m00:07:19.814416 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:19.815634 [debug] [MainThread]: On master: COMMIT
[0m00:07:19.967557 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m00:07:19.970327 [debug] [MainThread]: On master: Close
[0m00:07:19.977738 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:07:19.978406 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:07:19.978923 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m00:07:19.979431 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:07:19.979987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m00:07:19.980594 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:07:19.981323 [info ] [Thread-3 (]: 1 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m00:07:19.982079 [info ] [Thread-4 (]: 2 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m00:07:19.982677 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:07:19.983124 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:07:19.983652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m00:07:19.984138 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m00:07:19.991745 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:07:19.994564 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:07:19.994931 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m00:07:19.995251 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:07:19.997636 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:19.999660 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:20.000715 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:07:20.001512 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:07:20.001955 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:07:20.002331 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m00:07:20.002715 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:07:20.003156 [info ] [Thread-2 (]: 3 of 3 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m00:07:20.046575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_product)
[0m00:07:20.051281 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:20.053406 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:20.053614 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:07:20.053825 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp000720033928"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m00:07:20.054029 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp000720040434"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m00:07:20.055353 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:07:20.055550 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:07:20.055752 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:07:20.056267 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:07:20.058176 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:07:20.058565 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:07:20.058749 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:07:20.058914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:07:21.275056 [debug] [Thread-2 (]: SQL status: BEGIN in 1.215 seconds
[0m00:07:21.278019 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:07:21.278967 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_product"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m00:07:21.310503 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.254 seconds
[0m00:07:21.311691 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.256 seconds
[0m00:07:21.335189 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:21.337343 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.337807 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:07:21.338209 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m00:07:21.440660 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.161 seconds
[0m00:07:21.455122 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:07:21.455521 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:07:21.455765 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:07:21.487052 [debug] [Thread-4 (]: SQL status: BEGIN in 0.148 seconds
[0m00:07:21.487464 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:21.487896 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp000720033928'
        
      order by ordinal_position

  
[0m00:07:21.490668 [debug] [Thread-3 (]: SQL status: BEGIN in 0.152 seconds
[0m00:07:21.490983 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.491288 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp000720040434'
        
      order by ordinal_position

  
[0m00:07:21.609789 [debug] [Thread-2 (]: SQL status: COMMIT in 0.154 seconds
[0m00:07:21.611243 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:07:21.612655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0f830>]}
[0m00:07:21.613153 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model bitrix.btx_processed_product ........... [[32mSELECT 5[0m in 1.57s]
[0m00:07:21.613491 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:07:21.655913 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.168 seconds
[0m00:07:21.659077 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:21.659349 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.168 seconds
[0m00:07:21.659548 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m00:07:21.661932 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.662428 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m00:07:21.823343 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.160 seconds
[0m00:07:21.823999 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.162 seconds
[0m00:07:21.833287 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.836474 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:21.836881 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m00:07:21.837255 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m00:07:21.988141 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.150 seconds
[0m00:07:21.996257 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.997646 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:21.997848 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp000720040434" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp000720040434"
    )
  
[0m00:07:22.074534 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.237 seconds
[0m00:07:22.076636 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:22.077359 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:22.077779 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp000720033928" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp000720033928"
    )
  
[0m00:07:22.151121 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.153 seconds
[0m00:07:22.153218 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m00:07:22.153709 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m00:07:22.154108 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m00:07:22.231510 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.152 seconds
[0m00:07:22.234787 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:07:22.235454 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:07:22.235985 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:07:22.304643 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m00:07:22.306046 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m00:07:22.307345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d1fc50>]}
[0m00:07:22.308425 [info ] [Thread-3 (]: 1 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.32s]
[0m00:07:22.309267 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m00:07:22.385211 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m00:07:22.388342 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:07:22.390008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cf9bbc-2824-4e9e-aa49-0c775f49c95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11668c710>]}
[0m00:07:22.391085 [info ] [Thread-4 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.41s]
[0m00:07:22.391932 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:07:22.394083 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:22.394543 [debug] [MainThread]: On master: BEGIN
[0m00:07:22.394889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:23.625214 [debug] [MainThread]: SQL status: BEGIN in 1.230 seconds
[0m00:07:23.626448 [debug] [MainThread]: On master: COMMIT
[0m00:07:23.627115 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:23.627690 [debug] [MainThread]: On master: COMMIT
[0m00:07:23.793734 [debug] [MainThread]: SQL status: COMMIT in 0.165 seconds
[0m00:07:23.795450 [debug] [MainThread]: On master: Close
[0m00:07:23.796766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:23.797213 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_activity' was properly closed.
[0m00:07:23.797416 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:07:23.797591 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m00:07:23.797753 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m00:07:23.798077 [info ] [MainThread]: 
[0m00:07:23.798420 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m00:07:23.799414 [debug] [MainThread]: Command end result
[0m00:07:23.819238 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:07:23.820810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:07:23.825354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:07:23.825694 [info ] [MainThread]: 
[0m00:07:23.826007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:23.826250 [info ] [MainThread]: 
[0m00:07:23.826503 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:07:23.828549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.184654, "process_in_blocks": "0", "process_kernel_time": 0.234793, "process_mem_max_rss": "127991808", "process_out_blocks": "0", "process_user_time": 1.35815}
[0m00:07:23.828898 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:23.828830 after 9.19 seconds
[0m00:07:23.829413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aef2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e42d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116083fe0>]}
[0m00:07:23.829781 [debug] [MainThread]: Flushing usage events
[0m00:07:24.843788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:19.358029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105402db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105402a50>]}


============================== 11:15:19.360964 | ad236ea3-7445-4603-9cc2-234cec3c1267 ==============================
[0m11:15:19.360964 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:15:19.361337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:15:19.444336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105857b90>]}
[0m11:15:19.471672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105857cb0>]}
[0m11:15:19.472770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:15:19.561553 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m11:15:19.609072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:19.609337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:19.612027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m11:15:19.621427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f937d0>]}
[0m11:15:19.649157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:15:19.651178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:15:19.661263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f07c20>]}
[0m11:15:19.661555 [info ] [MainThread]: Found 5 models, 433 macros
[0m11:15:19.661740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060749b0>]}
[0m11:15:19.662605 [info ] [MainThread]: 
[0m11:15:19.662796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:19.662936 [info ] [MainThread]: 
[0m11:15:19.663195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:19.665177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m11:15:19.694554 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m11:15:19.694804 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m11:15:19.695025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:20.973229 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.277 seconds
[0m11:15:20.979597 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m11:15:20.982648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m11:15:20.990414 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:15:20.990837 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m11:15:20.991164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:22.222858 [debug] [ThreadPool]: SQL status: BEGIN in 1.232 seconds
[0m11:15:22.223291 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:15:22.223542 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m11:15:22.406280 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.182 seconds
[0m11:15:22.415993 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m11:15:22.563973 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m11:15:22.575731 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:22.576281 [debug] [MainThread]: On master: BEGIN
[0m11:15:22.576643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:23.834581 [debug] [MainThread]: SQL status: BEGIN in 1.257 seconds
[0m11:15:23.836380 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:23.837151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:24.017930 [debug] [MainThread]: SQL status: SELECT 0 in 0.180 seconds
[0m11:15:24.019017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eee6c0>]}
[0m11:15:24.019397 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:24.171845 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:24.173563 [debug] [MainThread]: On master: BEGIN
[0m11:15:24.477067 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m11:15:24.477502 [debug] [MainThread]: On master: COMMIT
[0m11:15:24.477751 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:24.477975 [debug] [MainThread]: On master: COMMIT
[0m11:15:24.629078 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m11:15:24.629536 [debug] [MainThread]: On master: Close
[0m11:15:24.633072 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m11:15:24.633536 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m11:15:24.633921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m11:15:24.634196 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m11:15:24.634473 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m11:15:24.634827 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m11:15:24.635084 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m11:15:24.635430 [info ] [Thread-3 (]: 1 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m11:15:24.635743 [info ] [Thread-4 (]: 2 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m11:15:24.635995 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m11:15:24.640701 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m11:15:24.641091 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m11:15:24.641390 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m11:15:24.643517 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m11:15:24.643958 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m11:15:24.644261 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m11:15:24.646127 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:24.646573 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m11:15:24.648072 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:24.648512 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m11:15:24.648995 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m11:15:24.649350 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m11:15:24.649650 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m11:15:24.649983 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m11:15:24.675583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m11:15:24.682492 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:24.684890 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:24.685126 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m11:15:24.685327 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp111524667736"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m11:15:24.685534 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp111524683840"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m11:15:24.686889 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m11:15:24.687081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:15:24.687251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:15:24.687851 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m11:15:24.690025 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:24.690291 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp111524689072"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m11:15:24.690504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:25.959331 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.272 seconds
[0m11:15:25.959681 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.269 seconds
[0m11:15:25.967311 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:25.968910 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:25.969146 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m11:15:25.969362 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m11:15:26.039874 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.353 seconds
[0m11:15:26.042144 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.042433 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m11:15:26.121171 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m11:15:26.121527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m11:15:26.121862 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.122112 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:26.122375 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp111524683840'
        
      order by ordinal_position

  
[0m11:15:26.122641 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp111524689072'
        
      order by ordinal_position

  
[0m11:15:26.191526 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m11:15:26.192010 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.192336 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp111524667736'
        
      order by ordinal_position

  
[0m11:15:26.334631 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.211 seconds
[0m11:15:26.336121 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.213 seconds
[0m11:15:26.347192 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.352666 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:26.353091 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.160 seconds
[0m11:15:26.353527 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.353947 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.356840 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.357458 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.515519 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.157 seconds
[0m11:15:26.517385 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.159 seconds
[0m11:15:26.518513 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.161 seconds
[0m11:15:26.531127 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.534516 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.537875 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:26.538305 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.538676 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.539025 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:15:26.690124 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.151 seconds
[0m11:15:26.697764 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.158 seconds
[0m11:15:26.698417 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.159 seconds
[0m11:15:26.705745 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.707265 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.709064 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m11:15:26.709864 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.710247 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.710570 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp111524683840" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp111524683840"
    )
  
[0m11:15:26.710966 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp111524667736" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp111524667736"
    )
  
[0m11:15:26.711373 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:26.711793 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp111524689072" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp111524689072"
    )
  
[0m11:15:26.865597 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.152 seconds
[0m11:15:26.867300 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.155 seconds
[0m11:15:26.868475 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.157 seconds
[0m11:15:26.888260 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:15:26.889793 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:15:26.891040 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:15:26.891420 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:15:26.891743 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:15:26.892062 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:15:26.892363 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:15:26.892666 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:15:26.892954 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:15:27.044654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m11:15:27.045470 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m11:15:27.046304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.153 seconds
[0m11:15:27.049253 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m11:15:27.050234 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m11:15:27.051091 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m11:15:27.056594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b8950>]}
[0m11:15:27.057043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106405dc0>]}
[0m11:15:27.057436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad236ea3-7445-4603-9cc2-234cec3c1267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031bf7d0>]}
[0m11:15:27.058420 [info ] [Thread-4 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.41s]
[0m11:15:27.059112 [info ] [Thread-3 (]: 1 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.41s]
[0m11:15:27.059715 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.38s]
[0m11:15:27.060306 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m11:15:27.060744 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m11:15:27.061147 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m11:15:27.062817 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:27.063195 [debug] [MainThread]: On master: BEGIN
[0m11:15:27.063477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:28.286065 [debug] [MainThread]: SQL status: BEGIN in 1.222 seconds
[0m11:15:28.288409 [debug] [MainThread]: On master: COMMIT
[0m11:15:28.289133 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:28.289687 [debug] [MainThread]: On master: COMMIT
[0m11:15:28.439339 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m11:15:28.441561 [debug] [MainThread]: On master: Close
[0m11:15:28.450000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:28.450823 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m11:15:28.451277 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m11:15:28.451701 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m11:15:28.452096 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m11:15:28.452720 [info ] [MainThread]: 
[0m11:15:28.453259 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m11:15:28.454447 [debug] [MainThread]: Command end result
[0m11:15:28.474801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:15:28.476335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:15:28.481026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m11:15:28.481305 [info ] [MainThread]: 
[0m11:15:28.481568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:28.481770 [info ] [MainThread]: 
[0m11:15:28.481991 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:15:28.484193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.161036, "process_in_blocks": "0", "process_kernel_time": 0.214341, "process_mem_max_rss": "124092416", "process_out_blocks": "0", "process_user_time": 1.223587}
[0m11:15:28.484561 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:28.484496 after 9.16 seconds
[0m11:15:28.484852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10106ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f88800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474f860>]}
[0m11:15:28.485127 [debug] [MainThread]: Flushing usage events
[0m11:15:29.298495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:38.649864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aaab0>]}


============================== 11:18:38.652700 | 4ffa8019-9c6d-4d1d-bb2e-23043a9dda09 ==============================
[0m11:18:38.652700 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:18:38.653032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m11:18:38.740095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106555340>]}
[0m11:18:38.766069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfbbc0>]}
[0m11:18:38.766658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:18:38.824049 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m11:18:38.870153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:38.870419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:38.873076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m11:18:38.882304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756c440>]}
[0m11:18:38.908018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:18:38.909733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:18:38.920790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770bd70>]}
[0m11:18:38.921111 [info ] [MainThread]: Found 5 models, 433 macros
[0m11:18:38.921315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c74a0>]}
[0m11:18:38.922194 [info ] [MainThread]: 
[0m11:18:38.922391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:38.922539 [info ] [MainThread]: 
[0m11:18:38.922802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:38.924721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m11:18:38.952510 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m11:18:38.952760 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m11:18:38.952918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:40.193437 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.240 seconds
[0m11:18:40.195831 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m11:18:40.197782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m11:18:40.204923 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:18:40.205468 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m11:18:40.205754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:41.417424 [debug] [ThreadPool]: SQL status: BEGIN in 1.212 seconds
[0m11:18:41.417836 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:18:41.418073 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m11:18:41.570613 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.152 seconds
[0m11:18:41.572992 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m11:18:41.721164 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m11:18:41.733279 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:41.733829 [debug] [MainThread]: On master: BEGIN
[0m11:18:41.734271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:42.944508 [debug] [MainThread]: SQL status: BEGIN in 1.210 seconds
[0m11:18:42.946223 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:42.947530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:43.099068 [debug] [MainThread]: SQL status: SELECT 0 in 0.150 seconds
[0m11:18:43.103554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696b4d0>]}
[0m11:18:43.104716 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:43.255410 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:43.256437 [debug] [MainThread]: On master: BEGIN
[0m11:18:43.558560 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m11:18:43.564470 [debug] [MainThread]: On master: COMMIT
[0m11:18:43.567599 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:43.568667 [debug] [MainThread]: On master: COMMIT
[0m11:18:43.716426 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m11:18:43.717174 [debug] [MainThread]: On master: Close
[0m11:18:43.722051 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m11:18:43.722497 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m11:18:43.722970 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m11:18:43.723453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m11:18:43.723826 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m11:18:43.724298 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m11:18:43.725253 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m11:18:43.724897 [info ] [Thread-3 (]: 1 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m11:18:43.725854 [info ] [Thread-4 (]: 2 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m11:18:43.726246 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m11:18:43.732784 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m11:18:43.733199 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m11:18:43.733544 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m11:18:43.736081 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m11:18:43.736491 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m11:18:43.736765 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m11:18:43.738729 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:18:43.739282 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m11:18:43.741122 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:18:43.741548 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m11:18:43.741897 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m11:18:43.742309 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m11:18:43.742682 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m11:18:43.742937 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m11:18:43.775607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m11:18:43.777145 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:18:43.779276 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:18:43.779498 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m11:18:43.780860 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m11:18:43.781245 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m11:18:43.781508 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:18:43.781731 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:18:43.783514 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m11:18:43.783726 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m11:18:43.783915 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m11:18:43.784131 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:18:43.784316 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:18:43.784577 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:18:43.784820 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m11:18:43.784986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:45.003541 [debug] [Thread-4 (]: SQL status: BEGIN in 1.218 seconds
[0m11:18:45.005931 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:18:45.010929 [debug] [Thread-1 (]: SQL status: BEGIN in 1.226 seconds
[0m11:18:45.011602 [debug] [Thread-3 (]: SQL status: BEGIN in 1.227 seconds
[0m11:18:45.012382 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m11:18:45.012943 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:18:45.013443 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:18:45.014361 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_product"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m11:18:45.015483 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m11:18:45.174103 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_product" does not exist
LINE 38: FROM bitrix.btx_raw_product
              ^

[0m11:18:45.174703 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: ROLLBACK
[0m11:18:45.180431 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.164 seconds
[0m11:18:45.197265 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:18:45.197676 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:18:45.197961 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:18:45.209270 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.195 seconds
[0m11:18:45.210815 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:18:45.211145 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:18:45.211419 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:18:45.327138 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m11:18:45.340060 [debug] [Thread-1 (]: Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  relation "bitrix.btx_raw_product" does not exist
  LINE 38: FROM bitrix.btx_raw_product
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql
[0m11:18:45.342578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756c290>]}
[0m11:18:45.343383 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model bitrix.btx_processed_product ....... [[31mERROR[0m in 1.57s]
[0m11:18:45.344015 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m11:18:45.344591 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_product' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  relation "bitrix.btx_raw_product" does not exist
  LINE 38: FROM bitrix.btx_raw_product
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql.
[0m11:18:45.353091 [debug] [Thread-3 (]: SQL status: COMMIT in 0.155 seconds
[0m11:18:45.355476 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m11:18:45.356503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b39a00>]}
[0m11:18:45.357189 [info ] [Thread-3 (]: 1 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mSELECT 11[0m in 1.62s]
[0m11:18:45.357734 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m11:18:45.359242 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m11:18:45.359934 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m11:18:45.360595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ffa8019-9c6d-4d1d-bb2e-23043a9dda09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a93da0>]}
[0m11:18:45.361162 [info ] [Thread-4 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mSELECT 4[0m in 1.63s]
[0m11:18:45.361646 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m11:18:45.363024 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:45.363321 [debug] [MainThread]: On master: BEGIN
[0m11:18:45.363569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:46.588498 [debug] [MainThread]: SQL status: BEGIN in 1.224 seconds
[0m11:18:46.590753 [debug] [MainThread]: On master: COMMIT
[0m11:18:46.591380 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:46.591787 [debug] [MainThread]: On master: COMMIT
[0m11:18:46.740761 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m11:18:46.742269 [debug] [MainThread]: On master: Close
[0m11:18:46.743661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:46.744103 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m11:18:46.744510 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m11:18:46.744894 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m11:18:46.745271 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m11:18:46.746024 [info ] [MainThread]: 
[0m11:18:46.746656 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m11:18:46.747875 [debug] [MainThread]: Command end result
[0m11:18:46.770280 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:18:46.772626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:18:46.777896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m11:18:46.778190 [info ] [MainThread]: 
[0m11:18:46.778505 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:18:46.778751 [info ] [MainThread]: 
[0m11:18:46.779033 [error] [MainThread]:   Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  relation "bitrix.btx_raw_product" does not exist
  LINE 38: FROM bitrix.btx_raw_product
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql
[0m11:18:46.779248 [info ] [MainThread]: 
[0m11:18:46.779475 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:18:46.781449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.164172, "process_in_blocks": "0", "process_kernel_time": 0.218356, "process_mem_max_rss": "123535360", "process_out_blocks": "0", "process_user_time": 1.15727}
[0m11:18:46.781836 [debug] [MainThread]: Command `dbt run` failed at 11:18:46.781776 after 8.16 seconds
[0m11:18:46.782143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10250ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104735d90>]}
[0m11:18:46.782440 [debug] [MainThread]: Flushing usage events
[0m11:18:47.686611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:18.224321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044df530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684eab0>]}


============================== 11:20:18.227251 | 0cc81382-ba38-47ce-8512-3c601427cf64 ==============================
[0m11:20:18.227251 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:20:18.227597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:20:18.315158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3bc0>]}
[0m11:20:18.342407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2f560>]}
[0m11:20:18.343146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:20:18.403580 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m11:20:18.451772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:20:18.452046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:20:18.454793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bdt_transformations.notion
[0m11:20:18.464582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073db770>]}
[0m11:20:18.492087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:20:18.493973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:20:18.505143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734f1d0>]}
[0m11:20:18.505454 [info ] [MainThread]: Found 5 models, 433 macros
[0m11:20:18.505638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c11f0>]}
[0m11:20:18.506486 [info ] [MainThread]: 
[0m11:20:18.506680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:18.506831 [info ] [MainThread]: 
[0m11:20:18.507095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:18.509085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m11:20:18.537514 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m11:20:18.537758 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m11:20:18.537917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:19.779019 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.240 seconds
[0m11:20:19.782666 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m11:20:19.785464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m11:20:19.793258 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:20:19.793742 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m11:20:19.794070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:21.007077 [debug] [ThreadPool]: SQL status: BEGIN in 1.213 seconds
[0m11:20:21.007649 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:20:21.007979 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m11:20:21.158398 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.150 seconds
[0m11:20:21.164632 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m11:20:21.312982 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m11:20:21.324480 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:21.325053 [debug] [MainThread]: On master: BEGIN
[0m11:20:21.325410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:22.539495 [debug] [MainThread]: SQL status: BEGIN in 1.213 seconds
[0m11:20:22.541980 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:22.543506 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:22.695048 [debug] [MainThread]: SQL status: SELECT 0 in 0.150 seconds
[0m11:20:22.700828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd53d0>]}
[0m11:20:22.702597 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:22.851227 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:22.853164 [debug] [MainThread]: On master: BEGIN
[0m11:20:23.150720 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m11:20:23.152544 [debug] [MainThread]: On master: COMMIT
[0m11:20:23.153177 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:23.153978 [debug] [MainThread]: On master: COMMIT
[0m11:20:23.300896 [debug] [MainThread]: SQL status: COMMIT in 0.146 seconds
[0m11:20:23.302805 [debug] [MainThread]: On master: Close
[0m11:20:23.310540 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m11:20:23.311206 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m11:20:23.311778 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m11:20:23.312326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m11:20:23.312743 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m11:20:23.313351 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m11:20:23.314074 [info ] [Thread-3 (]: 1 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m11:20:23.314559 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m11:20:23.315105 [info ] [Thread-4 (]: 2 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m11:20:23.315585 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m11:20:23.316208 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m11:20:23.324366 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m11:20:23.324930 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m11:20:23.327752 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m11:20:23.328119 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m11:20:23.328559 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m11:20:23.330748 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:23.331273 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m11:20:23.333126 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:23.333578 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m11:20:23.333957 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m11:20:23.334391 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m11:20:23.335127 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m11:20:23.334878 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m11:20:23.373360 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:23.374539 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:23.374788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m11:20:23.375009 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp112023356264"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m11:20:23.375224 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp112023363547"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m11:20:23.375422 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m11:20:23.375597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:20:23.375768 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:20:23.377064 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m11:20:23.377663 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m11:20:23.379598 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m11:20:23.379947 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:20:23.380134 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m11:20:23.380299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:24.596547 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.221 seconds
[0m11:20:24.603787 [debug] [Thread-1 (]: SQL status: BEGIN in 1.223 seconds
[0m11:20:24.615320 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:24.615837 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:20:24.616229 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m11:20:24.616672 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_product"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m11:20:24.621326 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.245 seconds
[0m11:20:24.624281 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:24.624700 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m11:20:24.763819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.147 seconds
[0m11:20:24.764448 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:24.764845 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp112023356264'
        
      order by ordinal_position

  
[0m11:20:24.774596 [debug] [Thread-4 (]: SQL status: BEGIN in 0.150 seconds
[0m11:20:24.775125 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:24.775637 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp112023363547'
        
      order by ordinal_position

  
[0m11:20:24.778361 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.161 seconds
[0m11:20:24.794955 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:20:24.795408 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:20:24.795699 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:20:24.919182 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.153 seconds
[0m11:20:24.929997 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:24.930652 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:20:24.931670 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.156 seconds
[0m11:20:24.935225 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:24.937463 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:20:24.945296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m11:20:24.947548 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m11:20:24.951401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fb8c0>]}
[0m11:20:24.952139 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bitrix.btx_processed_product ........... [[32mSELECT 5[0m in 1.57s]
[0m11:20:24.952722 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m11:20:25.081540 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.150 seconds
[0m11:20:25.095283 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:25.095871 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.158 seconds
[0m11:20:25.096405 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:20:25.099567 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:25.100104 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:20:25.250299 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.150 seconds
[0m11:20:25.261615 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.161 seconds
[0m11:20:25.271899 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:25.274161 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:25.275511 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:25.276025 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp112023356264" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp112023356264"
    )
  
[0m11:20:25.276460 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:25.277002 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp112023363547" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp112023363547"
    )
  
[0m11:20:25.426004 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.149 seconds
[0m11:20:25.431182 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:20:25.431985 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.154 seconds
[0m11:20:25.432754 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:20:25.435022 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:20:25.435510 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:20:25.435954 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:20:25.436481 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:20:25.584700 [debug] [Thread-3 (]: SQL status: COMMIT in 0.148 seconds
[0m11:20:25.588497 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m11:20:25.589502 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m11:20:25.590796 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m11:20:25.591702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e898e0>]}
[0m11:20:25.592316 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc81382-ba38-47ce-8512-3c601427cf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078405c0>]}
[0m11:20:25.593165 [info ] [Thread-3 (]: 1 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.28s]
[0m11:20:25.593899 [info ] [Thread-4 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.27s]
[0m11:20:25.594573 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m11:20:25.595128 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m11:20:25.596995 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:25.597377 [debug] [MainThread]: On master: BEGIN
[0m11:20:25.597717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:26.828441 [debug] [MainThread]: SQL status: BEGIN in 1.230 seconds
[0m11:20:26.830798 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.831828 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:26.833448 [debug] [MainThread]: On master: COMMIT
[0m11:20:26.986173 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m11:20:26.988625 [debug] [MainThread]: On master: Close
[0m11:20:26.990251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:26.990837 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m11:20:26.991407 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m11:20:26.991829 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m11:20:26.992224 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m11:20:26.993037 [info ] [MainThread]: 
[0m11:20:26.993785 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m11:20:26.995621 [debug] [MainThread]: Command end result
[0m11:20:27.015290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:20:27.017133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:20:27.022423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m11:20:27.022720 [info ] [MainThread]: 
[0m11:20:27.023021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:27.023238 [info ] [MainThread]: 
[0m11:20:27.023475 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:20:27.025744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.83497, "process_in_blocks": "0", "process_kernel_time": 0.224348, "process_mem_max_rss": "122716160", "process_out_blocks": "0", "process_user_time": 1.283855}
[0m11:20:27.026138 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:27.026070 after 8.84 seconds
[0m11:20:27.026466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684ebd0>]}
[0m11:20:27.026758 [debug] [MainThread]: Flushing usage events
[0m11:20:30.804659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:29.412021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097477a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a932f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a932c00>]}


============================== 11:24:29.414630 | 5ec50eae-0822-45d5-856d-86b057c70d23 ==============================
[0m11:24:29.414630 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:24:29.414974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:29.500090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f309e0>]}
[0m11:24:29.527175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6ae10>]}
[0m11:24:29.528288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:24:29.591687 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m11:24:29.623764 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:24:29.624128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a353830>]}
[0m11:24:30.034480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c12b140>]}
[0m11:24:30.059637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:24:30.061327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:24:30.069850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c135520>]}
[0m11:24:30.070129 [info ] [MainThread]: Found 5 models, 433 macros
[0m11:24:30.070310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c136a20>]}
[0m11:24:30.071414 [info ] [MainThread]: 
[0m11:24:30.071613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:30.071760 [info ] [MainThread]: 
[0m11:24:30.072016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:24:30.073852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m11:24:30.128829 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m11:24:30.129112 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m11:24:30.129277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:31.396693 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.267 seconds
[0m11:24:31.399195 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m11:24:31.401059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m11:24:31.407627 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:24:31.408173 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m11:24:31.408479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:32.628445 [debug] [ThreadPool]: SQL status: BEGIN in 1.219 seconds
[0m11:24:32.630164 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:24:32.630870 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m11:24:32.805115 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.173 seconds
[0m11:24:32.809769 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m11:24:32.958778 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m11:24:32.967034 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:32.967584 [debug] [MainThread]: On master: BEGIN
[0m11:24:32.967896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:34.210616 [debug] [MainThread]: SQL status: BEGIN in 1.243 seconds
[0m11:24:34.211046 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:34.211345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:24:34.381560 [debug] [MainThread]: SQL status: SELECT 0 in 0.170 seconds
[0m11:24:34.385527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae42ea0>]}
[0m11:24:34.386542 [debug] [MainThread]: On master: ROLLBACK
[0m11:24:34.535263 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:34.537714 [debug] [MainThread]: On master: BEGIN
[0m11:24:34.834642 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m11:24:34.837364 [debug] [MainThread]: On master: COMMIT
[0m11:24:34.838527 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:34.839093 [debug] [MainThread]: On master: COMMIT
[0m11:24:34.986610 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m11:24:34.988754 [debug] [MainThread]: On master: Close
[0m11:24:34.997350 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m11:24:34.997989 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m11:24:34.998457 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m11:24:34.998907 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m11:24:34.999426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m11:24:35.000009 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m11:24:35.000728 [info ] [Thread-3 (]: 1 of 3 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m11:24:35.001315 [info ] [Thread-4 (]: 2 of 3 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m11:24:35.001764 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m11:24:35.002153 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m11:24:35.002650 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m11:24:35.003174 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m11:24:35.011570 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m11:24:35.014817 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m11:24:35.015204 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m11:24:35.015517 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m11:24:35.017823 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:35.022151 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:35.022931 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m11:24:35.023454 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m11:24:35.023906 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m11:24:35.024298 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m11:24:35.024685 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m11:24:35.025036 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m11:24:35.061842 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:35.063001 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:35.063269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m11:24:35.063496 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp112435052418"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m11:24:35.063718 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp112435045057"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m11:24:35.063926 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m11:24:35.064112 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:24:35.064280 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:24:35.065567 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m11:24:35.066141 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m11:24:35.068095 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:35.068342 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp112435067215"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m11:24:35.068563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:36.377271 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.309 seconds
[0m11:24:36.388013 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:36.388337 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.324 seconds
[0m11:24:36.388653 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.324 seconds
[0m11:24:36.388894 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m11:24:36.390806 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:36.392640 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:36.392969 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m11:24:36.393240 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m11:24:36.540426 [debug] [Thread-4 (]: SQL status: BEGIN in 0.147 seconds
[0m11:24:36.541160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m11:24:36.541854 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:36.542403 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:36.542991 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp112435052418'
        
      order by ordinal_position

  
[0m11:24:36.543595 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp112435067215'
        
      order by ordinal_position

  
[0m11:24:36.544154 [debug] [Thread-3 (]: SQL status: BEGIN in 0.151 seconds
[0m11:24:36.544988 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:36.545660 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp112435045057'
        
      order by ordinal_position

  
[0m11:24:36.730568 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.183 seconds
[0m11:24:36.731713 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.187 seconds
[0m11:24:36.732496 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.188 seconds
[0m11:24:36.743348 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:36.747243 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:36.750143 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:36.750587 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:36.750981 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:36.751343 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:36.908222 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.156 seconds
[0m11:24:36.909183 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.157 seconds
[0m11:24:36.909746 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.158 seconds
[0m11:24:36.920927 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:36.924605 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:36.927563 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:36.927998 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:36.928391 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:36.928750 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:24:37.082093 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.152 seconds
[0m11:24:37.083767 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.155 seconds
[0m11:24:37.084409 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.155 seconds
[0m11:24:37.105615 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m11:24:37.107674 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:37.109492 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:37.110770 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:37.111271 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp112435052418" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp112435052418"
    )
  
[0m11:24:37.111726 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:37.112261 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:37.112705 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp112435067215" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp112435067215"
    )
  
[0m11:24:37.113071 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp112435045057" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp112435045057"
    )
  
[0m11:24:37.261572 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.150 seconds
[0m11:24:37.262192 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.149 seconds
[0m11:24:37.268479 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.155 seconds
[0m11:24:37.276375 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:24:37.278012 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:24:37.279443 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:24:37.279862 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:24:37.280232 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:24:37.280583 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:24:37.280930 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:24:37.281265 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:24:37.281592 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:24:37.431508 [debug] [Thread-4 (]: SQL status: COMMIT in 0.149 seconds
[0m11:24:37.433303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m11:24:37.434245 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m11:24:37.439051 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m11:24:37.440522 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m11:24:37.441357 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m11:24:37.447027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e35f0>]}
[0m11:24:37.447485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7264b0>]}
[0m11:24:37.447989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec50eae-0822-45d5-856d-86b057c70d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f03a70>]}
[0m11:24:37.448722 [info ] [Thread-3 (]: 1 of 3 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.44s]
[0m11:24:37.449450 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.38s]
[0m11:24:37.450095 [info ] [Thread-4 (]: 2 of 3 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.44s]
[0m11:24:37.450707 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m11:24:37.451227 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m11:24:37.451701 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m11:24:37.453710 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:37.454217 [debug] [MainThread]: On master: BEGIN
[0m11:24:37.454508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:24:38.692269 [debug] [MainThread]: SQL status: BEGIN in 1.237 seconds
[0m11:24:38.695300 [debug] [MainThread]: On master: COMMIT
[0m11:24:38.696392 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:38.697140 [debug] [MainThread]: On master: COMMIT
[0m11:24:38.847335 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m11:24:38.847685 [debug] [MainThread]: On master: Close
[0m11:24:38.848041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:38.848203 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m11:24:38.848346 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m11:24:38.848473 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m11:24:38.848596 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m11:24:38.848799 [info ] [MainThread]: 
[0m11:24:38.848968 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m11:24:38.849413 [debug] [MainThread]: Command end result
[0m11:24:38.860933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:24:38.861745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:24:38.864581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m11:24:38.864779 [info ] [MainThread]: 
[0m11:24:38.864958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:38.865099 [info ] [MainThread]: 
[0m11:24:38.865253 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:24:38.866989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.487986, "process_in_blocks": "0", "process_kernel_time": 0.223812, "process_mem_max_rss": "126812160", "process_out_blocks": "0", "process_user_time": 1.648034}
[0m11:24:38.867273 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:38.867228 after 9.49 seconds
[0m11:24:38.867473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704ba10>]}
[0m11:24:38.867669 [debug] [MainThread]: Flushing usage events
[0m11:24:39.475341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:01.891864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105336ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105336c60>]}


============================== 11:31:01.895885 | ceb2857d-1610-4ed2-9ccc-48255551c1ff ==============================
[0m11:31:01.895885 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:31:01.896523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:31:02.117660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571b6b0>]}
[0m11:31:02.161705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c3980>]}
[0m11:31:02.162709 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:31:02.239427 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m11:31:02.312837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:02.313250 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m11:31:02.557765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106474d10>]}
[0m11:31:02.589974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:31:02.591940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:31:02.608000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106450830>]}
[0m11:31:02.608370 [info ] [MainThread]: Found 5 models, 433 macros
[0m11:31:02.608568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645b830>]}
[0m11:31:02.609503 [info ] [MainThread]: 
[0m11:31:02.609747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:02.609908 [info ] [MainThread]: 
[0m11:31:02.610202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:31:02.612429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m11:31:02.644290 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m11:31:02.644592 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m11:31:02.644786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:03.894352 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.249 seconds
[0m11:31:03.895573 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m11:31:03.896606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m11:31:03.900656 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:31:03.900991 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m11:31:03.901167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:05.125744 [debug] [ThreadPool]: SQL status: BEGIN in 1.223 seconds
[0m11:31:05.127406 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m11:31:05.127726 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m11:31:05.311486 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.182 seconds
[0m11:31:05.362042 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m11:31:05.511934 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m11:31:05.584600 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:05.584928 [debug] [MainThread]: On master: BEGIN
[0m11:31:05.585101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:06.900432 [debug] [MainThread]: SQL status: BEGIN in 1.315 seconds
[0m11:31:06.900765 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:06.901369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:31:07.067820 [debug] [MainThread]: SQL status: SELECT 0 in 0.166 seconds
[0m11:31:07.068654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630b020>]}
[0m11:31:07.068969 [debug] [MainThread]: On master: ROLLBACK
[0m11:31:07.216133 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:07.219044 [debug] [MainThread]: On master: BEGIN
[0m11:31:07.520353 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m11:31:07.521105 [debug] [MainThread]: On master: COMMIT
[0m11:31:07.521859 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:07.522135 [debug] [MainThread]: On master: COMMIT
[0m11:31:07.672566 [debug] [MainThread]: SQL status: COMMIT in 0.146 seconds
[0m11:31:07.687217 [debug] [MainThread]: On master: Close
[0m11:31:07.728014 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m11:31:07.728375 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m11:31:07.728629 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m11:31:07.728889 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m11:31:07.729188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m11:31:07.729545 [info ] [Thread-2 (]: 1 of 4 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m11:31:07.729825 [info ] [Thread-3 (]: 2 of 4 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m11:31:07.730137 [info ] [Thread-4 (]: 3 of 4 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m11:31:07.730480 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m11:31:07.730786 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m11:31:07.731025 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m11:31:07.731246 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_dealcategory'
[0m11:31:07.735592 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m11:31:07.735915 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m11:31:07.736114 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m11:31:07.736297 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m11:31:07.738632 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m11:31:07.740399 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:07.740823 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m11:31:07.745801 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:07.748505 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m11:31:07.751684 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m11:31:07.753952 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m11:31:07.768504 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m11:31:07.790162 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m11:31:07.811925 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:07.812290 [info ] [Thread-1 (]: 4 of 4 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m11:31:07.814876 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:07.815593 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp113107800655"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
FROM bitrix.btx_raw_deal_stage
WHERE "SUCCESS" = true
  );
  
  
[0m11:31:07.815913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m11:31:07.816200 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp113107813747"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
FROM bitrix.btx_raw_dealcategory 
WHERE "SUCCESS" = true
  );
  
  
[0m11:31:07.816433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:31:07.818131 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m11:31:07.818427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:31:07.820159 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m11:31:07.820455 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m11:31:07.820968 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m11:31:07.821385 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:31:07.821822 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m11:31:07.823924 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:07.824201 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp113107823014"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
FROM bitrix.btx_raw_product
WHERE "SUCCESS" = true
  );
  
  
[0m11:31:07.824412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:09.179613 [debug] [Thread-2 (]: SQL status: BEGIN in 1.358 seconds
[0m11:31:09.180072 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m11:31:09.180489 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832
FROM bitrix.btx_raw_deal
WHERE "SUCCESS" = true
  );
[0m11:31:09.183440 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.367 seconds
[0m11:31:09.188732 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.370 seconds
[0m11:31:09.189037 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.365 seconds
[0m11:31:09.192007 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.193785 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.195337 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:09.195620 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m11:31:09.195833 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m11:31:09.196033 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m11:31:09.355823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.159 seconds
[0m11:31:09.356273 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.356493 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp113107800655'
        
      order by ordinal_position

  
[0m11:31:09.358099 [debug] [Thread-4 (]: SQL status: BEGIN in 0.162 seconds
[0m11:31:09.358983 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.360126 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp113107813747'
        
      order by ordinal_position

  
[0m11:31:09.361058 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.180 seconds
[0m11:31:09.370880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.174 seconds
[0m11:31:09.371326 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m11:31:09.371571 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:09.371809 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m11:31:09.372054 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp113107823014'
        
      order by ordinal_position

  
[0m11:31:09.526779 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m11:31:09.537765 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m11:31:09.538136 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m11:31:09.538375 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m11:31:09.553349 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.181 seconds
[0m11:31:09.553906 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.193 seconds
[0m11:31:09.554195 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.197 seconds
[0m11:31:09.557435 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:09.559579 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.561370 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.561774 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.562098 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.562481 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.691608 [debug] [Thread-2 (]: SQL status: COMMIT in 0.153 seconds
[0m11:31:09.695447 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m11:31:09.698299 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m11:31:09.698661 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m11:31:09.720596 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.158 seconds
[0m11:31:09.721081 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.158 seconds
[0m11:31:09.726970 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:09.727273 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.164 seconds
[0m11:31:09.728998 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.729270 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.730804 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.731036 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.731351 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m11:31:09.849817 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m11:31:09.851484 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m11:31:09.853072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10290f800>]}
[0m11:31:09.853502 [info ] [Thread-2 (]: 1 of 4 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.12s]
[0m11:31:09.853823 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m11:31:09.884403 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.153 seconds
[0m11:31:09.891915 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.160 seconds
[0m11:31:09.893263 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m11:31:09.893561 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.162 seconds
[0m11:31:09.894843 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.896485 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.897063 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:09.897429 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp113107823014" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp113107823014"
    )
  
[0m11:31:09.897880 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:09.898185 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp113107800655" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp113107800655"
    )
  
[0m11:31:09.898551 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:09.898775 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp113107813747" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp113107813747"
    )
  
[0m11:31:10.050169 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.152 seconds
[0m11:31:10.051346 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:31:10.051596 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m11:31:10.051785 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m11:31:10.052067 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.153 seconds
[0m11:31:10.053032 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:31:10.053316 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m11:31:10.053525 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m11:31:10.063163 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.165 seconds
[0m11:31:10.064222 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:31:10.064473 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m11:31:10.064655 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m11:31:10.206883 [debug] [Thread-4 (]: SQL status: COMMIT in 0.153 seconds
[0m11:31:10.207283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.155 seconds
[0m11:31:10.207832 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m11:31:10.208479 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m11:31:10.209080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ca720>]}
[0m11:31:10.209439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106331b80>]}
[0m11:31:10.209882 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.48s]
[0m11:31:10.210279 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.39s]
[0m11:31:10.210606 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m11:31:10.210856 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m11:31:10.216089 [debug] [Thread-3 (]: SQL status: COMMIT in 0.151 seconds
[0m11:31:10.216605 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m11:31:10.217228 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2857d-1610-4ed2-9ccc-48255551c1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689b5c0>]}
[0m11:31:10.217635 [info ] [Thread-3 (]: 2 of 4 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.49s]
[0m11:31:10.217957 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m11:31:10.219072 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:10.219324 [debug] [MainThread]: On master: BEGIN
[0m11:31:10.219489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:11.456745 [debug] [MainThread]: SQL status: BEGIN in 1.231 seconds
[0m11:31:11.462580 [debug] [MainThread]: On master: COMMIT
[0m11:31:11.465296 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:11.471546 [debug] [MainThread]: On master: COMMIT
[0m11:31:11.621552 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m11:31:11.621940 [debug] [MainThread]: On master: Close
[0m11:31:11.622380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:11.622571 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m11:31:11.622716 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m11:31:11.622858 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m11:31:11.622989 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m11:31:11.623192 [info ] [MainThread]: 
[0m11:31:11.623375 [info ] [MainThread]: Finished running 3 incremental models, 1 view model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m11:31:11.623872 [debug] [MainThread]: Command end result
[0m11:31:11.636157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m11:31:11.637245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m11:31:11.641083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m11:31:11.641351 [info ] [MainThread]: 
[0m11:31:11.641650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:11.641861 [info ] [MainThread]: 
[0m11:31:11.642045 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:31:11.643940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.799503, "process_in_blocks": "0", "process_kernel_time": 0.359014, "process_mem_max_rss": "129122304", "process_out_blocks": "0", "process_user_time": 1.559708}
[0m11:31:11.644271 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:11.644213 after 9.80 seconds
[0m11:31:11.644510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005a6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105336cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f6ed0>]}
[0m11:31:11.644728 [debug] [MainThread]: Flushing usage events
[0m11:31:12.604172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:28.011584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669aa50>]}


============================== 12:03:28.014435 | 1f3bc741-95a4-4886-8e50-b19eff446330 ==============================
[0m12:03:28.014435 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:03:28.014798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:28.078038 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'bitrix', 'description': 'Raw data imported from Bitrix CRM', 'schema': 'bitrix', 'tables': [{'name': 'btx_raw_deal'}, {'name': 'btx_raw_deal_userfield'}, {'name': 'btx_raw_deal_stage'}, {'name': 'btx_raw_dealcategory'}]}] is not of type 'object'

Error encountered in /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/dbt_project.yml
[0m12:03:28.080002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1045385, "process_in_blocks": "0", "process_kernel_time": 0.119579, "process_mem_max_rss": "95223808", "process_out_blocks": "0", "process_user_time": 0.703977}
[0m12:03:28.080280 [debug] [MainThread]: Command `dbt run` failed at 12:03:28.080220 after 0.10 seconds
[0m12:03:28.080510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022fed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669a510>]}
[0m12:03:28.080722 [debug] [MainThread]: Flushing usage events
[0m12:03:28.682930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:03.188000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104088da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e2bd0>]}


============================== 12:07:03.191892 | a7deacf8-b6fd-46e3-a32b-17ad241722db ==============================
[0m12:07:03.191892 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:07:03.192317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:03.324994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7deacf8-b6fd-46e3-a32b-17ad241722db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a1340>]}
[0m12:07:03.363054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7deacf8-b6fd-46e3-a32b-17ad241722db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1b950>]}
[0m12:07:03.364283 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:03.655108 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m12:07:03.727355 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:07:03.727755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7deacf8-b6fd-46e3-a32b-17ad241722db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104213710>]}
[0m12:07:04.585956 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_processed_activity' (models/bitrix/btx_processed_activity.sql) depends on a source named 'bitrix.btx_raw_activity' which was not found
[0m12:07:04.588207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.444695, "process_in_blocks": "0", "process_kernel_time": 0.356114, "process_mem_max_rss": "110854144", "process_out_blocks": "0", "process_user_time": 1.681232}
[0m12:07:04.588595 [debug] [MainThread]: Command `dbt run` failed at 12:07:04.588529 after 1.45 seconds
[0m12:07:04.588845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10034ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b939b0>]}
[0m12:07:04.589067 [debug] [MainThread]: Flushing usage events
[0m12:07:05.242994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:42.865534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ce8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453ebd0>]}


============================== 12:08:42.868832 | ef81254b-c8c4-42dc-ac63-0d0fa66ccc33 ==============================
[0m12:08:42.868832 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:08:42.869254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:42.967342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef81254b-c8c4-42dc-ac63-0d0fa66ccc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453ed20>]}
[0m12:08:42.994693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef81254b-c8c4-42dc-ac63-0d0fa66ccc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104572ea0>]}
[0m12:08:42.995443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:43.055201 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m12:08:43.086910 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:08:43.087261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef81254b-c8c4-42dc-ac63-0d0fa66ccc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406f6b0>]}
[0m12:08:43.509329 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_processed_product' (models/bitrix/btx_processed_product.sql) depends on a source named 'bitrix.btx_raw_product' which was not found
[0m12:08:43.512420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6863881, "process_in_blocks": "0", "process_kernel_time": 0.16347, "process_mem_max_rss": "109608960", "process_out_blocks": "0", "process_user_time": 1.218581}
[0m12:08:43.512708 [debug] [MainThread]: Command `dbt run` failed at 12:08:43.512654 after 0.69 seconds
[0m12:08:43.512950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1001a6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105081130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d79b0>]}
[0m12:08:43.513147 [debug] [MainThread]: Flushing usage events
[0m12:08:44.127943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:18.733879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56a50>]}


============================== 12:10:18.737041 | 505a9a4c-f84c-424a-82b9-afda1e763da4 ==============================
[0m12:10:18.737041 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:10:18.737453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:18.839039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c81340>]}
[0m12:10:18.865131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c81a0>]}
[0m12:10:18.865863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:10:18.925078 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m12:10:18.956657 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:10:18.957007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dfa70>]}
[0m12:10:19.414600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a65ac0>]}
[0m12:10:19.472324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m12:10:19.474378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m12:10:19.486419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987ddc0>]}
[0m12:10:19.486708 [info ] [MainThread]: Found 6 models, 6 sources, 433 macros
[0m12:10:19.486893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109971970>]}
[0m12:10:19.487780 [info ] [MainThread]: 
[0m12:10:19.487973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:19.488117 [info ] [MainThread]: 
[0m12:10:19.488372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:19.490275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m12:10:19.518433 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m12:10:19.518683 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m12:10:19.518843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:20.748889 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.230 seconds
[0m12:10:20.750526 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m12:10:20.751999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m12:10:20.757209 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m12:10:20.757511 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m12:10:20.757744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:21.967312 [debug] [ThreadPool]: SQL status: BEGIN in 1.209 seconds
[0m12:10:21.969698 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m12:10:21.971184 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m12:10:22.141711 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.169 seconds
[0m12:10:22.146864 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m12:10:22.294797 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m12:10:22.306546 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:22.307161 [debug] [MainThread]: On master: BEGIN
[0m12:10:22.307549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:23.516502 [debug] [MainThread]: SQL status: BEGIN in 1.208 seconds
[0m12:10:23.518833 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:23.520130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:23.697798 [debug] [MainThread]: SQL status: SELECT 1 in 0.175 seconds
[0m12:10:23.702847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3fda0>]}
[0m12:10:23.703931 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:23.851323 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:23.852546 [debug] [MainThread]: On master: BEGIN
[0m12:10:24.156138 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m12:10:24.158542 [debug] [MainThread]: On master: COMMIT
[0m12:10:24.159731 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:24.160717 [debug] [MainThread]: On master: COMMIT
[0m12:10:24.308978 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m12:10:24.311347 [debug] [MainThread]: On master: Close
[0m12:10:24.318249 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m12:10:24.318881 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m12:10:24.319438 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m12:10:24.319867 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m12:10:24.320362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m12:10:24.321083 [info ] [Thread-2 (]: 1 of 5 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m12:10:24.321688 [info ] [Thread-3 (]: 2 of 5 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m12:10:24.322219 [info ] [Thread-4 (]: 3 of 5 START sql incremental model bitrix.btx_processed_deal_userfields ........ [RUN]
[0m12:10:24.322658 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m12:10:24.323201 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m12:10:24.323695 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m12:10:24.324173 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m12:10:24.332841 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m12:10:24.333282 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m12:10:24.333602 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m12:10:24.333913 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m12:10:24.339725 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m12:10:24.342051 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:24.342621 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m12:10:24.344845 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:10:24.345381 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m12:10:24.346376 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m12:10:24.346061 [info ] [Thread-1 (]: 4 of 5 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m12:10:24.359811 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m12:10:24.360063 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m12:10:24.378689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m12:10:24.382186 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:24.384333 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:10:24.393243 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m12:10:24.393471 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m12:10:24.393680 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp121024366685"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
  
  
[0m12:10:24.395165 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:24.395442 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:10:24.395764 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:10:24.396147 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m12:10:24.396412 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m12:10:24.396645 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:24.399150 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:24.399398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:10:24.399587 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m12:10:24.399790 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp121024397700"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
  
  
[0m12:10:24.400058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:10:24.400235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:25.607145 [debug] [Thread-2 (]: SQL status: BEGIN in 1.207 seconds
[0m12:10:25.608190 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:25.609340 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m12:10:25.621882 [debug] [Thread-4 (]: SQL status: BEGIN in 1.222 seconds
[0m12:10:25.622500 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:10:25.622832 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      
  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields"
  
  
    as
  
  (
    

select 
	"ID"::int4 as id,
  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,
  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,
  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
  
  
[0m12:10:25.662167 [debug] [Thread-1 (]: SQL status: SELECT 4 in 1.261 seconds
[0m12:10:25.663352 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.268 seconds
[0m12:10:25.683228 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:25.686462 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:25.687006 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m12:10:25.687461 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m12:10:25.783498 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.173 seconds
[0m12:10:25.789140 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:25.789528 [debug] [Thread-4 (]: SQL status: SELECT 74 in 0.166 seconds
[0m12:10:25.789946 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m12:10:25.803479 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m12:10:25.803837 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:10:25.804102 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m12:10:25.835824 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m12:10:25.836243 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:25.836517 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp121024366685'
        
      order by ordinal_position

  
[0m12:10:25.837840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m12:10:25.838089 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:25.838347 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp121024397700'
        
      order by ordinal_position

  
[0m12:10:25.953293 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m12:10:25.953865 [debug] [Thread-4 (]: SQL status: COMMIT in 0.149 seconds
[0m12:10:25.958846 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:25.961201 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m12:10:25.961719 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m12:10:25.965583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a038f0>]}
[0m12:10:25.966590 [info ] [Thread-4 (]: 3 of 5 OK created sql incremental model bitrix.btx_processed_deal_userfields ... [[32mSELECT 74[0m in 1.64s]
[0m12:10:25.967256 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m12:10:25.967702 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m12:10:25.968448 [info ] [Thread-4 (]: 5 of 5 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m12:10:25.969080 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_product)
[0m12:10:25.969481 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m12:10:25.972895 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m12:10:25.974309 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m12:10:25.977769 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:25.978208 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp121025976204"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
  
  
[0m12:10:25.978599 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:10:26.019547 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.181 seconds
[0m12:10:26.025501 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:26.025949 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.189 seconds
[0m12:10:26.026439 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:26.029549 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:26.030180 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:26.110323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m12:10:26.115612 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m12:10:26.116103 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:26.116434 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m12:10:26.184932 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.154 seconds
[0m12:10:26.185603 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.156 seconds
[0m12:10:26.195687 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:26.201007 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:26.201449 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:26.201834 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:26.265420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.148 seconds
[0m12:10:26.274301 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m12:10:26.280016 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:10:26.280601 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m12:10:26.353704 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.151 seconds
[0m12:10:26.363220 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.161 seconds
[0m12:10:26.376940 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:26.378990 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:26.380489 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:26.380907 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:26.381261 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp121024397700" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp121024397700"
    )
  
[0m12:10:26.381658 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp121024366685" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp121024366685"
    )
  
[0m12:10:26.437338 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.156 seconds
[0m12:10:26.439460 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m12:10:26.440549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e83470>]}
[0m12:10:26.441445 [info ] [Thread-2 (]: 1 of 5 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.12s]
[0m12:10:26.442129 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m12:10:26.534630 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.152 seconds
[0m12:10:26.537386 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m12:10:26.538012 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:10:26.538529 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m12:10:26.578031 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.196 seconds
[0m12:10:26.580925 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m12:10:26.581563 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:10:26.582083 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m12:10:26.689793 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m12:10:26.694012 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m12:10:26.695526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4bdd0>]}
[0m12:10:26.696475 [info ] [Thread-3 (]: 2 of 5 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.37s]
[0m12:10:26.697183 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m12:10:26.732107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m12:10:26.734284 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m12:10:26.735880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e815b0>]}
[0m12:10:26.736733 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.36s]
[0m12:10:26.737421 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m12:10:27.213039 [debug] [Thread-4 (]: SQL status: SELECT 5 in 1.233 seconds
[0m12:10:27.224096 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:27.224885 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m12:10:27.377984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m12:10:27.380817 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:27.381678 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp121025976204'
        
      order by ordinal_position

  
[0m12:10:27.537080 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.154 seconds
[0m12:10:27.545496 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:27.546211 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:27.700816 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.153 seconds
[0m12:10:27.709430 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:27.710096 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:10:27.865506 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.154 seconds
[0m12:10:27.871894 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m12:10:27.873250 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:27.873755 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp121025976204" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp121025976204"
    )
  
[0m12:10:28.028981 [debug] [Thread-4 (]: SQL status: INSERT 0 5 in 0.154 seconds
[0m12:10:28.034834 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m12:10:28.036037 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:10:28.036584 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m12:10:28.188329 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m12:10:28.192442 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m12:10:28.195276 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '505a9a4c-f84c-424a-82b9-afda1e763da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2b440>]}
[0m12:10:28.197171 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.23s]
[0m12:10:28.198356 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m12:10:28.200606 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:28.201148 [debug] [MainThread]: On master: BEGIN
[0m12:10:28.201581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:29.393057 [debug] [MainThread]: SQL status: BEGIN in 1.191 seconds
[0m12:10:29.394126 [debug] [MainThread]: On master: COMMIT
[0m12:10:29.394639 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:29.395086 [debug] [MainThread]: On master: COMMIT
[0m12:10:29.541643 [debug] [MainThread]: SQL status: COMMIT in 0.146 seconds
[0m12:10:29.543773 [debug] [MainThread]: On master: Close
[0m12:10:29.546189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:29.547162 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m12:10:29.547710 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m12:10:29.548125 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m12:10:29.548521 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m12:10:29.549142 [info ] [MainThread]: 
[0m12:10:29.549671 [info ] [MainThread]: Finished running 4 incremental models, 1 view model in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m12:10:29.551285 [debug] [MainThread]: Command end result
[0m12:10:29.574910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m12:10:29.576437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m12:10:29.581474 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m12:10:29.581769 [info ] [MainThread]: 
[0m12:10:29.582048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:29.582270 [info ] [MainThread]: 
[0m12:10:29.582492 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:10:29.584587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.887336, "process_in_blocks": "0", "process_kernel_time": 0.250145, "process_mem_max_rss": "126599168", "process_out_blocks": "0", "process_user_time": 1.847417}
[0m12:10:29.585025 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:29.584901 after 10.89 seconds
[0m12:10:29.585374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ad1f0>]}
[0m12:10:29.585653 [debug] [MainThread]: Flushing usage events
[0m12:10:30.450839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:39.433116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c695b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac33110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac32d50>]}


============================== 12:34:39.436145 | 8b05db5a-b19e-4215-942c-bf21a3534f0f ==============================
[0m12:34:39.436145 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:34:39.436526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:39.532780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fbd10>]}
[0m12:34:39.560297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c3b00>]}
[0m12:34:39.561246 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:34:39.620600 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m12:34:39.681783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:39.682240 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m12:34:39.803757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba428d0>]}
[0m12:34:39.838577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m12:34:39.840934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m12:34:39.850885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba205c0>]}
[0m12:34:39.851207 [info ] [MainThread]: Found 6 models, 6 sources, 433 macros
[0m12:34:39.851390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9549e0>]}
[0m12:34:39.852476 [info ] [MainThread]: 
[0m12:34:39.852719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:39.852877 [info ] [MainThread]: 
[0m12:34:39.853243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:39.855171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m12:34:39.884907 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m12:34:39.885180 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m12:34:39.885355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:41.101622 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.216 seconds
[0m12:34:41.103081 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m12:34:41.104797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m12:34:41.109745 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m12:34:41.110047 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m12:34:41.110266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:42.340840 [debug] [ThreadPool]: SQL status: BEGIN in 1.230 seconds
[0m12:34:42.341252 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m12:34:42.341487 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m12:34:42.504313 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.162 seconds
[0m12:34:42.506579 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m12:34:42.662555 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m12:34:42.667267 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:42.667588 [debug] [MainThread]: On master: BEGIN
[0m12:34:42.667786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:43.913356 [debug] [MainThread]: SQL status: BEGIN in 1.245 seconds
[0m12:34:43.913769 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:43.914085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:34:44.075302 [debug] [MainThread]: SQL status: SELECT 1 in 0.161 seconds
[0m12:34:44.076746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde8080>]}
[0m12:34:44.077201 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:44.227724 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:44.228271 [debug] [MainThread]: On master: BEGIN
[0m12:34:44.539321 [debug] [MainThread]: SQL status: BEGIN in 0.311 seconds
[0m12:34:44.539759 [debug] [MainThread]: On master: COMMIT
[0m12:34:44.540003 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:44.540214 [debug] [MainThread]: On master: COMMIT
[0m12:34:44.693764 [debug] [MainThread]: SQL status: COMMIT in 0.153 seconds
[0m12:34:44.694219 [debug] [MainThread]: On master: Close
[0m12:34:44.697362 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m12:34:44.697695 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m12:34:44.697951 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m12:34:44.698201 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m12:34:44.698599 [info ] [Thread-1 (]: 1 of 6 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m12:34:44.698948 [info ] [Thread-2 (]: 2 of 6 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m12:34:44.699271 [info ] [Thread-3 (]: 3 of 6 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m12:34:44.699545 [info ] [Thread-4 (]: 4 of 6 START sql incremental model bitrix.btx_processed_deal_userfields ........ [RUN]
[0m12:34:44.699814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m12:34:44.700076 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m12:34:44.700326 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m12:34:44.700575 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m12:34:44.700775 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m12:34:44.700974 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m12:34:44.701168 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m12:34:44.701368 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m12:34:44.705902 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m12:34:44.707939 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m12:34:44.709322 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:44.710757 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:44.712060 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m12:34:44.712364 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m12:34:44.712584 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m12:34:44.712802 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m12:34:44.749733 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:44.754007 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m12:34:44.755747 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m12:34:44.757486 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:44.757693 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp123444729619"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
  
  
[0m12:34:44.758221 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

    
  
    

  create temporary table "btx_processed_deal_userfields__dbt_tmp123444756702"
  
  
    as
  
  (
    

select 
	"ID"::int4 as id,
  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,
  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,
  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
  
  
[0m12:34:44.758564 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:34:44.758899 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:34:44.759154 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m12:34:44.759408 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:44.759829 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m12:34:44.760017 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m12:34:44.760206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:44.760366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:34:45.995595 [debug] [Thread-1 (]: SQL status: BEGIN in 1.234 seconds
[0m12:34:45.997303 [debug] [Thread-2 (]: SQL status: BEGIN in 1.237 seconds
[0m12:34:45.999126 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m12:34:45.999870 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:46.002299 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m12:34:46.003580 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m12:34:46.055177 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.294 seconds
[0m12:34:46.056676 [debug] [Thread-4 (]: SQL status: SELECT 74 in 1.298 seconds
[0m12:34:46.074880 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.077422 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.077917 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m12:34:46.078409 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m12:34:46.154385 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m12:34:46.154946 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m12:34:46.179144 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.174 seconds
[0m12:34:46.185747 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:46.186134 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m12:34:46.226449 [debug] [Thread-3 (]: SQL status: BEGIN in 0.147 seconds
[0m12:34:46.226952 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.227336 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp123444729619'
        
      order by ordinal_position

  
[0m12:34:46.228223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m12:34:46.228530 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.228844 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields__dbt_tmp123444756702'
        
      order by ordinal_position

  
[0m12:34:46.309383 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m12:34:46.319945 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m12:34:46.322357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde11f0>]}
[0m12:34:46.323165 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.62s]
[0m12:34:46.323822 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m12:34:46.324261 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m12:34:46.324754 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m12:34:46.325280 [info ] [Thread-1 (]: 5 of 6 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m12:34:46.326481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m12:34:46.326881 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m12:34:46.329953 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:46.331253 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m12:34:46.336051 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:46.336425 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp123446334609"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
  
  
[0m12:34:46.336734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:46.337924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m12:34:46.340109 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:46.340405 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m12:34:46.404390 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.175 seconds
[0m12:34:46.404998 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.177 seconds
[0m12:34:46.412218 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.415104 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.415558 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:46.415945 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:46.490882 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m12:34:46.507730 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m12:34:46.508170 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:46.508463 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m12:34:46.573108 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.157 seconds
[0m12:34:46.573618 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.157 seconds
[0m12:34:46.582008 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.585130 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.585668 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:46.586078 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:46.658926 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m12:34:46.667175 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m12:34:46.672142 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m12:34:46.672577 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m12:34:46.735521 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.149 seconds
[0m12:34:46.742890 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.156 seconds
[0m12:34:46.751581 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.753323 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.754069 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.754429 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_userfields__dbt_tmp123444756702" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" ("id", "list", "sort", "xml_id", "multiple", "settings", "entity_id", "mandatory", "field_name", "show_filter", "edit_in_list", "show_in_list", "user_type_id", "is_searchable")
    (
        select "id", "list", "sort", "xml_id", "multiple", "settings", "entity_id", "mandatory", "field_name", "show_filter", "edit_in_list", "show_in_list", "user_type_id", "is_searchable"
        from "btx_processed_deal_userfields__dbt_tmp123444756702"
    )
  
[0m12:34:46.755299 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.755703 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp123444729619" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp123444729619"
    )
  
[0m12:34:46.827024 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.154 seconds
[0m12:34:46.829564 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m12:34:46.830322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003a70>]}
[0m12:34:46.830918 [info ] [Thread-2 (]: 2 of 6 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.13s]
[0m12:34:46.831439 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m12:34:46.831794 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m12:34:46.832259 [info ] [Thread-2 (]: 6 of 6 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m12:34:46.832666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_product)
[0m12:34:46.832992 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m12:34:46.835566 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m12:34:46.837225 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m12:34:46.840185 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:46.840542 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp123446838812"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
  
  
[0m12:34:46.840893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:34:46.910432 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.154 seconds
[0m12:34:46.912441 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m12:34:46.912877 [debug] [Thread-4 (]: SQL status: INSERT 0 74 in 0.158 seconds
[0m12:34:46.913253 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m12:34:46.914732 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m12:34:46.915126 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m12:34:46.915484 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m12:34:46.915871 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m12:34:47.065253 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m12:34:47.066738 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m12:34:47.069213 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m12:34:47.070323 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m12:34:47.071676 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde2930>]}
[0m12:34:47.072446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde3c50>]}
[0m12:34:47.073568 [info ] [Thread-4 (]: 4 of 6 OK created sql incremental model bitrix.btx_processed_deal_userfields ... [[32mINSERT 0 74[0m in 2.37s]
[0m12:34:47.074488 [info ] [Thread-3 (]: 3 of 6 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.37s]
[0m12:34:47.075290 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m12:34:47.075897 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m12:34:47.578823 [debug] [Thread-1 (]: SQL status: SELECT 4 in 1.241 seconds
[0m12:34:47.588380 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:47.589021 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m12:34:47.739419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m12:34:47.741858 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:47.742787 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp123446334609'
        
      order by ordinal_position

  
[0m12:34:47.905998 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.162 seconds
[0m12:34:47.914124 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:47.914868 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:48.071662 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.155 seconds
[0m12:34:48.078324 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:48.078990 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:48.087044 [debug] [Thread-2 (]: SQL status: SELECT 5 in 1.246 seconds
[0m12:34:48.090861 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.091467 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m12:34:48.236152 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.155 seconds
[0m12:34:48.241048 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:48.241657 [debug] [Thread-2 (]: SQL status: BEGIN in 0.150 seconds
[0m12:34:48.242319 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.242875 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp123446838812'
        
      order by ordinal_position

  
[0m12:34:48.243675 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:48.244176 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp123446334609" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp123446334609"
    )
  
[0m12:34:48.408117 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.164 seconds
[0m12:34:48.409791 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.165 seconds
[0m12:34:48.416747 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.419024 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m12:34:48.419552 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:48.420036 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m12:34:48.420580 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m12:34:48.580211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.158 seconds
[0m12:34:48.582858 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.162 seconds
[0m12:34:48.588308 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m12:34:48.593923 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.594808 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m12:34:48.595724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8cc950>]}
[0m12:34:48.596946 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.27s]
[0m12:34:48.597779 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m12:34:48.749889 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.153 seconds
[0m12:34:48.756599 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m12:34:48.758479 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.759052 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp123446838812" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp123446838812"
    )
  
[0m12:34:48.910895 [debug] [Thread-2 (]: SQL status: INSERT 0 5 in 0.151 seconds
[0m12:34:48.911985 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m12:34:48.912235 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m12:34:48.912423 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m12:34:49.096807 [debug] [Thread-2 (]: SQL status: COMMIT in 0.184 seconds
[0m12:34:49.097549 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m12:34:49.098118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b05db5a-b19e-4215-942c-bf21a3534f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e17c0>]}
[0m12:34:49.098590 [info ] [Thread-2 (]: 6 of 6 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.27s]
[0m12:34:49.099126 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m12:34:49.100223 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:49.100537 [debug] [MainThread]: On master: BEGIN
[0m12:34:49.100737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:50.335618 [debug] [MainThread]: SQL status: BEGIN in 1.235 seconds
[0m12:34:50.336045 [debug] [MainThread]: On master: COMMIT
[0m12:34:50.336270 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:50.336459 [debug] [MainThread]: On master: COMMIT
[0m12:34:50.485795 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m12:34:50.486156 [debug] [MainThread]: On master: Close
[0m12:34:50.486538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:50.486707 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m12:34:50.486856 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m12:34:50.486993 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m12:34:50.487126 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m12:34:50.487334 [info ] [MainThread]: 
[0m12:34:50.487518 [info ] [MainThread]: Finished running 4 incremental models, 2 view models in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m12:34:50.488171 [debug] [MainThread]: Command end result
[0m12:34:50.530858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m12:34:50.532227 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m12:34:50.535594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m12:34:50.535821 [info ] [MainThread]: 
[0m12:34:50.536031 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:34:50.536218 [info ] [MainThread]: 
[0m12:34:50.536418 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m12:34:50.536616 [info ] [MainThread]: 
[0m12:34:50.536782 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:34:50.538514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.140847, "process_in_blocks": "0", "process_kernel_time": 0.249058, "process_mem_max_rss": "129335296", "process_out_blocks": "0", "process_user_time": 1.513573}
[0m12:34:50.538749 [debug] [MainThread]: Command `dbt run` failed at 12:34:50.538710 after 11.14 seconds
[0m12:34:50.538934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b58da0>]}
[0m12:34:50.539115 [debug] [MainThread]: Flushing usage events
[0m12:34:51.284654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:28.303922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d33170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32de0>]}


============================== 14:12:28.306787 | ef5bdeff-8f80-4bc6-a912-2329b2add9a5 ==============================
[0m14:12:28.306787 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:12:28.307136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:28.401214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef5bdeff-8f80-4bc6-a912-2329b2add9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103834980>]}
[0m14:12:28.427068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef5bdeff-8f80-4bc6-a912-2329b2add9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fffa70>]}
[0m14:12:28.427740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:12:28.488770 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m14:12:28.547542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:12:28.547888 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m14:12:28.635094 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_processed_user' (models/bitrix/btx_processed_user.sql) depends on a source named 'bitrix.btx_raw_users' which was not found
[0m14:12:28.637042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.37084767, "process_in_blocks": "0", "process_kernel_time": 0.16293, "process_mem_max_rss": "110575616", "process_out_blocks": "0", "process_user_time": 0.923008}
[0m14:12:28.637334 [debug] [MainThread]: Command `dbt run` failed at 14:12:28.637282 after 0.37 seconds
[0m14:12:28.637573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ce120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad35f0>]}
[0m14:12:28.637786 [debug] [MainThread]: Flushing usage events
[0m14:12:29.465883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:14.823953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ccec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113637020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113636c60>]}


============================== 14:13:14.826915 | 458d4ff9-d4b3-4a71-8f49-97de5040f2c3 ==============================
[0m14:13:14.826915 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:13:14.827257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:14.904881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11422bb30>]}
[0m14:13:14.932059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113500080>]}
[0m14:13:14.933108 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:13:14.995788 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m14:13:15.050615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:13:15.050939 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m14:13:15.051310 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/sources.yml
[0m14:13:15.217534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc79b0>]}
[0m14:13:15.248224 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:13:15.250187 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:13:15.259695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e48560>]}
[0m14:13:15.259988 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m14:13:15.260169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141aec30>]}
[0m14:13:15.261024 [info ] [MainThread]: 
[0m14:13:15.261212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:15.261353 [info ] [MainThread]: 
[0m14:13:15.261590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:15.263529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m14:13:15.291115 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m14:13:15.291359 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m14:13:15.291520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:16.533079 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.241 seconds
[0m14:13:16.534814 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m14:13:16.536333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev_bitrix'
[0m14:13:16.541297 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m14:13:16.541621 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m14:13:16.541870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:17.764133 [debug] [ThreadPool]: SQL status: BEGIN in 1.222 seconds
[0m14:13:17.765847 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m14:13:17.766482 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m14:13:17.935250 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.167 seconds
[0m14:13:17.938045 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m14:13:18.087411 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m14:13:18.098132 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:18.098669 [debug] [MainThread]: On master: BEGIN
[0m14:13:18.099036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:19.316411 [debug] [MainThread]: SQL status: BEGIN in 1.217 seconds
[0m14:13:19.318821 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:19.320137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:19.482652 [debug] [MainThread]: SQL status: SELECT 1 in 0.161 seconds
[0m14:13:19.487994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e6270>]}
[0m14:13:19.489215 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:19.638774 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:19.639271 [debug] [MainThread]: On master: BEGIN
[0m14:13:19.940224 [debug] [MainThread]: SQL status: BEGIN in 0.300 seconds
[0m14:13:19.941162 [debug] [MainThread]: On master: COMMIT
[0m14:13:19.941671 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:19.942102 [debug] [MainThread]: On master: COMMIT
[0m14:13:20.090609 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m14:13:20.092429 [debug] [MainThread]: On master: Close
[0m14:13:20.099840 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m14:13:20.100455 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m14:13:20.100974 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m14:13:20.101652 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m14:13:20.102332 [info ] [Thread-2 (]: 2 of 7 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m14:13:20.102883 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m14:13:20.103392 [info ] [Thread-3 (]: 3 of 7 START sql incremental model bitrix.btx_processed_deal_stage ............. [RUN]
[0m14:13:20.103975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now model.bdt_transformations.btx_processed_activity)
[0m14:13:20.104421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_deal)
[0m14:13:20.104920 [info ] [Thread-4 (]: 4 of 7 START sql incremental model bitrix.btx_processed_deal_userfields ........ [RUN]
[0m14:13:20.105477 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m14:13:20.105883 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m14:13:20.106230 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m14:13:20.106628 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m14:13:20.106954 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m14:13:20.114941 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m14:13:20.118364 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m14:13:20.118770 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m14:13:20.121583 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:20.124651 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:20.125574 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m14:13:20.125998 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m14:13:20.143926 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m14:13:20.144181 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m14:13:20.150250 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m14:13:20.152300 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m14:13:20.176027 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:20.177196 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:20.177554 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

    
  
    

  create temporary table "btx_processed_deal_stage__dbt_tmp141320172084"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
  
  
[0m14:13:20.177825 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

    
  
    

  create temporary table "btx_processed_deal_userfields__dbt_tmp141320164833"
  
  
    as
  
  (
    

select 
	"ID"::int4 as id,
  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,
  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,
  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
  
  
[0m14:13:20.178089 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:20.178303 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:13:20.178517 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:20.178904 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m14:13:20.179087 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m14:13:20.179252 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m14:13:20.179407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:20.179563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:21.394083 [debug] [Thread-1 (]: SQL status: BEGIN in 1.214 seconds
[0m14:13:21.396626 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m14:13:21.397957 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m14:13:21.399015 [debug] [Thread-2 (]: SQL status: BEGIN in 1.219 seconds
[0m14:13:21.399614 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:21.400886 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m14:13:21.491968 [debug] [Thread-4 (]: SQL status: SELECT 74 in 1.314 seconds
[0m14:13:21.501874 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:21.502265 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m14:13:21.522219 [debug] [Thread-3 (]: SQL status: SELECT 11 in 1.344 seconds
[0m14:13:21.524506 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:21.524786 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m14:13:21.545951 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m14:13:21.546249 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m14:13:21.579752 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.177 seconds
[0m14:13:21.585464 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:21.585841 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m14:13:21.651178 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m14:13:21.651739 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:21.652170 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields__dbt_tmp141320164833'
        
      order by ordinal_position

  
[0m14:13:21.671113 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m14:13:21.671551 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:21.671956 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage__dbt_tmp141320172084'
        
      order by ordinal_position

  
[0m14:13:21.694754 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m14:13:21.707323 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m14:13:21.709882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c16b10>]}
[0m14:13:21.710746 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.60s]
[0m14:13:21.711374 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m14:13:21.711795 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m14:13:21.712366 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m14:13:21.712938 [info ] [Thread-1 (]: 5 of 7 START sql incremental model bitrix.btx_processed_dealcategory ........... [RUN]
[0m14:13:21.714175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m14:13:21.714556 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m14:13:21.717912 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:21.718826 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m14:13:21.723702 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:21.724085 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

    
  
    

  create temporary table "btx_processed_dealcategory__dbt_tmp141321720754"
  
  
    as
  
  (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
  
  
[0m14:13:21.724422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:21.737669 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m14:13:21.740381 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:21.740684 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m14:13:21.844211 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.191 seconds
[0m14:13:21.845584 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.173 seconds
[0m14:13:21.855849 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:21.859561 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:21.860108 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:21.860610 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:21.893401 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m14:13:21.911268 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m14:13:21.911796 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:21.912098 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m14:13:22.018169 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.157 seconds
[0m14:13:22.018950 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.158 seconds
[0m14:13:22.030384 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:22.033551 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:22.034019 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_stage'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:22.034466 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_deal_userfields'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:22.062143 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m14:13:22.069166 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m14:13:22.074241 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:13:22.074621 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m14:13:22.183862 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.148 seconds
[0m14:13:22.191611 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.157 seconds
[0m14:13:22.205437 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:22.207669 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:22.208741 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:22.209172 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_userfields__dbt_tmp141320164833" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" ("id", "list", "sort", "xml_id", "multiple", "settings", "entity_id", "mandatory", "field_name", "show_filter", "edit_in_list", "show_in_list", "user_type_id", "is_searchable")
    (
        select "id", "list", "sort", "xml_id", "multiple", "settings", "entity_id", "mandatory", "field_name", "show_filter", "edit_in_list", "show_in_list", "user_type_id", "is_searchable"
        from "btx_processed_deal_userfields__dbt_tmp141320164833"
    )
  
[0m14:13:22.209723 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:22.210090 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_deal_stage__dbt_tmp141320172084" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" ("id", "name", "sort", "status_id")
    (
        select "id", "name", "sort", "status_id"
        from "btx_processed_deal_stage__dbt_tmp141320172084"
    )
  
[0m14:13:22.240172 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.165 seconds
[0m14:13:22.242881 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m14:13:22.243858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069038f0>]}
[0m14:13:22.244611 [info ] [Thread-2 (]: 2 of 7 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.14s]
[0m14:13:22.245183 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m14:13:22.245604 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m14:13:22.246183 [info ] [Thread-2 (]: 6 of 7 START sql incremental model bitrix.btx_processed_product ................ [RUN]
[0m14:13:22.246634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_product)
[0m14:13:22.246972 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m14:13:22.249986 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m14:13:22.251103 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m14:13:22.254568 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:22.254933 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

    
  
    

  create temporary table "btx_processed_product__dbt_tmp141322253036"
  
  
    as
  
  (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
  
  
[0m14:13:22.255264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:22.366906 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.156 seconds
[0m14:13:22.371249 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m14:13:22.371922 [debug] [Thread-4 (]: SQL status: INSERT 0 74 in 0.162 seconds
[0m14:13:22.372574 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:13:22.374867 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m14:13:22.375310 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m14:13:22.375721 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:13:22.376221 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m14:13:22.527234 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m14:13:22.528896 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m14:13:22.531472 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m14:13:22.532996 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m14:13:22.534350 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115616d20>]}
[0m14:13:22.535085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151a87d0>]}
[0m14:13:22.536062 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model bitrix.btx_processed_deal_stage ........ [[32mINSERT 0 11[0m in 2.43s]
[0m14:13:22.536802 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model bitrix.btx_processed_deal_userfields ... [[32mINSERT 0 74[0m in 2.43s]
[0m14:13:22.537483 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m14:13:22.538052 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m14:13:22.538543 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m14:13:22.539345 [info ] [Thread-3 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m14:13:22.539962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_user)
[0m14:13:22.540426 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m14:13:22.544396 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m14:13:22.545436 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m14:13:22.616306 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m14:13:22.617139 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:13:22.617394 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m14:13:22.617568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:13:22.975298 [debug] [Thread-1 (]: SQL status: SELECT 4 in 1.251 seconds
[0m14:13:22.980627 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:22.981092 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m14:13:23.138302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m14:13:23.140241 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.141654 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory__dbt_tmp141321720754'
        
      order by ordinal_position

  
[0m14:13:23.297328 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.154 seconds
[0m14:13:23.305122 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.305801 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:23.461847 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.155 seconds
[0m14:13:23.469485 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.470325 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_dealcategory'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:23.513724 [debug] [Thread-2 (]: SQL status: SELECT 5 in 1.258 seconds
[0m14:13:23.520943 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:23.521544 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m14:13:23.623030 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.152 seconds
[0m14:13:23.629178 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.630697 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.631249 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_dealcategory__dbt_tmp141321720754" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" ("id", "name", "sort", "created_date")
    (
        select "id", "name", "sort", "created_date"
        from "btx_processed_dealcategory__dbt_tmp141321720754"
    )
  
[0m14:13:23.675342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.153 seconds
[0m14:13:23.677436 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:23.678208 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product__dbt_tmp141322253036'
        
      order by ordinal_position

  
[0m14:13:23.788957 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.156 seconds
[0m14:13:23.794361 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m14:13:23.794982 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:13:23.795394 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m14:13:23.834651 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.155 seconds
[0m14:13:23.842357 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:23.843094 [debug] [Thread-3 (]: SQL status: BEGIN in 1.225 seconds
[0m14:13:23.843668 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:23.844187 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:13:23.844813 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m14:13:23.944800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m14:13:23.946041 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m14:13:23.947046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149e9070>]}
[0m14:13:23.947790 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model bitrix.btx_processed_dealcategory ...... [[32mINSERT 0 4[0m in 2.23s]
[0m14:13:23.948386 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m14:13:23.998060 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.153 seconds
[0m14:13:24.003872 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:24.004409 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bendito_intelligence_dev".INFORMATION_SCHEMA.columns
      where table_name = 'btx_processed_product'
        
        and table_schema = 'bitrix'
        
      order by ordinal_position

  
[0m14:13:24.012280 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m14:13:24.015593 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:13:24.016042 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m14:13:24.158809 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.153 seconds
[0m14:13:24.164746 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m14:13:24.166320 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:24.166974 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

      
        
        
        delete from "bendito_intelligence_dev"."bitrix"."btx_processed_product" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "btx_processed_product__dbt_tmp141322253036" as DBT_INTERNAL_SOURCE
        );

    

    insert into "bendito_intelligence_dev"."bitrix"."btx_processed_product" ("id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id")
    (
        select "id", "name", "created_by", "date_create", "modified_by", "active", "catalog_id", "code", "currency_id", "description", "description_type", "detail_picture", "preview_picture", "measure", "price", "property_45", "section_id", "sort", "timestamp_x", "vat_id", "vat_included", "xml_id"
        from "btx_processed_product__dbt_tmp141322253036"
    )
  
[0m14:13:24.170238 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m14:13:24.172301 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m14:13:24.172751 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:13:24.173141 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m14:13:24.325303 [debug] [Thread-2 (]: SQL status: INSERT 0 5 in 0.157 seconds
[0m14:13:24.327126 [debug] [Thread-3 (]: SQL status: COMMIT in 0.153 seconds
[0m14:13:24.329816 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m14:13:24.333317 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m14:13:24.333898 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:13:24.334798 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:13:24.335213 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m14:13:24.335616 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m14:13:24.486114 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.149 seconds
[0m14:13:24.488337 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m14:13:24.492804 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m14:13:24.494608 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m14:13:24.495996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104617680>]}
[0m14:13:24.496750 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458d4ff9-d4b3-4a71-8f49-97de5040f2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11424da90>]}
[0m14:13:24.497680 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model bitrix.btx_processed_product ........... [[32mINSERT 0 5[0m in 2.25s]
[0m14:13:24.498585 [info ] [Thread-3 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 1.96s]
[0m14:13:24.499360 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m14:13:24.499953 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m14:13:24.501827 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:24.502239 [debug] [MainThread]: On master: BEGIN
[0m14:13:24.502591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:25.741783 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m14:13:25.744236 [debug] [MainThread]: On master: COMMIT
[0m14:13:25.745278 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:25.746206 [debug] [MainThread]: On master: COMMIT
[0m14:13:25.896003 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m14:13:25.897645 [debug] [MainThread]: On master: Close
[0m14:13:25.901516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:25.902446 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m14:13:25.902923 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m14:13:25.903669 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m14:13:25.904295 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m14:13:25.904965 [info ] [MainThread]: 
[0m14:13:25.905477 [info ] [MainThread]: Finished running 4 incremental models, 3 view models in 0 hours 0 minutes and 10.64 seconds (10.64s).
[0m14:13:25.907434 [debug] [MainThread]: Command end result
[0m14:13:25.932242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:13:25.933754 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:13:25.938499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:13:25.938757 [info ] [MainThread]: 
[0m14:13:25.939012 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:13:25.939230 [info ] [MainThread]: 
[0m14:13:25.939486 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m14:13:25.939696 [info ] [MainThread]: 
[0m14:13:25.939910 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:13:25.941934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.149397, "process_in_blocks": "0", "process_kernel_time": 0.240641, "process_mem_max_rss": "130646016", "process_out_blocks": "0", "process_user_time": 1.707412}
[0m14:13:25.942298 [debug] [MainThread]: Command `dbt run` failed at 14:13:25.942231 after 11.15 seconds
[0m14:13:25.942584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ccec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293a630>]}
[0m14:13:25.942845 [debug] [MainThread]: Flushing usage events
[0m14:13:26.683195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:39.089950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206e37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a32f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a32bd0>]}


============================== 14:33:39.092759 | 38dffc2e-3fcb-40db-9fda-5c15a04cbed2 ==============================
[0m14:33:39.092759 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:33:39.093115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:39.189679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ea72c0>]}
[0m14:33:39.217055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa96a0>]}
[0m14:33:39.217863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:33:39.277173 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m14:33:39.337366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m14:33:39.337764 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_product.sql
[0m14:33:39.337971 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_userfields.sql
[0m14:33:39.338159 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m14:33:39.338335 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m14:33:39.462340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232763c0>]}
[0m14:33:39.495716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:33:39.498026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:33:39.513370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234828d0>]}
[0m14:33:39.513768 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m14:33:39.513969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ea5f70>]}
[0m14:33:39.514985 [info ] [MainThread]: 
[0m14:33:39.515197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:33:39.515345 [info ] [MainThread]: 
[0m14:33:39.515629 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:39.517731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m14:33:39.547575 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m14:33:39.547848 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m14:33:39.548013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:40.806428 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.258 seconds
[0m14:33:40.807721 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m14:33:40.809089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m14:33:40.812896 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m14:33:40.813160 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m14:33:40.813349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:42.039129 [debug] [ThreadPool]: SQL status: BEGIN in 1.225 seconds
[0m14:33:42.041485 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m14:33:42.042530 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m14:33:42.204233 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.160 seconds
[0m14:33:42.209789 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m14:33:42.366690 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m14:33:42.377619 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:42.378199 [debug] [MainThread]: On master: BEGIN
[0m14:33:42.378564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:43.594453 [debug] [MainThread]: SQL status: BEGIN in 1.215 seconds
[0m14:33:43.596650 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:43.597475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:43.751068 [debug] [MainThread]: SQL status: SELECT 2 in 0.152 seconds
[0m14:33:43.756108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f80e90>]}
[0m14:33:43.757065 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:43.906548 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:43.908418 [debug] [MainThread]: On master: BEGIN
[0m14:33:44.204937 [debug] [MainThread]: SQL status: BEGIN in 0.295 seconds
[0m14:33:44.205809 [debug] [MainThread]: On master: COMMIT
[0m14:33:44.206143 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:44.206416 [debug] [MainThread]: On master: COMMIT
[0m14:33:44.354484 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m14:33:44.355296 [debug] [MainThread]: On master: Close
[0m14:33:44.360993 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m14:33:44.361538 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m14:33:44.362469 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m14:33:44.363075 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m14:33:44.363581 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m14:33:44.364153 [info ] [Thread-2 (]: 2 of 7 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m14:33:44.364726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m14:33:44.365219 [info ] [Thread-3 (]: 3 of 7 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m14:33:44.365778 [info ] [Thread-4 (]: 4 of 7 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m14:33:44.366339 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m14:33:44.366713 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m14:33:44.367157 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m14:33:44.367534 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m14:33:44.367834 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m14:33:44.375413 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m14:33:44.375872 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m14:33:44.376347 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m14:33:44.379788 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m14:33:44.382820 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:44.385278 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:44.385791 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m14:33:44.386336 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m14:33:44.392049 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m14:33:44.392331 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m14:33:44.411121 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m14:33:44.412991 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m14:33:44.414718 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:44.416315 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:44.417180 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:44.417433 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m14:33:44.417652 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:44.417970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:33:44.418309 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:44.418572 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m14:33:44.418920 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m14:33:44.419129 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m14:33:44.419313 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:33:44.419499 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m14:33:44.419676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:33:44.419948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:45.645812 [debug] [Thread-4 (]: SQL status: BEGIN in 1.227 seconds
[0m14:33:45.647671 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:45.648467 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
	
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m14:33:45.650045 [debug] [Thread-1 (]: SQL status: BEGIN in 1.230 seconds
[0m14:33:45.650955 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m14:33:45.651539 [debug] [Thread-3 (]: SQL status: BEGIN in 1.232 seconds
[0m14:33:45.652213 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m14:33:45.652870 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:45.653562 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m14:33:45.659030 [debug] [Thread-2 (]: SQL status: BEGIN in 1.239 seconds
[0m14:33:45.659560 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:45.660623 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m14:33:45.806126 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m14:33:45.806682 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m14:33:45.826852 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m14:33:45.832851 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:45.833236 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.179 seconds
[0m14:33:45.833623 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.183 seconds
[0m14:33:45.833957 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m14:33:45.836367 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:45.838464 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:45.838917 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m14:33:45.839259 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m14:33:45.955961 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m14:33:45.967417 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m14:33:45.969828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123814770>]}
[0m14:33:45.970714 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.60s]
[0m14:33:45.971393 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m14:33:45.971835 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m14:33:45.972362 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m14:33:45.972867 [info ] [Thread-1 (]: 5 of 7 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m14:33:45.974146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m14:33:45.975642 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m14:33:45.978727 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:45.981596 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m14:33:45.984734 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:45.987295 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:45.987639 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m14:33:45.987937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:45.988254 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m14:33:45.988554 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m14:33:45.989569 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m14:33:45.992945 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:45.998715 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:46.000874 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:46.001200 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m14:33:46.001532 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m14:33:46.001859 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m14:33:46.154761 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m14:33:46.155304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m14:33:46.155747 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m14:33:46.172200 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m14:33:46.173541 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m14:33:46.174768 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m14:33:46.175091 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:46.175372 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:46.175651 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:46.175908 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m14:33:46.176163 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m14:33:46.176412 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m14:33:46.328422 [debug] [Thread-2 (]: SQL status: COMMIT in 0.151 seconds
[0m14:33:46.340682 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m14:33:46.341244 [debug] [Thread-4 (]: SQL status: COMMIT in 0.164 seconds
[0m14:33:46.341637 [debug] [Thread-3 (]: SQL status: COMMIT in 0.165 seconds
[0m14:33:46.347304 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m14:33:46.349879 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m14:33:46.352480 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m14:33:46.353018 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m14:33:46.355934 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m14:33:46.356639 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m14:33:46.357167 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m14:33:46.357595 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m14:33:46.508077 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.150 seconds
[0m14:33:46.509857 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.152 seconds
[0m14:33:46.510587 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.153 seconds
[0m14:33:46.516547 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m14:33:46.518493 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m14:33:46.519986 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m14:33:46.521085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234956d0>]}
[0m14:33:46.521753 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12395c170>]}
[0m14:33:46.522308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b1e750>]}
[0m14:33:46.523144 [info ] [Thread-3 (]: 3 of 7 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.15s]
[0m14:33:46.523983 [info ] [Thread-2 (]: 2 of 7 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.16s]
[0m14:33:46.524626 [info ] [Thread-4 (]: 4 of 7 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.15s]
[0m14:33:46.525233 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m14:33:46.525725 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m14:33:46.526198 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m14:33:46.526617 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m14:33:46.526998 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m14:33:46.527661 [info ] [Thread-3 (]: 6 of 7 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m14:33:46.528161 [info ] [Thread-2 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m14:33:46.528612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m14:33:46.528999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m14:33:46.529362 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m14:33:46.529665 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m14:33:46.532690 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m14:33:46.535344 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m14:33:46.536320 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m14:33:46.539390 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m14:33:46.539792 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m14:33:46.542210 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m14:33:46.542647 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:46.542973 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m14:33:46.543260 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:46.543554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:33:46.543832 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m14:33:46.544207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:33:47.249597 [debug] [Thread-1 (]: SQL status: BEGIN in 1.261 seconds
[0m14:33:47.251962 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:47.253214 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m14:33:47.419105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m14:33:47.428843 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:47.429454 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m14:33:47.583830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m14:33:47.593123 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:47.593788 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m14:33:47.744943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m14:33:47.753936 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m14:33:47.754560 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:47.755564 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m14:33:47.758529 [debug] [Thread-3 (]: SQL status: BEGIN in 1.214 seconds
[0m14:33:47.759164 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:47.759720 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m14:33:47.782734 [debug] [Thread-2 (]: SQL status: BEGIN in 1.239 seconds
[0m14:33:47.784449 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:47.785426 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m14:33:47.910509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m14:33:47.916718 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m14:33:47.917406 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m14:33:47.918754 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m14:33:47.922543 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:47.923061 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m14:33:47.923518 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m14:33:48.024489 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.238 seconds
[0m14:33:48.034061 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:48.034708 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m14:33:48.085769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.161 seconds
[0m14:33:48.091658 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m14:33:48.093156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c13470>]}
[0m14:33:48.094131 [info ] [Thread-1 (]: 5 of 7 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.12s]
[0m14:33:48.094887 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m14:33:48.171967 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.248 seconds
[0m14:33:48.178804 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:48.179585 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m14:33:48.186385 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m14:33:48.190467 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:48.191019 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m14:33:48.328423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m14:33:48.333077 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m14:33:48.333875 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:48.334424 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m14:33:48.347081 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m14:33:48.350505 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m14:33:48.350918 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:48.351214 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m14:33:48.484370 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m14:33:48.490596 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m14:33:48.491951 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m14:33:48.492519 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m14:33:48.503170 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m14:33:48.505992 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m14:33:48.506837 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m14:33:48.507251 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m14:33:48.656774 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.163 seconds
[0m14:33:48.661295 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m14:33:48.662207 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.154 seconds
[0m14:33:48.664573 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m14:33:48.665405 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bf9160>]}
[0m14:33:48.666349 [info ] [Thread-3 (]: 6 of 7 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.14s]
[0m14:33:48.667007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dffc2e-3fcb-40db-9fda-5c15a04cbed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bf0650>]}
[0m14:33:48.667653 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m14:33:48.668423 [info ] [Thread-2 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.14s]
[0m14:33:48.669320 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m14:33:48.670983 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:48.671357 [debug] [MainThread]: On master: BEGIN
[0m14:33:48.671656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:49.940600 [debug] [MainThread]: SQL status: BEGIN in 1.268 seconds
[0m14:33:49.941976 [debug] [MainThread]: On master: COMMIT
[0m14:33:49.942645 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:49.943378 [debug] [MainThread]: On master: COMMIT
[0m14:33:50.094695 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m14:33:50.102346 [debug] [MainThread]: On master: Close
[0m14:33:50.103457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:50.103856 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m14:33:50.104227 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m14:33:50.104554 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m14:33:50.104862 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m14:33:50.105452 [info ] [MainThread]: 
[0m14:33:50.105935 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 10.59 seconds (10.59s).
[0m14:33:50.107054 [debug] [MainThread]: Command end result
[0m14:33:50.161923 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m14:33:50.163581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m14:33:50.167732 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m14:33:50.167961 [info ] [MainThread]: 
[0m14:33:50.168172 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:50.168338 [info ] [MainThread]: 
[0m14:33:50.168541 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m14:33:50.168706 [info ] [MainThread]: 
[0m14:33:50.168870 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:33:50.170572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.1153145, "process_in_blocks": "0", "process_kernel_time": 0.248769, "process_mem_max_rss": "128073728", "process_out_blocks": "0", "process_user_time": 1.550825}
[0m14:33:50.170809 [debug] [MainThread]: Command `dbt run` failed at 14:33:50.170766 after 11.12 seconds
[0m14:33:50.171017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105174050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208d6690>]}
[0m14:33:50.171217 [debug] [MainThread]: Flushing usage events
[0m14:33:51.077279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:28.202416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108556c60>]}


============================== 15:18:28.205371 | 2d13bcd8-c42a-42e6-9ade-6c82bda3aca4 ==============================
[0m15:18:28.205371 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:18:28.205727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:28.301422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334830>]}
[0m15:18:28.328806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d837a0>]}
[0m15:18:28.329587 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:28.389942 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m15:18:28.450315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:18:28.450784 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_userfields.sql
[0m15:18:28.451072 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m15:18:28.572612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f4440>]}
[0m15:18:28.605817 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:18:28.607846 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:18:28.618131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109042360>]}
[0m15:18:28.618428 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m15:18:28.618613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107817d10>]}
[0m15:18:28.619515 [info ] [MainThread]: 
[0m15:18:28.619710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:28.619857 [info ] [MainThread]: 
[0m15:18:28.620115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:28.622066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m15:18:28.651287 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m15:18:28.651552 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m15:18:28.651722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:29.940268 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.288 seconds
[0m15:18:29.942337 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m15:18:29.944043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m15:18:29.950166 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:18:29.950657 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m15:18:29.950906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:31.207760 [debug] [ThreadPool]: SQL status: BEGIN in 1.256 seconds
[0m15:18:31.209968 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:18:31.210971 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m15:18:31.527124 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.315 seconds
[0m15:18:31.532872 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m15:18:31.684617 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m15:18:31.696683 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:31.697270 [debug] [MainThread]: On master: BEGIN
[0m15:18:31.697651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:32.932920 [debug] [MainThread]: SQL status: BEGIN in 1.235 seconds
[0m15:18:32.934959 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.936146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:33.117824 [debug] [MainThread]: SQL status: SELECT 6 in 0.181 seconds
[0m15:18:33.125102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109246de0>]}
[0m15:18:33.126203 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:33.277215 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.279712 [debug] [MainThread]: On master: BEGIN
[0m15:18:33.580526 [debug] [MainThread]: SQL status: BEGIN in 0.299 seconds
[0m15:18:33.582813 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.583862 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.584433 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.737224 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m15:18:33.739327 [debug] [MainThread]: On master: Close
[0m15:18:33.747664 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m15:18:33.748487 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m15:18:33.749086 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:33.749501 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:33.750376 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m15:18:33.751163 [info ] [Thread-2 (]: 2 of 7 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m15:18:33.751869 [info ] [Thread-3 (]: 3 of 7 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m15:18:33.752455 [info ] [Thread-4 (]: 4 of 7 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m15:18:33.753088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m15:18:33.753675 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m15:18:33.754134 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m15:18:33.754563 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m15:18:33.754930 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m15:18:33.755276 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m15:18:33.755599 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:33.755926 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:33.763984 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m15:18:33.767364 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m15:18:33.769486 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:33.771772 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:33.773455 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:33.773918 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m15:18:33.774299 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m15:18:33.788308 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:33.797907 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:33.799871 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m15:18:33.801639 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m15:18:33.803350 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:33.804456 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:33.804705 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:33.804999 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m15:18:33.805282 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:18:33.805503 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m15:18:33.805712 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:33.805905 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:33.806093 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m15:18:33.806265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:33.806447 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m15:18:33.806700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:33.806957 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:35.083158 [debug] [Thread-1 (]: SQL status: BEGIN in 1.276 seconds
[0m15:18:35.083702 [debug] [Thread-2 (]: SQL status: BEGIN in 1.277 seconds
[0m15:18:35.084216 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:18:35.084615 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:35.085049 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m15:18:35.085939 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE')::varchar as title,
  ("CONTENT"->>'STAGE_ID')::varchar as stage_id,
  NULLIF("CONTENT"->>'CATEGORY_ID','')::int2 as category_id,
  NULLIF("CONTENT"->>'OPPORTUNITY','')::numeric as opportunity,
  NULLIF("CONTENT"->>'COMPANY_ID','')::int2 as company_id,
  NULLIF("CONTENT"->>'CONTACT_ID','')::int2 as contact_id,
  NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 as assigned_by_id,
  NULLIF("CONTENT"->>'CLOSED','[]')::bool as closed,
  NULLIF("CONTENT"->>'CLOSEDATE','')::timestamptz as close_date,
  NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz as date_create,
  NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz as date_modify,
  NULLIF("CONTENT"->>'BEGINDATE','')::timestamptz as begin_date,
  NULLIF("CONTENT"->>'MOVED_TIME','')::timestamptz::timestamptz as moved_time,
  NULLIF("CONTENT"->>'OPENED','[]')::bool as opened,
  NULLIF("CONTENT"->>'IS_NEW','[]')::bool as is_new,
  ("CONTENT"->>'LEAD_ID')::varchar as lead_id,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'COMMENTS')::text as comments,
  ("CONTENT"->>'QUOTE_ID')::varchar as quote_id,
  ("CONTENT"->>'ORIGIN_ID')::varchar as origin_id,
  ("CONTENT"->>'SOURCE_ID')::varchar as source_id,
  NULLIF("CONTENT"->>'TAX_VALUE','')::numeric as tax_value,
  ("CONTENT"->>'UTM_MEDIUM')::varchar as utm_medium,
  ("CONTENT"->>'UTM_SOURCE')::varchar as utm_source,
  ("CONTENT"->>'UTM_TERM')::varchar as utm_term,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'LOCATION_ID')::varchar as location_id,
  NULLIF("CONTENT"->>'MOVED_BY_ID','')::int2 as moved_by_id,
  ("CONTENT"->>'PROBABILITY')::varchar as probability,
  ("CONTENT"->>'UTM_CONTENT')::varchar as utm_content,
  ("CONTENT"->>'IS_RECURRING')::bool as is_recurring,
  NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN')::varchar as utm_campaign,
  NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION')::text as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO')::text as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID')::varchar as stage_semantic_id,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz as last_activity_time,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_BY','')::int2 as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID')::varchar as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY')::bool as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER')::bool as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH')::bool as is_repeated_approach,
  NULLIF("CONTENT"->>'UF_CRM_1718891707656','')::int2 as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318')::varchar as uf_crm_1718893063318,
  NULLIF("CONTENT"->>'UF_CRM_1718895613676','')::int2 as uf_crm_1718895613676,
  NULLIF("CONTENT"->>'UF_CRM_1718895632531','')::int2 as uf_crm_1718895632531,
  NULLIF("CONTENT"->>'UF_CRM_1718895837277','')::int2 as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494')::varchar as uf_crm_1719234554494,
  NULLIF("CONTENT"->>'UF_CRM_1719234611470','')::int2 as uf_crm_1719234611470,
  NULLIF("CONTENT"->>'UF_CRM_1719234653377','')::int2 as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133')::varchar as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735')::varchar as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227')::jsonb as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995')::jsonb as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652')::varchar as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628')::varchar as uf_crm_1720198502628,
  NULLIF("CONTENT"->>'UF_CRM_1721083795801','')::int2 as uf_crm_1721083795801,
  NULLIF("CONTENT"->>'UF_CRM_1721083820061','')::numeric as uf_crm_1721083820061,
  NULLIF("CONTENT"->>'UF_CRM_1721083836488','')::numeric as uf_crm_1721083836488,
  NULLIF("CONTENT"->>'UF_CRM_1721083849804','')::numeric as uf_crm_1721083849804,
  NULLIF("CONTENT"->>'UF_CRM_1721083861185','')::numeric as uf_crm_1721083861185,
  NULLIF("CONTENT"->>'UF_CRM_1721083874978','')::numeric as uf_crm_1721083874978,
  NULLIF("CONTENT"->>'UF_CRM_1721083894608','')::numeric as uf_crm_1721083894608,
  NULLIF("CONTENT"->>'UF_CRM_1721083906720','')::numeric as uf_crm_1721083906720,
  NULLIF("CONTENT"->>'UF_CRM_1721226126','[]')::bool as uf_crm_1721226126,
  nullif("CONTENT"->>'UF_CRM_1721227124','[]')::bool as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190')::varchar as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370')::varchar as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036')::varchar as uf_crm_1721243302036,
  NULLIF("CONTENT"->>'UF_CRM_1721243367','[]')::bool as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245')::text as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568')::text as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157')::text as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025')::text as uf_crm_1721244526025,
  NULLIF("CONTENT"->>'UF_CRM_1721244560622','')::timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT"->>'UF_CRM_1721244826264','')::int2 as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810')::text as uf_crm_1721244999810,
  NULLIF("CONTENT"->>'UF_CRM_1721248388070','')::int2 as uf_crm_1721248388070,
  NULLIF("CONTENT"->>'UF_CRM_1721248408791','')::varchar as uf_crm_1721248408791,
  NULLIF("CONTENT"->>'UF_CRM_1721406278811','')::timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT"->>'UF_CRM_1724261215','')::numeric as uf_crm_1724261215,
  NULLIF("CONTENT"->>'UF_CRM_1724264534445','')::numeric as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266')::varchar as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322')::varchar as uf_crm_1725574322,
  NULLIF(BTRIM("CONTENT"->>'UF_CRM_1725548469220','[]'),'')::timestamptz as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164')::text as uf_crm_1726002322164,
  NULLIF("CONTENT"->>'UF_CRM_1726003734','')::int2 as uf_crm_1726003734,
  NULLIF("CONTENT"->>'UF_CRM_1726007497','')::numeric as uf_crm_1726007497,
  NULLIF("CONTENT"->>'UF_CRM_1728416073106','')::numeric as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554')::text as uf_crm_1729086829554,
  NULLIF("CONTENT"->>'UF_CRM_1729086887055','')::timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT"->>'UF_CRM_1732567021643','')::int2 as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374')::text as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514')::varchar as uf_crm_1733491265514,
  NULLIF("CONTENT"->>'UF_CRM_1738931838','')::int2 as uf_crm_1738931838,
  NULLIF("CONTENT"->>'UF_CRM_1741275511723','')::int2 as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502')::varchar as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050')::text as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428')::varchar as uf_crm_1741275610428,
  NULLIF("CONTENT"->>'UF_CRM_1741275634394','')::numeric as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620')::text as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20')::text as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD')::text as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F')::text as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC')::text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1719236124580','')::jsonb  as uf_crm_deal_1719236124580,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540405848','')::int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540759541','')::jsonb as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488')::text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725569886689','[]')::jsonb as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411')::varchar as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239')::varchar as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103')::text as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944')::varchar as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827')::text as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832')::varchar as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m15:18:35.086827 [debug] [Thread-3 (]: SQL status: BEGIN in 1.280 seconds
[0m15:18:35.087322 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:35.087701 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m15:18:35.088285 [debug] [Thread-4 (]: SQL status: BEGIN in 1.282 seconds
[0m15:18:35.088624 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:35.089015 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m15:18:35.248596 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m15:18:35.250401 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m15:18:35.311744 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.223 seconds
[0m15:18:35.319929 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.233 seconds
[0m15:18:35.331017 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.241 seconds
[0m15:18:35.336562 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:35.338040 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:35.340042 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:35.340367 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m15:18:35.340575 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m15:18:35.340779 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m15:18:35.404285 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m15:18:35.410734 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:18:35.411971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cc9e0>]}
[0m15:18:35.412391 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.66s]
[0m15:18:35.412908 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m15:18:35.413137 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m15:18:35.413414 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m15:18:35.413729 [info ] [Thread-1 (]: 5 of 7 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m15:18:35.414412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m15:18:35.414634 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m15:18:35.416328 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:35.416769 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m15:18:35.418380 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:35.418733 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:35.418907 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m15:18:35.419063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:35.496014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m15:18:35.498132 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:35.498372 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m15:18:35.498628 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m15:18:35.498822 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m15:18:35.501232 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:35.502860 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:35.503146 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m15:18:35.503376 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m15:18:35.656870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m15:18:35.657371 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m15:18:35.657761 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m15:18:35.674239 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:18:35.675996 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:18:35.677285 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:18:35.677608 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:35.677937 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:35.678270 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:35.678560 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:18:35.678851 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:18:35.679128 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:18:35.832258 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m15:18:35.841612 [debug] [Thread-4 (]: SQL status: COMMIT in 0.162 seconds
[0m15:18:35.846100 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m15:18:35.846591 [debug] [Thread-3 (]: SQL status: COMMIT in 0.167 seconds
[0m15:18:35.849209 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m15:18:35.854341 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:35.856337 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m15:18:35.857030 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:35.857372 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m15:18:35.858001 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:35.858322 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m15:18:35.858742 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m15:18:36.020859 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.161 seconds
[0m15:18:36.022361 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.163 seconds
[0m15:18:36.023445 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.164 seconds
[0m15:18:36.028707 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m15:18:36.030645 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m15:18:36.032150 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m15:18:36.033259 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630f800>]}
[0m15:18:36.033885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109806060>]}
[0m15:18:36.034386 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f6240>]}
[0m15:18:36.035197 [info ] [Thread-4 (]: 4 of 7 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.28s]
[0m15:18:36.035907 [info ] [Thread-2 (]: 2 of 7 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.28s]
[0m15:18:36.036553 [info ] [Thread-3 (]: 3 of 7 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.28s]
[0m15:18:36.037218 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:36.037700 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m15:18:36.038166 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:36.038577 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m15:18:36.039080 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m15:18:36.039669 [info ] [Thread-4 (]: 6 of 7 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m15:18:36.040152 [info ] [Thread-2 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m15:18:36.040591 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_product)
[0m15:18:36.040968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m15:18:36.041340 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m15:18:36.041671 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m15:18:36.044865 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m15:18:36.047488 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m15:18:36.050307 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m15:18:36.050665 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m15:18:36.053937 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m15:18:36.056743 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m15:18:36.057493 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:36.057828 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m15:18:36.058124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:36.058518 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:36.058756 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m15:18:36.058975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:18:36.641746 [debug] [Thread-1 (]: SQL status: BEGIN in 1.222 seconds
[0m15:18:36.644192 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:36.645055 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m15:18:36.803198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m15:18:36.811355 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:36.812097 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m15:18:36.971328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m15:18:36.980872 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:36.981609 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m15:18:37.136786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m15:18:37.141087 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:18:37.141745 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:37.142260 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:18:37.289608 [debug] [Thread-4 (]: SQL status: BEGIN in 1.230 seconds
[0m15:18:37.292046 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:37.293356 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m15:18:37.298798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.156 seconds
[0m15:18:37.302123 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m15:18:37.303076 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:18:37.303517 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m15:18:37.326995 [debug] [Thread-2 (]: SQL status: BEGIN in 1.269 seconds
[0m15:18:37.327495 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:37.328101 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m15:18:37.453355 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m15:18:37.463886 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:37.464564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.161 seconds
[0m15:18:37.465291 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m15:18:37.467440 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m15:18:37.468599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988d910>]}
[0m15:18:37.469451 [info ] [Thread-1 (]: 5 of 7 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.05s]
[0m15:18:37.470151 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m15:18:37.483269 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.155 seconds
[0m15:18:37.487005 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:37.487449 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m15:18:37.617443 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:18:37.623944 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:37.624540 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m15:18:37.634313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.146 seconds
[0m15:18:37.638145 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:37.638680 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m15:18:37.779000 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m15:18:37.784595 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:18:37.785329 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:37.785862 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:18:37.786370 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m15:18:37.788514 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:18:37.788953 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:37.789346 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:18:37.937716 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m15:18:37.939364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.149 seconds
[0m15:18:37.944898 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m15:18:37.948149 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m15:18:37.949131 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:18:37.949968 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:18:37.950416 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m15:18:37.950846 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m15:18:38.180997 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.229 seconds
[0m15:18:38.185162 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m15:18:38.185810 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.234 seconds
[0m15:18:38.188129 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m15:18:38.188956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dc1a0>]}
[0m15:18:38.190026 [info ] [Thread-2 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.15s]
[0m15:18:38.190792 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d13bcd8-c42a-42e6-9ade-6c82bda3aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c7d10>]}
[0m15:18:38.191418 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m15:18:38.192105 [info ] [Thread-4 (]: 6 of 7 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.15s]
[0m15:18:38.192940 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m15:18:38.194577 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.194969 [debug] [MainThread]: On master: BEGIN
[0m15:18:38.195311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:39.410503 [debug] [MainThread]: SQL status: BEGIN in 1.215 seconds
[0m15:18:39.412817 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.413849 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.415031 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.566514 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m15:18:39.568632 [debug] [MainThread]: On master: Close
[0m15:18:39.570701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:39.571273 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m15:18:39.571759 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m15:18:39.572332 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m15:18:39.573309 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m15:18:39.574066 [info ] [MainThread]: 
[0m15:18:39.574644 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m15:18:39.576728 [debug] [MainThread]: Command end result
[0m15:18:39.657507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:18:39.658444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:18:39.661830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m15:18:39.662031 [info ] [MainThread]: 
[0m15:18:39.662224 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:39.662382 [info ] [MainThread]: 
[0m15:18:39.662562 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:18:39.662716 [info ] [MainThread]: 
[0m15:18:39.662874 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:18:39.664425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.497052, "process_in_blocks": "0", "process_kernel_time": 0.252454, "process_mem_max_rss": "128909312", "process_out_blocks": "0", "process_user_time": 1.631223}
[0m15:18:39.664652 [debug] [MainThread]: Command `dbt run` failed at 15:18:39.664611 after 11.50 seconds
[0m15:18:39.664847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041badb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644bb00>]}
[0m15:18:39.665025 [debug] [MainThread]: Flushing usage events
[0m15:18:40.838564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:53.545423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112436cf0>]}


============================== 15:18:53.548698 | 0af53949-73d1-49cc-bc59-2cfc03f0bc81 ==============================
[0m15:18:53.548698 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:18:53.549061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m15:18:53.636288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425adb0>]}
[0m15:18:53.664540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee2570>]}
[0m15:18:53.665348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:53.724601 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m15:18:53.783186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:53.783496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:53.799846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e3440>]}
[0m15:18:53.834499 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:18:53.836619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:18:53.846614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112967f20>]}
[0m15:18:53.847011 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m15:18:53.847240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112904290>]}
[0m15:18:53.848268 [info ] [MainThread]: 
[0m15:18:53.848478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:53.848636 [info ] [MainThread]: 
[0m15:18:53.848913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:53.850898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m15:18:53.877582 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m15:18:53.877835 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m15:18:53.878003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:55.105247 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.227 seconds
[0m15:18:55.106495 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m15:18:55.107577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m15:18:55.110939 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:18:55.111153 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m15:18:55.111323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:56.344613 [debug] [ThreadPool]: SQL status: BEGIN in 1.233 seconds
[0m15:18:56.344957 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:18:56.345171 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m15:18:56.500427 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.155 seconds
[0m15:18:56.501863 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m15:18:56.652331 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m15:18:56.657181 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:56.657533 [debug] [MainThread]: On master: BEGIN
[0m15:18:56.657752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:57.872236 [debug] [MainThread]: SQL status: BEGIN in 1.214 seconds
[0m15:18:57.874358 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:57.875404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:58.032308 [debug] [MainThread]: SQL status: SELECT 6 in 0.155 seconds
[0m15:18:58.040820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eecf20>]}
[0m15:18:58.041636 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:58.193436 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:58.195704 [debug] [MainThread]: On master: BEGIN
[0m15:18:58.503307 [debug] [MainThread]: SQL status: BEGIN in 0.306 seconds
[0m15:18:58.505674 [debug] [MainThread]: On master: COMMIT
[0m15:18:58.506719 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:58.507644 [debug] [MainThread]: On master: COMMIT
[0m15:18:58.673321 [debug] [MainThread]: SQL status: COMMIT in 0.164 seconds
[0m15:18:58.675466 [debug] [MainThread]: On master: Close
[0m15:18:58.683064 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m15:18:58.683942 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m15:18:58.684459 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:58.684910 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:58.685573 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m15:18:58.686338 [info ] [Thread-2 (]: 2 of 7 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m15:18:58.687077 [info ] [Thread-3 (]: 3 of 7 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m15:18:58.687680 [info ] [Thread-4 (]: 4 of 7 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m15:18:58.688279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m15:18:58.688873 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m15:18:58.689423 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m15:18:58.689963 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m15:18:58.690371 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m15:18:58.690723 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m15:18:58.691058 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:58.691397 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:58.699279 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m15:18:58.704466 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m15:18:58.706598 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:58.708685 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:58.710603 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m15:18:58.711064 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m15:18:58.711363 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m15:18:58.711636 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m15:18:58.733710 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:58.735641 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m15:18:58.737498 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m15:18:58.739238 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:58.739901 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:58.740252 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:18:58.740602 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m15:18:58.740837 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:58.741055 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m15:18:58.741262 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:58.741449 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m15:18:58.741651 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:58.741833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:58.742105 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:58.742285 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m15:18:58.742600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:59.989858 [debug] [Thread-1 (]: SQL status: BEGIN in 1.248 seconds
[0m15:18:59.990324 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:18:59.990670 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m15:18:59.991084 [debug] [Thread-2 (]: SQL status: BEGIN in 1.248 seconds
[0m15:18:59.991498 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:18:59.992218 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE')::varchar as title,
  ("CONTENT"->>'STAGE_ID')::varchar as stage_id,
  NULLIF("CONTENT"->>'CATEGORY_ID','')::int2 as category_id,
  NULLIF("CONTENT"->>'OPPORTUNITY','')::numeric as opportunity,
  NULLIF("CONTENT"->>'COMPANY_ID','')::int2 as company_id,
  NULLIF("CONTENT"->>'CONTACT_ID','')::int2 as contact_id,
  NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 as assigned_by_id,
  NULLIF("CONTENT"->>'CLOSED','[]')::bool as closed,
  NULLIF("CONTENT"->>'CLOSEDATE','')::timestamptz as close_date,
  NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz as date_create,
  NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz as date_modify,
  NULLIF("CONTENT"->>'BEGINDATE','')::timestamptz as begin_date,
  NULLIF("CONTENT"->>'MOVED_TIME','')::timestamptz::timestamptz as moved_time,
  NULLIF("CONTENT"->>'OPENED','[]')::bool as opened,
  NULLIF("CONTENT"->>'IS_NEW','[]')::bool as is_new,
  ("CONTENT"->>'LEAD_ID')::varchar as lead_id,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'COMMENTS')::text as comments,
  ("CONTENT"->>'QUOTE_ID')::varchar as quote_id,
  ("CONTENT"->>'ORIGIN_ID')::varchar as origin_id,
  ("CONTENT"->>'SOURCE_ID')::varchar as source_id,
  NULLIF("CONTENT"->>'TAX_VALUE','')::numeric as tax_value,
  ("CONTENT"->>'UTM_MEDIUM')::varchar as utm_medium,
  ("CONTENT"->>'UTM_SOURCE')::varchar as utm_source,
  ("CONTENT"->>'UTM_TERM')::varchar as utm_term,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'LOCATION_ID')::varchar as location_id,
  NULLIF("CONTENT"->>'MOVED_BY_ID','')::int2 as moved_by_id,
  ("CONTENT"->>'PROBABILITY')::varchar as probability,
  ("CONTENT"->>'UTM_CONTENT')::varchar as utm_content,
  ("CONTENT"->>'IS_RECURRING')::bool as is_recurring,
  NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN')::varchar as utm_campaign,
  NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION')::text as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO')::text as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID')::varchar as stage_semantic_id,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz as last_activity_time,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_BY','')::int2 as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID')::varchar as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY')::bool as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER')::bool as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH')::bool as is_repeated_approach,
  NULLIF("CONTENT"->>'UF_CRM_1718891707656','')::int2 as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318')::varchar as uf_crm_1718893063318,
  NULLIF("CONTENT"->>'UF_CRM_1718895613676','')::int2 as uf_crm_1718895613676,
  NULLIF("CONTENT"->>'UF_CRM_1718895632531','')::int2 as uf_crm_1718895632531,
  NULLIF("CONTENT"->>'UF_CRM_1718895837277','')::int2 as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494')::varchar as uf_crm_1719234554494,
  NULLIF("CONTENT"->>'UF_CRM_1719234611470','')::int2 as uf_crm_1719234611470,
  NULLIF("CONTENT"->>'UF_CRM_1719234653377','')::int2 as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133')::varchar as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735')::varchar as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227')::jsonb as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995')::jsonb as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652')::varchar as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628')::varchar as uf_crm_1720198502628,
  NULLIF("CONTENT"->>'UF_CRM_1721083795801','')::int2 as uf_crm_1721083795801,
  NULLIF("CONTENT"->>'UF_CRM_1721083820061','')::numeric as uf_crm_1721083820061,
  NULLIF("CONTENT"->>'UF_CRM_1721083836488','')::numeric as uf_crm_1721083836488,
  NULLIF("CONTENT"->>'UF_CRM_1721083849804','')::numeric as uf_crm_1721083849804,
  NULLIF("CONTENT"->>'UF_CRM_1721083861185','')::numeric as uf_crm_1721083861185,
  NULLIF("CONTENT"->>'UF_CRM_1721083874978','')::numeric as uf_crm_1721083874978,
  NULLIF("CONTENT"->>'UF_CRM_1721083894608','')::numeric as uf_crm_1721083894608,
  NULLIF("CONTENT"->>'UF_CRM_1721083906720','')::numeric as uf_crm_1721083906720,
  NULLIF("CONTENT"->>'UF_CRM_1721226126','[]')::bool as uf_crm_1721226126,
  nullif("CONTENT"->>'UF_CRM_1721227124','[]')::bool as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190')::varchar as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370')::varchar as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036')::varchar as uf_crm_1721243302036,
  NULLIF("CONTENT"->>'UF_CRM_1721243367','[]')::bool as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245')::text as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568')::text as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157')::text as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025')::text as uf_crm_1721244526025,
  NULLIF("CONTENT"->>'UF_CRM_1721244560622','')::timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT"->>'UF_CRM_1721244826264','')::int2 as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810')::text as uf_crm_1721244999810,
  NULLIF("CONTENT"->>'UF_CRM_1721248388070','')::int2 as uf_crm_1721248388070,
  NULLIF("CONTENT"->>'UF_CRM_1721248408791','')::varchar as uf_crm_1721248408791,
  NULLIF("CONTENT"->>'UF_CRM_1721406278811','')::timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT"->>'UF_CRM_1724261215','')::numeric as uf_crm_1724261215,
  NULLIF("CONTENT"->>'UF_CRM_1724264534445','')::numeric as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266')::varchar as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322')::varchar as uf_crm_1725574322,
  NULLIF(BTRIM("CONTENT"->>'UF_CRM_1725548469220','[]'),'')::timestamptz as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164')::text as uf_crm_1726002322164,
  NULLIF("CONTENT"->>'UF_CRM_1726003734','')::int2 as uf_crm_1726003734,
  NULLIF("CONTENT"->>'UF_CRM_1726007497','')::numeric as uf_crm_1726007497,
  NULLIF("CONTENT"->>'UF_CRM_1728416073106','')::numeric as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554')::text as uf_crm_1729086829554,
  NULLIF("CONTENT"->>'UF_CRM_1729086887055','')::timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT"->>'UF_CRM_1732567021643','')::int2 as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374')::text as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514')::varchar as uf_crm_1733491265514,
  NULLIF("CONTENT"->>'UF_CRM_1738931838','')::int2 as uf_crm_1738931838,
  NULLIF("CONTENT"->>'UF_CRM_1741275511723','')::int2 as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502')::varchar as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050')::text as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428')::varchar as uf_crm_1741275610428,
  NULLIF("CONTENT"->>'UF_CRM_1741275634394','')::numeric as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620')::text as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20')::text as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD')::text as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F')::text as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC')::text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1719236124580','')::jsonb  as uf_crm_deal_1719236124580,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540405848','')::int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540759541','')::jsonb as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488')::text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725569886689','[]')::jsonb as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411')::varchar as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239')::varchar as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103')::text as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944')::varchar as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827')::text as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832')::varchar as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m15:18:59.992969 [debug] [Thread-4 (]: SQL status: BEGIN in 1.252 seconds
[0m15:18:59.993239 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:18:59.993569 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m15:18:59.997469 [debug] [Thread-3 (]: SQL status: BEGIN in 1.255 seconds
[0m15:18:59.997845 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:18:59.998131 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m15:19:00.145022 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m15:19:00.146017 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m15:19:00.154442 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.156 seconds
[0m15:19:00.164090 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:19:00.164648 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.172 seconds
[0m15:19:00.165214 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m15:19:00.168917 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:19:00.169422 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m15:19:00.174823 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.181 seconds
[0m15:19:00.177848 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:19:00.178226 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m15:19:00.298005 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m15:19:00.315170 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:19:00.317588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m15:19:00.318155 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m15:19:00.323163 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:19:00.325750 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:19:00.326186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ecc50>]}
[0m15:19:00.326527 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m15:19:00.326888 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m15:19:00.327616 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.63s]
[0m15:19:00.328339 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m15:19:00.328669 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m15:19:00.328996 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m15:19:00.329368 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m15:19:00.331554 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:19:00.331948 [info ] [Thread-1 (]: 5 of 7 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m15:19:00.332863 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m15:19:00.333207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m15:19:00.333540 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m15:19:00.335844 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:00.336412 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m15:19:00.338765 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:00.339238 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:00.339488 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m15:19:00.339716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:00.476256 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m15:19:00.477764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m15:19:00.485081 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m15:19:00.498861 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:19:00.500517 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:19:00.502027 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:19:00.502423 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:19:00.502749 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:19:00.503049 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:19:00.503326 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:19:00.503575 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:19:00.503821 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:19:00.652199 [debug] [Thread-4 (]: SQL status: COMMIT in 0.147 seconds
[0m15:19:00.653611 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m15:19:00.654266 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m15:19:00.664423 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m15:19:00.667206 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m15:19:00.669298 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m15:19:00.674255 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:19:00.674949 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:19:00.675587 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:19:00.675932 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m15:19:00.676298 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m15:19:00.676610 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m15:19:00.828784 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m15:19:00.830352 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m15:19:00.831168 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.154 seconds
[0m15:19:00.835339 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m15:19:00.837624 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m15:19:00.839358 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m15:19:00.840178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d57320>]}
[0m15:19:00.840952 [info ] [Thread-3 (]: 3 of 7 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.15s]
[0m15:19:00.841562 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cd4b00>]}
[0m15:19:00.842023 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m15:19:00.842228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cd4770>]}
[0m15:19:00.842642 [info ] [Thread-4 (]: 4 of 7 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.15s]
[0m15:19:00.842930 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m15:19:00.843336 [info ] [Thread-2 (]: 2 of 7 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.15s]
[0m15:19:00.843727 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:19:00.844009 [info ] [Thread-3 (]: 6 of 7 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m15:19:00.844313 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m15:19:00.844620 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_user
[0m15:19:00.844979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m15:19:00.845386 [info ] [Thread-4 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m15:19:00.845640 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m15:19:00.845861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m15:19:00.848626 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m15:19:00.849089 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m15:19:00.851859 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m15:19:00.852463 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m15:19:00.856654 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m15:19:00.857138 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m15:19:00.859193 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m15:19:00.859599 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:00.859951 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m15:19:00.860190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:19:00.860443 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:00.860819 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m15:19:00.861066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:19:01.562426 [debug] [Thread-1 (]: SQL status: BEGIN in 1.222 seconds
[0m15:19:01.565198 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:01.566260 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m15:19:01.727274 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m15:19:01.735906 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:01.736615 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m15:19:01.885133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m15:19:01.890951 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:01.891720 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m15:19:02.039383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m15:19:02.044699 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:19:02.045360 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:02.045863 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:19:02.389856 [debug] [Thread-4 (]: SQL status: BEGIN in 1.528 seconds
[0m15:19:02.391610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.345 seconds
[0m15:19:02.392997 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:02.397707 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m15:19:02.398598 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m15:19:02.399713 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:19:02.400365 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m15:19:02.550378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.149 seconds
[0m15:19:02.554967 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m15:19:02.556209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ce7320>]}
[0m15:19:02.557204 [info ] [Thread-1 (]: 5 of 7 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.22s]
[0m15:19:02.558024 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m15:19:02.558732 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m15:19:02.562801 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:02.563287 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m15:19:02.572102 [debug] [Thread-3 (]: SQL status: BEGIN in 1.712 seconds
[0m15:19:02.572517 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:02.573003 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m15:19:02.713642 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:19:02.719916 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:02.720483 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m15:19:02.735860 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m15:19:02.739935 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:02.740438 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m15:19:02.878703 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m15:19:02.885454 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:19:02.886097 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:02.886521 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:19:02.892878 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:19:02.897250 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:02.897757 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m15:19:03.039700 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m15:19:03.046943 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m15:19:03.047991 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:19:03.048412 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m15:19:03.061085 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.163 seconds
[0m15:19:03.063003 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:19:03.063436 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:03.063819 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:19:03.201538 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m15:19:03.207029 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: Close
[0m15:19:03.208284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114da9a30>]}
[0m15:19:03.209342 [info ] [Thread-4 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.36s]
[0m15:19:03.210151 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m15:19:03.220382 [debug] [Thread-3 (]: SQL status: COMMIT in 0.156 seconds
[0m15:19:03.223656 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m15:19:03.224562 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:19:03.224996 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m15:19:03.379588 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m15:19:03.385251 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m15:19:03.386886 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af53949-73d1-49cc-bc59-2cfc03f0bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159ce540>]}
[0m15:19:03.388021 [info ] [Thread-3 (]: 6 of 7 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.54s]
[0m15:19:03.388742 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m15:19:03.390565 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:03.391025 [debug] [MainThread]: On master: BEGIN
[0m15:19:03.391380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:04.602899 [debug] [MainThread]: SQL status: BEGIN in 1.211 seconds
[0m15:19:04.605313 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.606093 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:04.606644 [debug] [MainThread]: On master: COMMIT
[0m15:19:04.756725 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m15:19:04.757684 [debug] [MainThread]: On master: Close
[0m15:19:04.758731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:04.759598 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m15:19:04.760105 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m15:19:04.760452 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m15:19:04.760770 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m15:19:04.761335 [info ] [MainThread]: 
[0m15:19:04.761793 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m15:19:04.763519 [debug] [MainThread]: Command end result
[0m15:19:04.787107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:19:04.788549 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:19:04.793146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m15:19:04.793417 [info ] [MainThread]: 
[0m15:19:04.793691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:19:04.793911 [info ] [MainThread]: 
[0m15:19:04.794183 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:19:04.794400 [info ] [MainThread]: 
[0m15:19:04.794626 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:19:04.796479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.286023, "process_in_blocks": "0", "process_kernel_time": 0.22169, "process_mem_max_rss": "124157952", "process_out_blocks": "0", "process_user_time": 1.424571}
[0m15:19:04.796803 [debug] [MainThread]: Command `dbt run` failed at 15:19:04.796745 after 11.29 seconds
[0m15:19:04.797080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c05f0>]}
[0m15:19:04.797399 [debug] [MainThread]: Flushing usage events
[0m15:19:05.536229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:36.869491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114236ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114236c60>]}


============================== 15:20:36.872987 | 2e7afe7b-7025-4834-a6a3-766dd69f5965 ==============================
[0m15:20:36.872987 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:20:36.873479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:36.973180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147bb6b0>]}
[0m15:20:37.001144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124282f0>]}
[0m15:20:37.001947 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:20:37.062911 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m15:20:37.124032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:37.124389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:37.140504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11508b980>]}
[0m15:20:37.175340 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:20:37.177204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:20:37.188048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115210560>]}
[0m15:20:37.188362 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m15:20:37.188544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e42e70>]}
[0m15:20:37.189508 [info ] [MainThread]: 
[0m15:20:37.189699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:20:37.189839 [info ] [MainThread]: 
[0m15:20:37.190099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:20:37.192332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m15:20:37.220766 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m15:20:37.221031 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m15:20:37.221192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:38.471503 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.250 seconds
[0m15:20:38.473713 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m15:20:38.475687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m15:20:38.481466 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:20:38.481804 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m15:20:38.482074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:39.712352 [debug] [ThreadPool]: SQL status: BEGIN in 1.229 seconds
[0m15:20:39.714640 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:20:39.715816 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m15:20:39.866721 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.150 seconds
[0m15:20:39.873220 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m15:20:40.022268 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m15:20:40.030461 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:40.030962 [debug] [MainThread]: On master: BEGIN
[0m15:20:40.031250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:41.236824 [debug] [MainThread]: SQL status: BEGIN in 1.205 seconds
[0m15:20:41.239316 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:41.240134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:20:41.396526 [debug] [MainThread]: SQL status: SELECT 6 in 0.156 seconds
[0m15:20:41.400019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114742690>]}
[0m15:20:41.400836 [debug] [MainThread]: On master: ROLLBACK
[0m15:20:41.550260 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:41.551092 [debug] [MainThread]: On master: BEGIN
[0m15:20:41.847900 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m15:20:41.848802 [debug] [MainThread]: On master: COMMIT
[0m15:20:41.849186 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:41.849508 [debug] [MainThread]: On master: COMMIT
[0m15:20:41.997283 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m15:20:41.998294 [debug] [MainThread]: On master: Close
[0m15:20:42.003342 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m15:20:42.004170 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m15:20:42.004772 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m15:20:42.005313 [info ] [Thread-2 (]: 2 of 7 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m15:20:42.005755 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m15:20:42.006422 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:20:42.007030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m15:20:42.007587 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m15:20:42.008062 [info ] [Thread-3 (]: 3 of 7 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m15:20:42.008502 [info ] [Thread-4 (]: 4 of 7 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m15:20:42.008852 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m15:20:42.009145 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m15:20:42.009542 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m15:20:42.009914 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m15:20:42.017244 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m15:20:42.022419 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m15:20:42.022824 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m15:20:42.023114 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m15:20:42.025659 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:42.027922 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:42.028246 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m15:20:42.028508 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m15:20:42.034098 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m15:20:42.051616 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m15:20:42.051939 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m15:20:42.053872 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m15:20:42.055620 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:42.057400 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:42.057822 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:20:42.058249 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m15:20:42.058464 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:42.058660 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:42.058863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:42.059067 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:42.059257 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m15:20:42.059466 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m15:20:42.059812 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m15:20:42.060003 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:20:42.060188 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:20:42.060361 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:20:43.288572 [debug] [Thread-1 (]: SQL status: BEGIN in 1.229 seconds
[0m15:20:43.290031 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:20:43.290700 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m15:20:43.327337 [debug] [Thread-4 (]: SQL status: BEGIN in 1.267 seconds
[0m15:20:43.328029 [debug] [Thread-2 (]: SQL status: BEGIN in 1.268 seconds
[0m15:20:43.328724 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:43.329182 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:43.329728 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m15:20:43.330264 [debug] [Thread-3 (]: SQL status: BEGIN in 1.270 seconds
[0m15:20:43.331167 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'TITLE')::varchar as title,
  ("CONTENT"->>'STAGE_ID')::varchar as stage_id,
  NULLIF("CONTENT"->>'CATEGORY_ID','')::int2 as category_id,
  NULLIF("CONTENT"->>'OPPORTUNITY','')::numeric as opportunity,
  NULLIF("CONTENT"->>'COMPANY_ID','')::int2 as company_id,
  NULLIF("CONTENT"->>'CONTACT_ID','')::int2 as contact_id,
  NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 as assigned_by_id,
  NULLIF("CONTENT"->>'CLOSED','[]')::bool as closed,
  NULLIF("CONTENT"->>'CLOSEDATE','')::timestamptz as close_date,
  NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz as date_create,
  NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz as date_modify,
  NULLIF("CONTENT"->>'BEGINDATE','')::timestamptz as begin_date,
  NULLIF("CONTENT"->>'MOVED_TIME','')::timestamptz::timestamptz as moved_time,
  NULLIF("CONTENT"->>'OPENED','[]')::bool as opened,
  NULLIF("CONTENT"->>'IS_NEW','[]')::bool as is_new,
  ("CONTENT"->>'LEAD_ID')::varchar as lead_id,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'COMMENTS')::text as comments,
  ("CONTENT"->>'QUOTE_ID')::varchar as quote_id,
  ("CONTENT"->>'ORIGIN_ID')::varchar as origin_id,
  ("CONTENT"->>'SOURCE_ID')::varchar as source_id,
  NULLIF("CONTENT"->>'TAX_VALUE','')::numeric as tax_value,
  ("CONTENT"->>'UTM_MEDIUM')::varchar as utm_medium,
  ("CONTENT"->>'UTM_SOURCE')::varchar as utm_source,
  ("CONTENT"->>'UTM_TERM')::varchar as utm_term,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'LOCATION_ID')::varchar as location_id,
  NULLIF("CONTENT"->>'MOVED_BY_ID','')::int2 as moved_by_id,
  ("CONTENT"->>'PROBABILITY')::varchar as probability,
  ("CONTENT"->>'UTM_CONTENT')::varchar as utm_content,
  ("CONTENT"->>'IS_RECURRING')::bool as is_recurring,
  NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN')::varchar as utm_campaign,
  NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION')::text as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO')::text as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID')::varchar as stage_semantic_id,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz as last_activity_time,
  NULLIF("CONTENT"->>'LAST_ACTIVITY_BY','')::int2 as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID')::varchar as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY')::bool as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER')::bool as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH')::bool as is_repeated_approach,
  NULLIF("CONTENT"->>'UF_CRM_1718891707656','')::int2 as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318')::varchar as uf_crm_1718893063318,
  NULLIF("CONTENT"->>'UF_CRM_1718895613676','')::int2 as uf_crm_1718895613676,
  NULLIF("CONTENT"->>'UF_CRM_1718895632531','')::int2 as uf_crm_1718895632531,
  NULLIF("CONTENT"->>'UF_CRM_1718895837277','')::int2 as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494')::varchar as uf_crm_1719234554494,
  NULLIF("CONTENT"->>'UF_CRM_1719234611470','')::int2 as uf_crm_1719234611470,
  NULLIF("CONTENT"->>'UF_CRM_1719234653377','')::int2 as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133')::varchar as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735')::varchar as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227')::jsonb as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995')::jsonb as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652')::varchar as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628')::varchar as uf_crm_1720198502628,
  NULLIF("CONTENT"->>'UF_CRM_1721083795801','')::int2 as uf_crm_1721083795801,
  NULLIF("CONTENT"->>'UF_CRM_1721083820061','')::numeric as uf_crm_1721083820061,
  NULLIF("CONTENT"->>'UF_CRM_1721083836488','')::numeric as uf_crm_1721083836488,
  NULLIF("CONTENT"->>'UF_CRM_1721083849804','')::numeric as uf_crm_1721083849804,
  NULLIF("CONTENT"->>'UF_CRM_1721083861185','')::numeric as uf_crm_1721083861185,
  NULLIF("CONTENT"->>'UF_CRM_1721083874978','')::numeric as uf_crm_1721083874978,
  NULLIF("CONTENT"->>'UF_CRM_1721083894608','')::numeric as uf_crm_1721083894608,
  NULLIF("CONTENT"->>'UF_CRM_1721083906720','')::numeric as uf_crm_1721083906720,
  NULLIF("CONTENT"->>'UF_CRM_1721226126','[]')::bool as uf_crm_1721226126,
  nullif("CONTENT"->>'UF_CRM_1721227124','[]')::bool as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190')::varchar as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370')::varchar as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036')::varchar as uf_crm_1721243302036,
  NULLIF("CONTENT"->>'UF_CRM_1721243367','[]')::bool as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245')::text as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568')::text as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157')::text as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025')::text as uf_crm_1721244526025,
  NULLIF("CONTENT"->>'UF_CRM_1721244560622','')::timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT"->>'UF_CRM_1721244826264','')::int2 as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810')::text as uf_crm_1721244999810,
  NULLIF("CONTENT"->>'UF_CRM_1721248388070','')::int2 as uf_crm_1721248388070,
  NULLIF("CONTENT"->>'UF_CRM_1721248408791','')::varchar as uf_crm_1721248408791,
  NULLIF("CONTENT"->>'UF_CRM_1721406278811','')::timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT"->>'UF_CRM_1724261215','')::numeric as uf_crm_1724261215,
  NULLIF("CONTENT"->>'UF_CRM_1724264534445','')::numeric as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266')::varchar as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322')::varchar as uf_crm_1725574322,
  NULLIF(BTRIM("CONTENT"->>'UF_CRM_1725548469220','[]'),'')::timestamptz as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164')::text as uf_crm_1726002322164,
  NULLIF("CONTENT"->>'UF_CRM_1726003734','')::int2 as uf_crm_1726003734,
  NULLIF("CONTENT"->>'UF_CRM_1726007497','')::numeric as uf_crm_1726007497,
  NULLIF("CONTENT"->>'UF_CRM_1728416073106','')::numeric as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554')::text as uf_crm_1729086829554,
  NULLIF("CONTENT"->>'UF_CRM_1729086887055','')::timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT"->>'UF_CRM_1732567021643','')::int2 as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374')::text as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514')::varchar as uf_crm_1733491265514,
  NULLIF("CONTENT"->>'UF_CRM_1738931838','')::int2 as uf_crm_1738931838,
  NULLIF("CONTENT"->>'UF_CRM_1741275511723','')::int2 as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502')::varchar as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050')::text as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428')::varchar as uf_crm_1741275610428,
  NULLIF("CONTENT"->>'UF_CRM_1741275634394','')::numeric as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620')::text as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20')::text as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD')::text as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F')::text as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC')::text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1719236124580','')::jsonb  as uf_crm_deal_1719236124580,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540405848','')::int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725540759541','')::jsonb as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488')::text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT"->>'UF_CRM_DEAL_1725569886689','[]')::jsonb as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411')::varchar as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239')::varchar as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103')::text as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944')::varchar as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827')::text as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832')::varchar as uf_crm_deal_1722632496832
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE "SUCCESS" = true
  );
[0m15:20:43.332205 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:43.332781 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m15:20:43.441456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m15:20:43.441865 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m15:20:43.503703 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m15:20:43.507872 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:43.508116 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.176 seconds
[0m15:20:43.508353 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.176 seconds
[0m15:20:43.508542 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m15:20:43.510181 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:43.511758 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:43.512029 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m15:20:43.512265 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m15:20:43.591594 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m15:20:43.598829 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:20:43.600331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155cf050>]}
[0m15:20:43.600835 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.59s]
[0m15:20:43.601253 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m15:20:43.601552 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m15:20:43.601885 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m15:20:43.602205 [info ] [Thread-1 (]: 5 of 7 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m15:20:43.603765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m15:20:43.604027 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m15:20:43.605827 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:43.606407 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m15:20:43.609023 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:43.609671 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:43.609915 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m15:20:43.610131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:43.664469 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:20:43.664815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m15:20:43.665147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m15:20:43.667489 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:43.669513 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:43.671297 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:43.671586 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m15:20:43.671848 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m15:20:43.672098 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m15:20:43.823481 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m15:20:43.824830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:20:43.825796 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m15:20:43.845972 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:20:43.847841 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:20:43.849468 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:20:43.849835 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:43.850153 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:43.850561 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:43.850843 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:20:43.851114 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m15:20:43.851376 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:20:44.004860 [debug] [Thread-4 (]: SQL status: COMMIT in 0.153 seconds
[0m15:20:44.005483 [debug] [Thread-2 (]: SQL status: COMMIT in 0.154 seconds
[0m15:20:44.005862 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m15:20:44.012394 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m15:20:44.014830 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m15:20:44.016534 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m15:20:44.020728 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:20:44.021448 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:20:44.022016 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:20:44.022296 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m15:20:44.022562 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m15:20:44.022843 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m15:20:44.178814 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.156 seconds
[0m15:20:44.179222 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.156 seconds
[0m15:20:44.179505 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.156 seconds
[0m15:20:44.181534 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m15:20:44.182564 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m15:20:44.183416 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m15:20:44.184032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155a3d40>]}
[0m15:20:44.184543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155cc800>]}
[0m15:20:44.185068 [info ] [Thread-4 (]: 4 of 7 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.17s]
[0m15:20:44.185500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11564b0e0>]}
[0m15:20:44.186026 [info ] [Thread-3 (]: 3 of 7 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.18s]
[0m15:20:44.186450 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:20:44.186826 [info ] [Thread-2 (]: 2 of 7 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.18s]
[0m15:20:44.187177 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m15:20:44.187436 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m15:20:44.187810 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m15:20:44.188091 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m15:20:44.188398 [info ] [Thread-4 (]: 6 of 7 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m15:20:44.188772 [info ] [Thread-3 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m15:20:44.189069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_product)
[0m15:20:44.189313 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_user)
[0m15:20:44.189548 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m15:20:44.189766 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m15:20:44.191958 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m15:20:44.194051 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m15:20:44.195896 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m15:20:44.199041 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m15:20:44.199441 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m15:20:44.201482 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m15:20:44.201797 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:44.202173 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m15:20:44.202425 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:20:44.202774 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:44.203000 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m15:20:44.203186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:20:44.822568 [debug] [Thread-1 (]: SQL status: BEGIN in 1.211 seconds
[0m15:20:44.825030 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:44.825901 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m15:20:44.999180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.172 seconds
[0m15:20:45.002950 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:45.003287 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m15:20:45.154030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m15:20:45.157169 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:45.157499 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m15:20:45.309328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m15:20:45.311721 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:20:45.312159 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:45.312924 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:20:45.420401 [debug] [Thread-3 (]: SQL status: BEGIN in 1.217 seconds
[0m15:20:45.421077 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:45.421535 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m15:20:45.424412 [debug] [Thread-4 (]: SQL status: BEGIN in 1.222 seconds
[0m15:20:45.424794 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:45.425198 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m15:20:45.464371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m15:20:45.466813 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m15:20:45.467458 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:20:45.467736 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m15:20:45.580105 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m15:20:45.583213 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:45.583741 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m15:20:45.584115 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m15:20:45.586619 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:45.586962 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m15:20:45.622692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.155 seconds
[0m15:20:45.624035 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m15:20:45.624649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11559d760>]}
[0m15:20:45.625161 [info ] [Thread-1 (]: 5 of 7 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.02s]
[0m15:20:45.625558 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m15:20:45.736439 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:20:45.738972 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:45.739273 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m15:20:45.743260 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m15:20:45.745242 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:45.745515 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m15:20:45.888250 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:20:45.890024 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:20:45.890399 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:45.890718 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:20:45.892947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m15:20:45.894259 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:20:45.894584 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:45.894852 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:20:46.043352 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m15:20:46.043938 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m15:20:46.047146 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m15:20:46.049263 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m15:20:46.050059 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:20:46.050722 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:20:46.051089 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m15:20:46.051422 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m15:20:46.204450 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m15:20:46.205063 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m15:20:46.207150 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m15:20:46.208617 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m15:20:46.209698 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161c04d0>]}
[0m15:20:46.210292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7afe7b-7025-4834-a6a3-766dd69f5965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11616efc0>]}
[0m15:20:46.211022 [info ] [Thread-4 (]: 6 of 7 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.02s]
[0m15:20:46.211554 [info ] [Thread-3 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.02s]
[0m15:20:46.212068 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m15:20:46.212560 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m15:20:46.214335 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:46.214725 [debug] [MainThread]: On master: BEGIN
[0m15:20:46.214990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:47.439971 [debug] [MainThread]: SQL status: BEGIN in 1.224 seconds
[0m15:20:47.441876 [debug] [MainThread]: On master: COMMIT
[0m15:20:47.442524 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:47.443078 [debug] [MainThread]: On master: COMMIT
[0m15:20:47.597122 [debug] [MainThread]: SQL status: COMMIT in 0.153 seconds
[0m15:20:47.599120 [debug] [MainThread]: On master: Close
[0m15:20:47.600874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:47.601544 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m15:20:47.602114 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal' was properly closed.
[0m15:20:47.602515 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m15:20:47.602897 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m15:20:47.603802 [info ] [MainThread]: 
[0m15:20:47.604648 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m15:20:47.606624 [debug] [MainThread]: Command end result
[0m15:20:47.630431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:20:47.632233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:20:47.639059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m15:20:47.639456 [info ] [MainThread]: 
[0m15:20:47.639761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:20:47.639997 [info ] [MainThread]: 
[0m15:20:47.640279 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:20:47.640498 [info ] [MainThread]: 
[0m15:20:47.640722 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:20:47.642706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.810725, "process_in_blocks": "0", "process_kernel_time": 0.238154, "process_mem_max_rss": "123764736", "process_out_blocks": "0", "process_user_time": 1.304441}
[0m15:20:47.643087 [debug] [MainThread]: Command `dbt run` failed at 15:20:47.643022 after 10.81 seconds
[0m15:20:47.643407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114236ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152392b0>]}
[0m15:20:47.643685 [debug] [MainThread]: Flushing usage events
[0m15:20:48.846505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:38.974321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36ba0>]}


============================== 15:27:38.978080 | d34cd142-c148-4713-800a-441e82c3d409 ==============================
[0m15:27:38.978080 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:27:38.978547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m15:27:39.080874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f15340>]}
[0m15:27:39.108136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cec560>]}
[0m15:27:39.109002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:39.169454 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m15:27:39.230986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:39.231389 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m15:27:39.355092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9f530>]}
[0m15:27:39.389614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:27:39.391794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:27:39.405499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d70c50>]}
[0m15:27:39.405928 [info ] [MainThread]: Found 7 models, 7 sources, 433 macros
[0m15:27:39.406129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c9d040>]}
[0m15:27:39.407141 [info ] [MainThread]: 
[0m15:27:39.407336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:39.407483 [info ] [MainThread]: 
[0m15:27:39.407751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:39.409810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m15:27:39.439927 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m15:27:39.440199 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m15:27:39.440365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:40.758434 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.318 seconds
[0m15:27:40.766063 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m15:27:40.792882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m15:27:40.796595 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:27:40.796865 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m15:27:40.797027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:41.993248 [debug] [ThreadPool]: SQL status: BEGIN in 1.196 seconds
[0m15:27:41.993723 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m15:27:41.994025 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m15:27:42.158773 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.164 seconds
[0m15:27:42.161791 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m15:27:42.310131 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m15:27:42.320109 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:42.320634 [debug] [MainThread]: On master: BEGIN
[0m15:27:42.320990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:43.547783 [debug] [MainThread]: SQL status: BEGIN in 1.226 seconds
[0m15:27:43.548866 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:43.549542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:43.715905 [debug] [MainThread]: SQL status: SELECT 6 in 0.166 seconds
[0m15:27:43.718858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127edb0>]}
[0m15:27:43.719423 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:43.871858 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:43.872293 [debug] [MainThread]: On master: BEGIN
[0m15:27:44.168537 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m15:27:44.169571 [debug] [MainThread]: On master: COMMIT
[0m15:27:44.170102 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:44.170543 [debug] [MainThread]: On master: COMMIT
[0m15:27:44.319314 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m15:27:44.320915 [debug] [MainThread]: On master: Close
[0m15:27:44.327469 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m15:27:44.328083 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m15:27:44.328593 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m15:27:44.329125 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:27:44.329785 [info ] [Thread-1 (]: 1 of 7 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m15:27:44.330352 [info ] [Thread-2 (]: 2 of 7 START sql table model bitrix.btx_processed_deal ......................... [RUN]
[0m15:27:44.331099 [info ] [Thread-3 (]: 3 of 7 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m15:27:44.331702 [info ] [Thread-4 (]: 4 of 7 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m15:27:44.332210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m15:27:44.332702 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m15:27:44.333146 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m15:27:44.333563 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m15:27:44.333949 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m15:27:44.334291 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m15:27:44.334616 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m15:27:44.334947 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m15:27:44.342797 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m15:27:44.344523 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m15:27:44.346808 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:44.349077 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:44.350956 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m15:27:44.351286 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m15:27:44.351656 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m15:27:44.357156 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m15:27:44.377459 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:44.377702 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:44.379528 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m15:27:44.391782 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m15:27:44.392324 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:44.392579 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:44.392858 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m15:27:44.393072 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:27:44.393277 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m15:27:44.393488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:27:44.393710 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:27:44.393929 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m15:27:44.394116 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:27:44.394384 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m15:27:44.394564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:44.394808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:27:45.621872 [debug] [Thread-2 (]: SQL status: BEGIN in 1.227 seconds
[0m15:27:45.622342 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m15:27:45.622975 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  { { source('bitrix', 'btx_raw_deal') } }
WHERE
  "SUCCESS" = true
  );
  
[0m15:27:45.631326 [debug] [Thread-4 (]: SQL status: BEGIN in 1.237 seconds
[0m15:27:45.631684 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:45.631987 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m15:27:45.633201 [debug] [Thread-3 (]: SQL status: BEGIN in 1.240 seconds
[0m15:27:45.633441 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:45.633676 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m15:27:45.636429 [debug] [Thread-1 (]: SQL status: BEGIN in 1.242 seconds
[0m15:27:45.636643 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m15:27:45.636887 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m15:27:45.771938 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m15:27:45.772373 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m15:27:45.790759 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m15:27:45.791121 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m15:27:45.809360 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.175 seconds
[0m15:27:45.813791 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:45.814105 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.182 seconds
[0m15:27:45.814356 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m15:27:45.816292 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:45.816609 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m15:27:45.923624 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m15:27:45.931075 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m15:27:45.932614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112226a80>]}
[0m15:27:45.933156 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model bitrix.btx_processed_deal ................ [[31mERROR[0m in 1.60s]
[0m15:27:45.933590 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m15:27:45.933973 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m15:27:45.934281 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m15:27:45.934593 [info ] [Thread-2 (]: 5 of 7 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m15:27:45.935326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_dealcategory)
[0m15:27:45.935567 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m15:27:45.937524 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:45.938353 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m15:27:45.940530 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:45.941323 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:45.941605 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m15:27:45.941835 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:45.945634 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m15:27:45.947379 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:27:45.947688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ccc20>]}
[0m15:27:45.948059 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.62s]
[0m15:27:45.948373 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m15:27:45.948597 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m15:27:45.948948 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m15:27:45.949281 [info ] [Thread-1 (]: 6 of 7 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m15:27:45.949725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m15:27:45.949945 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m15:27:45.951855 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m15:27:45.952915 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m15:27:45.955744 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m15:27:45.956191 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:45.956394 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m15:27:45.956576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:45.967067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m15:27:45.968797 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:45.969000 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:27:45.969229 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m15:27:45.970701 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:45.970950 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m15:27:46.119607 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:27:46.119991 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:27:46.132059 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:27:46.133273 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:27:46.133558 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:46.133967 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:46.134336 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m15:27:46.134585 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m15:27:46.284254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m15:27:46.288918 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m15:27:46.292127 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m15:27:46.292397 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m15:27:46.358378 [debug] [Thread-4 (]: SQL status: COMMIT in 0.223 seconds
[0m15:27:46.360934 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m15:27:46.361643 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m15:27:46.361977 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m15:27:46.460948 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.168 seconds
[0m15:27:46.465004 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m15:27:46.466459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122cefc0>]}
[0m15:27:46.467680 [info ] [Thread-3 (]: 3 of 7 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.13s]
[0m15:27:46.468455 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m15:27:46.468924 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m15:27:46.469736 [info ] [Thread-3 (]: 7 of 7 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m15:27:46.470486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_user)
[0m15:27:46.470955 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m15:27:46.474657 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m15:27:46.477397 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m15:27:46.481305 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m15:27:46.482179 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:46.482481 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m15:27:46.482740 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:27:46.512964 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.151 seconds
[0m15:27:46.514302 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m15:27:46.514881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124194c0>]}
[0m15:27:46.515350 [info ] [Thread-4 (]: 4 of 7 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.18s]
[0m15:27:46.515759 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m15:27:47.131066 [debug] [Thread-2 (]: SQL status: BEGIN in 1.189 seconds
[0m15:27:47.131653 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:47.132019 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m15:27:47.179485 [debug] [Thread-1 (]: SQL status: BEGIN in 1.223 seconds
[0m15:27:47.179963 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:47.180472 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m15:27:47.310428 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.178 seconds
[0m15:27:47.313144 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:47.313488 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m15:27:47.344381 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m15:27:47.346892 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:47.347162 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m15:27:47.461300 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m15:27:47.463805 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:47.464117 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m15:27:47.499696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:27:47.502158 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:47.502489 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m15:27:47.611157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m15:27:47.612582 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:27:47.612898 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:47.613152 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m15:27:47.653251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m15:27:47.654804 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:27:47.655162 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:47.655398 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m15:27:47.712557 [debug] [Thread-3 (]: SQL status: BEGIN in 1.230 seconds
[0m15:27:47.713036 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:47.713382 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID",
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m15:27:47.796020 [debug] [Thread-2 (]: SQL status: COMMIT in 0.182 seconds
[0m15:27:47.801318 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m15:27:47.802073 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m15:27:47.802404 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m15:27:47.807672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m15:27:47.809949 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m15:27:47.810709 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m15:27:47.811055 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m15:27:47.872326 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m15:27:47.874738 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:47.875018 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m15:27:47.951963 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.149 seconds
[0m15:27:47.953094 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m15:27:47.953627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264eae0>]}
[0m15:27:47.954049 [info ] [Thread-2 (]: 5 of 7 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.02s]
[0m15:27:47.954393 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m15:27:47.964075 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.153 seconds
[0m15:27:47.965075 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m15:27:47.965556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112601af0>]}
[0m15:27:47.965936 [info ] [Thread-1 (]: 6 of 7 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.02s]
[0m15:27:47.966272 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m15:27:48.024510 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m15:27:48.026696 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:48.026971 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m15:27:48.179052 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m15:27:48.180462 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:27:48.180734 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:48.180956 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m15:27:48.340438 [debug] [Thread-3 (]: SQL status: COMMIT in 0.159 seconds
[0m15:27:48.342412 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m15:27:48.343045 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m15:27:48.343336 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m15:27:48.495674 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m15:27:48.497717 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m15:27:48.498635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd34cd142-c148-4713-800a-441e82c3d409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261acc0>]}
[0m15:27:48.499275 [info ] [Thread-3 (]: 7 of 7 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.03s]
[0m15:27:48.499773 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m15:27:48.501352 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:48.501856 [debug] [MainThread]: On master: BEGIN
[0m15:27:48.502124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:49.738786 [debug] [MainThread]: SQL status: BEGIN in 1.237 seconds
[0m15:27:49.739265 [debug] [MainThread]: On master: COMMIT
[0m15:27:49.739457 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:49.739607 [debug] [MainThread]: On master: COMMIT
[0m15:27:49.888382 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m15:27:49.888940 [debug] [MainThread]: On master: Close
[0m15:27:49.889518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:49.889773 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m15:27:49.889986 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m15:27:49.890168 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m15:27:49.890346 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m15:27:49.890636 [info ] [MainThread]: 
[0m15:27:49.890894 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m15:27:49.891886 [debug] [MainThread]: Command end result
[0m15:27:49.907322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m15:27:49.909305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m15:27:49.913419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m15:27:49.913669 [info ] [MainThread]: 
[0m15:27:49.913913 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:27:49.914106 [info ] [MainThread]: 
[0m15:27:49.914328 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m15:27:49.914508 [info ] [MainThread]: 
[0m15:27:49.914721 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m15:27:49.914888 [info ] [MainThread]: 
[0m15:27:49.915076 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m15:27:49.917023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.98019, "process_in_blocks": "0", "process_kernel_time": 0.240805, "process_mem_max_rss": "127860736", "process_out_blocks": "0", "process_user_time": 1.430715}
[0m15:27:49.917283 [debug] [MainThread]: Command `dbt run` failed at 15:27:49.917236 after 10.98 seconds
[0m15:27:49.917523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce5760>]}
[0m15:27:49.917739 [debug] [MainThread]: Flushing usage events
[0m15:27:51.177706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:23.735567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36b10>]}


============================== 17:29:23.738800 | a4dbc163-5f2f-4c4a-855e-76b3aad6c0d9 ==============================
[0m17:29:23.738800 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:29:23.739176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:23.838609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4dbc163-5f2f-4c4a-855e-76b3aad6c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36c30>]}
[0m17:29:23.866781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4dbc163-5f2f-4c4a-855e-76b3aad6c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e61880>]}
[0m17:29:23.867624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:29:23.927059 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:29:23.988165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:29:23.988538 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:29:23.988758 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m17:29:24.078585 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_curated_deal' (models/bitrix/btx_curated_deal.sql) depends on a source named 'bitrix.btx_processed_user' which was not found
[0m17:29:24.080506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38343662, "process_in_blocks": "0", "process_kernel_time": 0.166538, "process_mem_max_rss": "108576768", "process_out_blocks": "0", "process_user_time": 0.934693}
[0m17:29:24.080866 [debug] [MainThread]: Command `dbt run` failed at 17:29:24.080808 after 0.38 seconds
[0m17:29:24.081118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104552d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d7a40>]}
[0m17:29:24.081334 [debug] [MainThread]: Flushing usage events
[0m17:29:25.380257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:54.003596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106332f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106332bd0>]}


============================== 17:31:54.006510 | bea3cc26-019b-4239-9d70-a93e6c18d3e2 ==============================
[0m17:31:54.006510 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:31:54.006872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:54.101060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bea3cc26-019b-4239-9d70-a93e6c18d3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df1340>]}
[0m17:31:54.127717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bea3cc26-019b-4239-9d70-a93e6c18d3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042da840>]}
[0m17:31:54.128555 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:31:54.271436 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:31:54.331909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m17:31:54.332296 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:31:54.332509 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m17:31:54.332704 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m17:31:54.426339 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_curated_deal' (models/bitrix/btx_curated_deal.sql) depends on a source named 'bitrix.btx_processed_deal' which was not found
[0m17:31:54.428370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45936376, "process_in_blocks": "0", "process_kernel_time": 0.166169, "process_mem_max_rss": "108363776", "process_out_blocks": "0", "process_user_time": 0.921315}
[0m17:31:54.428629 [debug] [MainThread]: Command `dbt run` failed at 17:31:54.428575 after 0.46 seconds
[0m17:31:54.428862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10013ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e5be0>]}
[0m17:31:54.429202 [debug] [MainThread]: Flushing usage events
[0m17:31:55.376211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:43.646066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d430b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049beae0>]}


============================== 17:36:43.649036 | e9843ea5-bf3b-4376-8feb-7cbb93b14e8f ==============================
[0m17:36:43.649036 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:36:43.649388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:43.745762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9843ea5-bf3b-4376-8feb-7cbb93b14e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105795340>]}
[0m17:36:43.773096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9843ea5-bf3b-4376-8feb-7cbb93b14e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497d340>]}
[0m17:36:43.773847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:36:43.833124 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:36:43.896498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m17:36:43.896891 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:36:43.897100 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m17:36:43.897288 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m17:36:43.990866 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bdt_transformations.btx_curated_deal' (models/bitrix/btx_curated_deal.sql) depends on a source named 'bitrix.btx_processed_deal' which was not found
[0m17:36:43.992838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3821262, "process_in_blocks": "0", "process_kernel_time": 0.150107, "process_mem_max_rss": "108412928", "process_out_blocks": "0", "process_user_time": 0.904197}
[0m17:36:43.993194 [debug] [MainThread]: Command `dbt run` failed at 17:36:43.993135 after 0.38 seconds
[0m17:36:43.993452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100626d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107527d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105796c60>]}
[0m17:36:43.993662 [debug] [MainThread]: Flushing usage events
[0m17:36:45.011973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:01.562440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36a20>]}


============================== 17:38:01.565561 | 16ddb79c-3abb-4ff2-9563-0a67fe0d05a9 ==============================
[0m17:38:01.565561 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:01.565928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m17:38:01.660922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36c00>]}
[0m17:38:01.687213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105086840>]}
[0m17:38:01.687952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:01.747295 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:38:01.810953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m17:38:01.811361 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:38:01.811573 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m17:38:01.811790 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m17:38:01.938106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106211a90>]}
[0m17:38:01.971509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:38:01.973541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:38:01.983573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aed010>]}
[0m17:38:01.983865 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m17:38:01.984051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034e1eb0>]}
[0m17:38:01.984992 [info ] [MainThread]: 
[0m17:38:01.985189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:01.985335 [info ] [MainThread]: 
[0m17:38:01.985598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:01.987632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:38:02.016243 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:38:02.016496 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:38:02.016665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:03.270208 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.253 seconds
[0m17:38:03.275366 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:38:03.278844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m17:38:03.286811 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:38:03.287275 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m17:38:03.287594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:04.516997 [debug] [ThreadPool]: SQL status: BEGIN in 1.229 seconds
[0m17:38:04.519548 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:38:04.520416 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m17:38:04.672587 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.151 seconds
[0m17:38:04.675021 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m17:38:04.824665 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m17:38:04.838145 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:04.838795 [debug] [MainThread]: On master: BEGIN
[0m17:38:04.839153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:06.068674 [debug] [MainThread]: SQL status: BEGIN in 1.229 seconds
[0m17:38:06.069075 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:06.069345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:06.274794 [debug] [MainThread]: SQL status: SELECT 6 in 0.205 seconds
[0m17:38:06.283481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c57ec0>]}
[0m17:38:06.284692 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:06.437313 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:06.438091 [debug] [MainThread]: On master: BEGIN
[0m17:38:06.741555 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m17:38:06.743596 [debug] [MainThread]: On master: COMMIT
[0m17:38:06.744853 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:06.745510 [debug] [MainThread]: On master: COMMIT
[0m17:38:06.895777 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:38:06.896536 [debug] [MainThread]: On master: Close
[0m17:38:06.902530 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:38:06.902970 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:38:06.903413 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:38:06.903998 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m17:38:06.904616 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:38:06.905445 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m17:38:06.906059 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m17:38:06.906618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:38:06.907108 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m17:38:06.907594 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:38:06.907990 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:38:06.908310 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:38:06.908695 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m17:38:06.909005 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:38:06.909348 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:38:06.917034 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:38:06.917400 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m17:38:06.920622 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:38:06.922943 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:06.925698 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:06.926474 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m17:38:06.926814 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:38:06.947700 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m17:38:06.951900 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m17:38:06.953946 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:06.954182 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m17:38:06.955923 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m17:38:06.957738 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:06.958147 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:06.958360 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:38:06.958608 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:38:06.958844 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m17:38:06.959051 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:38:06.959244 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:06.959436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:38:06.959638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:06.959826 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m17:38:06.960014 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m17:38:06.960330 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:06.960525 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:08.188385 [debug] [Thread-1 (]: SQL status: BEGIN in 1.228 seconds
[0m17:38:08.190145 [debug] [Thread-4 (]: SQL status: BEGIN in 1.229 seconds
[0m17:38:08.191122 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:38:08.191701 [debug] [Thread-2 (]: SQL status: BEGIN in 1.231 seconds
[0m17:38:08.192241 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:08.192855 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m17:38:08.193461 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:38:08.194097 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m17:38:08.195678 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  { { source('bitrix', 'btx_raw_deal') } }
WHERE
  "SUCCESS" = true
  );
[0m17:38:08.208965 [debug] [Thread-3 (]: SQL status: BEGIN in 1.249 seconds
[0m17:38:08.209551 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:08.210070 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m17:38:08.348550 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 131:   { { source('bitrix', 'btx_raw_deal') } }
            ^

[0m17:38:08.350111 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m17:38:08.350781 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m17:38:08.351444 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m17:38:08.393479 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.182 seconds
[0m17:38:08.401370 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.205 seconds
[0m17:38:08.410942 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:08.407431 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:08.411696 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m17:38:08.412127 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m17:38:08.503333 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m17:38:08.504664 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m17:38:08.518836 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:38:08.520287 [debug] [Thread-2 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 131:   { { source('bitrix', 'btx_raw_deal') } }
              ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m17:38:08.522653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107604890>]}
[0m17:38:08.523042 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f350>]}
[0m17:38:08.523717 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.61s]
[0m17:38:08.524324 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model bitrix.btx_processed_deal ................. [[31mERROR[0m in 1.61s]
[0m17:38:08.524868 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:38:08.525309 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:38:08.525691 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:38:08.526112 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m17:38:08.526480 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m17:38:08.526869 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m17:38:08.527956 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 131:   { { source('bitrix', 'btx_raw_deal') } }
              ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m17:38:08.528378 [info ] [Thread-2 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m17:38:08.528796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m17:38:08.529194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_product)
[0m17:38:08.529484 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:38:08.529761 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m17:38:08.532641 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:08.534992 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m17:38:08.535997 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:38:08.538430 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:08.538720 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m17:38:08.540917 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m17:38:08.541474 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:08.541751 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:08.542009 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:38:08.542258 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m17:38:08.542506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:08.542736 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:08.565092 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:38:08.568482 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:08.568761 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m17:38:08.569036 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m17:38:08.570921 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:08.571247 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m17:38:08.720231 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m17:38:08.733662 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.162 seconds
[0m17:38:08.744539 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:38:08.746228 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:38:08.746699 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:08.747038 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:08.747356 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:38:08.747649 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:38:08.899471 [debug] [Thread-4 (]: SQL status: COMMIT in 0.151 seconds
[0m17:38:08.911868 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m17:38:08.917599 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:38:08.918044 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m17:38:08.950830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.203 seconds
[0m17:38:08.953708 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m17:38:08.954568 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:38:08.954993 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m17:38:09.074601 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.155 seconds
[0m17:38:09.081101 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m17:38:09.082459 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103403a70>]}
[0m17:38:09.083512 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.17s]
[0m17:38:09.084371 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:38:09.084870 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_user
[0m17:38:09.085401 [info ] [Thread-4 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m17:38:09.086020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m17:38:09.086557 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m17:38:09.090694 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m17:38:09.092533 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m17:38:09.096155 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m17:38:09.096913 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:09.097255 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m17:38:09.097559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:09.109553 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.154 seconds
[0m17:38:09.111218 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:38:09.112036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d5e80>]}
[0m17:38:09.112658 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.20s]
[0m17:38:09.113174 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:38:09.779334 [debug] [Thread-1 (]: SQL status: BEGIN in 1.237 seconds
[0m17:38:09.780290 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:09.780579 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m17:38:09.829188 [debug] [Thread-2 (]: SQL status: BEGIN in 1.286 seconds
[0m17:38:09.829596 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:09.829888 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m17:38:09.938440 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m17:38:09.941556 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:09.941888 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m17:38:09.993172 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m17:38:09.997083 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:09.997582 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m17:38:10.092296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:38:10.094301 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:10.094540 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m17:38:10.149097 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:38:10.151397 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:10.151715 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m17:38:10.246414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m17:38:10.248079 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:38:10.248413 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:10.248781 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:38:10.303839 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m17:38:10.305239 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:38:10.305585 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:10.305808 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:38:10.321981 [debug] [Thread-4 (]: SQL status: BEGIN in 1.224 seconds
[0m17:38:10.322362 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:10.322660 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID"::int2 as id,
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m17:38:10.399209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m17:38:10.403383 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m17:38:10.404071 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:38:10.404373 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m17:38:10.459377 [debug] [Thread-2 (]: SQL status: COMMIT in 0.153 seconds
[0m17:38:10.461881 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m17:38:10.462722 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:38:10.463100 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m17:38:10.485625 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m17:38:10.489622 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:10.490131 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m17:38:10.555830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.151 seconds
[0m17:38:10.558320 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:38:10.559662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073da1b0>]}
[0m17:38:10.560616 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.03s]
[0m17:38:10.561305 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:38:10.616931 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.153 seconds
[0m17:38:10.619287 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m17:38:10.620247 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107605ac0>]}
[0m17:38:10.621012 [info ] [Thread-2 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.09s]
[0m17:38:10.621644 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m17:38:10.641850 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:38:10.645741 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:10.646218 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m17:38:10.797922 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:38:10.800601 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:38:10.801270 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:10.801753 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:38:10.960692 [debug] [Thread-4 (]: SQL status: COMMIT in 0.155 seconds
[0m17:38:10.970810 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m17:38:10.972147 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:38:10.972916 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m17:38:11.127410 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.154 seconds
[0m17:38:11.129933 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: Close
[0m17:38:11.131042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ddb79c-3abb-4ff2-9563-0a67fe0d05a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703cdd0>]}
[0m17:38:11.131803 [info ] [Thread-4 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.04s]
[0m17:38:11.132393 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m17:38:11.133570 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m17:38:11.134227 [info ] [Thread-3 (]: 8 of 8 SKIP relation bitrix.btx_curated_deal ................................... [[33mSKIP[0m]
[0m17:38:11.134877 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m17:38:11.136737 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:11.137213 [debug] [MainThread]: On master: BEGIN
[0m17:38:11.137572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:12.378642 [debug] [MainThread]: SQL status: BEGIN in 1.241 seconds
[0m17:38:12.379039 [debug] [MainThread]: On master: COMMIT
[0m17:38:12.379241 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:12.379411 [debug] [MainThread]: On master: COMMIT
[0m17:38:12.527437 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m17:38:12.528004 [debug] [MainThread]: On master: Close
[0m17:38:12.528627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:12.528913 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:38:12.529160 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m17:38:12.529389 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m17:38:12.529625 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m17:38:12.529978 [info ] [MainThread]: 
[0m17:38:12.530278 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m17:38:12.531371 [debug] [MainThread]: Command end result
[0m17:38:12.547470 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:38:12.556943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:38:12.561274 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:38:12.561526 [info ] [MainThread]: 
[0m17:38:12.561763 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:38:12.561951 [info ] [MainThread]: 
[0m17:38:12.562180 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:38:12.562362 [info ] [MainThread]: 
[0m17:38:12.562564 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 131:   { { source('bitrix', 'btx_raw_deal') } }
              ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m17:38:12.562736 [info ] [MainThread]: 
[0m17:38:12.562914 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=1 TOTAL=8
[0m17:38:12.564660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.039939, "process_in_blocks": "0", "process_kernel_time": 0.262128, "process_mem_max_rss": "130285568", "process_out_blocks": "0", "process_user_time": 1.517363}
[0m17:38:12.565052 [debug] [MainThread]: Command `dbt run` failed at 17:38:12.564990 after 11.04 seconds
[0m17:38:12.565333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101036d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d36d20>]}
[0m17:38:12.565650 [debug] [MainThread]: Flushing usage events
[0m17:38:13.625080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:12.726484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932c00>]}


============================== 17:39:12.729369 | 1709f891-d783-4091-b219-6fee53aee03a ==============================
[0m17:39:12.729369 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:12.729809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:39:12.812889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3d100>]}
[0m17:39:12.840069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496d310>]}
[0m17:39:12.841266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:39:12.900349 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:39:12.957353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:12.957754 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m17:39:13.072329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686be90>]}
[0m17:39:13.105211 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:39:13.107099 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:39:13.117109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659c9b0>]}
[0m17:39:13.117379 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m17:39:13.117562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857e00>]}
[0m17:39:13.118454 [info ] [MainThread]: 
[0m17:39:13.118661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:39:13.118802 [info ] [MainThread]: 
[0m17:39:13.119054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:39:13.121129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:39:13.150451 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:39:13.150726 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:39:13.150891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:14.381623 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.231 seconds
[0m17:39:14.383575 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:39:14.385605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m17:39:14.390772 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:39:14.391125 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m17:39:14.391367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:15.645049 [debug] [ThreadPool]: SQL status: BEGIN in 1.253 seconds
[0m17:39:15.646683 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:39:15.647582 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m17:39:15.803946 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.155 seconds
[0m17:39:15.809212 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m17:39:15.962942 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m17:39:15.975368 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:15.976007 [debug] [MainThread]: On master: BEGIN
[0m17:39:15.976379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:17.226227 [debug] [MainThread]: SQL status: BEGIN in 1.249 seconds
[0m17:39:17.228650 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:17.229202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:39:17.391786 [debug] [MainThread]: SQL status: SELECT 6 in 0.162 seconds
[0m17:39:17.397998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d66c00>]}
[0m17:39:17.398964 [debug] [MainThread]: On master: ROLLBACK
[0m17:39:17.557331 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:17.558001 [debug] [MainThread]: On master: BEGIN
[0m17:39:17.865819 [debug] [MainThread]: SQL status: BEGIN in 0.305 seconds
[0m17:39:17.867938 [debug] [MainThread]: On master: COMMIT
[0m17:39:17.868818 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:17.869268 [debug] [MainThread]: On master: COMMIT
[0m17:39:18.021342 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m17:39:18.022965 [debug] [MainThread]: On master: Close
[0m17:39:18.029182 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:39:18.029820 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:39:18.030937 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:39:18.030559 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m17:39:18.031469 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:39:18.032073 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m17:39:18.032693 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m17:39:18.033305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:39:18.033849 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m17:39:18.034428 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:39:18.034905 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:39:18.035255 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:39:18.035661 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m17:39:18.035996 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:39:18.036317 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:39:18.044731 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:39:18.045091 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m17:39:18.048512 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:39:18.050642 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:18.053202 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:18.053740 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m17:39:18.066950 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m17:39:18.079044 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m17:39:18.081326 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m17:39:18.081597 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:39:18.081842 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m17:39:18.084067 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:18.084423 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:39:18.086292 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:18.086538 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:18.086798 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m17:39:18.087072 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m17:39:18.087273 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:18.087466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:18.087672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:39:18.087852 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:18.088033 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:39:18.088370 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m17:39:18.088564 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:39:18.088753 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:39:19.307957 [debug] [Thread-1 (]: SQL status: BEGIN in 1.219 seconds
[0m17:39:19.309538 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:39:19.310373 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m17:39:19.322276 [debug] [Thread-3 (]: SQL status: BEGIN in 1.233 seconds
[0m17:39:19.323320 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:19.324038 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m17:39:19.324790 [debug] [Thread-2 (]: SQL status: BEGIN in 1.237 seconds
[0m17:39:19.325644 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:19.326745 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m17:39:19.341296 [debug] [Thread-4 (]: SQL status: BEGIN in 1.252 seconds
[0m17:39:19.342069 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:19.342651 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m17:39:19.458631 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m17:39:19.459265 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m17:39:19.485237 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m17:39:19.493122 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:19.493747 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m17:39:19.499622 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.172 seconds
[0m17:39:19.503175 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:19.503557 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m17:39:19.510200 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m17:39:19.513283 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:19.513736 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m17:39:19.609525 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m17:39:19.621683 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:39:19.624183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd18e0>]}
[0m17:39:19.624966 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.59s]
[0m17:39:19.625614 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:39:19.626062 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:39:19.626494 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m17:39:19.626937 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m17:39:19.628101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m17:39:19.628476 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:39:19.631533 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:19.632436 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:39:19.635260 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:19.635858 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:19.636139 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:39:19.636406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:19.649507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m17:39:19.652105 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:19.652434 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m17:39:19.657325 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:39:19.661637 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:19.661992 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m17:39:19.668563 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m17:39:19.670796 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:19.671136 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m17:39:19.803788 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:39:19.819107 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m17:39:19.825946 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m17:39:19.829297 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:39:19.830949 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:39:19.832308 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:39:19.832681 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:19.832999 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:19.833270 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:19.833531 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:39:19.833786 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:39:19.834034 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:39:19.986209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.151 seconds
[0m17:39:19.987351 [debug] [Thread-2 (]: SQL status: COMMIT in 0.153 seconds
[0m17:39:19.987938 [debug] [Thread-4 (]: SQL status: COMMIT in 0.153 seconds
[0m17:39:19.997228 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m17:39:19.999718 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m17:39:20.001974 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m17:39:20.006874 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:39:20.007575 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:39:20.008198 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:39:20.008535 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m17:39:20.008853 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m17:39:20.009163 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m17:39:20.162400 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m17:39:20.163566 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.154 seconds
[0m17:39:20.169348 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:39:20.171613 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m17:39:20.172849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11891a7b0>]}
[0m17:39:20.173568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de45f0>]}
[0m17:39:20.174496 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.14s]
[0m17:39:20.175316 [info ] [Thread-2 (]: 2 of 8 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.14s]
[0m17:39:20.176017 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:39:20.176584 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:39:20.177065 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m17:39:20.177643 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m17:39:20.178255 [info ] [Thread-3 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m17:39:20.178778 [info ] [Thread-2 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m17:39:20.179220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m17:39:20.179588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m17:39:20.179947 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m17:39:20.180276 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m17:39:20.183523 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m17:39:20.186335 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m17:39:20.187442 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m17:39:20.190535 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m17:39:20.190912 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m17:39:20.193517 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m17:39:20.193944 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:20.194234 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m17:39:20.194578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:39:20.194985 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:20.195245 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m17:39:20.195489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:39:20.255267 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.246 seconds
[0m17:39:20.256832 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m17:39:20.257533 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d54440>]}
[0m17:39:20.258155 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.22s]
[0m17:39:20.258708 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:39:20.865717 [debug] [Thread-1 (]: SQL status: BEGIN in 1.228 seconds
[0m17:39:20.868830 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:20.869774 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m17:39:21.028888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m17:39:21.038044 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:21.038629 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m17:39:21.190080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:39:21.199339 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:21.199956 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m17:39:21.351979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:39:21.357301 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:39:21.358057 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:21.358595 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:39:21.408499 [debug] [Thread-3 (]: SQL status: BEGIN in 1.213 seconds
[0m17:39:21.411458 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:21.412600 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m17:39:21.418210 [debug] [Thread-2 (]: SQL status: BEGIN in 1.222 seconds
[0m17:39:21.419274 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:21.420107 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID"::int2 as id,
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m17:39:21.511936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m17:39:21.518879 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m17:39:21.519758 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:39:21.520157 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m17:39:21.571385 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m17:39:21.577335 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:21.577963 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m17:39:21.581825 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m17:39:21.585425 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:21.585889 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m17:39:21.673052 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.152 seconds
[0m17:39:21.677547 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:39:21.678868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5bd40>]}
[0m17:39:21.679921 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.05s]
[0m17:39:21.680753 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:39:21.727286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m17:39:21.734234 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:21.734758 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m17:39:21.737178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:39:21.740830 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:21.741307 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m17:39:21.884265 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m17:39:21.890861 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:39:21.891514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:39:21.892216 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:21.894546 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:39:21.895025 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:39:21.895455 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:21.895955 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:39:22.047642 [debug] [Thread-3 (]: SQL status: COMMIT in 0.151 seconds
[0m17:39:22.049158 [debug] [Thread-2 (]: SQL status: COMMIT in 0.153 seconds
[0m17:39:22.053695 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m17:39:22.056590 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m17:39:22.057520 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:39:22.058336 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:39:22.058775 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m17:39:22.059200 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m17:39:22.209801 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.149 seconds
[0m17:39:22.215244 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m17:39:22.215855 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.156 seconds
[0m17:39:22.217903 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m17:39:22.218719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a25790>]}
[0m17:39:22.219602 [info ] [Thread-3 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.04s]
[0m17:39:22.220193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5b0b0>]}
[0m17:39:22.220839 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m17:39:22.221514 [info ] [Thread-2 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.04s]
[0m17:39:22.222305 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m17:39:22.223198 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m17:39:22.223787 [info ] [Thread-4 (]: 8 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m17:39:22.224295 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_curated_deal)
[0m17:39:22.224708 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m17:39:22.230067 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m17:39:22.231393 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m17:39:22.250543 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m17:39:22.251741 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:39:22.252023 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m17:39:22.252269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:39:23.483995 [debug] [Thread-4 (]: SQL status: BEGIN in 1.231 seconds
[0m17:39:23.486127 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:39:23.487719 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
select
	x.id,
	x.title as titulo,
	x1.name as estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity as mrr,
	x.company_id,
	x.contact_id,
	x2.name as atribuido_por,
	x.opened as aberto,
	x.begin_date as data_de_inicio,
	x.closed as encerrado,
	x.close_date as data_de_encerramento,
	x.date_create as criado_em,
	x5.name as criado_por,
	x.date_modify as modificado_em,
	x4.name as modificdo_por,
	x.moved_time as movido_em,
	x3.name as movido_por,
	x.last_activity_time as ultima_atividade_em,
	x6.name as ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id as id_lead,
	x.type_id as id_tipo,
	x.comments as comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id as moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring as recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 as quantidade_de_usuarios,
	x.uf_crm_1718893063318 as ponto_focal,
	x.uf_crm_1721248408791 as email_ponto_focal,
	x.uf_crm_1718895613676 as erp,
	x.uf_crm_1718895632531 as segmento,
	x.uf_crm_1718895837277 as perfil,
	x.uf_crm_1719234554494 as email_financeiro,
	x.uf_crm_1719234611470 as forma_pgto_implementacao,
	x.uf_crm_1719234653377 as forma_pgto_recorrencia,
	x.uf_crm_1719851689133 as vr_negociado_recorrencia,
	x.uf_crm_1719851724735 as vr_negociado_implementacao,
	x.uf_crm_1719942627227 as anexar_o_contrato,
	x.uf_crm_1720015348995 as contrato_do_setup,
	x.uf_crm_1720198477652 as valor_negociado_ativacao,
	x.uf_crm_1720198502628 as valor_negociado_integracao,
	x.uf_crm_1721083795801 as quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 as vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 as vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 as vr_transacionado_em_janeiro,
	x.uf_crm_1721083861185 as vr_transacionado_em_abril,
	x.uf_crm_1721083874978 as vr_transacionado_em_maio,
	x.uf_crm_1721083894608 as vr_transacionado_em_junho,
	x.uf_crm_1721083906720 as vr_transacionado_em_julho,
	x.uf_crm_1721226126 as modulo_do_sistema,
	x.uf_crm_1721227124 as ambiente,
	x.uf_crm_1721241190 as classificacao_do_atendimento,
	x.uf_crm_1721243220370 as area,
	x.uf_crm_1721243302036 as descricao,
	x.uf_crm_1721243367 as arquivos,
	x.uf_crm_1721244413245 as carro_chefe,
	x.uf_crm_1721244451568 as faturamento_medio_mensal,
	x.uf_crm_1721244493157 as qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 as vendedor_destaque,
	x.uf_crm_1721244560622 as pretende_estar_operando_em,
	x.uf_crm_1721244826264 as motivo_do_cancelamento,
	x.uf_crm_1721244999810 as o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 as tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 as data_do_churn,
	x.uf_crm_1724261215 as media_de_faturamento,
	x.uf_crm_1724264534445 as vr_transacionado_em_agosto,
	x.uf_crm_1725574177266 as id_asaas,
	x.uf_crm_1725574322 as status_do_pagamento,
	x.uf_crm_1725548469220 as data_solicitacao_upsell,
	x.uf_crm_1726002322164 as expectativa_com_o_projeto,
	x.uf_crm_1726003734 as status_do_projeto,
	x.uf_crm_1726007497 as vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 as vr_transacionado_em_outubro,
	x.uf_crm_1729086829554 as detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 as data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 as como_avalia_implantacao_bendito,
	x.uf_crm_1733168617374 as vr_transacionado_novembro,
	x.uf_crm_1733491265514 as novo_valor,
	x.uf_crm_1738931838 as cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 as quantidade_de_pedidos,
	x.uf_crm_1741275566502 as valor_faturado,
	x.uf_crm_1741275596050 as produto,
	x.uf_crm_1741275610428 as valor_vendido,
	x.uf_crm_1741275634394 as qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 as plano,
	x.uf_crm_deal_1725540405848 as tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 as tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 as expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 as pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 as qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 as ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 as conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 as tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 as como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 as email_da_pessoa_ponto_focal--,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
from
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
left join "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1
	on x.stage_id = x1.status_id
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2
	on x.assigned_by_id = x2."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3
	on x.moved_by_id = x3."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4
	on x.modify_by_id = x4."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5
	on x.created_by_id = x5."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6
	on x.last_activity_by = x6."id"
  );
  
[0m17:39:23.651092 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "vr_transacionado_em_janeiro" specified more than once

[0m17:39:23.653553 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: ROLLBACK
[0m17:39:23.805064 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m17:39:23.811773 [debug] [Thread-4 (]: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "vr_transacionado_em_janeiro" specified more than once
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m17:39:23.812853 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1709f891-d783-4091-b219-6fee53aee03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a50da0>]}
[0m17:39:23.813788 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model bitrix.btx_curated_deal .................. [[31mERROR[0m in 1.59s]
[0m17:39:23.814477 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m17:39:23.815357 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_curated_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "vr_transacionado_em_janeiro" specified more than once
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql.
[0m17:39:23.817338 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:23.817835 [debug] [MainThread]: On master: BEGIN
[0m17:39:23.818228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:25.036392 [debug] [MainThread]: SQL status: BEGIN in 1.217 seconds
[0m17:39:25.038828 [debug] [MainThread]: On master: COMMIT
[0m17:39:25.039933 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:25.041293 [debug] [MainThread]: On master: COMMIT
[0m17:39:25.200905 [debug] [MainThread]: SQL status: COMMIT in 0.158 seconds
[0m17:39:25.202925 [debug] [MainThread]: On master: Close
[0m17:39:25.204459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:25.205280 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:39:25.205777 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m17:39:25.206204 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m17:39:25.206602 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m17:39:25.207249 [info ] [MainThread]: 
[0m17:39:25.207786 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m17:39:25.209948 [debug] [MainThread]: Command end result
[0m17:39:25.289610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:39:25.290506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:39:25.293472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:39:25.293652 [info ] [MainThread]: 
[0m17:39:25.293837 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:39:25.293998 [info ] [MainThread]: 
[0m17:39:25.294256 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:39:25.294504 [info ] [MainThread]: 
[0m17:39:25.294718 [error] [MainThread]:   Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "vr_transacionado_em_janeiro" specified more than once
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m17:39:25.294874 [info ] [MainThread]: 
[0m17:39:25.295033 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m17:39:25.296846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.604257, "process_in_blocks": "0", "process_kernel_time": 0.255932, "process_mem_max_rss": "129368064", "process_out_blocks": "0", "process_user_time": 1.648424}
[0m17:39:25.297079 [debug] [MainThread]: Command `dbt run` failed at 17:39:25.297039 after 12.60 seconds
[0m17:39:25.297260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1001dad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30110>]}
[0m17:39:25.297448 [debug] [MainThread]: Flushing usage events
[0m17:39:26.081404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:17.126442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107929c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636b40>]}


============================== 17:43:17.129538 | 939bd0f0-d5cb-4a59-9f6c-246e152ed81a ==============================
[0m17:43:17.129538 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:43:17.129936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:43:17.226603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34a10>]}
[0m17:43:17.253139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b79b0>]}
[0m17:43:17.254045 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:43:17.312899 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:43:17.373539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:17.373928 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:43:17.495368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c739b0>]}
[0m17:43:17.528701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:43:17.531093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:43:17.541183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139a4860>]}
[0m17:43:17.541484 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m17:43:17.541670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139da390>]}
[0m17:43:17.542649 [info ] [MainThread]: 
[0m17:43:17.542887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:17.543048 [info ] [MainThread]: 
[0m17:43:17.543316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:43:17.545313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:43:17.573508 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:43:17.573746 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:43:17.573906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:18.817900 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.244 seconds
[0m17:43:18.819137 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:43:18.820371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m17:43:18.824547 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:43:18.824879 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m17:43:18.825098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:20.034093 [debug] [ThreadPool]: SQL status: BEGIN in 1.209 seconds
[0m17:43:20.034533 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:43:20.034779 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m17:43:20.186159 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.151 seconds
[0m17:43:20.188748 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m17:43:20.338092 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m17:43:20.350463 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:20.351153 [debug] [MainThread]: On master: BEGIN
[0m17:43:20.351555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:21.590643 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m17:43:21.591146 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:21.591508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:43:21.747241 [debug] [MainThread]: SQL status: SELECT 6 in 0.155 seconds
[0m17:43:21.753879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11425be30>]}
[0m17:43:21.754726 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:21.908809 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:21.911203 [debug] [MainThread]: On master: BEGIN
[0m17:43:22.230102 [debug] [MainThread]: SQL status: BEGIN in 0.318 seconds
[0m17:43:22.231009 [debug] [MainThread]: On master: COMMIT
[0m17:43:22.231533 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:22.231994 [debug] [MainThread]: On master: COMMIT
[0m17:43:22.383025 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:43:22.385745 [debug] [MainThread]: On master: Close
[0m17:43:22.393057 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:43:22.393668 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:43:22.394241 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:43:22.394943 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m17:43:22.395527 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:43:22.396154 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m17:43:22.396793 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m17:43:22.397431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:43:22.397991 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m17:43:22.398601 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:43:22.399120 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:43:22.399540 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:43:22.399957 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m17:43:22.400289 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:43:22.400608 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:43:22.408619 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:43:22.408973 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m17:43:22.412251 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:43:22.414360 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:22.416897 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:22.417734 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m17:43:22.425538 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:43:22.444651 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m17:43:22.447286 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:22.448672 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m17:43:22.448892 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m17:43:22.450675 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m17:43:22.452830 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:22.453295 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:22.453580 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:43:22.453825 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:43:22.454055 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:22.454368 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:22.454570 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m17:43:22.454768 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:22.454955 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m17:43:22.455138 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m17:43:22.455311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:22.455555 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:22.455746 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:43:23.658614 [debug] [Thread-1 (]: SQL status: BEGIN in 1.203 seconds
[0m17:43:23.659613 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:43:23.660306 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m17:43:23.696311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.240 seconds
[0m17:43:23.696723 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:23.697061 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m17:43:23.697682 [debug] [Thread-2 (]: SQL status: BEGIN in 1.242 seconds
[0m17:43:23.697935 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:23.698723 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m17:43:23.700681 [debug] [Thread-3 (]: SQL status: BEGIN in 1.246 seconds
[0m17:43:23.700980 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:23.701213 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m17:43:23.811869 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m17:43:23.812662 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m17:43:23.867038 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m17:43:23.879012 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.181 seconds
[0m17:43:23.879566 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:23.883711 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:23.884323 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m17:43:23.884755 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m17:43:23.889487 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.188 seconds
[0m17:43:23.893103 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:23.893485 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m17:43:23.960196 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m17:43:23.971068 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:43:23.974000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d91fa0>]}
[0m17:43:23.975116 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.57s]
[0m17:43:23.975772 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:43:23.976202 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:43:23.976744 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m17:43:23.977454 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m17:43:23.979003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m17:43:23.979424 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:43:23.982621 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:23.983822 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:43:23.986778 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:23.987482 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:23.987789 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:43:23.988060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:24.035401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:43:24.035827 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:43:24.039180 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:24.043278 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:24.043671 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m17:43:24.044021 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m17:43:24.051650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m17:43:24.054031 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:24.054364 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m17:43:24.206278 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.161 seconds
[0m17:43:24.215392 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.171 seconds
[0m17:43:24.221682 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.167 seconds
[0m17:43:24.233704 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:43:24.235355 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:43:24.236646 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:43:24.236983 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:24.237484 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:24.237794 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:24.238076 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:43:24.238443 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:43:24.238811 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:43:24.392407 [debug] [Thread-4 (]: SQL status: COMMIT in 0.151 seconds
[0m17:43:24.394651 [debug] [Thread-2 (]: SQL status: COMMIT in 0.155 seconds
[0m17:43:24.404448 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m17:43:24.406803 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m17:43:24.411904 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:43:24.412729 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:43:24.413121 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m17:43:24.413516 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m17:43:24.430532 [debug] [Thread-3 (]: SQL status: COMMIT in 0.191 seconds
[0m17:43:24.432818 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m17:43:24.433560 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:43:24.433924 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m17:43:24.566585 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m17:43:24.568232 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.154 seconds
[0m17:43:24.573222 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m17:43:24.575243 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m17:43:24.576324 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b03920>]}
[0m17:43:24.577385 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.18s]
[0m17:43:24.577903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142fc3b0>]}
[0m17:43:24.578602 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:43:24.579317 [info ] [Thread-2 (]: 2 of 8 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.18s]
[0m17:43:24.579889 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m17:43:24.580591 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:43:24.581092 [info ] [Thread-4 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m17:43:24.581518 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m17:43:24.581989 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_product)
[0m17:43:24.582422 [info ] [Thread-2 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m17:43:24.582800 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m17:43:24.583198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m17:43:24.586744 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m17:43:24.587159 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m17:43:24.590007 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m17:43:24.590398 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.156 seconds
[0m17:43:24.591828 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:43:24.592172 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m17:43:24.592587 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m17:43:24.595654 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m17:43:24.596033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11425b1a0>]}
[0m17:43:24.598450 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m17:43:24.599132 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.20s]
[0m17:43:24.599616 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:24.599991 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:43:24.600306 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m17:43:24.600580 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:24.600932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:43:24.601237 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m17:43:24.601592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:43:25.206141 [debug] [Thread-1 (]: SQL status: BEGIN in 1.217 seconds
[0m17:43:25.208550 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:25.209555 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m17:43:25.367356 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m17:43:25.372180 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:25.372710 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m17:43:25.522277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m17:43:25.526569 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:25.526915 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m17:43:25.676979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m17:43:25.683077 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:43:25.683964 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:25.684521 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:43:25.822406 [debug] [Thread-2 (]: SQL status: BEGIN in 1.220 seconds
[0m17:43:25.824557 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:25.825636 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID"::int2 as id,
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m17:43:25.829005 [debug] [Thread-4 (]: SQL status: BEGIN in 1.228 seconds
[0m17:43:25.829615 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:25.830232 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m17:43:25.836260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m17:43:25.841263 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m17:43:25.842547 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:43:25.843130 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m17:43:25.994970 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m17:43:25.996022 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.169 seconds
[0m17:43:25.996622 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.153 seconds
[0m17:43:26.002791 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:26.006731 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:26.008333 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:43:26.008815 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m17:43:26.009249 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m17:43:26.010266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11422e4e0>]}
[0m17:43:26.010978 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.03s]
[0m17:43:26.011557 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:43:26.162261 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m17:43:26.163583 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m17:43:26.169465 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:26.172840 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:26.173514 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m17:43:26.173993 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m17:43:26.323808 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m17:43:26.325383 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m17:43:26.328768 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:43:26.331197 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:43:26.331814 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:26.332338 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:26.332754 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:43:26.333157 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:43:26.486818 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m17:43:26.488467 [debug] [Thread-4 (]: SQL status: COMMIT in 0.155 seconds
[0m17:43:26.492189 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m17:43:26.494676 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m17:43:26.495550 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:43:26.496353 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:43:26.496774 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m17:43:26.497198 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m17:43:26.649178 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m17:43:26.650918 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m17:43:26.653720 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m17:43:26.655506 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m17:43:26.656822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114648050>]}
[0m17:43:26.657520 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11425bfe0>]}
[0m17:43:26.658367 [info ] [Thread-2 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.07s]
[0m17:43:26.659166 [info ] [Thread-4 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.08s]
[0m17:43:26.659875 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m17:43:26.660443 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m17:43:26.661212 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m17:43:26.661820 [info ] [Thread-4 (]: 8 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m17:43:26.662327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_product, now model.bdt_transformations.btx_curated_deal)
[0m17:43:26.662745 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m17:43:26.668120 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m17:43:26.671768 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m17:43:26.688712 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m17:43:26.689912 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:43:26.690184 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m17:43:26.690417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:43:27.966962 [debug] [Thread-4 (]: SQL status: BEGIN in 1.276 seconds
[0m17:43:27.969472 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:43:27.971459 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
select
	x.id,
	x.title as titulo,
	x1.name as estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity as mrr,
	x.company_id,
	x.contact_id,
	x2.name as atribuido_por,
	x.opened as aberto,
	x.begin_date as data_de_inicio,
	x.closed as encerrado,
	x.close_date as data_de_encerramento,
	x.date_create as criado_em,
	x5.name as criado_por,
	x.date_modify as modificado_em,
	x4.name as modificdo_por,
	x.moved_time as movido_em,
	x3.name as movido_por,
	x.last_activity_time as ultima_atividade_em,
	x6.name as ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id as id_lead,
	x.type_id as id_tipo,
	x.comments as comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id as moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring as recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 as quantidade_de_usuarios,
	x.uf_crm_1718893063318 as ponto_focal,
	x.uf_crm_1721248408791 as email_ponto_focal,
	x.uf_crm_1718895613676 as erp,
	x.uf_crm_1718895632531 as segmento,
	x.uf_crm_1718895837277 as perfil,
	x.uf_crm_1719234554494 as email_financeiro,
	x.uf_crm_1719234611470 as forma_pgto_implementacao,
	x.uf_crm_1719234653377 as forma_pgto_recorrencia,
	x.uf_crm_1719851689133 as vr_negociado_recorrencia,
	x.uf_crm_1719851724735 as vr_negociado_implementacao,
	x.uf_crm_1719942627227 as anexar_o_contrato,
	x.uf_crm_1720015348995 as contrato_do_setup,
	x.uf_crm_1720198477652 as valor_negociado_ativacao,
	x.uf_crm_1720198502628 as valor_negociado_integracao,
	x.uf_crm_1721083795801 as quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 as vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 as vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 as vr_transacionado_em_marco,
	x.uf_crm_1721083861185 as vr_transacionado_em_abril,
	x.uf_crm_1721083874978 as vr_transacionado_em_maio,
	x.uf_crm_1721083894608 as vr_transacionado_em_junho,
	x.uf_crm_1721083906720 as vr_transacionado_em_julho,
	x.uf_crm_1724264534445 as vr_transacionado_em_agosto,
	x.uf_crm_1726007497 as vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 as vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 as vr_transacionado_novembro,
	x.uf_crm_1721226126 as modulo_do_sistema,
	x.uf_crm_1721227124 as ambiente,
	x.uf_crm_1721241190 as classificacao_do_atendimento,
	x.uf_crm_1721243220370 as area,
	x.uf_crm_1721243302036 as descricao,
	x.uf_crm_1721243367 as arquivos,
	x.uf_crm_1721244413245 as carro_chefe,
	x.uf_crm_1721244451568 as faturamento_medio_mensal,
	x.uf_crm_1721244493157 as qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 as vendedor_destaque,
	x.uf_crm_1721244560622 as pretende_estar_operando_em,
	x.uf_crm_1721244826264 as motivo_do_cancelamento,
	x.uf_crm_1721244999810 as o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 as tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 as data_do_churn,
	x.uf_crm_1724261215 as media_de_faturamento,
	x.uf_crm_1725574177266 as id_asaas,
	x.uf_crm_1725574322 as status_do_pagamento,
	x.uf_crm_1725548469220 as data_solicitacao_upsell,
	x.uf_crm_1726002322164 as expectativa_com_o_projeto,
	x.uf_crm_1726003734 as status_do_projeto,
	x.uf_crm_1729086829554 as detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 as data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 as como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 as novo_valor,
	x.uf_crm_1738931838 as cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 as quantidade_de_pedidos,
	x.uf_crm_1741275566502 as valor_faturado,
	x.uf_crm_1741275596050 as produto,
	x.uf_crm_1741275610428 as valor_vendido,
	x.uf_crm_1741275634394 as qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 as plano,
	x.uf_crm_deal_1725540405848 as tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 as tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 as expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 as pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 as qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 as ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 as conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 as tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 as como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 as email_da_pessoa_ponto_focal--,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
from
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
left join "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1
	on x.stage_id = x1.status_id
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2
	on x.assigned_by_id = x2."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3
	on x.moved_by_id = x3."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4
	on x.modify_by_id = x4."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5
	on x.created_by_id = x5."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6
	on x.last_activity_by = x6."id"
  );
  
[0m17:43:28.253229 [debug] [Thread-4 (]: SQL status: SELECT 226 in 0.274 seconds
[0m17:43:28.258933 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:43:28.259472 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m17:43:28.413899 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:43:28.423724 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m17:43:28.424397 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:43:28.424841 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m17:43:28.583630 [debug] [Thread-4 (]: SQL status: COMMIT in 0.158 seconds
[0m17:43:28.595165 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m17:43:28.599123 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:43:28.599649 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m17:43:28.748812 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.149 seconds
[0m17:43:28.750278 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m17:43:28.750975 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939bd0f0-d5cb-4a59-9f6c-246e152ed81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114683e30>]}
[0m17:43:28.751488 [info ] [Thread-4 (]: 8 of 8 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.09s]
[0m17:43:28.751894 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m17:43:28.752915 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:28.753211 [debug] [MainThread]: On master: BEGIN
[0m17:43:28.753409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:29.984073 [debug] [MainThread]: SQL status: BEGIN in 1.230 seconds
[0m17:43:29.986595 [debug] [MainThread]: On master: COMMIT
[0m17:43:29.987273 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:29.987910 [debug] [MainThread]: On master: COMMIT
[0m17:43:30.141820 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m17:43:30.144310 [debug] [MainThread]: On master: Close
[0m17:43:30.146050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:30.146788 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:43:30.147255 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m17:43:30.147661 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_stage' was properly closed.
[0m17:43:30.148111 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m17:43:30.148829 [info ] [MainThread]: 
[0m17:43:30.149366 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m17:43:30.151191 [debug] [MainThread]: Command end result
[0m17:43:30.227155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:43:30.228149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:43:30.231069 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:43:30.231249 [info ] [MainThread]: 
[0m17:43:30.231433 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:43:30.231584 [info ] [MainThread]: 
[0m17:43:30.231789 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:43:30.231965 [info ] [MainThread]: 
[0m17:43:30.232133 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:43:30.233859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.1404705, "process_in_blocks": "0", "process_kernel_time": 0.256619, "process_mem_max_rss": "128925696", "process_out_blocks": "0", "process_user_time": 1.648764}
[0m17:43:30.234129 [debug] [MainThread]: Command `dbt run` failed at 17:43:30.234086 after 13.14 seconds
[0m17:43:30.234328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107929c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ab2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146af9b0>]}
[0m17:43:30.234514 [debug] [MainThread]: Flushing usage events
[0m17:43:31.407242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:29.543451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106950740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111736ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111736c30>]}


============================== 17:45:29.546716 | ababb47a-8ea4-41ae-8529-335835d60a2e ==============================
[0m17:45:29.546716 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:45:29.547065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:29.645373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f4e30>]}
[0m17:45:29.672923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbc2f0>]}
[0m17:45:29.673739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:45:29.733207 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:45:29.795305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:29.795594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:29.812533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c45c0>]}
[0m17:45:29.846773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:45:29.848894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:45:29.860729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f4b30>]}
[0m17:45:29.861072 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m17:45:29.861270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c1a870>]}
[0m17:45:29.862287 [info ] [MainThread]: 
[0m17:45:29.862510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:29.862657 [info ] [MainThread]: 
[0m17:45:29.862927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:29.865019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:45:29.894167 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:45:29.894447 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:45:29.894626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:31.139774 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.245 seconds
[0m17:45:31.142510 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:45:31.145092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m17:45:31.152217 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:45:31.152644 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m17:45:31.152967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:32.380724 [debug] [ThreadPool]: SQL status: BEGIN in 1.227 seconds
[0m17:45:32.381736 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:45:32.382283 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m17:45:32.534363 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.152 seconds
[0m17:45:32.535531 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m17:45:32.683850 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m17:45:32.689222 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:32.689551 [debug] [MainThread]: On master: BEGIN
[0m17:45:32.689754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:33.925385 [debug] [MainThread]: SQL status: BEGIN in 1.236 seconds
[0m17:45:33.925979 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:33.926393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:34.085095 [debug] [MainThread]: SQL status: SELECT 6 in 0.158 seconds
[0m17:45:34.091056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f6de0>]}
[0m17:45:34.091993 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:34.242970 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.243919 [debug] [MainThread]: On master: BEGIN
[0m17:45:34.544659 [debug] [MainThread]: SQL status: BEGIN in 0.300 seconds
[0m17:45:34.545158 [debug] [MainThread]: On master: COMMIT
[0m17:45:34.545434 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.545678 [debug] [MainThread]: On master: COMMIT
[0m17:45:34.697645 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m17:45:34.698060 [debug] [MainThread]: On master: Close
[0m17:45:34.701181 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:45:34.701511 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:45:34.701979 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:45:34.702258 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:45:34.702667 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m17:45:34.703097 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m17:45:34.703482 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m17:45:34.703828 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m17:45:34.704136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m17:45:34.704435 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:45:34.704767 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:45:34.705112 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m17:45:34.705395 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:45:34.705622 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:45:34.705828 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:45:34.706022 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m17:45:34.711769 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:45:34.714273 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:45:34.716076 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:34.717624 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:34.719459 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:45:34.719753 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m17:45:34.719993 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m17:45:34.720173 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m17:45:34.739449 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:34.741375 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m17:45:34.743171 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m17:45:34.744711 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:34.745437 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:34.745687 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m17:45:34.745956 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:34.746199 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:34.746479 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:45:34.746709 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:34.746939 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:45:34.747231 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m17:45:34.747431 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m17:45:34.747615 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:34.747793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:34.747978 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:35.955039 [debug] [Thread-2 (]: SQL status: BEGIN in 1.209 seconds
[0m17:45:35.957936 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:35.959258 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m17:45:35.965676 [debug] [Thread-3 (]: SQL status: BEGIN in 1.218 seconds
[0m17:45:35.966102 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:35.966488 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'STATUS_ID')::varchar as status_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m17:45:35.973645 [debug] [Thread-4 (]: SQL status: BEGIN in 1.226 seconds
[0m17:45:35.974401 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:35.975013 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    

select 

	"ID"::int4 as id,
	("CONTENT"->>'FIELD_NAME')::varchar as field_name,
	(("CONTENT"->>'EDIT_FORM_LABEL')::jsonb)->>'br' as friendly_name,

	jsonb_path_query_array(replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb, '$[*].VALUE') as options,

  	replace(
  		replace("CONTENT"->>'LIST','''','"'),
  		'None',
  		'null')::jsonb as list,

  	("CONTENT"->>'SORT')::int2 as sort,
  	("CONTENT"->>'XML_ID')::text as xml_id,
  	("CONTENT"->>'MULTIPLE')::bool as multiple,

  	replace(
  		replace("CONTENT"->>'SETTINGS','''','"'),
  		'None',
  		'null'
  	)::jsonb as settings,
  	("CONTENT"->>'ENTITY_ID')::varchar as entity_id,
  	("CONTENT"->>'MANDATORY')::bool as mandatory,
  	("CONTENT"->>'SHOW_FILTER')::varchar as show_filter,
  	("CONTENT"->>'EDIT_IN_LIST')::bool as edit_in_list,
  	("CONTENT"->>'SHOW_IN_LIST')::bool as show_in_list,
  	("CONTENT"->>'USER_TYPE_ID')::varchar as user_type_id,
  	("CONTENT"->>'IS_SEARCHABLE')::bool as is_searchable,
	("CONTENT"->>'EDIT_FORM_LABEL')::jsonb as edit_form_label,
	("CONTENT"->>'ERROR_MESSAGE')::jsonb as error_message,
	("CONTENT"->>'HELP_MESSAGE')::jsonb as help_message,
	("CONTENT"->>'LIST_COLUMN_LABEL')::jsonb as list_column_label,
	("CONTENT"->>'LIST_FILTER_LABEL')::jsonb as list_filter_label
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE "SUCCESS" = true
  );
[0m17:45:35.981457 [debug] [Thread-1 (]: SQL status: BEGIN in 1.233 seconds
[0m17:45:35.982261 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:45:35.982870 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'SUBJECT')::varchar as subject,
  ("CONTENT"->>'DESCRIPTION')::varchar as description,
  ("CONTENT"->>'TYPE_ID')::varchar as type_id,
  ("CONTENT"->>'PROVIDER_ID')::varchar as provider_id,
  ("CONTENT"->>'PROVIDER_TYPE_ID')::varchar as provider_type_id,
  ("CONTENT"->>'PRIORITY')::varchar as priority,
  ("CONTENT"->>'OWNER_ID')::integer as owner_id,
  ("CONTENT"->>'OWNER_TYPE_ID')::varchar as owner_type_id,
  ("CONTENT"->>'RESPONSIBLE_ID')::integer as responsible_id,
  ("CONTENT"->>'COMPLETED')::boolean as completed,
  ("CONTENT"->>'STATUS')::integer as status,
  ("CONTENT"->>'CREATED')::timestamp as created,
  ("CONTENT"->>'LAST_UPDATED')::timestamp as last_updated
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE "SUCCESS" = true
  );
[0m17:45:36.125642 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m17:45:36.131552 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:36.131967 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m17:45:36.132358 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m17:45:36.135444 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:36.135813 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
              ^

[0m17:45:36.136262 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m17:45:36.136547 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m17:45:36.138428 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m17:45:36.140500 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:36.140829 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m17:45:36.285052 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m17:45:36.288597 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:36.289016 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m17:45:36.289613 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:45:36.291966 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:36.292453 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m17:45:36.292814 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m17:45:36.293184 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m17:45:36.295570 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:36.296990 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m17:45:36.303613 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:45:36.305127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eeff0>]}
[0m17:45:36.305618 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.60s]
[0m17:45:36.306037 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:45:36.306320 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:45:36.306659 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m17:45:36.307009 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m17:45:36.307841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m17:45:36.308250 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:45:36.310218 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:36.311043 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:45:36.313276 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:36.313707 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:36.313930 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:45:36.314133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:36.439233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:45:36.456392 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m17:45:36.458029 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:45:36.458384 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.161 seconds
[0m17:45:36.459763 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:45:36.460099 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:36.461258 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:45:36.461552 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:36.461878 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m17:45:36.462207 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:36.462531 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m17:45:36.462878 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m17:45:36.612514 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m17:45:36.618215 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m17:45:36.618598 [debug] [Thread-4 (]: SQL status: COMMIT in 0.155 seconds
[0m17:45:36.622742 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:45:36.623118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.160 seconds
[0m17:45:36.624900 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m17:45:36.625252 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m17:45:36.626775 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m17:45:36.627294 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:45:36.627881 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:45:36.628169 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m17:45:36.628434 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m17:45:36.779318 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m17:45:36.779869 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.151 seconds
[0m17:45:36.780313 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m17:45:36.783264 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m17:45:36.784751 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:45:36.785795 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m17:45:36.787142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c6f00>]}
[0m17:45:36.787620 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11290a6f0>]}
[0m17:45:36.787920 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296fb90>]}
[0m17:45:36.788482 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.08s]
[0m17:45:36.788968 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.08s]
[0m17:45:36.789410 [info ] [Thread-2 (]: 2 of 8 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.08s]
[0m17:45:36.789847 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:45:36.790225 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:45:36.790872 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:45:36.791277 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m17:45:36.791673 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_user
[0m17:45:36.792110 [info ] [Thread-3 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m17:45:36.792442 [info ] [Thread-4 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m17:45:36.792758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m17:45:36.793021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m17:45:36.793276 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m17:45:36.793504 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m17:45:36.795779 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m17:45:36.799164 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m17:45:36.800431 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m17:45:36.802914 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m17:45:36.803221 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m17:45:36.805314 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m17:45:36.805703 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:36.805969 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m17:45:36.806190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:36.806423 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:36.806733 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m17:45:36.806941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:37.529414 [debug] [Thread-1 (]: SQL status: BEGIN in 1.215 seconds
[0m17:45:37.529822 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:37.530095 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID" as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'SORT')::int4 as sort,
  ("CONTENT"->>'CREATED_DATE')::timestamp as created_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE "SUCCESS" = true
  );
[0m17:45:37.686141 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.156 seconds
[0m17:45:37.689210 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:37.689606 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m17:45:37.838949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m17:45:37.842124 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:37.842465 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m17:45:37.991205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m17:45:37.993577 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:45:37.994075 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:37.994435 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m17:45:38.033107 [debug] [Thread-3 (]: SQL status: BEGIN in 1.227 seconds
[0m17:45:38.033843 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:38.034411 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    

SELECT 
  "ID"::int4 as id,
  ("CONTENT"->>'NAME')::varchar as name,
  ("CONTENT"->>'CREATED_BY')::int2 as created_by,
  ("CONTENT"->>'DATE_CREATE')::timestamptz as date_create,
  ("CONTENT"->>'MODIFIED_BY')::int2 as modified_by,
  ("CONTENT"->>'ACTIVE')::bool as active,
  ("CONTENT"->>'CATALOG_ID')::int2 as catalog_id,
  ("CONTENT"->>'CODE')::varchar as code,
  ("CONTENT"->>'CURRENCY_ID')::varchar as currency_id,
  ("CONTENT"->>'DESCRIPTION')::text as description,
  ("CONTENT"->>'DESCRIPTION_TYPE')::varchar as description_type,
  ("CONTENT"->>'DETAIL_PICTURE')::text as detail_picture,
  ("CONTENT"->>'PREVIEW_PICTURE')::text as preview_picture,
  ("CONTENT"->>'MEASURE')::int2 as measure,
  ("CONTENT"->>'PRICE')::numeric as price,
  ("CONTENT"->>'PROPERTY_45')::text as property_45,
  ("CONTENT"->>'SECTION_ID')::varchar as section_id,
  ("CONTENT"->>'SORT')::int2 as sort,
  ("CONTENT"->>'TIMESTAMP_X')::timestamptz as timestamp_x,
  ("CONTENT"->>'VAT_ID')::int2 as vat_id,
  ("CONTENT"->>'VAT_INCLUDED')::bool as vat_included,
  ("CONTENT"->>'XML_ID')::int2 as xml_id
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE "SUCCESS" = true
  );
[0m17:45:38.041909 [debug] [Thread-4 (]: SQL status: BEGIN in 1.235 seconds
[0m17:45:38.042534 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:38.043176 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    

select "ID"::int2 as id,
	  ("CONTENT"->>'NAME')::varchar as name,
	  ("CONTENT"->>'LAST_NAME')::varchar as last_name,
	  ("CONTENT"->>'EMAIL')::varchar as email,
	  ("CONTENT"->>'ACTIVE')::bool as active,
	  ("CONTENT"->>'XML_ID')::varchar as xml_id,
	  ("CONTENT"->>'IS_ONLINE')::bool as is_online,
	  ("CONTENT"->>'TIME_ZONE')::varchar as time_zone,
	  ("CONTENT"->>'USER_TYPE')::varchar as user_type,
	  ("CONTENT"->>'LAST_LOGIN')::timestamptz as last_login,
	  ("CONTENT"->>'WORK_PHONE')::varchar as work_phone,
	  ("CONTENT"->>'TIMESTAMP_X')::jsonb as timestamp_x,
	  ("CONTENT"->>'PERSONAL_WWW')::varchar as personal_www,
	  ("CONTENT"->>'DATE_REGISTER')::timestamptz as date_register,
	  ("CONTENT"->>'PERSONAL_CITY')::varchar as personal_city,
	  ("CONTENT"->>'UF_DEPARTMENT')::json as uf_department,
	  ("CONTENT"->>'WORK_POSITION')::varchar as work_position,
	  ("CONTENT"->>'PERSONAL_PHOTO')::text as personal_photo,
	  ("CONTENT"->>'UF_PHONE_INNER')::int2 as uf_phone_number,
	  ("CONTENT"->>'PERSONAL_GENDER')::varchar as personal_gender,
	  ("CONTENT"->>'PERSONAL_MOBILE')::varchar as personal_mobile,
	  ("CONTENT"->>'TIME_ZONE_OFFSET')::int4 as time_zone_offset,
	  ("CONTENT"->>'PERSONAL_BIRTHDAY')::varchar as personal_birthday,
	  ("CONTENT"->>'LAST_ACTIVITY_DATE')::jsonb as last_activity_date,
	  ("CONTENT"->>'UF_EMPLOYMENT_DATE')::varchar as uf_employment_date
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE "SUCCESS" = true
  );
[0m17:45:38.145244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m17:45:38.149730 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m17:45:38.151123 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:45:38.151648 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m17:45:38.204733 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m17:45:38.210624 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:38.211257 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m17:45:38.211754 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m17:45:38.215889 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:38.216595 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m17:45:38.314993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.162 seconds
[0m17:45:38.319505 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:45:38.321020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c778c0>]}
[0m17:45:38.322072 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.01s]
[0m17:45:38.322916 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:45:38.366568 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:45:38.370621 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:38.371125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m17:45:38.371596 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m17:45:38.374761 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:38.375575 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m17:45:38.525005 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:45:38.527685 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:45:38.528161 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:38.528531 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m17:45:38.530533 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m17:45:38.532456 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:45:38.533075 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:38.533403 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m17:45:38.684945 [debug] [Thread-3 (]: SQL status: COMMIT in 0.156 seconds
[0m17:45:38.687871 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m17:45:38.688217 [debug] [Thread-4 (]: SQL status: COMMIT in 0.155 seconds
[0m17:45:38.688910 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:45:38.692298 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m17:45:38.692679 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m17:45:38.693232 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:45:38.693687 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m17:45:38.847754 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.154 seconds
[0m17:45:38.850014 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m17:45:38.851034 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cb8cb0>]}
[0m17:45:38.851746 [info ] [Thread-3 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.06s]
[0m17:45:38.852326 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m17:45:38.852732 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.159 seconds
[0m17:45:38.854249 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: Close
[0m17:45:38.854997 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cde960>]}
[0m17:45:38.855597 [info ] [Thread-4 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.06s]
[0m17:45:38.856312 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m17:45:38.857148 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m17:45:38.857729 [info ] [Thread-2 (]: 8 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m17:45:38.858124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_curated_deal)
[0m17:45:38.858445 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m17:45:38.863081 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m17:45:38.866138 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m17:45:38.882102 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m17:45:38.883343 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:38.883676 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m17:45:38.883902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:40.126498 [debug] [Thread-2 (]: SQL status: BEGIN in 1.242 seconds
[0m17:45:40.129289 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:40.131087 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
select
	x.id,
	x.title as titulo,
	x1.name as estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity as mrr,
	x.company_id,
	x.contact_id,
	x2.name as atribuido_por,
	x.opened as aberto,
	x.begin_date as data_de_inicio,
	x.closed as encerrado,
	x.close_date as data_de_encerramento,
	x.date_create as criado_em,
	x5.name as criado_por,
	x.date_modify as modificado_em,
	x4.name as modificdo_por,
	x.moved_time as movido_em,
	x3.name as movido_por,
	x.last_activity_time as ultima_atividade_em,
	x6.name as ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id as id_lead,
	x.type_id as id_tipo,
	x.comments as comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id as moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring as recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 as quantidade_de_usuarios,
	x.uf_crm_1718893063318 as ponto_focal,
	x.uf_crm_1721248408791 as email_ponto_focal,
	x.uf_crm_1718895613676 as erp,
	x.uf_crm_1718895632531 as segmento,
	x.uf_crm_1718895837277 as perfil,
	x.uf_crm_1719234554494 as email_financeiro,
	x.uf_crm_1719234611470 as forma_pgto_implementacao,
	x.uf_crm_1719234653377 as forma_pgto_recorrencia,
	x.uf_crm_1719851689133 as vr_negociado_recorrencia,
	x.uf_crm_1719851724735 as vr_negociado_implementacao,
	x.uf_crm_1719942627227 as anexar_o_contrato,
	x.uf_crm_1720015348995 as contrato_do_setup,
	x.uf_crm_1720198477652 as valor_negociado_ativacao,
	x.uf_crm_1720198502628 as valor_negociado_integracao,
	x.uf_crm_1721083795801 as quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 as vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 as vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 as vr_transacionado_em_marco,
	x.uf_crm_1721083861185 as vr_transacionado_em_abril,
	x.uf_crm_1721083874978 as vr_transacionado_em_maio,
	x.uf_crm_1721083894608 as vr_transacionado_em_junho,
	x.uf_crm_1721083906720 as vr_transacionado_em_julho,
	x.uf_crm_1724264534445 as vr_transacionado_em_agosto,
	x.uf_crm_1726007497 as vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 as vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 as vr_transacionado_novembro,
	x.uf_crm_1721226126 as modulo_do_sistema,
	x.uf_crm_1721227124 as ambiente,
	x.uf_crm_1721241190 as classificacao_do_atendimento,
	x.uf_crm_1721243220370 as area,
	x.uf_crm_1721243302036 as descricao,
	x.uf_crm_1721243367 as arquivos,
	x.uf_crm_1721244413245 as carro_chefe,
	x.uf_crm_1721244451568 as faturamento_medio_mensal,
	x.uf_crm_1721244493157 as qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 as vendedor_destaque,
	x.uf_crm_1721244560622 as pretende_estar_operando_em,
	x.uf_crm_1721244826264 as motivo_do_cancelamento,
	x.uf_crm_1721244999810 as o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 as tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 as data_do_churn,
	x.uf_crm_1724261215 as media_de_faturamento,
	x.uf_crm_1725574177266 as id_asaas,
	x.uf_crm_1725574322 as status_do_pagamento,
	x.uf_crm_1725548469220 as data_solicitacao_upsell,
	x.uf_crm_1726002322164 as expectativa_com_o_projeto,
	x.uf_crm_1726003734 as status_do_projeto,
	x.uf_crm_1729086829554 as detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 as data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 as como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 as novo_valor,
	x.uf_crm_1738931838 as cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 as quantidade_de_pedidos,
	x.uf_crm_1741275566502 as valor_faturado,
	x.uf_crm_1741275596050 as produto,
	x.uf_crm_1741275610428 as valor_vendido,
	x.uf_crm_1741275634394 as qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 as plano,
	x.uf_crm_deal_1725540405848 as tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 as tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 as expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 as pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 as qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 as ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 as conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 as tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 as como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 as email_da_pessoa_ponto_focal--,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
from
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
left join "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1
	on x.stage_id = x1.status_id
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2
	on x.assigned_by_id = x2."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3
	on x.moved_by_id = x3."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4
	on x.modify_by_id = x4."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5
	on x.created_by_id = x5."id"
left join "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6
	on x.last_activity_by = x6."id"
  );
  
[0m17:45:40.391494 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.259 seconds
[0m17:45:40.395794 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:40.396307 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m17:45:40.549872 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:45:40.553814 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:40.554331 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m17:45:40.708168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m17:45:40.743297 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m17:45:40.753063 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:40.755490 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m17:45:40.919715 [debug] [Thread-2 (]: SQL status: COMMIT in 0.155 seconds
[0m17:45:40.932984 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m17:45:40.942985 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:45:40.944490 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m17:45:41.100927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.156 seconds
[0m17:45:41.102125 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m17:45:41.102641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ababb47a-8ea4-41ae-8529-335835d60a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112944d40>]}
[0m17:45:41.102995 [info ] [Thread-2 (]: 8 of 8 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.24s]
[0m17:45:41.103289 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m17:45:41.104120 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:41.104341 [debug] [MainThread]: On master: BEGIN
[0m17:45:41.104510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:42.342022 [debug] [MainThread]: SQL status: BEGIN in 1.237 seconds
[0m17:45:42.344808 [debug] [MainThread]: On master: COMMIT
[0m17:45:42.346139 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:42.347185 [debug] [MainThread]: On master: COMMIT
[0m17:45:42.503314 [debug] [MainThread]: SQL status: COMMIT in 0.155 seconds
[0m17:45:42.504037 [debug] [MainThread]: On master: Close
[0m17:45:42.504961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:42.505285 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:45:42.505533 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m17:45:42.505759 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m17:45:42.505962 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m17:45:42.506352 [info ] [MainThread]: 
[0m17:45:42.506659 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.64 seconds (12.64s).
[0m17:45:42.507898 [debug] [MainThread]: Command end result
[0m17:45:42.525689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:45:42.529696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:45:42.534035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:45:42.534273 [info ] [MainThread]: 
[0m17:45:42.534495 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:45:42.534679 [info ] [MainThread]: 
[0m17:45:42.534900 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24: from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
                ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:45:42.535075 [info ] [MainThread]: 
[0m17:45:42.535257 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:45:42.537026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.028709, "process_in_blocks": "0", "process_kernel_time": 0.251809, "process_mem_max_rss": "125714432", "process_out_blocks": "0", "process_user_time": 1.375276}
[0m17:45:42.537318 [debug] [MainThread]: Command `dbt run` failed at 17:45:42.537268 after 13.03 seconds
[0m17:45:42.537563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111736f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111736ff0>]}
[0m17:45:42.537780 [debug] [MainThread]: Flushing usage events
[0m17:45:43.463138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:38.659378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11092b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36b40>]}


============================== 17:57:38.662545 | 83cd0b45-b312-4257-a40e-4f9a23236853 ==============================
[0m17:57:38.662545 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:57:38.662927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m17:57:38.752979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5db50>]}
[0m17:57:38.778296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5f020>]}
[0m17:57:38.779099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:57:38.840250 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m17:57:38.899182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m17:57:38.899583 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_userfields.sql
[0m17:57:38.899794 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_product.sql
[0m17:57:38.899980 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m17:57:38.900157 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m17:57:38.900333 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m17:57:38.900507 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m17:57:38.900678 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m17:57:38.900846 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m17:57:39.023024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112499700>]}
[0m17:57:39.054927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:57:39.057006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:57:39.068192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123bd700>]}
[0m17:57:39.068477 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m17:57:39.068658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11246fec0>]}
[0m17:57:39.069545 [info ] [MainThread]: 
[0m17:57:39.069744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:39.069887 [info ] [MainThread]: 
[0m17:57:39.070137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:57:39.072161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m17:57:39.099834 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m17:57:39.100077 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m17:57:39.100238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:40.378176 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.278 seconds
[0m17:57:40.380358 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m17:57:40.382470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m17:57:40.389008 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:57:40.389432 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m17:57:40.389703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:41.599237 [debug] [ThreadPool]: SQL status: BEGIN in 1.209 seconds
[0m17:57:41.601657 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m17:57:41.602707 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m17:57:41.769372 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.165 seconds
[0m17:57:41.775058 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m17:57:41.924282 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m17:57:41.937258 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:41.937842 [debug] [MainThread]: On master: BEGIN
[0m17:57:41.938207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:43.158127 [debug] [MainThread]: SQL status: BEGIN in 1.219 seconds
[0m17:57:43.160476 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:43.161458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:57:43.327246 [debug] [MainThread]: SQL status: SELECT 6 in 0.164 seconds
[0m17:57:43.334155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e0b30>]}
[0m17:57:43.335133 [debug] [MainThread]: On master: ROLLBACK
[0m17:57:43.485157 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:43.486077 [debug] [MainThread]: On master: BEGIN
[0m17:57:43.780982 [debug] [MainThread]: SQL status: BEGIN in 0.294 seconds
[0m17:57:43.781422 [debug] [MainThread]: On master: COMMIT
[0m17:57:43.781654 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:43.781846 [debug] [MainThread]: On master: COMMIT
[0m17:57:43.929439 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m17:57:43.930705 [debug] [MainThread]: On master: Close
[0m17:57:43.937483 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m17:57:43.938168 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m17:57:43.938991 [info ] [Thread-1 (]: 1 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m17:57:43.939457 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m17:57:43.939871 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m17:57:43.940425 [info ] [Thread-2 (]: 2 of 8 START sql table model bitrix.btx_processed_activity ..................... [RUN]
[0m17:57:43.941015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_curated_deal)
[0m17:57:43.941551 [info ] [Thread-3 (]: 3 of 8 START sql table model bitrix.btx_processed_deal ......................... [RUN]
[0m17:57:43.942077 [info ] [Thread-4 (]: 4 of 8 START sql table model bitrix.btx_processed_deal_stage ................... [RUN]
[0m17:57:43.942609 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_activity'
[0m17:57:43.943018 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m17:57:43.943476 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m17:57:43.943943 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m17:57:43.944324 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m17:57:43.950608 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m17:57:43.950993 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m17:57:43.951324 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m17:57:43.952735 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m17:57:43.954241 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m17:57:43.955491 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:57:43.956089 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m17:57:43.968692 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m17:57:43.969016 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m17:57:43.975659 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m17:57:43.986578 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m17:57:43.988218 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m17:57:43.990268 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m17:57:43.991918 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m17:57:43.992559 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:57:43.992935 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m17:57:43.993361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:43.993652 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:57:43.993897 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:57:43.994194 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:57:43.994410 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m17:57:43.994623 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m17:57:43.994811 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m17:57:43.994989 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:57:43.995177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:43.995355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:57:45.216089 [debug] [Thread-1 (]: SQL status: BEGIN in 1.223 seconds
[0m17:57:45.216683 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m17:57:45.217270 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    { { config(
	materialized = 'table',
	unique_key = 'id',
) } }
SELECT
	x.id,
	x.title AS titulo,
	x1.name AS estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity AS mrr,
	x.company_id,
	x.contact_id,
	x2.name AS atribuido_por,
	x.opened AS aberto,
	x.begin_date AS data_de_inicio,
	x.closed AS encerrado,
	x.close_date AS data_de_encerramento,
	x.date_create AS criado_em,
	x5.name AS criado_por,
	x.date_modify AS modificado_em,
	x4.name AS modificdo_por,
	x.moved_time AS movido_em,
	x3.name AS movido_por,
	x.last_activity_time AS ultima_atividade_em,
	x6.name AS ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id AS id_lead,
	x.type_id AS id_tipo,
	x.comments AS comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id AS moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring AS recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 AS quantidade_de_usuarios,
	x.uf_crm_1718893063318 AS ponto_focal,
	x.uf_crm_1721248408791 AS email_ponto_focal,
	x.uf_crm_1718895613676 AS erp,
	x.uf_crm_1718895632531 AS segmento,
	x.uf_crm_1718895837277 AS perfil,
	x.uf_crm_1719234554494 AS email_financeiro,
	x.uf_crm_1719234611470 AS forma_pgto_implementacao,
	x.uf_crm_1719234653377 AS forma_pgto_recorrencia,
	x.uf_crm_1719851689133 AS vr_negociado_recorrencia,
	x.uf_crm_1719851724735 AS vr_negociado_implementacao,
	x.uf_crm_1719942627227 AS anexar_o_contrato,
	x.uf_crm_1720015348995 AS contrato_do_setup,
	x.uf_crm_1720198477652 AS valor_negociado_ativacao,
	x.uf_crm_1720198502628 AS valor_negociado_integracao,
	x.uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 AS vr_transacionado_em_marco,
	x.uf_crm_1721083861185 AS vr_transacionado_em_abril,
	x.uf_crm_1721083874978 AS vr_transacionado_em_maio,
	x.uf_crm_1721083894608 AS vr_transacionado_em_junho,
	x.uf_crm_1721083906720 AS vr_transacionado_em_julho,
	x.uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	x.uf_crm_1726007497 AS vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 AS vr_transacionado_novembro,
	x.uf_crm_1721226126 AS modulo_do_sistema,
	x.uf_crm_1721227124 AS ambiente,
	x.uf_crm_1721241190 AS classificacao_do_atendimento,
	x.uf_crm_1721243220370 AS area,
	x.uf_crm_1721243302036 AS descricao,
	x.uf_crm_1721243367 AS arquivos,
	x.uf_crm_1721244413245 AS carro_chefe,
	x.uf_crm_1721244451568 AS faturamento_medio_mensal,
	x.uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 AS vendedor_destaque,
	x.uf_crm_1721244560622 AS pretende_estar_operando_em,
	x.uf_crm_1721244826264 AS motivo_do_cancelamento,
	x.uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 AS data_do_churn,
	x.uf_crm_1724261215 AS media_de_faturamento,
	x.uf_crm_1725574177266 AS id_asaas,
	x.uf_crm_1725574322 AS status_do_pagamento,
	x.uf_crm_1725548469220 AS data_solicitacao_upsell,
	x.uf_crm_1726002322164 AS expectativa_com_o_projeto,
	x.uf_crm_1726003734 AS status_do_projeto,
	x.uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 AS novo_valor,
	x.uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 AS quantidade_de_pedidos,
	x.uf_crm_1741275566502 AS valor_faturado,
	x.uf_crm_1741275596050 AS produto,
	x.uf_crm_1741275610428 AS valor_vendido,
	x.uf_crm_1741275634394 AS qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 AS plano,
	x.uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
FROM
	{ { ref('btx_processed_deal') } } x
	LEFT JOIN { { ref('btx_processed_deal_stage') } } x1 ON x.stage_id = x1.status_id
	LEFT JOIN { { ref('btx_processed_user') } } x2 ON x.assigned_by_id = x2."id"
	LEFT JOIN { { ref('btx_processed_user') } } x3 ON x.moved_by_id = x3."id"
	LEFT JOIN { { ref('btx_processed_user') } } x4 ON x.modify_by_id = x4."id"
	LEFT JOIN { { ref('btx_processed_user') } } x5 ON x.created_by_id = x5."id"
	LEFT JOIN { { ref('btx_processed_user') } } x6 ON x.last_activity_by = x6."id"
  );
  
[0m17:57:45.217946 [debug] [Thread-2 (]: SQL status: BEGIN in 1.223 seconds
[0m17:57:45.218345 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m17:57:45.218716 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view',) } }
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') :: VARCHAR AS subject,
  ("CONTENT" ->> 'DESCRIPTION') :: VARCHAR AS description,
  ("CONTENT" ->> 'TYPE_ID') :: VARCHAR AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') :: VARCHAR AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') :: VARCHAR AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') :: VARCHAR AS priority,
  ("CONTENT" ->> 'OWNER_ID') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') :: VARCHAR AS owner_type_id,
  ("CONTENT" ->> 'RESPONSIBLE_ID') :: INTEGER AS responsible_id,
  ("CONTENT" ->> 'COMPLETED') :: BOOLEAN AS completed,
  ("CONTENT" ->> 'STATUS') :: INTEGER AS status,
  ("CONTENT" ->> 'CREATED') :: TIMESTAMP AS created,
  ("CONTENT" ->> 'LAST_UPDATED') :: TIMESTAMP AS last_updated
FROM
  { { source('bitrix', 'btx_raw_activity') } }
WHERE
  "SUCCESS" = TRUE
  );
  
[0m17:57:45.221848 [debug] [Thread-4 (]: SQL status: BEGIN in 1.227 seconds
[0m17:57:45.222135 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m17:57:45.222424 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  { { source('bitrix', 'btx_raw_deal_stage') } }
WHERE
  "SUCCESS" = true
  );
  
[0m17:57:45.231885 [debug] [Thread-3 (]: SQL status: BEGIN in 1.237 seconds
[0m17:57:45.232204 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m17:57:45.232853 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  { { source('bitrix', 'btx_raw_deal') } }
WHERE
  "SUCCESS" = true
  );
  
[0m17:57:45.368092 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(
             ^

[0m17:57:45.368489 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: ROLLBACK
[0m17:57:45.368790 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view',) } }
             ^

[0m17:57:45.369057 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m17:57:45.370571 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:45.370837 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: ROLLBACK
[0m17:57:45.389232 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:45.389717 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: ROLLBACK
[0m17:57:45.516174 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m17:57:45.520513 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m17:57:45.520973 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m17:57:45.526881 [debug] [Thread-2 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view',) } }
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:57:45.528701 [debug] [Thread-4 (]: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m17:57:45.529644 [debug] [Thread-1 (]: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m17:57:45.530275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc25d0>]}
[0m17:57:45.530519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112531ca0>]}
[0m17:57:45.530744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bfecf0>]}
[0m17:57:45.531212 [error] [Thread-2 (]: 2 of 8 ERROR creating sql table model bitrix.btx_processed_activity ............ [[31mERROR[0m in 1.58s]
[0m17:57:45.531766 [error] [Thread-4 (]: 4 of 8 ERROR creating sql table model bitrix.btx_processed_deal_stage .......... [[31mERROR[0m in 1.59s]
[0m17:57:45.532231 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model bitrix.btx_curated_deal .................. [[31mERROR[0m in 1.59s]
[0m17:57:45.532637 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m17:57:45.532982 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m17:57:45.533307 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m17:57:45.533592 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:57:45.533860 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view',) } }
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m17:57:45.534124 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m17:57:45.534369 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m17:57:45.534651 [info ] [Thread-2 (]: 5 of 8 START sql table model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m17:57:45.535474 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_stage' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql.
[0m17:57:45.535845 [info ] [Thread-4 (]: 6 of 8 START sql table model bitrix.btx_processed_dealcategory ................. [RUN]
[0m17:57:45.536216 [info ] [Thread-1 (]: 7 of 8 START sql table model bitrix.btx_processed_product ...................... [RUN]
[0m17:57:45.536553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_deal_userfields)
[0m17:57:45.536914 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_curated_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql.
[0m17:57:45.537159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_dealcategory)
[0m17:57:45.537405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_curated_deal, now model.bdt_transformations.btx_processed_product)
[0m17:57:45.537622 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m17:57:45.537855 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m17:57:45.538044 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m17:57:45.539176 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:57:45.540057 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:57:45.540999 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m17:57:45.541260 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m17:57:45.541775 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m17:57:45.544491 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m17:57:45.544927 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m17:57:45.545220 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m17:57:45.547357 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m17:57:45.548165 [debug] [Thread-3 (]: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m17:57:45.548418 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:57:45.551065 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:57:45.551491 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m17:57:45.551717 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eb38f0>]}
[0m17:57:45.552033 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:57:45.552231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:45.552812 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:57:45.552630 [error] [Thread-3 (]: 3 of 8 ERROR creating sql table model bitrix.btx_processed_deal ................ [[31mERROR[0m in 1.61s]
[0m17:57:45.553078 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m17:57:45.553378 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m17:57:45.553663 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m17:57:45.553849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:45.554029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:45.554260 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m17:57:45.554473 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql.
[0m17:57:45.554927 [info ] [Thread-3 (]: 8 of 8 START sql table model bitrix.btx_processed_user ......................... [RUN]
[0m17:57:45.555243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m17:57:45.555430 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m17:57:45.556405 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m17:57:45.557201 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m17:57:45.559012 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m17:57:45.559436 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:57:45.559624 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m17:57:45.559791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:46.793741 [debug] [Thread-1 (]: SQL status: BEGIN in 1.240 seconds
[0m17:57:46.794382 [debug] [Thread-3 (]: SQL status: BEGIN in 1.234 seconds
[0m17:57:46.794767 [debug] [Thread-2 (]: SQL status: BEGIN in 1.241 seconds
[0m17:57:46.796193 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m17:57:46.796593 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m17:57:46.796930 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m17:57:46.797389 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'CREATED_BY') :: int2 as created_by,
  ("CONTENT" ->> 'DATE_CREATE') :: timestamptz as date_create,
  ("CONTENT" ->> 'MODIFIED_BY') :: int2 as modified_by,
  ("CONTENT" ->> 'ACTIVE') :: bool as active,
  ("CONTENT" ->> 'CATALOG_ID') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  ("CONTENT" ->> 'MEASURE') :: int2 as measure,
  ("CONTENT" ->> 'PRICE') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  ("CONTENT" ->> 'SORT') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  ("CONTENT" ->> 'VAT_ID') :: int2 as vat_id,
  ("CONTENT" ->> 'VAT_INCLUDED') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  { { source('bitrix', 'btx_raw_product') } }
WHERE
  "SUCCESS" = true
  );
  
[0m17:57:46.797964 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	("CONTENT" ->> 'ACTIVE') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	("CONTENT" ->> 'IS_ONLINE') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	("CONTENT" ->> 'LAST_LOGIN') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	("CONTENT" ->> 'TIMESTAMP_X') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	("CONTENT" ->> 'DATE_REGISTER') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	("CONTENT" ->> 'UF_DEPARTMENT') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	("CONTENT" ->> 'UF_PHONE_INNER') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	("CONTENT" ->> 'LAST_ACTIVITY_DATE') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	{ { source('bitrix', 'btx_raw_user') } }
WHERE
	"SUCCESS" = true
  );
  
[0m17:57:46.798914 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	(("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb) ->> 'br' as friendly_name,
	jsonb_path_query_array(
		replace(
			replace("CONTENT" ->> 'LIST', '''', '"'),
			'None',
			'null'
		) :: jsonb,
		'$[*].VALUE'
	) as options,
	replace(
		replace("CONTENT" ->> 'LIST', '''', '"'),
		'None',
		'null'
	) :: jsonb as list,
	("CONTENT" ->> 'SORT') :: int2 as sort,
	("CONTENT" ->> 'XML_ID') :: text as xml_id,
	("CONTENT" ->> 'MULTIPLE') :: bool as multiple,
	replace(
		replace("CONTENT" ->> 'SETTINGS', '''', '"'),
		'None',
		'null'
	) :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	("CONTENT" ->> 'MANDATORY') :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	("CONTENT" ->> 'EDIT_IN_LIST') :: bool as edit_in_list,
	("CONTENT" ->> 'SHOW_IN_LIST') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	("CONTENT" ->> 'IS_SEARCHABLE') :: bool as is_searchable,
	("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb as edit_form_label,
	("CONTENT" ->> 'ERROR_MESSAGE') :: jsonb as error_message,
	("CONTENT" ->> 'HELP_MESSAGE') :: jsonb as help_message,
	("CONTENT" ->> 'LIST_COLUMN_LABEL') :: jsonb as list_column_label,
	("CONTENT" ->> 'LIST_FILTER_LABEL') :: jsonb as list_filter_label
from
	{ { source('bitrix', 'btx_raw_deal_userfield') } }
WHERE
	"SUCCESS" = true
  );
  
[0m17:57:46.803041 [debug] [Thread-4 (]: SQL status: BEGIN in 1.251 seconds
[0m17:57:46.803490 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m17:57:46.803794 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
  
  
    as
  
  (
    { { config(materialized = 'view', unique_key = 'id',) } }
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'CREATED_DATE') :: timestamp as created_date
from
  { { source('bitrix', 'btx_raw_dealcategory') } }
WHERE
  "SUCCESS" = true
  );
  
[0m17:57:46.950067 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:46.950650 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:46.951076 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:46.951425 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: ROLLBACK
[0m17:57:46.951757 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: ROLLBACK
[0m17:57:46.952045 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: ROLLBACK
[0m17:57:46.956239 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
             ^

[0m17:57:46.956582 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: ROLLBACK
[0m17:57:47.101788 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m17:57:47.102526 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m17:57:47.104339 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m17:57:47.107789 [debug] [Thread-3 (]: Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql
[0m17:57:47.108251 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m17:57:47.108644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8fc50>]}
[0m17:57:47.109867 [debug] [Thread-2 (]: Database Error in model btx_processed_deal_userfields (models/bitrix/btx_processed_deal_userfields.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_userfields.sql
[0m17:57:47.110961 [debug] [Thread-1 (]: Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql
[0m17:57:47.111626 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model bitrix.btx_processed_user ................ [[31mERROR[0m in 1.55s]
[0m17:57:47.112899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd3470>]}
[0m17:57:47.113257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8c530>]}
[0m17:57:47.113664 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m17:57:47.114740 [debug] [Thread-4 (]: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m17:57:47.115218 [error] [Thread-2 (]: 5 of 8 ERROR creating sql table model bitrix.btx_processed_deal_userfields ..... [[31mERROR[0m in 1.58s]
[0m17:57:47.115646 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model bitrix.btx_processed_product ............. [[31mERROR[0m in 1.58s]
[0m17:57:47.115999 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_user' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql.
[0m17:57:47.116267 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd0b45-b312-4257-a40e-4f9a23236853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b27aa0>]}
[0m17:57:47.116678 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m17:57:47.116995 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m17:57:47.117442 [error] [Thread-4 (]: 6 of 8 ERROR creating sql table model bitrix.btx_processed_dealcategory ........ [[31mERROR[0m in 1.58s]
[0m17:57:47.117778 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_deal_userfields' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_deal_userfields (models/bitrix/btx_processed_deal_userfields.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_userfields.sql.
[0m17:57:47.118139 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m17:57:47.118424 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_product' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql.
[0m17:57:47.118873 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_dealcategory' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql.
[0m17:57:47.119797 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:47.120034 [debug] [MainThread]: On master: BEGIN
[0m17:57:47.120221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:48.362439 [debug] [MainThread]: SQL status: BEGIN in 1.242 seconds
[0m17:57:48.363321 [debug] [MainThread]: On master: COMMIT
[0m17:57:48.363649 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:48.363923 [debug] [MainThread]: On master: COMMIT
[0m17:57:48.514234 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m17:57:48.514813 [debug] [MainThread]: On master: Close
[0m17:57:48.515459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:48.515770 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m17:57:48.516047 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m17:57:48.516305 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m17:57:48.516556 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m17:57:48.516914 [info ] [MainThread]: 
[0m17:57:48.517216 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 9.45 seconds (9.45s).
[0m17:57:48.518780 [debug] [MainThread]: Command end result
[0m17:57:48.535065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m17:57:48.536724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m17:57:48.541254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m17:57:48.541491 [info ] [MainThread]: 
[0m17:57:48.541727 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m17:57:48.541920 [info ] [MainThread]: 
[0m17:57:48.542162 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view',) } }
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m17:57:48.542353 [info ] [MainThread]: 
[0m17:57:48.542570 [error] [MainThread]:   Database Error in model btx_processed_deal_stage (models/bitrix/btx_processed_deal_stage.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_stage.sql
[0m17:57:48.542756 [info ] [MainThread]: 
[0m17:57:48.542966 [error] [MainThread]:   Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m17:57:48.543137 [info ] [MainThread]: 
[0m17:57:48.543341 [error] [MainThread]:   Database Error in model btx_processed_deal (models/bitrix/btx_processed_deal.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal.sql
[0m17:57:48.543515 [info ] [MainThread]: 
[0m17:57:48.543723 [error] [MainThread]:   Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql
[0m17:57:48.543894 [info ] [MainThread]: 
[0m17:57:48.544099 [error] [MainThread]:   Database Error in model btx_processed_deal_userfields (models/bitrix/btx_processed_deal_userfields.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_deal_userfields.sql
[0m17:57:48.544277 [info ] [MainThread]: 
[0m17:57:48.544481 [error] [MainThread]:   Database Error in model btx_processed_product (models/bitrix/btx_processed_product.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_product.sql
[0m17:57:48.544649 [info ] [MainThread]: 
[0m17:57:48.544854 [error] [MainThread]:   Database Error in model btx_processed_dealcategory (models/bitrix/btx_processed_dealcategory.sql)
  syntax error at or near "{"
  LINE 12:     { { config(materialized = 'view', unique_key = 'id',) } ...
               ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_dealcategory.sql
[0m17:57:48.545032 [info ] [MainThread]: 
[0m17:57:48.545222 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m17:57:48.547496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.922098, "process_in_blocks": "0", "process_kernel_time": 0.226129, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 1.411482}
[0m17:57:48.547890 [debug] [MainThread]: Command `dbt run` failed at 17:57:48.547826 after 9.92 seconds
[0m17:57:48.548134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e163f0>]}
[0m17:57:48.548366 [debug] [MainThread]: Flushing usage events
[0m17:57:49.426988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:56.239020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087336b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922ed50>]}


============================== 18:11:56.241930 | 0f598672-7a8b-49c3-9268-8242affdd52f ==============================
[0m18:11:56.241930 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:11:56.242308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:56.337448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700c890>]}
[0m18:11:56.362538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bae240>]}
[0m18:11:56.363232 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:11:56.420545 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m18:11:56.479081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m18:11:56.479442 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m18:11:56.479647 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_userfields.sql
[0m18:11:56.479836 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_product.sql
[0m18:11:56.480019 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m18:11:56.480194 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m18:11:56.480366 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m18:11:56.480537 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal.sql
[0m18:11:56.480705 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m18:11:56.607087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee0440>]}
[0m18:11:56.639686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:11:56.641494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:11:56.652840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a031f10>]}
[0m18:11:56.653149 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m18:11:56.653330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f420f0>]}
[0m18:11:56.654196 [info ] [MainThread]: 
[0m18:11:56.654403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:11:56.654553 [info ] [MainThread]: 
[0m18:11:56.654813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:56.656791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m18:11:56.685827 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m18:11:56.686104 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:11:56.686263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:58.039750 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.353 seconds
[0m18:11:58.045337 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m18:11:58.048570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m18:11:58.056561 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m18:11:58.056980 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m18:11:58.057297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:59.284634 [debug] [ThreadPool]: SQL status: BEGIN in 1.227 seconds
[0m18:11:59.286468 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m18:11:59.287146 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m18:11:59.457934 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.170 seconds
[0m18:11:59.463936 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m18:11:59.614383 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m18:11:59.627252 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:59.627873 [debug] [MainThread]: On master: BEGIN
[0m18:11:59.628242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:00.847718 [debug] [MainThread]: SQL status: BEGIN in 1.219 seconds
[0m18:12:00.851156 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:00.852227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:01.017168 [debug] [MainThread]: SQL status: SELECT 6 in 0.163 seconds
[0m18:12:01.023242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a05b980>]}
[0m18:12:01.024646 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:01.173013 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:01.175072 [debug] [MainThread]: On master: BEGIN
[0m18:12:01.482804 [debug] [MainThread]: SQL status: BEGIN in 0.306 seconds
[0m18:12:01.485102 [debug] [MainThread]: On master: COMMIT
[0m18:12:01.486237 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:01.486897 [debug] [MainThread]: On master: COMMIT
[0m18:12:01.635017 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m18:12:01.636405 [debug] [MainThread]: On master: Close
[0m18:12:01.644414 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m18:12:01.645150 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m18:12:01.645741 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m18:12:01.646261 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m18:12:01.646929 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m18:12:01.647713 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m18:12:01.648384 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m18:12:01.648964 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m18:12:01.649562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m18:12:01.650147 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m18:12:01.650660 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m18:12:01.651160 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m18:12:01.651621 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m18:12:01.651981 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m18:12:01.652301 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m18:12:01.652625 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m18:12:01.660661 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m18:12:01.664058 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m18:12:01.666295 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:01.668454 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:01.670006 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m18:12:01.690797 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m18:12:01.694683 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:01.696730 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:01.696976 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m18:12:01.697172 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m18:12:01.699055 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m18:12:01.700953 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m18:12:01.701222 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:01.701456 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:01.701768 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m18:12:01.702117 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m18:12:01.702406 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:01.702613 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:01.702811 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:12:01.703007 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:12:01.703265 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m18:12:01.703462 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m18:12:01.703704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:12:01.703879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:02.925923 [debug] [Thread-4 (]: SQL status: BEGIN in 1.222 seconds
[0m18:12:02.927526 [debug] [Thread-2 (]: SQL status: BEGIN in 1.224 seconds
[0m18:12:02.928225 [debug] [Thread-1 (]: SQL status: BEGIN in 1.224 seconds
[0m18:12:02.928828 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:02.929358 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:02.930191 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:12:02.931178 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	(("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb) ->> 'br' as friendly_name,
	jsonb_path_query_array(
		replace(
			replace("CONTENT" ->> 'LIST', '''', '"'),
			'None',
			'null'
		) :: jsonb,
		'$[*].VALUE'
	) as options,
	replace(
		replace("CONTENT" ->> 'LIST', '''', '"'),
		'None',
		'null'
	) :: jsonb as list,
	("CONTENT" ->> 'SORT') :: int2 as sort,
	("CONTENT" ->> 'XML_ID') :: text as xml_id,
	("CONTENT" ->> 'MULTIPLE') :: bool as multiple,
	replace(
		replace("CONTENT" ->> 'SETTINGS', '''', '"'),
		'None',
		'null'
	) :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	("CONTENT" ->> 'MANDATORY') :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	("CONTENT" ->> 'EDIT_IN_LIST') :: bool as edit_in_list,
	("CONTENT" ->> 'SHOW_IN_LIST') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	("CONTENT" ->> 'IS_SEARCHABLE') :: bool as is_searchable,
	("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb as edit_form_label,
	("CONTENT" ->> 'ERROR_MESSAGE') :: jsonb as error_message,
	("CONTENT" ->> 'HELP_MESSAGE') :: jsonb as help_message,
	("CONTENT" ->> 'LIST_COLUMN_LABEL') :: jsonb as list_column_label,
	("CONTENT" ->> 'LIST_FILTER_LABEL') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m18:12:02.932676 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m18:12:02.933973 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') :: VARCHAR AS subject,
  ("CONTENT" ->> 'DESCRIPTION') :: VARCHAR AS description,
  ("CONTENT" ->> 'TYPE_ID') :: VARCHAR AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') :: VARCHAR AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') :: VARCHAR AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') :: VARCHAR AS priority,
  ("CONTENT" ->> 'OWNER_ID') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') :: VARCHAR AS owner_type_id,
  ("CONTENT" ->> 'RESPONSIBLE_ID') :: INTEGER AS responsible_id,
  ("CONTENT" ->> 'COMPLETED') :: BOOLEAN AS completed,
  ("CONTENT" ->> 'STATUS') :: INTEGER AS status,
  ("CONTENT" ->> 'CREATED') :: TIMESTAMP AS created,
  ("CONTENT" ->> 'LAST_UPDATED') :: TIMESTAMP AS last_updated
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m18:12:02.954070 [debug] [Thread-3 (]: SQL status: BEGIN in 1.251 seconds
[0m18:12:02.955372 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:02.956074 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m18:12:03.105618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bitrix.btx_raw_activity" does not exist
LINE 24:   "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
           ^

[0m18:12:03.107820 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: ROLLBACK
[0m18:12:03.124306 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.189 seconds
[0m18:12:03.125518 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.191 seconds
[0m18:12:03.126351 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m18:12:03.137411 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:03.141157 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:03.144170 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:03.144591 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m18:12:03.144994 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m18:12:03.145370 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m18:12:03.263873 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m18:12:03.277609 [debug] [Thread-1 (]: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24:   "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
             ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m18:12:03.280241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a470560>]}
[0m18:12:03.281065 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model bitrix.btx_processed_activity ............. [[31mERROR[0m in 1.63s]
[0m18:12:03.281723 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m18:12:03.282157 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m18:12:03.282655 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_activity' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24:   "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
             ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql.
[0m18:12:03.283150 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m18:12:03.284418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m18:12:03.284815 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m18:12:03.288062 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:03.288902 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m18:12:03.292028 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:03.292631 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:03.292918 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m18:12:03.293187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:03.295931 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m18:12:03.296220 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m18:12:03.298525 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:03.302044 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:03.302380 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m18:12:03.302657 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m18:12:03.318472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m18:12:03.320672 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:03.320977 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m18:12:03.452892 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m18:12:03.453991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m18:12:03.474009 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m18:12:03.475484 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m18:12:03.475884 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:03.476208 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:03.476505 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m18:12:03.476807 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m18:12:03.477093 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m18:12:03.478408 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m18:12:03.478911 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:03.479288 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m18:12:03.628497 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m18:12:03.629081 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m18:12:03.636314 [debug] [Thread-3 (]: SQL status: COMMIT in 0.157 seconds
[0m18:12:03.637667 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m18:12:03.641041 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m18:12:03.644180 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m18:12:03.650575 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:12:03.651743 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:12:03.652421 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:12:03.653471 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m18:12:03.652791 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m18:12:03.653132 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m18:12:03.810369 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.156 seconds
[0m18:12:03.811687 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.157 seconds
[0m18:12:03.812253 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.158 seconds
[0m18:12:03.815959 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m18:12:03.817219 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m18:12:03.818818 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m18:12:03.819760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a57c3b0>]}
[0m18:12:03.820223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3fac60>]}
[0m18:12:03.820457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4047a0>]}
[0m18:12:03.821076 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.17s]
[0m18:12:03.821459 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.17s]
[0m18:12:03.822274 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m18:12:03.821804 [info ] [Thread-2 (]: 2 of 8 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.17s]
[0m18:12:03.822654 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m18:12:03.822926 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m18:12:03.823357 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m18:12:03.823646 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m18:12:03.823974 [info ] [Thread-4 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m18:12:03.824331 [info ] [Thread-3 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m18:12:03.824619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_product)
[0m18:12:03.824862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_user)
[0m18:12:03.825087 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m18:12:03.825377 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m18:12:03.828532 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m18:12:03.831415 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m18:12:03.832515 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m18:12:03.832845 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m18:12:03.835856 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m18:12:03.838573 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m18:12:03.839150 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:03.839453 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m18:12:03.839734 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:03.840004 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:03.840385 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m18:12:03.840642 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:04.529542 [debug] [Thread-1 (]: SQL status: BEGIN in 1.235 seconds
[0m18:12:04.531894 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:04.533170 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'CREATED_DATE') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m18:12:04.707198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.173 seconds
[0m18:12:04.716091 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:04.716729 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m18:12:04.872715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m18:12:04.881219 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:04.882014 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m18:12:05.034187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m18:12:05.039537 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m18:12:05.040360 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:05.040919 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m18:12:05.065490 [debug] [Thread-4 (]: SQL status: BEGIN in 1.224 seconds
[0m18:12:05.066675 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:05.070877 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'CREATED_BY') :: int2 as created_by,
  ("CONTENT" ->> 'DATE_CREATE') :: timestamptz as date_create,
  ("CONTENT" ->> 'MODIFIED_BY') :: int2 as modified_by,
  ("CONTENT" ->> 'ACTIVE') :: bool as active,
  ("CONTENT" ->> 'CATALOG_ID') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  ("CONTENT" ->> 'MEASURE') :: int2 as measure,
  ("CONTENT" ->> 'PRICE') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  ("CONTENT" ->> 'SORT') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  ("CONTENT" ->> 'VAT_ID') :: int2 as vat_id,
  ("CONTENT" ->> 'VAT_INCLUDED') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m18:12:05.071865 [debug] [Thread-3 (]: SQL status: BEGIN in 1.232 seconds
[0m18:12:05.073377 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:05.074109 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	("CONTENT" ->> 'ACTIVE') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	("CONTENT" ->> 'IS_ONLINE') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	("CONTENT" ->> 'LAST_LOGIN') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	("CONTENT" ->> 'TIMESTAMP_X') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	("CONTENT" ->> 'DATE_REGISTER') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	("CONTENT" ->> 'UF_DEPARTMENT') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	("CONTENT" ->> 'UF_PHONE_INNER') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	("CONTENT" ->> 'LAST_ACTIVITY_DATE') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m18:12:05.196801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.155 seconds
[0m18:12:05.203603 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m18:12:05.204663 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:12:05.205112 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m18:12:05.230730 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m18:12:05.234663 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:05.235120 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m18:12:05.244162 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.169 seconds
[0m18:12:05.247708 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:05.248139 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m18:12:05.363314 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.157 seconds
[0m18:12:05.367087 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m18:12:05.368342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3fbb90>]}
[0m18:12:05.369353 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.08s]
[0m18:12:05.370078 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m18:12:05.386459 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m18:12:05.390440 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:05.390912 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m18:12:05.397434 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m18:12:05.401288 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:05.401826 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m18:12:05.541487 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m18:12:05.548122 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m18:12:05.549095 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:05.549522 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m18:12:05.551208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m18:12:05.553130 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m18:12:05.553546 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:05.553923 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m18:12:05.700547 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m18:12:05.707235 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m18:12:05.707999 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m18:12:05.709415 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:12:05.712480 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m18:12:05.712975 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m18:12:05.713860 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:12:05.714405 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m18:12:05.872815 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.157 seconds
[0m18:12:05.878574 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m18:12:05.879236 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.165 seconds
[0m18:12:05.881112 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m18:12:05.881961 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a404c50>]}
[0m18:12:05.883029 [info ] [Thread-3 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.06s]
[0m18:12:05.883633 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3fbb00>]}
[0m18:12:05.884269 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m18:12:05.884962 [info ] [Thread-4 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.06s]
[0m18:12:05.885759 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m18:12:05.886311 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m18:12:05.886855 [info ] [Thread-2 (]: 8 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m18:12:05.887489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_curated_deal)
[0m18:12:05.887930 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m18:12:05.893372 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m18:12:05.895055 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m18:12:05.912560 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m18:12:05.913241 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:05.913503 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m18:12:05.913738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:07.150629 [debug] [Thread-2 (]: SQL status: BEGIN in 1.236 seconds
[0m18:12:07.153222 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:07.154217 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	x.id,
	x.title AS titulo,
	x1.name AS estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity AS mrr,
	x.company_id,
	x.contact_id,
	x2.name AS atribuido_por,
	x.opened AS aberto,
	x.begin_date AS data_de_inicio,
	x.closed AS encerrado,
	x.close_date AS data_de_encerramento,
	x.date_create AS criado_em,
	x5.name AS criado_por,
	x.date_modify AS modificado_em,
	x4.name AS modificdo_por,
	x.moved_time AS movido_em,
	x3.name AS movido_por,
	x.last_activity_time AS ultima_atividade_em,
	x6.name AS ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id AS id_lead,
	x.type_id AS id_tipo,
	x.comments AS comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id AS moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring AS recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 AS quantidade_de_usuarios,
	x.uf_crm_1718893063318 AS ponto_focal,
	x.uf_crm_1721248408791 AS email_ponto_focal,
	x.uf_crm_1718895613676 AS erp,
	x.uf_crm_1718895632531 AS segmento,
	x.uf_crm_1718895837277 AS perfil,
	x.uf_crm_1719234554494 AS email_financeiro,
	x.uf_crm_1719234611470 AS forma_pgto_implementacao,
	x.uf_crm_1719234653377 AS forma_pgto_recorrencia,
	x.uf_crm_1719851689133 AS vr_negociado_recorrencia,
	x.uf_crm_1719851724735 AS vr_negociado_implementacao,
	x.uf_crm_1719942627227 AS anexar_o_contrato,
	x.uf_crm_1720015348995 AS contrato_do_setup,
	x.uf_crm_1720198477652 AS valor_negociado_ativacao,
	x.uf_crm_1720198502628 AS valor_negociado_integracao,
	x.uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 AS vr_transacionado_em_marco,
	x.uf_crm_1721083861185 AS vr_transacionado_em_abril,
	x.uf_crm_1721083874978 AS vr_transacionado_em_maio,
	x.uf_crm_1721083894608 AS vr_transacionado_em_junho,
	x.uf_crm_1721083906720 AS vr_transacionado_em_julho,
	x.uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	x.uf_crm_1726007497 AS vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 AS vr_transacionado_novembro,
	x.uf_crm_1721226126 AS modulo_do_sistema,
	x.uf_crm_1721227124 AS ambiente,
	x.uf_crm_1721241190 AS classificacao_do_atendimento,
	x.uf_crm_1721243220370 AS area,
	x.uf_crm_1721243302036 AS descricao,
	x.uf_crm_1721243367 AS arquivos,
	x.uf_crm_1721244413245 AS carro_chefe,
	x.uf_crm_1721244451568 AS faturamento_medio_mensal,
	x.uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 AS vendedor_destaque,
	x.uf_crm_1721244560622 AS pretende_estar_operando_em,
	x.uf_crm_1721244826264 AS motivo_do_cancelamento,
	x.uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 AS data_do_churn,
	x.uf_crm_1724261215 AS media_de_faturamento,
	x.uf_crm_1725574177266 AS id_asaas,
	x.uf_crm_1725574322 AS status_do_pagamento,
	x.uf_crm_1725548469220 AS data_solicitacao_upsell,
	x.uf_crm_1726002322164 AS expectativa_com_o_projeto,
	x.uf_crm_1726003734 AS status_do_projeto,
	x.uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 AS novo_valor,
	x.uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 AS quantidade_de_pedidos,
	x.uf_crm_1741275566502 AS valor_faturado,
	x.uf_crm_1741275596050 AS produto,
	x.uf_crm_1741275610428 AS valor_vendido,
	x.uf_crm_1741275634394 AS qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 AS plano,
	x.uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1 ON x.stage_id = x1.status_id
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2 ON x.assigned_by_id = x2."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3 ON x.moved_by_id = x3."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4 ON x.modify_by_id = x4."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5 ON x.created_by_id = x5."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6 ON x.last_activity_by = x6."id"
  );
  
[0m18:12:07.470110 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.314 seconds
[0m18:12:07.478708 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:07.479395 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m18:12:07.631868 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m18:12:07.641076 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:07.641654 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m18:12:07.794871 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:12:07.807625 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m18:12:07.808322 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:07.808741 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m18:12:07.988831 [debug] [Thread-2 (]: SQL status: COMMIT in 0.179 seconds
[0m18:12:08.059158 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m18:12:08.060954 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:12:08.061183 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m18:12:08.220758 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.159 seconds
[0m18:12:08.222854 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m18:12:08.223988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f598672-7a8b-49c3-9268-8242affdd52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a613080>]}
[0m18:12:08.224997 [info ] [Thread-2 (]: 8 of 8 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.34s]
[0m18:12:08.225719 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m18:12:08.227436 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:08.227913 [debug] [MainThread]: On master: BEGIN
[0m18:12:08.228287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:09.447448 [debug] [MainThread]: SQL status: BEGIN in 1.218 seconds
[0m18:12:09.449813 [debug] [MainThread]: On master: COMMIT
[0m18:12:09.450991 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:09.451626 [debug] [MainThread]: On master: COMMIT
[0m18:12:09.601084 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m18:12:09.602515 [debug] [MainThread]: On master: Close
[0m18:12:09.604306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:09.604986 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m18:12:09.605471 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m18:12:09.605932 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m18:12:09.606537 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m18:12:09.607244 [info ] [MainThread]: 
[0m18:12:09.607769 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m18:12:09.609957 [debug] [MainThread]: Command end result
[0m18:12:09.634127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:12:09.636232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:12:09.641997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m18:12:09.642286 [info ] [MainThread]: 
[0m18:12:09.642561 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:12:09.642778 [info ] [MainThread]: 
[0m18:12:09.643050 [error] [MainThread]:   Database Error in model btx_processed_activity (models/bitrix/btx_processed_activity.sql)
  relation "bitrix.btx_raw_activity" does not exist
  LINE 24:   "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
             ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_activity.sql
[0m18:12:09.643276 [info ] [MainThread]: 
[0m18:12:09.643504 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m18:12:09.646025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.441546, "process_in_blocks": "0", "process_kernel_time": 0.265675, "process_mem_max_rss": "128483328", "process_out_blocks": "0", "process_user_time": 1.699091}
[0m18:12:09.646370 [debug] [MainThread]: Command `dbt run` failed at 18:12:09.646310 after 13.44 seconds
[0m18:12:09.646680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e92db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108577860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bacd70>]}
[0m18:12:09.646973 [debug] [MainThread]: Flushing usage events
[0m18:12:10.711300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:20:45.625300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108726a80>]}


============================== 18:20:45.628484 | 7dd00a69-adc4-4571-90d2-57dc5cd8d2d3 ==============================
[0m18:20:45.628484 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:20:45.628858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:20:45.723437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcbef0>]}
[0m18:20:45.748779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108594380>]}
[0m18:20:45.749514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:20:45.809829 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m18:20:45.869496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:45.869778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:45.885772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb0cb0>]}
[0m18:20:45.917682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:20:45.919485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:20:45.931540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e5eb0>]}
[0m18:20:45.931825 [info ] [MainThread]: Found 8 models, 7 sources, 433 macros
[0m18:20:45.932005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcbdd0>]}
[0m18:20:45.932946 [info ] [MainThread]: 
[0m18:20:45.933198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:20:45.933362 [info ] [MainThread]: 
[0m18:20:45.933636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:45.935577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m18:20:45.963599 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m18:20:45.963864 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m18:20:45.964027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:47.202383 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.237 seconds
[0m18:20:47.205985 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m18:20:47.209008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m18:20:47.216422 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m18:20:47.216861 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m18:20:47.217180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:48.478584 [debug] [ThreadPool]: SQL status: BEGIN in 1.260 seconds
[0m18:20:48.481005 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m18:20:48.481808 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m18:20:48.636592 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.154 seconds
[0m18:20:48.641345 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m18:20:48.792250 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m18:20:48.808207 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:48.808738 [debug] [MainThread]: On master: BEGIN
[0m18:20:48.809102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:50.054674 [debug] [MainThread]: SQL status: BEGIN in 1.245 seconds
[0m18:20:50.057240 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:50.058578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:50.215622 [debug] [MainThread]: SQL status: SELECT 6 in 0.156 seconds
[0m18:20:50.221745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c53230>]}
[0m18:20:50.222637 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:50.372272 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:50.373824 [debug] [MainThread]: On master: BEGIN
[0m18:20:50.675563 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m18:20:50.677971 [debug] [MainThread]: On master: COMMIT
[0m18:20:50.679004 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:50.679917 [debug] [MainThread]: On master: COMMIT
[0m18:20:50.829078 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m18:20:50.829549 [debug] [MainThread]: On master: Close
[0m18:20:50.833053 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m18:20:50.833375 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m18:20:50.833764 [info ] [Thread-1 (]: 1 of 8 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m18:20:50.834107 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m18:20:50.834464 [info ] [Thread-2 (]: 2 of 8 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m18:20:50.834751 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m18:20:50.835053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m18:20:50.835398 [info ] [Thread-3 (]: 3 of 8 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m18:20:50.835737 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m18:20:50.836038 [info ] [Thread-4 (]: 4 of 8 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m18:20:50.836302 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m18:20:50.836595 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m18:20:50.836824 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m18:20:50.837156 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m18:20:50.843761 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m18:20:50.844096 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m18:20:50.846862 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m18:20:50.847144 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m18:20:50.849083 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:50.851053 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:50.851300 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m18:20:50.851722 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m18:20:50.858299 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m18:20:50.864613 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m18:20:50.871485 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m18:20:50.873355 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m18:20:50.874968 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:50.876543 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:50.877119 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:50.877373 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:50.877579 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m18:20:50.877847 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m18:20:50.878049 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:50.878246 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:20:50.878409 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:20:50.878586 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:20:50.878765 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m18:20:50.878938 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m18:20:50.879252 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:20:50.879447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:52.121272 [debug] [Thread-2 (]: SQL status: BEGIN in 1.242 seconds
[0m18:20:52.122778 [debug] [Thread-1 (]: SQL status: BEGIN in 1.243 seconds
[0m18:20:52.123939 [debug] [Thread-4 (]: SQL status: BEGIN in 1.245 seconds
[0m18:20:52.124878 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:52.125492 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:20:52.126030 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:52.127298 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m18:20:52.128635 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') :: VARCHAR AS subject,
  ("CONTENT" ->> 'DESCRIPTION') :: VARCHAR AS description,
  ("CONTENT" ->> 'TYPE_ID') :: VARCHAR AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') :: VARCHAR AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') :: VARCHAR AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') :: VARCHAR AS priority,
  ("CONTENT" ->> 'OWNER_ID') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') :: VARCHAR AS owner_type_id,
  ("CONTENT" ->> 'RESPONSIBLE_ID') :: INTEGER AS responsible_id,
  ("CONTENT" ->> 'COMPLETED') :: BOOLEAN AS completed,
  ("CONTENT" ->> 'STATUS') :: INTEGER AS status,
  ("CONTENT" ->> 'CREATED') :: TIMESTAMP AS created,
  ("CONTENT" ->> 'LAST_UPDATED') :: TIMESTAMP AS last_updated
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m18:20:52.129282 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	(("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb) ->> 'br' as friendly_name,
	jsonb_path_query_array(
		replace(
			replace("CONTENT" ->> 'LIST', '''', '"'),
			'None',
			'null'
		) :: jsonb,
		'$[*].VALUE'
	) as options,
	replace(
		replace("CONTENT" ->> 'LIST', '''', '"'),
		'None',
		'null'
	) :: jsonb as list,
	("CONTENT" ->> 'SORT') :: int2 as sort,
	("CONTENT" ->> 'XML_ID') :: text as xml_id,
	("CONTENT" ->> 'MULTIPLE') :: bool as multiple,
	replace(
		replace("CONTENT" ->> 'SETTINGS', '''', '"'),
		'None',
		'null'
	) :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	("CONTENT" ->> 'MANDATORY') :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	("CONTENT" ->> 'EDIT_IN_LIST') :: bool as edit_in_list,
	("CONTENT" ->> 'SHOW_IN_LIST') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	("CONTENT" ->> 'IS_SEARCHABLE') :: bool as is_searchable,
	("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb as edit_form_label,
	("CONTENT" ->> 'ERROR_MESSAGE') :: jsonb as error_message,
	("CONTENT" ->> 'HELP_MESSAGE') :: jsonb as help_message,
	("CONTENT" ->> 'LIST_COLUMN_LABEL') :: jsonb as list_column_label,
	("CONTENT" ->> 'LIST_FILTER_LABEL') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m18:20:52.137533 [debug] [Thread-3 (]: SQL status: BEGIN in 1.258 seconds
[0m18:20:52.138077 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:52.138565 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m18:20:52.293417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m18:20:52.302940 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m18:20:52.305955 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:20:52.306419 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.176 seconds
[0m18:20:52.306833 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.177 seconds
[0m18:20:52.311914 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:52.312416 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m18:20:52.315373 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:52.318006 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:52.318360 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m18:20:52.318811 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m18:20:52.319203 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m18:20:52.470599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m18:20:52.471876 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m18:20:52.472435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:52.473048 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:52.491952 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m18:20:52.495159 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:52.497756 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:52.500037 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:52.500349 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:20:52.500652 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m18:20:52.500950 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m18:20:52.501230 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m18:20:52.501493 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m18:20:52.654161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m18:20:52.655283 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:52.656509 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m18:20:52.663203 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.161 seconds
[0m18:20:52.667249 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m18:20:52.671684 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m18:20:52.673398 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m18:20:52.675138 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m18:20:52.679644 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m18:20:52.680038 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:52.680373 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:52.680688 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:52.681010 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m18:20:52.681318 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m18:20:52.681619 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m18:20:52.681895 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m18:20:52.832204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.149 seconds
[0m18:20:52.833750 [debug] [Thread-3 (]: SQL status: COMMIT in 0.151 seconds
[0m18:20:52.839616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.157 seconds
[0m18:20:52.840299 [debug] [Thread-4 (]: SQL status: COMMIT in 0.158 seconds
[0m18:20:52.839278 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m18:20:52.844048 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m18:20:52.846581 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m18:20:52.848716 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m18:20:52.849621 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m18:20:52.851914 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m18:20:52.852809 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m18:20:52.853248 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m18:20:52.853673 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m18:20:52.854088 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m18:20:52.854452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064db7a0>]}
[0m18:20:52.855353 [info ] [Thread-1 (]: 1 of 8 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.02s]
[0m18:20:52.855941 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m18:20:52.856340 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m18:20:52.856839 [info ] [Thread-1 (]: 5 of 8 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m18:20:52.857257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m18:20:52.857593 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m18:20:52.860405 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:52.861290 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m18:20:52.865374 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:52.865985 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:52.866271 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m18:20:52.866539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:53.008682 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m18:20:53.009385 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.154 seconds
[0m18:20:53.009738 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.155 seconds
[0m18:20:53.012329 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m18:20:53.013975 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m18:20:53.015237 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m18:20:53.016271 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098eade0>]}
[0m18:20:53.017239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ea990>]}
[0m18:20:53.018136 [info ] [Thread-3 (]: 3 of 8 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.18s]
[0m18:20:53.018891 [info ] [Thread-4 (]: 4 of 8 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.18s]
[0m18:20:53.019240 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ebd10>]}
[0m18:20:53.019621 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m18:20:53.019948 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m18:20:53.020622 [info ] [Thread-2 (]: 2 of 8 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.18s]
[0m18:20:53.021280 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m18:20:53.021866 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_user
[0m18:20:53.022424 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m18:20:53.022863 [info ] [Thread-3 (]: 6 of 8 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m18:20:53.023283 [info ] [Thread-4 (]: 7 of 8 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m18:20:53.023809 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m18:20:53.024183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m18:20:53.024526 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m18:20:53.024832 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m18:20:53.027798 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m18:20:53.030489 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m18:20:53.031403 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m18:20:53.034229 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m18:20:53.034555 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m18:20:53.037215 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m18:20:53.037875 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:53.038175 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m18:20:53.038453 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:53.038730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:20:53.038994 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m18:20:53.039363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:20:54.115892 [debug] [Thread-1 (]: SQL status: BEGIN in 1.249 seconds
[0m18:20:54.117631 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:54.118546 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'CREATED_DATE') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m18:20:54.272315 [debug] [Thread-3 (]: SQL status: BEGIN in 1.233 seconds
[0m18:20:54.273497 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:54.274385 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'CREATED_BY') :: int2 as created_by,
  ("CONTENT" ->> 'DATE_CREATE') :: timestamptz as date_create,
  ("CONTENT" ->> 'MODIFIED_BY') :: int2 as modified_by,
  ("CONTENT" ->> 'ACTIVE') :: bool as active,
  ("CONTENT" ->> 'CATALOG_ID') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  ("CONTENT" ->> 'MEASURE') :: int2 as measure,
  ("CONTENT" ->> 'PRICE') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  ("CONTENT" ->> 'SORT') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  ("CONTENT" ->> 'VAT_ID') :: int2 as vat_id,
  ("CONTENT" ->> 'VAT_INCLUDED') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m18:20:54.276412 [debug] [Thread-4 (]: SQL status: BEGIN in 1.237 seconds
[0m18:20:54.277072 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:54.277781 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	("CONTENT" ->> 'ACTIVE') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	("CONTENT" ->> 'IS_ONLINE') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	("CONTENT" ->> 'LAST_LOGIN') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	("CONTENT" ->> 'TIMESTAMP_X') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	("CONTENT" ->> 'DATE_REGISTER') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	("CONTENT" ->> 'UF_DEPARTMENT') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	("CONTENT" ->> 'UF_PHONE_INNER') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	("CONTENT" ->> 'LAST_ACTIVITY_DATE') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m18:20:54.282328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m18:20:54.287372 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:54.287864 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m18:20:54.437117 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m18:20:54.443795 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:54.444626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m18:20:54.445141 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m18:20:54.445570 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m18:20:54.448836 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:54.452402 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:54.453013 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m18:20:54.453411 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m18:20:54.604814 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m18:20:54.606170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:54.606711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:54.611330 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:54.614593 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:54.616681 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m18:20:54.617158 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m18:20:54.617609 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m18:20:54.618041 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:54.618663 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m18:20:54.769665 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m18:20:54.771397 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m18:20:54.772132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m18:20:54.775393 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m18:20:54.777784 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m18:20:54.783425 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m18:20:54.783935 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:54.784377 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:54.785172 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m18:20:54.785523 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m18:20:54.785857 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m18:20:54.786205 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m18:20:54.939322 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m18:20:54.943974 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m18:20:54.944631 [debug] [Thread-3 (]: SQL status: COMMIT in 0.158 seconds
[0m18:20:54.945754 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m18:20:54.946170 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.159 seconds
[0m18:20:54.948696 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m18:20:54.949172 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m18:20:54.951167 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m18:20:54.952014 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m18:20:54.952568 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m18:20:54.953270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f8170>]}
[0m18:20:54.954012 [info ] [Thread-1 (]: 5 of 8 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.10s]
[0m18:20:54.954621 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m18:20:55.106136 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m18:20:55.110696 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: Close
[0m18:20:55.111212 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.158 seconds
[0m18:20:55.113327 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m18:20:55.114105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f9970>]}
[0m18:20:55.115157 [info ] [Thread-4 (]: 7 of 8 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.09s]
[0m18:20:55.115914 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m18:20:55.116534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f8d70>]}
[0m18:20:55.117459 [info ] [Thread-3 (]: 6 of 8 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.09s]
[0m18:20:55.117992 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m18:20:55.118532 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m18:20:55.119081 [info ] [Thread-2 (]: 8 of 8 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m18:20:55.119678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_curated_deal)
[0m18:20:55.120114 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m18:20:55.126035 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m18:20:55.127985 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m18:20:55.145713 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m18:20:55.146616 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:55.146895 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m18:20:55.147134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:20:56.350552 [debug] [Thread-2 (]: SQL status: BEGIN in 1.202 seconds
[0m18:20:56.352903 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:56.354305 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	x.id,
	x.title AS titulo,
	x1.name AS estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity AS mrr,
	x.company_id,
	x.contact_id,
	x2.name AS atribuido_por,
	x.opened AS aberto,
	x.begin_date AS data_de_inicio,
	x.closed AS encerrado,
	x.close_date AS data_de_encerramento,
	x.date_create AS criado_em,
	x5.name AS criado_por,
	x.date_modify AS modificado_em,
	x4.name AS modificdo_por,
	x.moved_time AS movido_em,
	x3.name AS movido_por,
	x.last_activity_time AS ultima_atividade_em,
	x6.name AS ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id AS id_lead,
	x.type_id AS id_tipo,
	x.comments AS comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id AS moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring AS recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 AS quantidade_de_usuarios,
	x.uf_crm_1718893063318 AS ponto_focal,
	x.uf_crm_1721248408791 AS email_ponto_focal,
	x.uf_crm_1718895613676 AS erp,
	x.uf_crm_1718895632531 AS segmento,
	x.uf_crm_1718895837277 AS perfil,
	x.uf_crm_1719234554494 AS email_financeiro,
	x.uf_crm_1719234611470 AS forma_pgto_implementacao,
	x.uf_crm_1719234653377 AS forma_pgto_recorrencia,
	x.uf_crm_1719851689133 AS vr_negociado_recorrencia,
	x.uf_crm_1719851724735 AS vr_negociado_implementacao,
	x.uf_crm_1719942627227 AS anexar_o_contrato,
	x.uf_crm_1720015348995 AS contrato_do_setup,
	x.uf_crm_1720198477652 AS valor_negociado_ativacao,
	x.uf_crm_1720198502628 AS valor_negociado_integracao,
	x.uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 AS vr_transacionado_em_marco,
	x.uf_crm_1721083861185 AS vr_transacionado_em_abril,
	x.uf_crm_1721083874978 AS vr_transacionado_em_maio,
	x.uf_crm_1721083894608 AS vr_transacionado_em_junho,
	x.uf_crm_1721083906720 AS vr_transacionado_em_julho,
	x.uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	x.uf_crm_1726007497 AS vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 AS vr_transacionado_novembro,
	x.uf_crm_1721226126 AS modulo_do_sistema,
	x.uf_crm_1721227124 AS ambiente,
	x.uf_crm_1721241190 AS classificacao_do_atendimento,
	x.uf_crm_1721243220370 AS area,
	x.uf_crm_1721243302036 AS descricao,
	x.uf_crm_1721243367 AS arquivos,
	x.uf_crm_1721244413245 AS carro_chefe,
	x.uf_crm_1721244451568 AS faturamento_medio_mensal,
	x.uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 AS vendedor_destaque,
	x.uf_crm_1721244560622 AS pretende_estar_operando_em,
	x.uf_crm_1721244826264 AS motivo_do_cancelamento,
	x.uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 AS data_do_churn,
	x.uf_crm_1724261215 AS media_de_faturamento,
	x.uf_crm_1725574177266 AS id_asaas,
	x.uf_crm_1725574322 AS status_do_pagamento,
	x.uf_crm_1725548469220 AS data_solicitacao_upsell,
	x.uf_crm_1726002322164 AS expectativa_com_o_projeto,
	x.uf_crm_1726003734 AS status_do_projeto,
	x.uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 AS novo_valor,
	x.uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 AS quantidade_de_pedidos,
	x.uf_crm_1741275566502 AS valor_faturado,
	x.uf_crm_1741275596050 AS produto,
	x.uf_crm_1741275610428 AS valor_vendido,
	x.uf_crm_1741275634394 AS qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 AS plano,
	x.uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1 ON x.stage_id = x1.status_id
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2 ON x.assigned_by_id = x2."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3 ON x.moved_by_id = x3."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4 ON x.modify_by_id = x4."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5 ON x.created_by_id = x5."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6 ON x.last_activity_by = x6."id"
  );
  
[0m18:20:56.605593 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.250 seconds
[0m18:20:56.611730 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:56.612271 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m18:20:56.761202 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m18:20:56.768743 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:56.769409 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m18:20:56.917980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m18:20:56.930677 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m18:20:56.931382 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:56.931844 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m18:20:57.081065 [debug] [Thread-2 (]: SQL status: COMMIT in 0.148 seconds
[0m18:20:57.087992 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m18:20:57.092785 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m18:20:57.093323 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m18:20:57.246112 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.152 seconds
[0m18:20:57.250014 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m18:20:57.251339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd00a69-adc4-4571-90d2-57dc5cd8d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945b470>]}
[0m18:20:57.252360 [info ] [Thread-2 (]: 8 of 8 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.13s]
[0m18:20:57.253063 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m18:20:57.254846 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.255244 [debug] [MainThread]: On master: BEGIN
[0m18:20:57.255583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:58.500042 [debug] [MainThread]: SQL status: BEGIN in 1.244 seconds
[0m18:20:58.502519 [debug] [MainThread]: On master: COMMIT
[0m18:20:58.503093 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:58.503558 [debug] [MainThread]: On master: COMMIT
[0m18:20:58.656736 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m18:20:58.659226 [debug] [MainThread]: On master: Close
[0m18:20:58.661128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:58.663096 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m18:20:58.663558 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m18:20:58.663964 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m18:20:58.664350 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m18:20:58.665008 [info ] [MainThread]: 
[0m18:20:58.665549 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 12.73 seconds (12.73s).
[0m18:20:58.667664 [debug] [MainThread]: Command end result
[0m18:20:58.689425 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m18:20:58.690962 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m18:20:58.695610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m18:20:58.695892 [info ] [MainThread]: 
[0m18:20:58.696154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:58.696369 [info ] [MainThread]: 
[0m18:20:58.696593 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:20:58.698678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.108187, "process_in_blocks": "0", "process_kernel_time": 0.256033, "process_mem_max_rss": "123666432", "process_out_blocks": "0", "process_user_time": 1.555049}
[0m18:20:58.699060 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:58.698995 after 13.11 seconds
[0m18:20:58.699364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104386db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c00740>]}
[0m18:20:58.699633 [debug] [MainThread]: Flushing usage events
[0m18:20:59.515716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:33.123065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107933080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107932cc0>]}


============================== 21:16:33.125888 | 6a776abe-54f1-4efa-8df7-7195b1df9859 ==============================
[0m21:16:33.125888 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:16:33.126256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:33.219187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbd100>]}
[0m21:16:33.244891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742dd60>]}
[0m21:16:33.245577 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:33.303974 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m21:16:33.362766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:16:33.363150 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_processed_company.sql
[0m21:16:33.363601 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/sources.yml
[0m21:16:33.533161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12116b800>]}
[0m21:16:33.564662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:16:33.566510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:16:33.576214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121564050>]}
[0m21:16:33.576517 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m21:16:33.576705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206ee3c0>]}
[0m21:16:33.577628 [info ] [MainThread]: 
[0m21:16:33.577819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:33.577966 [info ] [MainThread]: 
[0m21:16:33.578248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:33.580355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:16:33.618165 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:16:33.618470 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:16:33.618635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:34.852642 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.234 seconds
[0m21:16:34.854322 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:16:34.856050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev_bitrix'
[0m21:16:34.861516 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m21:16:34.861859 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m21:16:34.862101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:36.103646 [debug] [ThreadPool]: SQL status: BEGIN in 1.241 seconds
[0m21:16:36.106088 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m21:16:36.107152 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m21:16:36.274150 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.165 seconds
[0m21:16:36.278417 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m21:16:36.431564 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m21:16:36.444024 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:36.444528 [debug] [MainThread]: On master: BEGIN
[0m21:16:36.444893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:37.649351 [debug] [MainThread]: SQL status: BEGIN in 1.204 seconds
[0m21:16:37.649896 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:37.650255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:37.827090 [debug] [MainThread]: SQL status: SELECT 7 in 0.176 seconds
[0m21:16:37.828893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12116b260>]}
[0m21:16:37.829219 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:37.977283 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:37.977659 [debug] [MainThread]: On master: BEGIN
[0m21:16:38.292988 [debug] [MainThread]: SQL status: BEGIN in 0.315 seconds
[0m21:16:38.293574 [debug] [MainThread]: On master: COMMIT
[0m21:16:38.293885 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:38.294158 [debug] [MainThread]: On master: COMMIT
[0m21:16:38.465084 [debug] [MainThread]: SQL status: COMMIT in 0.170 seconds
[0m21:16:38.467213 [debug] [MainThread]: On master: Close
[0m21:16:38.472972 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m21:16:38.473906 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m21:16:38.474590 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m21:16:38.475126 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m21:16:38.475929 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m21:16:38.476617 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m21:16:38.477178 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m21:16:38.477714 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m21:16:38.478324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now model.bdt_transformations.btx_processed_activity)
[0m21:16:38.478788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_company)
[0m21:16:38.479311 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m21:16:38.479783 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m21:16:38.480140 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m21:16:38.480483 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m21:16:38.480805 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m21:16:38.481131 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m21:16:38.489020 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m21:16:38.492577 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m21:16:38.496620 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m21:16:38.498856 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:38.500536 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m21:16:38.500922 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m21:16:38.508594 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m21:16:38.514498 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m21:16:38.526901 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m21:16:38.528992 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:38.530812 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m21:16:38.532608 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m21:16:38.533796 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:38.534107 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:38.534385 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:16:38.534629 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m21:16:38.534909 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m21:16:38.535136 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:38.535347 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m21:16:38.535601 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:16:38.535834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:38.536042 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m21:16:38.536222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:38.536635 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:16:39.754080 [debug] [Thread-3 (]: SQL status: BEGIN in 1.217 seconds
[0m21:16:39.759149 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:39.760023 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m21:16:39.784549 [debug] [Thread-1 (]: SQL status: BEGIN in 1.249 seconds
[0m21:16:39.784937 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:39.785239 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') :: VARCHAR AS subject,
  ("CONTENT" ->> 'DESCRIPTION') :: VARCHAR AS description,
  ("CONTENT" ->> 'TYPE_ID') :: VARCHAR AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') :: VARCHAR AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') :: VARCHAR AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') :: VARCHAR AS priority,
  ("CONTENT" ->> 'OWNER_ID') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') :: VARCHAR AS owner_type_id,
  ("CONTENT" ->> 'RESPONSIBLE_ID') :: INTEGER AS responsible_id,
  ("CONTENT" ->> 'COMPLETED') :: BOOLEAN AS completed,
  ("CONTENT" ->> 'STATUS') :: INTEGER AS status,
  ("CONTENT" ->> 'CREATED') :: TIMESTAMP AS created,
  ("CONTENT" ->> 'LAST_UPDATED') :: TIMESTAMP AS last_updated
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m21:16:39.792189 [debug] [Thread-4 (]: SQL status: BEGIN in 1.257 seconds
[0m21:16:39.792579 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:39.792874 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m21:16:39.804645 [debug] [Thread-2 (]: SQL status: BEGIN in 1.268 seconds
[0m21:16:39.805099 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:16:39.805618 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE "SUCCESS" = true
  );
[0m21:16:39.985573 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.192 seconds
[0m21:16:39.993823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.208 seconds
[0m21:16:39.994531 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.188 seconds
[0m21:16:39.995143 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.230 seconds
[0m21:16:39.995802 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:39.999206 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:40.001750 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:16:40.004432 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:40.004923 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m21:16:40.005275 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m21:16:40.005612 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m21:16:40.005904 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m21:16:40.158785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m21:16:40.159685 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m21:16:40.160401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m21:16:40.166112 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:40.166836 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.160 seconds
[0m21:16:40.170659 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:40.173831 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:40.174255 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m21:16:40.190194 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m21:16:40.190575 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m21:16:40.190892 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m21:16:40.191268 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:16:40.191683 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m21:16:40.341169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:16:40.350469 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m21:16:40.351147 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m21:16:40.351626 [debug] [Thread-2 (]: SQL status: COMMIT in 0.160 seconds
[0m21:16:40.351979 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.160 seconds
[0m21:16:40.352446 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:40.354368 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m21:16:40.361420 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m21:16:40.363029 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:16:40.363410 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m21:16:40.363747 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:40.368464 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:16:40.368865 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:40.369294 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m21:16:40.369656 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m21:16:40.369988 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:16:40.521174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m21:16:40.522654 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m21:16:40.523193 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.153 seconds
[0m21:16:40.524042 [debug] [Thread-4 (]: SQL status: COMMIT in 0.153 seconds
[0m21:16:40.528321 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m21:16:40.531172 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m21:16:40.534690 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m21:16:40.537058 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m21:16:40.538272 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:16:40.539282 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:16:40.540312 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:16:40.542498 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m21:16:40.543168 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m21:16:40.543644 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m21:16:40.544406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460f7a0>]}
[0m21:16:40.545122 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.06s]
[0m21:16:40.545671 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m21:16:40.546058 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m21:16:40.546753 [info ] [Thread-2 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m21:16:40.547241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_deal_userfields)
[0m21:16:40.547589 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m21:16:40.550740 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:40.553323 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m21:16:40.556155 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:40.556847 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:40.557139 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m21:16:40.557411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:40.715129 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.171 seconds
[0m21:16:40.715681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.171 seconds
[0m21:16:40.716158 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.172 seconds
[0m21:16:40.717810 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m21:16:40.719222 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m21:16:40.720617 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m21:16:40.721664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a3b3e0>]}
[0m21:16:40.722411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c00050>]}
[0m21:16:40.723548 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.24s]
[0m21:16:40.724053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a19c10>]}
[0m21:16:40.724747 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.24s]
[0m21:16:40.725434 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m21:16:40.726061 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.24s]
[0m21:16:40.726687 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m21:16:40.727171 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m21:16:40.727976 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m21:16:40.728509 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m21:16:40.729114 [info ] [Thread-4 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m21:16:40.729618 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m21:16:40.730246 [info ] [Thread-1 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m21:16:40.730803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_dealcategory)
[0m21:16:40.731296 [info ] [Thread-3 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m21:16:40.731721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m21:16:40.732103 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m21:16:40.732463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m21:16:40.732824 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m21:16:40.736515 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:40.736906 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m21:16:40.739434 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m21:16:40.742284 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m21:16:40.742960 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m21:16:40.745846 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:40.746376 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m21:16:40.746673 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m21:16:40.750529 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m21:16:40.783857 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:40.785699 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m21:16:40.786037 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m21:16:40.786385 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:16:40.786644 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:40.787075 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:40.787329 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m21:16:40.787560 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m21:16:40.787748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:40.787936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:41.779304 [debug] [Thread-2 (]: SQL status: BEGIN in 1.221 seconds
[0m21:16:41.782380 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:41.783381 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	(("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb) ->> 'br' as friendly_name,
	jsonb_path_query_array(
		replace(
			replace("CONTENT" ->> 'LIST', '''', '"'),
			'None',
			'null'
		) :: jsonb,
		'$[*].VALUE'
	) as options,
	replace(
		replace("CONTENT" ->> 'LIST', '''', '"'),
		'None',
		'null'
	) :: jsonb as list,
	("CONTENT" ->> 'SORT') :: int2 as sort,
	("CONTENT" ->> 'XML_ID') :: text as xml_id,
	("CONTENT" ->> 'MULTIPLE') :: bool as multiple,
	replace(
		replace("CONTENT" ->> 'SETTINGS', '''', '"'),
		'None',
		'null'
	) :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	("CONTENT" ->> 'MANDATORY') :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	("CONTENT" ->> 'EDIT_IN_LIST') :: bool as edit_in_list,
	("CONTENT" ->> 'SHOW_IN_LIST') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	("CONTENT" ->> 'IS_SEARCHABLE') :: bool as is_searchable,
	("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb as edit_form_label,
	("CONTENT" ->> 'ERROR_MESSAGE') :: jsonb as error_message,
	("CONTENT" ->> 'HELP_MESSAGE') :: jsonb as help_message,
	("CONTENT" ->> 'LIST_COLUMN_LABEL') :: jsonb as list_column_label,
	("CONTENT" ->> 'LIST_FILTER_LABEL') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m21:16:41.947423 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m21:16:41.956750 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:41.957302 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m21:16:42.021370 [debug] [Thread-1 (]: SQL status: BEGIN in 1.234 seconds
[0m21:16:42.021836 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:42.022333 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'CREATED_BY') :: int2 as created_by,
  ("CONTENT" ->> 'DATE_CREATE') :: timestamptz as date_create,
  ("CONTENT" ->> 'MODIFIED_BY') :: int2 as modified_by,
  ("CONTENT" ->> 'ACTIVE') :: bool as active,
  ("CONTENT" ->> 'CATALOG_ID') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  ("CONTENT" ->> 'MEASURE') :: int2 as measure,
  ("CONTENT" ->> 'PRICE') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  ("CONTENT" ->> 'SORT') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  ("CONTENT" ->> 'VAT_ID') :: int2 as vat_id,
  ("CONTENT" ->> 'VAT_INCLUDED') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m21:16:42.026811 [debug] [Thread-3 (]: SQL status: BEGIN in 1.239 seconds
[0m21:16:42.027291 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:42.027896 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	("CONTENT" ->> 'ACTIVE') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	("CONTENT" ->> 'IS_ONLINE') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	("CONTENT" ->> 'LAST_LOGIN') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	("CONTENT" ->> 'TIMESTAMP_X') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	("CONTENT" ->> 'DATE_REGISTER') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	("CONTENT" ->> 'UF_DEPARTMENT') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	("CONTENT" ->> 'UF_PHONE_INNER') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	("CONTENT" ->> 'LAST_ACTIVITY_DATE') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m21:16:42.078308 [debug] [Thread-4 (]: SQL status: BEGIN in 1.291 seconds
[0m21:16:42.080365 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:42.081471 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'CREATED_DATE') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m21:16:42.108705 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:16:42.116418 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:42.117067 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m21:16:42.190066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m21:16:42.199911 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:42.200509 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.172 seconds
[0m21:16:42.201122 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m21:16:42.205140 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:42.205800 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m21:16:42.251656 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.169 seconds
[0m21:16:42.257463 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:42.258094 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m21:16:42.280234 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.163 seconds
[0m21:16:42.283083 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m21:16:42.283653 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:42.284160 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m21:16:42.357605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m21:16:42.358619 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m21:16:42.363083 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:42.366385 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:42.366863 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m21:16:42.367316 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m21:16:42.415866 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m21:16:42.422029 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:42.422592 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m21:16:42.446997 [debug] [Thread-2 (]: SQL status: COMMIT in 0.162 seconds
[0m21:16:42.452896 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m21:16:42.454016 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:16:42.454552 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m21:16:42.519342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:16:42.520759 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m21:16:42.525150 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m21:16:42.527171 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m21:16:42.527630 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:42.528077 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:42.528506 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m21:16:42.528905 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m21:16:42.573472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m21:16:42.577505 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:16:42.578289 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:42.579037 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:16:42.607179 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m21:16:42.612343 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m21:16:42.614259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121af4230>]}
[0m21:16:42.615382 [info ] [Thread-2 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.07s]
[0m21:16:42.616228 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m21:16:42.682251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m21:16:42.683353 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m21:16:42.690708 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m21:16:42.693390 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m21:16:42.694365 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:16:42.695202 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:16:42.695651 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m21:16:42.696064 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m21:16:42.730953 [debug] [Thread-4 (]: SQL status: COMMIT in 0.151 seconds
[0m21:16:42.733987 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m21:16:42.734851 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:16:42.735276 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m21:16:42.853482 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.156 seconds
[0m21:16:42.855213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.159 seconds
[0m21:16:42.858763 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m21:16:42.860764 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m21:16:42.862082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de26c0>]}
[0m21:16:42.862820 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de20c0>]}
[0m21:16:42.863824 [info ] [Thread-1 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.13s]
[0m21:16:42.864492 [info ] [Thread-3 (]: 8 of 9 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.13s]
[0m21:16:42.865327 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m21:16:42.865928 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m21:16:42.866748 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m21:16:42.867282 [info ] [Thread-2 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m21:16:42.867767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_curated_deal)
[0m21:16:42.868184 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m21:16:42.873514 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m21:16:42.876353 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m21:16:42.894447 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.159 seconds
[0m21:16:42.894870 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m21:16:42.895853 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m21:16:42.896449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12101f320>]}
[0m21:16:42.896767 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:42.897200 [info ] [Thread-4 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.17s]
[0m21:16:42.897501 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m21:16:42.897847 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m21:16:42.898086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:44.137375 [debug] [Thread-2 (]: SQL status: BEGIN in 1.238 seconds
[0m21:16:44.139926 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:44.142021 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	x.id,
	x.title AS titulo,
	x1.name AS estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity AS mrr,
	x.company_id,
	x.contact_id,
	x2.name AS atribuido_por,
	x.opened AS aberto,
	x.begin_date AS data_de_inicio,
	x.closed AS encerrado,
	x.close_date AS data_de_encerramento,
	x.date_create AS criado_em,
	x5.name AS criado_por,
	x.date_modify AS modificado_em,
	x4.name AS modificdo_por,
	x.moved_time AS movido_em,
	x3.name AS movido_por,
	x.last_activity_time AS ultima_atividade_em,
	x6.name AS ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id AS id_lead,
	x.type_id AS id_tipo,
	x.comments AS comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id AS moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring AS recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 AS quantidade_de_usuarios,
	x.uf_crm_1718893063318 AS ponto_focal,
	x.uf_crm_1721248408791 AS email_ponto_focal,
	x.uf_crm_1718895613676 AS erp,
	x.uf_crm_1718895632531 AS segmento,
	x.uf_crm_1718895837277 AS perfil,
	x.uf_crm_1719234554494 AS email_financeiro,
	x.uf_crm_1719234611470 AS forma_pgto_implementacao,
	x.uf_crm_1719234653377 AS forma_pgto_recorrencia,
	x.uf_crm_1719851689133 AS vr_negociado_recorrencia,
	x.uf_crm_1719851724735 AS vr_negociado_implementacao,
	x.uf_crm_1719942627227 AS anexar_o_contrato,
	x.uf_crm_1720015348995 AS contrato_do_setup,
	x.uf_crm_1720198477652 AS valor_negociado_ativacao,
	x.uf_crm_1720198502628 AS valor_negociado_integracao,
	x.uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 AS vr_transacionado_em_marco,
	x.uf_crm_1721083861185 AS vr_transacionado_em_abril,
	x.uf_crm_1721083874978 AS vr_transacionado_em_maio,
	x.uf_crm_1721083894608 AS vr_transacionado_em_junho,
	x.uf_crm_1721083906720 AS vr_transacionado_em_julho,
	x.uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	x.uf_crm_1726007497 AS vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 AS vr_transacionado_novembro,
	x.uf_crm_1721226126 AS modulo_do_sistema,
	x.uf_crm_1721227124 AS ambiente,
	x.uf_crm_1721241190 AS classificacao_do_atendimento,
	x.uf_crm_1721243220370 AS area,
	x.uf_crm_1721243302036 AS descricao,
	x.uf_crm_1721243367 AS arquivos,
	x.uf_crm_1721244413245 AS carro_chefe,
	x.uf_crm_1721244451568 AS faturamento_medio_mensal,
	x.uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 AS vendedor_destaque,
	x.uf_crm_1721244560622 AS pretende_estar_operando_em,
	x.uf_crm_1721244826264 AS motivo_do_cancelamento,
	x.uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 AS data_do_churn,
	x.uf_crm_1724261215 AS media_de_faturamento,
	x.uf_crm_1725574177266 AS id_asaas,
	x.uf_crm_1725574322 AS status_do_pagamento,
	x.uf_crm_1725548469220 AS data_solicitacao_upsell,
	x.uf_crm_1726002322164 AS expectativa_com_o_projeto,
	x.uf_crm_1726003734 AS status_do_projeto,
	x.uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 AS novo_valor,
	x.uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 AS quantidade_de_pedidos,
	x.uf_crm_1741275566502 AS valor_faturado,
	x.uf_crm_1741275596050 AS produto,
	x.uf_crm_1741275610428 AS valor_vendido,
	x.uf_crm_1741275634394 AS qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 AS plano,
	x.uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1 ON x.stage_id = x1.status_id
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2 ON x.assigned_by_id = x2."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3 ON x.moved_by_id = x3."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4 ON x.modify_by_id = x4."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5 ON x.created_by_id = x5."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6 ON x.last_activity_by = x6."id"
  );
  
[0m21:16:44.470657 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.327 seconds
[0m21:16:44.478285 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:44.478903 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m21:16:44.631949 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m21:16:44.638948 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:44.639677 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m21:16:44.790143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:16:44.802692 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m21:16:44.803416 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:44.803845 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m21:16:44.955130 [debug] [Thread-2 (]: SQL status: COMMIT in 0.151 seconds
[0m21:16:44.957954 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m21:16:44.960862 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:16:44.961238 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m21:16:45.122725 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.160 seconds
[0m21:16:45.126441 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m21:16:45.127822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a776abe-54f1-4efa-8df7-7195b1df9859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de20c0>]}
[0m21:16:45.128870 [info ] [Thread-2 (]: 9 of 9 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.26s]
[0m21:16:45.129820 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m21:16:45.131919 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:45.132623 [debug] [MainThread]: On master: BEGIN
[0m21:16:45.133018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:46.370868 [debug] [MainThread]: SQL status: BEGIN in 1.237 seconds
[0m21:16:46.372600 [debug] [MainThread]: On master: COMMIT
[0m21:16:46.373442 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:46.373995 [debug] [MainThread]: On master: COMMIT
[0m21:16:46.524910 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m21:16:46.527283 [debug] [MainThread]: On master: Close
[0m21:16:46.530883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:46.531844 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m21:16:46.532329 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m21:16:46.532792 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m21:16:46.533253 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m21:16:46.534195 [info ] [MainThread]: 
[0m21:16:46.535175 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 12.96 seconds (12.96s).
[0m21:16:46.537674 [debug] [MainThread]: Command end result
[0m21:16:46.560081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:16:46.561449 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:16:46.565811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m21:16:46.566068 [info ] [MainThread]: 
[0m21:16:46.566334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:46.566540 [info ] [MainThread]: 
[0m21:16:46.566764 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m21:16:46.568592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.480232, "process_in_blocks": "0", "process_kernel_time": 0.26753, "process_mem_max_rss": "129351680", "process_out_blocks": "0", "process_user_time": 1.746588}
[0m21:16:46.569009 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:46.568927 after 13.48 seconds
[0m21:16:46.569288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107750ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215896d0>]}
[0m21:16:46.569567 [debug] [MainThread]: Flushing usage events
[0m21:16:47.537241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:54.965745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536de0>]}


============================== 21:17:54.968798 | 871f0e6c-e287-459e-bcd3-860195397101 ==============================
[0m21:17:54.968798 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:17:54.969168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:17:55.052596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536fc0>]}
[0m21:17:55.079947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106496810>]}
[0m21:17:55.080986 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:17:55.141406 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m21:17:55.200169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:17:55.200611 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_company.sql
[0m21:17:55.319305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a12e0>]}
[0m21:17:55.352294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:17:55.354184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:17:55.363207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110693650>]}
[0m21:17:55.363497 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m21:17:55.363693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a10a0>]}
[0m21:17:55.364631 [info ] [MainThread]: 
[0m21:17:55.364824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:55.364967 [info ] [MainThread]: 
[0m21:17:55.365226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:55.367425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m21:17:55.396007 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m21:17:55.396298 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m21:17:55.396465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:56.642139 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.245 seconds
[0m21:17:56.643831 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m21:17:56.645511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m21:17:56.650739 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m21:17:56.651323 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m21:17:56.651606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:57.884072 [debug] [ThreadPool]: SQL status: BEGIN in 1.231 seconds
[0m21:17:57.886527 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m21:17:57.887582 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m21:17:58.039842 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.151 seconds
[0m21:17:58.045520 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m21:17:58.195536 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m21:17:58.209807 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:58.210458 [debug] [MainThread]: On master: BEGIN
[0m21:17:58.210844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:59.435224 [debug] [MainThread]: SQL status: BEGIN in 1.223 seconds
[0m21:17:59.437586 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:59.438794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:17:59.594126 [debug] [MainThread]: SQL status: SELECT 8 in 0.154 seconds
[0m21:17:59.601521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439a240>]}
[0m21:17:59.602381 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:59.751229 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:59.753593 [debug] [MainThread]: On master: BEGIN
[0m21:18:00.050574 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m21:18:00.051308 [debug] [MainThread]: On master: COMMIT
[0m21:18:00.051930 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:00.052394 [debug] [MainThread]: On master: COMMIT
[0m21:18:00.202908 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m21:18:00.204428 [debug] [MainThread]: On master: Close
[0m21:18:00.209938 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m21:18:00.210731 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m21:18:00.211296 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m21:18:00.211855 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:00.212507 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m21:18:00.213147 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m21:18:00.213724 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m21:18:00.214245 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m21:18:00.214798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m21:18:00.215169 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m21:18:00.215521 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m21:18:00.215832 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m21:18:00.216098 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m21:18:00.216350 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m21:18:00.216595 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m21:18:00.216972 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:00.224733 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m21:18:00.227661 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m21:18:00.230974 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m21:18:00.233209 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:00.234722 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m21:18:00.235025 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m21:18:00.235338 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m21:18:00.249536 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:00.260048 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m21:18:00.262118 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m21:18:00.264046 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m21:18:00.265859 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:00.266760 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:00.267151 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:00.267423 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:00.267654 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m21:18:00.267907 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m21:18:00.268124 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:00.268335 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m21:18:00.268546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:00.268756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:18:00.268959 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m21:18:00.269153 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:18:00.269511 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:18:01.511549 [debug] [Thread-4 (]: SQL status: BEGIN in 1.241 seconds
[0m21:18:01.513616 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:01.515407 [debug] [Thread-3 (]: SQL status: BEGIN in 1.246 seconds
[0m21:18:01.516244 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m21:18:01.516878 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:01.518327 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m21:18:01.543684 [debug] [Thread-2 (]: SQL status: BEGIN in 1.273 seconds
[0m21:18:01.546233 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:01.547318 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m21:18:01.548871 [debug] [Thread-1 (]: SQL status: BEGIN in 1.280 seconds
[0m21:18:01.549607 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:01.550255 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') :: VARCHAR AS subject,
  ("CONTENT" ->> 'DESCRIPTION') :: VARCHAR AS description,
  ("CONTENT" ->> 'TYPE_ID') :: VARCHAR AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') :: VARCHAR AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') :: VARCHAR AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') :: VARCHAR AS priority,
  ("CONTENT" ->> 'OWNER_ID') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') :: VARCHAR AS owner_type_id,
  ("CONTENT" ->> 'RESPONSIBLE_ID') :: INTEGER AS responsible_id,
  ("CONTENT" ->> 'COMPLETED') :: BOOLEAN AS completed,
  ("CONTENT" ->> 'STATUS') :: INTEGER AS status,
  ("CONTENT" ->> 'CREATED') :: TIMESTAMP AS created,
  ("CONTENT" ->> 'LAST_UPDATED') :: TIMESTAMP AS last_updated
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m21:18:01.677634 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m21:18:01.683125 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:01.683672 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m21:18:01.685221 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m21:18:01.687894 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:01.688189 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m21:18:01.709459 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m21:18:01.712343 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:01.712676 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m21:18:01.712980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m21:18:01.715431 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:01.715729 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m21:18:01.831731 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m21:18:01.838531 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:01.839190 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:01.839798 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m21:18:01.843287 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:01.843871 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m21:18:01.862351 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:18:01.865712 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:01.866272 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m21:18:01.866849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:01.871974 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:01.872428 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m21:18:01.992165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m21:18:01.993755 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:18:02.015470 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:18:02.017079 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m21:18:02.017491 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:02.017810 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:02.018116 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m21:18:02.018410 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m21:18:02.019539 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m21:18:02.020972 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m21:18:02.021294 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:02.021584 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m21:18:02.024288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:02.025704 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m21:18:02.026121 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:02.026448 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m21:18:02.180167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m21:18:02.180820 [debug] [Thread-4 (]: SQL status: COMMIT in 0.162 seconds
[0m21:18:02.186572 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m21:18:02.186919 [debug] [Thread-3 (]: SQL status: COMMIT in 0.168 seconds
[0m21:18:02.187154 [debug] [Thread-2 (]: SQL status: COMMIT in 0.165 seconds
[0m21:18:02.188710 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m21:18:02.191971 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m21:18:02.193419 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m21:18:02.194764 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m21:18:02.195253 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m21:18:02.195650 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m21:18:02.196305 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m21:18:02.196801 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m21:18:02.197055 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m21:18:02.197432 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m21:18:02.197763 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m21:18:02.349083 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.150 seconds
[0m21:18:02.350913 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m21:18:02.351609 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.153 seconds
[0m21:18:02.352267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.155 seconds
[0m21:18:02.357162 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m21:18:02.359197 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m21:18:02.360709 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m21:18:02.362214 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m21:18:02.366898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b7920>]}
[0m21:18:02.367299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5fc80>]}
[0m21:18:02.367715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c2d20>]}
[0m21:18:02.368032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e47e30>]}
[0m21:18:02.368734 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.15s]
[0m21:18:02.369372 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.15s]
[0m21:18:02.369932 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.15s]
[0m21:18:02.370467 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.15s]
[0m21:18:02.370980 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m21:18:02.371449 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m21:18:02.371941 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m21:18:02.372382 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m21:18:02.372779 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m21:18:02.373127 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:02.373568 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m21:18:02.373930 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m21:18:02.374368 [info ] [Thread-4 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m21:18:02.374814 [info ] [Thread-1 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m21:18:02.375204 [info ] [Thread-3 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m21:18:02.375599 [info ] [Thread-2 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m21:18:02.375993 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_deal_userfields)
[0m21:18:02.376311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m21:18:02.376614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_product)
[0m21:18:02.376926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_user)
[0m21:18:02.377246 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m21:18:02.377531 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:02.377810 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m21:18:02.378086 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m21:18:02.381269 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:02.383406 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:02.385455 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m21:18:02.387698 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m21:18:02.388633 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m21:18:02.388927 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m21:18:02.389204 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:02.391745 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:02.392010 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m21:18:02.395209 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m21:18:02.397188 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:02.399442 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m21:18:02.399851 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:02.400210 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:02.400519 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m21:18:02.400894 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:02.401111 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m21:18:02.401345 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:02.401605 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:02.401833 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m21:18:02.402064 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:02.402301 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m21:18:02.402609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:02.402892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:03.674953 [debug] [Thread-3 (]: SQL status: BEGIN in 1.272 seconds
[0m21:18:03.675828 [debug] [Thread-2 (]: SQL status: BEGIN in 1.273 seconds
[0m21:18:03.676687 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:03.678010 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:03.678782 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'CREATED_BY') :: int2 as created_by,
  ("CONTENT" ->> 'DATE_CREATE') :: timestamptz as date_create,
  ("CONTENT" ->> 'MODIFIED_BY') :: int2 as modified_by,
  ("CONTENT" ->> 'ACTIVE') :: bool as active,
  ("CONTENT" ->> 'CATALOG_ID') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  ("CONTENT" ->> 'MEASURE') :: int2 as measure,
  ("CONTENT" ->> 'PRICE') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  ("CONTENT" ->> 'SORT') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  ("CONTENT" ->> 'VAT_ID') :: int2 as vat_id,
  ("CONTENT" ->> 'VAT_INCLUDED') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m21:18:03.679346 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	("CONTENT" ->> 'ACTIVE') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	("CONTENT" ->> 'IS_ONLINE') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	("CONTENT" ->> 'LAST_LOGIN') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	("CONTENT" ->> 'TIMESTAMP_X') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	("CONTENT" ->> 'DATE_REGISTER') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	("CONTENT" ->> 'UF_DEPARTMENT') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	("CONTENT" ->> 'UF_PHONE_INNER') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	("CONTENT" ->> 'LAST_ACTIVITY_DATE') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m21:18:03.684985 [debug] [Thread-1 (]: SQL status: BEGIN in 1.281 seconds
[0m21:18:03.686337 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:03.686949 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  ("CONTENT" ->> 'SORT') :: int4 as sort,
  ("CONTENT" ->> 'CREATED_DATE') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m21:18:03.698565 [debug] [Thread-4 (]: SQL status: BEGIN in 1.296 seconds
[0m21:18:03.700243 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:03.701098 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	(("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb) ->> 'br' as friendly_name,
	jsonb_path_query_array(
		replace(
			replace("CONTENT" ->> 'LIST', '''', '"'),
			'None',
			'null'
		) :: jsonb,
		'$[*].VALUE'
	) as options,
	replace(
		replace("CONTENT" ->> 'LIST', '''', '"'),
		'None',
		'null'
	) :: jsonb as list,
	("CONTENT" ->> 'SORT') :: int2 as sort,
	("CONTENT" ->> 'XML_ID') :: text as xml_id,
	("CONTENT" ->> 'MULTIPLE') :: bool as multiple,
	replace(
		replace("CONTENT" ->> 'SETTINGS', '''', '"'),
		'None',
		'null'
	) :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	("CONTENT" ->> 'MANDATORY') :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	("CONTENT" ->> 'EDIT_IN_LIST') :: bool as edit_in_list,
	("CONTENT" ->> 'SHOW_IN_LIST') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	("CONTENT" ->> 'IS_SEARCHABLE') :: bool as is_searchable,
	("CONTENT" ->> 'EDIT_FORM_LABEL') :: jsonb as edit_form_label,
	("CONTENT" ->> 'ERROR_MESSAGE') :: jsonb as error_message,
	("CONTENT" ->> 'HELP_MESSAGE') :: jsonb as help_message,
	("CONTENT" ->> 'LIST_COLUMN_LABEL') :: jsonb as list_column_label,
	("CONTENT" ->> 'LIST_FILTER_LABEL') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m21:18:03.842195 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m21:18:03.843523 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m21:18:03.849452 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:03.850006 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m21:18:03.853869 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:03.854408 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m21:18:03.857607 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:03.858013 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m21:18:03.858492 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m21:18:03.864652 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m21:18:03.867692 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:03.868111 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m21:18:04.008625 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:18:04.010418 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m21:18:04.017152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m21:18:04.017970 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:04.021264 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:04.021754 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m21:18:04.025006 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:04.025434 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m21:18:04.025817 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m21:18:04.028540 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:04.028952 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m21:18:04.029573 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m21:18:04.178705 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m21:18:04.180195 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:04.181296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:04.184951 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m21:18:04.185601 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m21:18:04.187776 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m21:18:04.189752 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:18:04.190208 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:04.191874 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m21:18:04.192303 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:04.192712 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:04.193121 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m21:18:04.193517 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:04.193897 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m21:18:04.194277 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m21:18:04.194747 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m21:18:04.347591 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m21:18:04.349880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m21:18:04.350728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.155 seconds
[0m21:18:04.357145 [debug] [Thread-4 (]: SQL status: COMMIT in 0.162 seconds
[0m21:18:04.357919 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m21:18:04.425314 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m21:18:04.426469 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m21:18:04.427585 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m21:18:04.428018 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m21:18:04.428396 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m21:18:04.428758 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m21:18:04.429107 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m21:18:04.429294 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m21:18:04.429476 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m21:18:04.429658 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m21:18:04.429839 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m21:18:04.580191 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.150 seconds
[0m21:18:04.580707 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.150 seconds
[0m21:18:04.582513 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m21:18:04.582894 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.153 seconds
[0m21:18:04.584266 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m21:18:04.584645 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.154 seconds
[0m21:18:04.585962 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m21:18:04.586557 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb59a0>]}
[0m21:18:04.587867 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m21:18:04.588259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108022d0>]}
[0m21:18:04.589810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110800500>]}
[0m21:18:04.589231 [info ] [Thread-2 (]: 8 of 9 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.21s]
[0m21:18:04.590621 [info ] [Thread-3 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.21s]
[0m21:18:04.591042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec5790>]}
[0m21:18:04.591602 [info ] [Thread-1 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.21s]
[0m21:18:04.592119 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m21:18:04.592555 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m21:18:04.593020 [info ] [Thread-4 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.22s]
[0m21:18:04.593462 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m21:18:04.594067 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m21:18:04.594589 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m21:18:04.595079 [info ] [Thread-2 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m21:18:04.595513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_user, now model.bdt_transformations.btx_curated_deal)
[0m21:18:04.595794 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m21:18:04.600029 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m21:18:04.600936 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m21:18:04.616464 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m21:18:04.617232 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:04.617474 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m21:18:04.617686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:05.829050 [debug] [Thread-2 (]: SQL status: BEGIN in 1.209 seconds
[0m21:18:05.831717 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:05.833838 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	x.id,
	x.title AS titulo,
	x1.name AS estagio,
	--x.category_id, -- nenhum deal possui este campo preenchido
	x.opportunity AS mrr,
	x.company_id,
	x.contact_id,
	x2.name AS atribuido_por,
	x.opened AS aberto,
	x.begin_date AS data_de_inicio,
	x.closed AS encerrado,
	x.close_date AS data_de_encerramento,
	x.date_create AS criado_em,
	x5.name AS criado_por,
	x.date_modify AS modificado_em,
	x4.name AS modificdo_por,
	x.moved_time AS movido_em,
	x3.name AS movido_por,
	x.last_activity_time AS ultima_atividade_em,
	x6.name AS ultima_atividade_por,
	--x.is_new, -- provavelmente indica se o deal é recente
	x.lead_id AS id_lead,
	x.type_id AS id_tipo,
	x.comments AS comentarios,
	--x.quote_id, -- provavelmente o id do orçamento
	--x.origin_id, -- nenhum valor preenchido
	x.source_id id_da_fonte,
	--x.source_description descricao_da_fonte, -- não utilizado
	--tax_value, -- valor do imposto
	x.currency_id AS moeda,
	--x.location_id, -- não utilizado
	--x.probability, -- provavelmente probabilidade de fechamento, não utilizado
	x.is_recurring AS recorrente,
	--x.additional_info, -- não utilizado
	--x.stage_semantic_id, -- não utilizado
	--x.originator_id, -- não utilizado
	x.is_manual_opportunity oportunidade_manual,
	x.is_return_customer cliente_retorno,
	x.is_repeated_approach abordagem_repetida,
	x.uf_crm_1718891707656 AS quantidade_de_usuarios,
	x.uf_crm_1718893063318 AS ponto_focal,
	x.uf_crm_1721248408791 AS email_ponto_focal,
	x.uf_crm_1718895613676 AS erp,
	x.uf_crm_1718895632531 AS segmento,
	x.uf_crm_1718895837277 AS perfil,
	x.uf_crm_1719234554494 AS email_financeiro,
	x.uf_crm_1719234611470 AS forma_pgto_implementacao,
	x.uf_crm_1719234653377 AS forma_pgto_recorrencia,
	x.uf_crm_1719851689133 AS vr_negociado_recorrencia,
	x.uf_crm_1719851724735 AS vr_negociado_implementacao,
	x.uf_crm_1719942627227 AS anexar_o_contrato,
	x.uf_crm_1720015348995 AS contrato_do_setup,
	x.uf_crm_1720198477652 AS valor_negociado_ativacao,
	x.uf_crm_1720198502628 AS valor_negociado_integracao,
	x.uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	x.uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	x.uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	x.uf_crm_1721083849804 AS vr_transacionado_em_marco,
	x.uf_crm_1721083861185 AS vr_transacionado_em_abril,
	x.uf_crm_1721083874978 AS vr_transacionado_em_maio,
	x.uf_crm_1721083894608 AS vr_transacionado_em_junho,
	x.uf_crm_1721083906720 AS vr_transacionado_em_julho,
	x.uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	x.uf_crm_1726007497 AS vr_transacionado_em_setembro,
	x.uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	x.uf_crm_1733168617374 AS vr_transacionado_novembro,
	x.uf_crm_1721226126 AS modulo_do_sistema,
	x.uf_crm_1721227124 AS ambiente,
	x.uf_crm_1721241190 AS classificacao_do_atendimento,
	x.uf_crm_1721243220370 AS area,
	x.uf_crm_1721243302036 AS descricao,
	x.uf_crm_1721243367 AS arquivos,
	x.uf_crm_1721244413245 AS carro_chefe,
	x.uf_crm_1721244451568 AS faturamento_medio_mensal,
	x.uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	x.uf_crm_1721244526025 AS vendedor_destaque,
	x.uf_crm_1721244560622 AS pretende_estar_operando_em,
	x.uf_crm_1721244826264 AS motivo_do_cancelamento,
	x.uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	x.uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	x.uf_crm_1721406278811 AS data_do_churn,
	x.uf_crm_1724261215 AS media_de_faturamento,
	x.uf_crm_1725574177266 AS id_asaas,
	x.uf_crm_1725574322 AS status_do_pagamento,
	x.uf_crm_1725548469220 AS data_solicitacao_upsell,
	x.uf_crm_1726002322164 AS expectativa_com_o_projeto,
	x.uf_crm_1726003734 AS status_do_projeto,
	x.uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	x.uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	x.uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	x.uf_crm_1733491265514 AS novo_valor,
	x.uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	x.uf_crm_1741275511723 AS quantidade_de_pedidos,
	x.uf_crm_1741275566502 AS valor_faturado,
	x.uf_crm_1741275596050 AS produto,
	x.uf_crm_1741275610428 AS valor_vendido,
	x.uf_crm_1741275634394 AS qtd_vendida,
	--x.uf_crm_66d0a6a12e620, -- não é usado
	--x.uf_crm_66d0a6a146d20, -- não é usado
	--x.uf_crm_66d0a6a1529fd, -- não é usado
	--x.uf_crm_66d0a6a15d94f, -- não é usado
	--x.uf_crm_66d0a6a169edc, -- não é usado
	x.uf_crm_deal_1719236124580 AS plano,
	x.uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	x.uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	x.uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	x.uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	x.uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	x.uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	x.uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	x.uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	x.uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	x.uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--x.utm_medium, --não é usado
	--x.utm_source, --não é usado
	--x.utm_term, -- não é usado
	--x.utm_content, -- não é usado
	--x.utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal" x
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" x1 ON x.stage_id = x1.status_id
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x2 ON x.assigned_by_id = x2."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x3 ON x.moved_by_id = x3."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x4 ON x.modify_by_id = x4."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x5 ON x.created_by_id = x5."id"
	LEFT JOIN "bendito_intelligence_dev"."bitrix"."btx_processed_user" x6 ON x.last_activity_by = x6."id"
  );
  
[0m21:18:06.089137 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.252 seconds
[0m21:18:06.095922 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:06.096419 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m21:18:06.248885 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m21:18:06.256525 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:06.257282 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m21:18:06.406765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m21:18:06.416867 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m21:18:06.417491 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:06.417919 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m21:18:06.619575 [debug] [Thread-2 (]: SQL status: COMMIT in 0.200 seconds
[0m21:18:06.625934 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m21:18:06.630694 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m21:18:06.631312 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m21:18:06.782528 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.151 seconds
[0m21:18:06.785122 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m21:18:06.785997 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871f0e6c-e287-459e-bcd3-860195397101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110463320>]}
[0m21:18:06.786756 [info ] [Thread-2 (]: 9 of 9 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.19s]
[0m21:18:06.787372 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m21:18:06.789025 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:06.789350 [debug] [MainThread]: On master: BEGIN
[0m21:18:06.789606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:08.017563 [debug] [MainThread]: SQL status: BEGIN in 1.227 seconds
[0m21:18:08.018408 [debug] [MainThread]: On master: COMMIT
[0m21:18:08.018722 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:08.018977 [debug] [MainThread]: On master: COMMIT
[0m21:18:08.170993 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m21:18:08.171631 [debug] [MainThread]: On master: Close
[0m21:18:08.172280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:08.172512 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m21:18:08.172715 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m21:18:08.172931 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m21:18:08.173108 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m21:18:08.173436 [info ] [MainThread]: 
[0m21:18:08.173705 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m21:18:08.175019 [debug] [MainThread]: Command end result
[0m21:18:08.189688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m21:18:08.191139 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m21:18:08.194983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m21:18:08.195232 [info ] [MainThread]: 
[0m21:18:08.195463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:08.195646 [info ] [MainThread]: 
[0m21:18:08.195838 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m21:18:08.197530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.261065, "process_in_blocks": "0", "process_kernel_time": 0.258281, "process_mem_max_rss": "128204800", "process_out_blocks": "0", "process_user_time": 1.721876}
[0m21:18:08.197787 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:08.197740 after 13.26 seconds
[0m21:18:08.198006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068148c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5fbc0>]}
[0m21:18:08.198221 [debug] [MainThread]: Flushing usage events
[0m21:18:09.058562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:20.543295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105933170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932db0>]}


============================== 22:18:20.546318 | 2a9e8412-a65b-489f-9af4-afc6cfe69153 ==============================
[0m22:18:20.546318 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:18:20.546706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:18:20.641399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfbe30>]}
[0m22:18:20.668477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3a10>]}
[0m22:18:20.669274 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:18:20.727729 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:18:20.788318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m22:18:20.788726 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_userfields.sql
[0m22:18:20.788934 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m22:18:20.789123 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m22:18:20.789309 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m22:18:20.789490 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_dealcategory.sql
[0m22:18:20.789676 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_product.sql
[0m22:18:20.789846 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_activity.sql
[0m22:18:20.918872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b5670>]}
[0m22:18:20.952162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:18:20.953800 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:18:20.963980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106799970>]}
[0m22:18:20.964269 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m22:18:20.964458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070310a0>]}
[0m22:18:20.965404 [info ] [MainThread]: 
[0m22:18:20.965599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:20.965745 [info ] [MainThread]: 
[0m22:18:20.966003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:20.968013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:18:20.995996 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:18:20.996246 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:18:20.996404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:22.273154 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.277 seconds
[0m22:18:22.275125 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:18:22.277083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m22:18:22.282813 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:18:22.283153 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m22:18:22.283420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:23.531681 [debug] [ThreadPool]: SQL status: BEGIN in 1.248 seconds
[0m22:18:23.533747 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:18:23.534954 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m22:18:23.704107 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.168 seconds
[0m22:18:23.710839 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m22:18:23.863457 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m22:18:23.874468 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:23.875073 [debug] [MainThread]: On master: BEGIN
[0m22:18:23.875396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:25.115567 [debug] [MainThread]: SQL status: BEGIN in 1.240 seconds
[0m22:18:25.116298 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:25.116670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:25.294257 [debug] [MainThread]: SQL status: SELECT 8 in 0.177 seconds
[0m22:18:25.297212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670f620>]}
[0m22:18:25.297722 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:25.447296 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:25.448539 [debug] [MainThread]: On master: BEGIN
[0m22:18:25.752314 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m22:18:25.754626 [debug] [MainThread]: On master: COMMIT
[0m22:18:25.755646 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:25.756726 [debug] [MainThread]: On master: COMMIT
[0m22:18:25.908389 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m22:18:25.910556 [debug] [MainThread]: On master: Close
[0m22:18:25.917641 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:18:25.918276 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m22:18:25.918785 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:18:25.919263 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:18:25.919957 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m22:18:25.920593 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m22:18:25.921147 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m22:18:25.921682 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m22:18:25.922270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m22:18:25.922860 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m22:18:25.923341 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:18:25.923786 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:18:25.924157 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:18:25.924497 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m22:18:25.924826 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:18:25.925160 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:18:25.933181 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:18:25.936072 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m22:18:25.939122 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:18:25.942841 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:25.944704 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:18:25.945007 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m22:18:25.945270 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:18:25.958972 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m22:18:25.967439 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:18:25.969439 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m22:18:25.971288 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:25.973082 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m22:18:25.974095 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:25.974347 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:25.974592 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:18:25.974846 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:25.975085 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:18:25.975309 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:25.975516 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:25.975705 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m22:18:25.975883 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:18:25.976148 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m22:18:25.976333 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:25.976582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:27.214894 [debug] [Thread-2 (]: SQL status: BEGIN in 1.238 seconds
[0m22:18:27.215307 [debug] [Thread-1 (]: SQL status: BEGIN in 1.239 seconds
[0m22:18:27.215714 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:27.216057 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:27.216525 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m22:18:27.217017 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m22:18:27.227324 [debug] [Thread-4 (]: SQL status: BEGIN in 1.251 seconds
[0m22:18:27.227675 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:27.227978 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m22:18:27.230207 [debug] [Thread-3 (]: SQL status: BEGIN in 1.255 seconds
[0m22:18:27.230468 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:27.231069 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m22:18:27.428244 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.199 seconds
[0m22:18:27.430745 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.213 seconds
[0m22:18:27.439235 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.222 seconds
[0m22:18:27.444596 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:27.445059 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.213 seconds
[0m22:18:27.448477 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:27.451488 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:27.452006 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m22:18:27.454669 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:27.455017 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m22:18:27.455361 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m22:18:27.455810 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m22:18:27.606651 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:18:27.608038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m22:18:27.608592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m22:18:27.613731 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:27.614308 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m22:18:27.619376 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:27.622487 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:27.622904 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m22:18:27.625572 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:27.625967 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m22:18:27.626358 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m22:18:27.626829 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m22:18:27.781041 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m22:18:27.782618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m22:18:27.783240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m22:18:27.783738 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m22:18:27.801062 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:18:27.802568 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:18:27.803955 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:18:27.805262 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:18:27.805625 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:27.805944 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:27.806247 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:27.806544 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:27.806853 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:18:27.807138 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:18:27.807424 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:18:27.807702 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:18:27.957985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m22:18:27.959999 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m22:18:27.970515 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m22:18:27.973274 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m22:18:27.978492 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:18:27.979230 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:18:27.979595 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m22:18:27.979934 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m22:18:28.002515 [debug] [Thread-4 (]: SQL status: COMMIT in 0.194 seconds
[0m22:18:28.002935 [debug] [Thread-3 (]: SQL status: COMMIT in 0.195 seconds
[0m22:18:28.005127 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m22:18:28.007168 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m22:18:28.007889 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:18:28.008570 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:18:28.008911 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m22:18:28.009224 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m22:18:28.139693 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.159 seconds
[0m22:18:28.147576 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m22:18:28.148025 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.168 seconds
[0m22:18:28.149400 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m22:18:28.152643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078138f0>]}
[0m22:18:28.152999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784fad0>]}
[0m22:18:28.153671 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.23s]
[0m22:18:28.154201 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.23s]
[0m22:18:28.154665 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:18:28.155048 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m22:18:28.155386 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:18:28.155836 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:18:28.156228 [info ] [Thread-1 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m22:18:28.156632 [info ] [Thread-2 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m22:18:28.156983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_deal_userfields)
[0m22:18:28.157273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_dealcategory)
[0m22:18:28.157553 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m22:18:28.157824 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:18:28.160337 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:28.162362 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:28.162706 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:18:28.162941 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:18:28.163913 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:18:28.164823 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:18:28.165331 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:18:28.165634 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m22:18:28.166013 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107855670>]}
[0m22:18:28.168495 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:28.168911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fba70>]}
[0m22:18:28.172061 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:28.172477 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.24s]
[0m22:18:28.172934 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.25s]
[0m22:18:28.173399 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:18:28.173645 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:28.173966 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:18:28.174244 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m22:18:28.174495 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:28.174747 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:18:28.175009 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m22:18:28.175377 [info ] [Thread-4 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m22:18:28.175640 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m22:18:28.175860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:28.176134 [info ] [Thread-3 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m22:18:28.176554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m22:18:28.176802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:28.177145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m22:18:28.177379 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m22:18:28.177691 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m22:18:28.179634 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m22:18:28.181277 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m22:18:28.182221 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m22:18:28.184207 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m22:18:28.184432 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m22:18:28.186353 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m22:18:28.186708 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:28.186949 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m22:18:28.187162 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:18:28.187368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:18:28.187571 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m22:18:28.187829 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:29.487896 [debug] [Thread-4 (]: SQL status: BEGIN in 1.300 seconds
[0m22:18:29.490272 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:29.491558 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m22:18:29.494529 [debug] [Thread-3 (]: SQL status: BEGIN in 1.307 seconds
[0m22:18:29.495127 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:18:29.495779 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m22:18:29.497676 [debug] [Thread-1 (]: SQL status: BEGIN in 1.321 seconds
[0m22:18:29.498187 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:29.498835 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m22:18:29.531136 [debug] [Thread-2 (]: SQL status: BEGIN in 1.355 seconds
[0m22:18:29.533411 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:29.534136 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m22:18:29.647252 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 30:  NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zo...
                                                 ^

[0m22:18:29.649083 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: ROLLBACK
[0m22:18:29.654278 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m22:18:29.662723 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:29.663375 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m22:18:29.664022 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m22:18:29.668036 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:29.668632 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m22:18:29.695775 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m22:18:29.700210 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:29.700774 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m22:18:29.799278 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m22:18:29.812373 [debug] [Thread-3 (]: Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near ")"
  LINE 30:  NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zo...
                                                   ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql
[0m22:18:29.813130 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078dc230>]}
[0m22:18:29.814009 [error] [Thread-3 (]: 8 of 9 ERROR creating sql view model bitrix.btx_processed_user ................. [[31mERROR[0m in 1.64s]
[0m22:18:29.814656 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m22:18:29.815087 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m22:18:29.815582 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_processed_user' to be skipped because of status 'error'.  Reason: Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near ")"
  LINE 30:  NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zo...
                                                   ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql.
[0m22:18:29.816119 [info ] [Thread-3 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m22:18:29.817643 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:18:29.818109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_user, now model.bdt_transformations.btx_curated_deal)
[0m22:18:29.821094 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:29.821450 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m22:18:29.821784 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m22:18:29.825138 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m22:18:29.825480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m22:18:29.828110 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:29.828447 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m22:18:29.829037 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m22:18:29.874659 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m22:18:29.878539 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m22:18:29.880392 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:29.880730 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m22:18:29.881247 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:18:29.881437 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m22:18:29.881612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:29.975504 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:18:29.976951 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:18:29.977242 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:29.977484 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:18:29.978009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:18:29.979060 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:18:29.979314 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:29.979544 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:18:30.031007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:18:30.032724 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:18:30.033076 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:30.033391 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:18:30.132376 [debug] [Thread-4 (]: SQL status: COMMIT in 0.154 seconds
[0m22:18:30.133327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m22:18:30.137997 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m22:18:30.140866 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m22:18:30.141779 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:18:30.142640 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:18:30.143090 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m22:18:30.143524 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m22:18:30.184365 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m22:18:30.190110 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m22:18:30.191229 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:18:30.191767 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m22:18:30.297060 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.152 seconds
[0m22:18:30.298589 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.155 seconds
[0m22:18:30.302847 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m22:18:30.304788 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m22:18:30.305937 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784efc0>]}
[0m22:18:30.306563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf9640>]}
[0m22:18:30.307422 [info ] [Thread-4 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.13s]
[0m22:18:30.308127 [info ] [Thread-1 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.15s]
[0m22:18:30.308785 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m22:18:30.309387 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:18:30.344127 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m22:18:30.346251 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:18:30.347237 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784f380>]}
[0m22:18:30.348086 [info ] [Thread-2 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.19s]
[0m22:18:30.348852 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:18:31.176694 [debug] [Thread-3 (]: SQL status: BEGIN in 1.295 seconds
[0m22:18:31.177809 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:18:31.178890 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	name AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	name AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m22:18:31.384027 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 31:  name AS id_movido_por,
          ^

[0m22:18:31.386322 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: ROLLBACK
[0m22:18:31.549516 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m22:18:31.555970 [debug] [Thread-3 (]: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "name" does not exist
  LINE 31:  name AS id_movido_por,
            ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m22:18:31.557098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9e8412-a65b-489f-9af4-afc6cfe69153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfacf0>]}
[0m22:18:31.558107 [error] [Thread-3 (]: 9 of 9 ERROR creating sql table model bitrix.btx_curated_deal .................. [[31mERROR[0m in 1.74s]
[0m22:18:31.558796 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m22:18:31.559383 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_curated_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "name" does not exist
  LINE 31:  name AS id_movido_por,
            ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql.
[0m22:18:31.561427 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:31.561900 [debug] [MainThread]: On master: BEGIN
[0m22:18:31.562250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:32.767844 [debug] [MainThread]: SQL status: BEGIN in 1.205 seconds
[0m22:18:32.768962 [debug] [MainThread]: On master: COMMIT
[0m22:18:32.769487 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:32.769936 [debug] [MainThread]: On master: COMMIT
[0m22:18:32.917330 [debug] [MainThread]: SQL status: COMMIT in 0.147 seconds
[0m22:18:32.918190 [debug] [MainThread]: On master: Close
[0m22:18:32.919190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:32.919568 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m22:18:32.919907 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:18:32.920216 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m22:18:32.920523 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m22:18:32.921033 [info ] [MainThread]: 
[0m22:18:32.921447 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 11.95 seconds (11.95s).
[0m22:18:32.923373 [debug] [MainThread]: Command end result
[0m22:18:32.944955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:18:32.946972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:18:32.951505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:18:32.951773 [info ] [MainThread]: 
[0m22:18:32.952039 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:18:32.952260 [info ] [MainThread]: 
[0m22:18:32.952520 [error] [MainThread]:   Database Error in model btx_processed_user (models/bitrix/btx_processed_user.sql)
  syntax error at or near ")"
  LINE 30:  NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET') :: int4 AS time_zo...
                                                   ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_processed_user.sql
[0m22:18:32.952742 [info ] [MainThread]: 
[0m22:18:32.952979 [error] [MainThread]:   Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "name" does not exist
  LINE 31:  name AS id_movido_por,
            ^
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m22:18:32.953182 [info ] [MainThread]: 
[0m22:18:32.953402 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m22:18:32.955212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.446193, "process_in_blocks": "0", "process_kernel_time": 0.252342, "process_mem_max_rss": "130023424", "process_out_blocks": "0", "process_user_time": 1.684562}
[0m22:18:32.955604 [debug] [MainThread]: Command `dbt run` failed at 22:18:32.955538 after 12.45 seconds
[0m22:18:32.955895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100246db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7fbc0>]}
[0m22:18:32.956176 [debug] [MainThread]: Flushing usage events
[0m22:18:34.047907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:20:28.978803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bccec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943ac60>]}


============================== 22:20:28.981692 | 9113ff0f-9b3f-4f58-975c-22d1ba4b887e ==============================
[0m22:20:28.981692 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:20:28.982051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:20:29.065586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c7b60>]}
[0m22:20:29.093023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc9100>]}
[0m22:20:29.093836 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:20:29.152597 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:20:29.211671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:20:29.212098 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_processed_user.sql
[0m22:20:29.212312 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m22:20:29.335290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a15e7e0>]}
[0m22:20:29.369476 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:20:29.371153 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:20:29.380055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7cec0>]}
[0m22:20:29.380356 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m22:20:29.380540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109facda0>]}
[0m22:20:29.381480 [info ] [MainThread]: 
[0m22:20:29.381678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:29.381830 [info ] [MainThread]: 
[0m22:20:29.382087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:20:29.384377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:20:29.412352 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:20:29.412628 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:20:29.412792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:30.659848 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.247 seconds
[0m22:20:30.661534 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:20:30.663283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m22:20:30.668511 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:20:30.668837 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m22:20:30.669083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:31.885444 [debug] [ThreadPool]: SQL status: BEGIN in 1.216 seconds
[0m22:20:31.888779 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:20:31.889577 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m22:20:32.043912 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.153 seconds
[0m22:20:32.049071 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m22:20:32.197502 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m22:20:32.210919 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:32.211480 [debug] [MainThread]: On master: BEGIN
[0m22:20:32.211849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:33.470026 [debug] [MainThread]: SQL status: BEGIN in 1.257 seconds
[0m22:20:33.472262 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:33.473534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:20:33.633186 [debug] [MainThread]: SQL status: SELECT 8 in 0.158 seconds
[0m22:20:33.641486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a247f20>]}
[0m22:20:33.642336 [debug] [MainThread]: On master: ROLLBACK
[0m22:20:33.792145 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:33.794886 [debug] [MainThread]: On master: BEGIN
[0m22:20:34.095214 [debug] [MainThread]: SQL status: BEGIN in 0.299 seconds
[0m22:20:34.096080 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.096516 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.096872 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.246551 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m22:20:34.248562 [debug] [MainThread]: On master: Close
[0m22:20:34.257739 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:20:34.258444 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m22:20:34.259225 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m22:20:34.259843 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:20:34.260397 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:20:34.260935 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m22:20:34.261560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m22:20:34.262102 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m22:20:34.262621 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m22:20:34.263196 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m22:20:34.263612 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:20:34.264101 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:20:34.264585 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:20:34.264973 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m22:20:34.273446 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:20:34.273832 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:20:34.274175 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:20:34.277073 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m22:20:34.280297 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:20:34.282402 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:34.283047 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m22:20:34.289770 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m22:20:34.302351 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:20:34.312020 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m22:20:34.312829 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m22:20:34.314781 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:20:34.315027 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:20:34.317229 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:34.317528 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:34.317881 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:34.318131 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:34.318361 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m22:20:34.318561 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:34.318763 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:20:34.318955 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m22:20:34.319145 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:34.319333 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:20:34.319588 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:20:34.319772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:34.320018 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:20:35.553721 [debug] [Thread-2 (]: SQL status: BEGIN in 1.234 seconds
[0m22:20:35.556048 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:35.557933 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m22:20:35.560481 [debug] [Thread-3 (]: SQL status: BEGIN in 1.241 seconds
[0m22:20:35.560963 [debug] [Thread-4 (]: SQL status: BEGIN in 1.241 seconds
[0m22:20:35.561397 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:35.561809 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:35.562735 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m22:20:35.563651 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m22:20:35.577591 [debug] [Thread-1 (]: SQL status: BEGIN in 1.258 seconds
[0m22:20:35.577958 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:35.578444 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m22:20:35.720224 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m22:20:35.726795 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:35.727255 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m22:20:35.727751 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m22:20:35.730523 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:35.730862 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m22:20:35.731344 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m22:20:35.733979 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:35.734360 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m22:20:35.737482 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m22:20:35.739773 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:35.740038 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m22:20:35.879164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m22:20:35.886006 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:35.886861 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m22:20:35.887601 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m22:20:35.891065 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:35.891560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:20:35.892066 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m22:20:35.896656 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:35.897162 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m22:20:35.915536 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.181 seconds
[0m22:20:35.918809 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:35.919267 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m22:20:36.039997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m22:20:36.052940 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m22:20:36.059708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.162 seconds
[0m22:20:36.063671 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:20:36.065292 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:20:36.066665 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:20:36.067030 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:36.067346 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:36.067611 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:36.067869 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:20:36.068124 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:20:36.068376 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:20:36.068933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:20:36.070200 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:20:36.070531 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:36.070797 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:20:36.218316 [debug] [Thread-2 (]: SQL status: COMMIT in 0.149 seconds
[0m22:20:36.220230 [debug] [Thread-4 (]: SQL status: COMMIT in 0.151 seconds
[0m22:20:36.220903 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m22:20:36.221575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m22:20:36.231567 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m22:20:36.234285 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m22:20:36.236437 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m22:20:36.238480 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m22:20:36.243146 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:20:36.243842 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:20:36.244480 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:20:36.245083 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:20:36.245410 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m22:20:36.245726 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m22:20:36.246033 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m22:20:36.246345 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m22:20:36.399952 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m22:20:36.406425 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m22:20:36.406937 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.160 seconds
[0m22:20:36.407356 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.161 seconds
[0m22:20:36.408063 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.161 seconds
[0m22:20:36.410551 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m22:20:36.411883 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:20:36.413076 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:20:36.413507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108784bc0>]}
[0m22:20:36.413972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d8710>]}
[0m22:20:36.414783 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.14s]
[0m22:20:36.415237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5cebd0>]}
[0m22:20:36.415632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610da0>]}
[0m22:20:36.416107 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:36.416614 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m22:20:36.417096 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:36.417567 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:36.417979 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:20:36.418308 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:20:36.418773 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:20:36.419158 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:20:36.419457 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:20:36.419852 [info ] [Thread-2 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m22:20:36.420171 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_product
[0m22:20:36.420475 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m22:20:36.420900 [info ] [Thread-1 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m22:20:36.421232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_deal_userfields)
[0m22:20:36.421572 [info ] [Thread-4 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m22:20:36.421922 [info ] [Thread-3 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m22:20:36.422229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m22:20:36.422500 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m22:20:36.422767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_product)
[0m22:20:36.423033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m22:20:36.423297 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:20:36.425781 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:36.426059 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m22:20:36.426299 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m22:20:36.428097 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:36.430162 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m22:20:36.432080 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m22:20:36.432448 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m22:20:36.432853 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:20:36.436372 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:36.438453 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:36.438682 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m22:20:36.438916 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m22:20:36.441102 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m22:20:36.441381 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:36.443384 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m22:20:36.443645 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:36.443965 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m22:20:36.444269 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:36.444546 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:20:36.444802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:20:36.445034 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:36.445253 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m22:20:36.445461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:36.445731 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m22:20:36.445938 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:20:36.446211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:37.672022 [debug] [Thread-3 (]: SQL status: BEGIN in 1.225 seconds
[0m22:20:37.673806 [debug] [Thread-1 (]: SQL status: BEGIN in 1.228 seconds
[0m22:20:37.675159 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:37.676004 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:37.676833 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m22:20:37.677745 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m22:20:37.693640 [debug] [Thread-2 (]: SQL status: BEGIN in 1.249 seconds
[0m22:20:37.694207 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:37.694866 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m22:20:37.707862 [debug] [Thread-4 (]: SQL status: BEGIN in 1.262 seconds
[0m22:20:37.709838 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:37.711219 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m22:20:37.840833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m22:20:37.842479 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m22:20:37.848883 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:37.852662 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:37.853145 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m22:20:37.853591 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m22:20:37.855846 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m22:20:37.859246 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:37.859668 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m22:20:37.872616 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m22:20:37.875579 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:37.875967 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m22:20:38.003357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:20:38.005051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:20:38.010706 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:38.011372 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:20:38.015407 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:38.015925 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m22:20:38.019145 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:38.019572 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m22:20:38.020045 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m22:20:38.024953 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:20:38.027544 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:38.029580 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m22:20:38.169877 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:20:38.171434 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:20:38.174340 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:20:38.174967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:20:38.177196 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:20:38.177744 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:38.179450 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:20:38.179891 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:20:38.180358 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:38.180783 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:20:38.181219 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:38.183039 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:20:38.183463 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:20:38.183923 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:20:38.184281 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:38.184707 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:20:38.334147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m22:20:38.335713 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m22:20:38.336273 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m22:20:38.404320 [debug] [Thread-4 (]: SQL status: COMMIT in 0.219 seconds
[0m22:20:38.405280 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m22:20:38.406530 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m22:20:38.407656 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m22:20:38.408694 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m22:20:38.409102 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:20:38.409466 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:20:38.409829 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:20:38.410181 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:20:38.410373 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m22:20:38.410567 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m22:20:38.410763 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m22:20:38.410951 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m22:20:38.561205 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.150 seconds
[0m22:20:38.561862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.151 seconds
[0m22:20:38.563804 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m22:20:38.564245 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:20:38.564642 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:20:38.565900 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:20:38.567307 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m22:20:38.567922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dc3b0>]}
[0m22:20:38.569171 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_product: Close
[0m22:20:38.570050 [info ] [Thread-3 (]: 8 of 9 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.14s]
[0m22:20:38.570611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c79e0>]}
[0m22:20:38.571043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61e180>]}
[0m22:20:38.571714 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m22:20:38.572172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a795730>]}
[0m22:20:38.572717 [info ] [Thread-2 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:38.573213 [info ] [Thread-1 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:38.573620 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m22:20:38.574175 [info ] [Thread-4 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.15s]
[0m22:20:38.574661 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:20:38.575087 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:20:38.575479 [info ] [Thread-3 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m22:20:38.575952 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m22:20:38.576449 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_user, now model.bdt_transformations.btx_curated_deal)
[0m22:20:38.576840 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m22:20:38.580172 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m22:20:38.581256 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m22:20:38.597635 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m22:20:38.598402 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:20:38.598663 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m22:20:38.598876 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:39.864861 [debug] [Thread-3 (]: SQL status: BEGIN in 1.265 seconds
[0m22:20:39.867405 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:20:39.868459 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by_id AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m22:20:40.042200 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "last_activity_by_id" does not exist
LINE 33:  last_activity_by_id AS id_ultima_atividade_por,
          ^
HINT:  Perhaps you meant to reference the column "btx_processed_deal.last_activity_by".

[0m22:20:40.044094 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: ROLLBACK
[0m22:20:40.213585 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m22:20:40.228000 [debug] [Thread-3 (]: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "last_activity_by_id" does not exist
  LINE 33:  last_activity_by_id AS id_ultima_atividade_por,
            ^
  HINT:  Perhaps you meant to reference the column "btx_processed_deal.last_activity_by".
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m22:20:40.228797 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113ff0f-9b3f-4f58-975c-22d1ba4b887e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a24eae0>]}
[0m22:20:40.229648 [error] [Thread-3 (]: 9 of 9 ERROR creating sql table model bitrix.btx_curated_deal .................. [[31mERROR[0m in 1.65s]
[0m22:20:40.230285 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m22:20:40.230821 [debug] [Thread-7 (]: Marking all children of 'model.bdt_transformations.btx_curated_deal' to be skipped because of status 'error'.  Reason: Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "last_activity_by_id" does not exist
  LINE 33:  last_activity_by_id AS id_ultima_atividade_por,
            ^
  HINT:  Perhaps you meant to reference the column "btx_processed_deal.last_activity_by".
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql.
[0m22:20:40.233075 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:40.233465 [debug] [MainThread]: On master: BEGIN
[0m22:20:40.233752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:20:41.473852 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m22:20:41.476189 [debug] [MainThread]: On master: COMMIT
[0m22:20:41.477216 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:41.478136 [debug] [MainThread]: On master: COMMIT
[0m22:20:41.644079 [debug] [MainThread]: SQL status: COMMIT in 0.163 seconds
[0m22:20:41.646132 [debug] [MainThread]: On master: Close
[0m22:20:41.647599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:41.648103 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:20:41.648517 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m22:20:41.648895 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m22:20:41.649268 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m22:20:41.649863 [info ] [MainThread]: 
[0m22:20:41.650331 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 12.27 seconds (12.27s).
[0m22:20:41.654464 [debug] [MainThread]: Command end result
[0m22:20:41.677660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:20:41.679719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:20:41.684283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:20:41.684562 [info ] [MainThread]: 
[0m22:20:41.684829 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:20:41.685053 [info ] [MainThread]: 
[0m22:20:41.685315 [error] [MainThread]:   Database Error in model btx_curated_deal (models/bitrix/btx_curated_deal.sql)
  column "last_activity_by_id" does not exist
  LINE 33:  last_activity_by_id AS id_ultima_atividade_por,
            ^
  HINT:  Perhaps you meant to reference the column "btx_processed_deal.last_activity_by".
  compiled code at target/run/bdt_transformations/models/bitrix/btx_curated_deal.sql
[0m22:20:41.685533 [info ] [MainThread]: 
[0m22:20:41.685751 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m22:20:41.687594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.743681, "process_in_blocks": "0", "process_kernel_time": 0.250307, "process_mem_max_rss": "127533056", "process_out_blocks": "0", "process_user_time": 1.728046}
[0m22:20:41.687884 [debug] [MainThread]: Command `dbt run` failed at 22:20:41.687833 after 12.74 seconds
[0m22:20:41.688123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bccec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a3380>]}
[0m22:20:41.688349 [debug] [MainThread]: Flushing usage events
[0m22:20:42.669523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:30.639996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e32e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e32ab0>]}


============================== 22:21:30.642937 | 64b3bfc7-f1e0-477b-a5c4-b29fc6230940 ==============================
[0m22:21:30.642937 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:21:30.643276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:30.727250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026bce0>]}
[0m22:21:30.754081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef6390>]}
[0m22:21:30.755103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:21:30.817656 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:21:30.878563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:30.878978 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_curated_deal.sql
[0m22:21:30.999489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c0740>]}
[0m22:21:31.032324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:21:31.034032 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:21:31.042855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5aa80>]}
[0m22:21:31.043155 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m22:21:31.043356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112374590>]}
[0m22:21:31.044357 [info ] [MainThread]: 
[0m22:21:31.044608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:31.044774 [info ] [MainThread]: 
[0m22:21:31.045144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:31.047190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:21:31.075296 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:21:31.075566 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:21:31.075732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:32.383931 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.307 seconds
[0m22:21:32.389578 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:21:32.392508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m22:21:32.400127 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:21:32.400553 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m22:21:32.400880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:33.635059 [debug] [ThreadPool]: SQL status: BEGIN in 1.233 seconds
[0m22:21:33.637136 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:21:33.637900 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m22:21:33.791026 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.152 seconds
[0m22:21:33.795548 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m22:21:33.947050 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m22:21:33.959668 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:33.960249 [debug] [MainThread]: On master: BEGIN
[0m22:21:33.960609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:35.207998 [debug] [MainThread]: SQL status: BEGIN in 1.247 seconds
[0m22:21:35.210727 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:35.211629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:35.367693 [debug] [MainThread]: SQL status: SELECT 8 in 0.154 seconds
[0m22:21:35.374702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e2180>]}
[0m22:21:35.375519 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:35.524368 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:35.526151 [debug] [MainThread]: On master: BEGIN
[0m22:21:35.825028 [debug] [MainThread]: SQL status: BEGIN in 0.297 seconds
[0m22:21:35.827475 [debug] [MainThread]: On master: COMMIT
[0m22:21:35.828553 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:35.829465 [debug] [MainThread]: On master: COMMIT
[0m22:21:35.984523 [debug] [MainThread]: SQL status: COMMIT in 0.154 seconds
[0m22:21:35.986609 [debug] [MainThread]: On master: Close
[0m22:21:35.993936 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:21:35.994648 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m22:21:35.995314 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:21:35.995996 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m22:21:35.996494 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:21:35.997043 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m22:21:35.997597 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m22:21:35.998213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m22:21:35.998766 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m22:21:35.999338 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m22:21:35.999843 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:21:36.000259 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:21:36.000742 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:21:36.001138 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m22:21:36.001477 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:21:36.009750 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:21:36.010158 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:21:36.013048 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m22:21:36.017167 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:21:36.019827 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:36.020764 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m22:21:36.045654 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m22:21:36.045941 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:21:36.046166 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:21:36.046310 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m22:21:36.048438 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m22:21:36.050316 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:21:36.052149 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:36.052904 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:36.053122 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m22:21:36.053336 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:36.053539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:21:36.053740 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m22:21:36.053928 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:36.054110 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:36.054397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:21:36.054583 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:21:36.054762 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:21:36.055020 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:21:36.055206 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:21:37.275946 [debug] [Thread-2 (]: SQL status: BEGIN in 1.222 seconds
[0m22:21:37.276339 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:37.276748 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m22:21:37.288866 [debug] [Thread-4 (]: SQL status: BEGIN in 1.234 seconds
[0m22:21:37.289114 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:37.289351 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m22:21:37.297207 [debug] [Thread-3 (]: SQL status: BEGIN in 1.242 seconds
[0m22:21:37.297445 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:37.298079 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m22:21:37.303629 [debug] [Thread-1 (]: SQL status: BEGIN in 1.249 seconds
[0m22:21:37.303952 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:37.304271 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m22:21:37.436388 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m22:21:37.443663 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:37.444120 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m22:21:37.447706 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m22:21:37.450451 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:37.451181 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m22:21:37.460491 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m22:21:37.463324 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:37.463702 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m22:21:37.466989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m22:21:37.469326 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:37.469628 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m22:21:37.594906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:21:37.604226 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:37.605012 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m22:21:37.605794 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m22:21:37.609793 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:37.610394 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m22:21:37.614513 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:21:37.619637 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:37.620048 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m22:21:37.625535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m22:21:37.628813 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:37.629233 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m22:21:37.765868 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:21:37.766968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m22:21:37.774161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:21:37.790698 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:21:37.791122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.162 seconds
[0m22:21:37.792783 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:21:37.794160 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:21:37.794532 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:37.795757 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:21:37.796045 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:37.796317 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:37.796616 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:21:37.796891 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:37.797144 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:21:37.797400 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:21:37.797766 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:21:37.952882 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m22:21:37.962627 [debug] [Thread-2 (]: SQL status: COMMIT in 0.164 seconds
[0m22:21:37.965417 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m22:21:37.966013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.168 seconds
[0m22:21:37.968821 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m22:21:37.974283 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:21:37.974700 [debug] [Thread-4 (]: SQL status: COMMIT in 0.177 seconds
[0m22:21:37.976822 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m22:21:37.977517 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:21:37.977874 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m22:21:37.979706 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m22:21:37.980337 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:21:37.980652 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m22:21:37.981374 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:21:37.981690 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m22:21:37.982029 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m22:21:38.139900 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.156 seconds
[0m22:21:38.141697 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.160 seconds
[0m22:21:38.142320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.160 seconds
[0m22:21:38.143251 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.162 seconds
[0m22:21:38.148515 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:21:38.150156 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m22:21:38.151644 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m22:21:38.153051 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:21:38.156599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131167b0>]}
[0m22:21:38.156988 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106403830>]}
[0m22:21:38.157404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112376990>]}
[0m22:21:38.158153 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.15s]
[0m22:21:38.158544 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344c680>]}
[0m22:21:38.159115 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.15s]
[0m22:21:38.159676 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.16s]
[0m22:21:38.160238 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m22:21:38.160693 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.16s]
[0m22:21:38.161138 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:21:38.161538 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:21:38.161906 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:21:38.162459 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:21:38.162821 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:21:38.163195 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m22:21:38.163616 [info ] [Thread-2 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m22:21:38.163981 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m22:21:38.164505 [info ] [Thread-4 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m22:21:38.165007 [info ] [Thread-1 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m22:21:38.165498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_deal_userfields)
[0m22:21:38.166162 [info ] [Thread-3 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m22:21:38.166827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_dealcategory)
[0m22:21:38.167257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_product)
[0m22:21:38.167637 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m22:21:38.168021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m22:21:38.168319 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:21:38.168607 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m22:21:38.171915 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:38.172257 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m22:21:38.174409 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:38.176472 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m22:21:38.179192 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m22:21:38.179868 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m22:21:38.180235 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:21:38.180495 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m22:21:38.180723 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m22:21:38.184536 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:38.186596 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:38.188541 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m22:21:38.190707 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m22:21:38.191358 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:38.191654 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m22:21:38.191904 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:38.192132 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:38.192375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:21:38.192592 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:38.192806 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:21:38.193030 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m22:21:38.193385 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m22:21:38.193657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:21:38.193882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:21:38.194089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:21:39.422711 [debug] [Thread-3 (]: SQL status: BEGIN in 1.228 seconds
[0m22:21:39.423999 [debug] [Thread-2 (]: SQL status: BEGIN in 1.232 seconds
[0m22:21:39.424621 [debug] [Thread-4 (]: SQL status: BEGIN in 1.231 seconds
[0m22:21:39.425510 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:39.426131 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:39.427017 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:39.427980 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m22:21:39.428856 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m22:21:39.429580 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m22:21:39.430332 [debug] [Thread-1 (]: SQL status: BEGIN in 1.236 seconds
[0m22:21:39.431283 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:39.432051 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m22:21:39.591619 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m22:21:39.593234 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m22:21:39.600842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.168 seconds
[0m22:21:39.601440 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:39.601865 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.171 seconds
[0m22:21:39.605532 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:39.608726 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:39.609132 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m22:21:39.612074 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:39.612461 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m22:21:39.612838 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m22:21:39.613386 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m22:21:39.762801 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:21:39.763801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:21:39.764352 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:21:39.764857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m22:21:39.769944 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:39.773294 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:39.776342 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:39.779429 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:39.779856 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m22:21:39.780245 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m22:21:39.780687 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m22:21:39.781124 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m22:21:39.933248 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:21:39.938915 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:21:39.939706 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:39.940234 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:21:39.962414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.179 seconds
[0m22:21:39.963721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.180 seconds
[0m22:21:39.967845 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:21:39.968573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m22:21:39.970808 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:21:39.971295 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:39.973048 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:21:39.973483 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:39.973898 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:21:39.974292 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:39.974689 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:21:39.975208 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:21:40.110028 [debug] [Thread-3 (]: SQL status: COMMIT in 0.169 seconds
[0m22:21:40.184138 [debug] [Thread-4 (]: SQL status: COMMIT in 0.209 seconds
[0m22:21:40.184420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.209 seconds
[0m22:21:40.184604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.209 seconds
[0m22:21:40.185399 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m22:21:40.186519 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m22:21:40.187561 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m22:21:40.188542 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m22:21:40.188920 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:21:40.189273 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:21:40.189614 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:21:40.189951 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:21:40.190139 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m22:21:40.190326 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m22:21:40.190504 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m22:21:40.190708 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m22:21:40.345582 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.154 seconds
[0m22:21:40.347569 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:21:40.348022 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.157 seconds
[0m22:21:40.348484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.157 seconds
[0m22:21:40.348811 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.158 seconds
[0m22:21:40.350181 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m22:21:40.350805 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f52b0>]}
[0m22:21:40.352117 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m22:21:40.353328 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m22:21:40.354518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f52b0>]}
[0m22:21:40.354101 [info ] [Thread-4 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.18s]
[0m22:21:40.355412 [info ] [Thread-2 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.19s]
[0m22:21:40.356016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f7d10>]}
[0m22:21:40.356467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344ce30>]}
[0m22:21:40.356987 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:21:40.357436 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:21:40.357921 [info ] [Thread-3 (]: 8 of 9 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.19s]
[0m22:21:40.358412 [info ] [Thread-1 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 2.19s]
[0m22:21:40.358823 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m22:21:40.359394 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m22:21:40.359813 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m22:21:40.360202 [info ] [Thread-4 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m22:21:40.360735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory, now model.bdt_transformations.btx_curated_deal)
[0m22:21:40.361069 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m22:21:40.364312 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m22:21:40.365397 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m22:21:40.381210 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m22:21:40.381955 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:40.382203 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m22:21:40.382423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:21:41.807600 [debug] [Thread-4 (]: SQL status: BEGIN in 1.424 seconds
[0m22:21:41.810015 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:41.811586 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m22:21:42.070664 [debug] [Thread-4 (]: SQL status: SELECT 226 in 0.257 seconds
[0m22:21:42.078348 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:42.079017 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m22:21:42.228160 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:21:42.235723 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:42.236217 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m22:21:42.386545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:21:42.391786 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m22:21:42.392179 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:42.392500 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m22:21:42.542821 [debug] [Thread-4 (]: SQL status: COMMIT in 0.149 seconds
[0m22:21:42.549451 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m22:21:42.553962 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:21:42.554505 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m22:21:42.734884 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.179 seconds
[0m22:21:42.739545 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m22:21:42.740754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b3bfc7-f1e0-477b-a5c4-b29fc6230940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113516600>]}
[0m22:21:42.741602 [info ] [Thread-4 (]: 9 of 9 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.38s]
[0m22:21:42.742277 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m22:21:42.744138 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:42.744670 [debug] [MainThread]: On master: BEGIN
[0m22:21:42.745077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:43.984741 [debug] [MainThread]: SQL status: BEGIN in 1.239 seconds
[0m22:21:43.987293 [debug] [MainThread]: On master: COMMIT
[0m22:21:43.988381 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:43.989116 [debug] [MainThread]: On master: COMMIT
[0m22:21:44.139479 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m22:21:44.141731 [debug] [MainThread]: On master: Close
[0m22:21:44.144126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:44.145003 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m22:21:44.145563 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m22:21:44.145983 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m22:21:44.146383 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m22:21:44.147018 [info ] [MainThread]: 
[0m22:21:44.147540 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 13.10 seconds (13.10s).
[0m22:21:44.149594 [debug] [MainThread]: Command end result
[0m22:21:44.172085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:21:44.173409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:21:44.177830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:21:44.178086 [info ] [MainThread]: 
[0m22:21:44.178343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:21:44.178554 [info ] [MainThread]: 
[0m22:21:44.178770 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:21:44.180877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.575134, "process_in_blocks": "0", "process_kernel_time": 0.256814, "process_mem_max_rss": "128663552", "process_out_blocks": "0", "process_user_time": 1.733851}
[0m22:21:44.181231 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:44.181168 after 13.58 seconds
[0m22:21:44.181512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112331df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123306e0>]}
[0m22:21:44.181782 [debug] [MainThread]: Flushing usage events
[0m22:21:44.950966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:38.810703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107233200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107232e10>]}


============================== 22:41:38.813845 | 843b0b40-a762-482c-bb92-5933fd190855 ==============================
[0m22:41:38.813845 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:41:38.814206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:41:38.916581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102526db0>]}
[0m22:41:38.944255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ad460>]}
[0m22:41:38.945056 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:41:39.005480 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m22:41:39.068114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:39.068402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:39.085471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a2e70>]}
[0m22:41:39.123858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:41:39.126131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:41:39.138840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a3ef0>]}
[0m22:41:39.139257 [info ] [MainThread]: Found 9 models, 9 sources, 433 macros
[0m22:41:39.139470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc11f0>]}
[0m22:41:39.140688 [info ] [MainThread]: 
[0m22:41:39.140945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:39.141100 [info ] [MainThread]: 
[0m22:41:39.141362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:39.143363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m22:41:39.173104 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m22:41:39.173406 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m22:41:39.173573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:40.400752 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.227 seconds
[0m22:41:40.401883 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m22:41:40.403029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m22:41:40.406993 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:41:40.407270 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m22:41:40.407453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:41.643390 [debug] [ThreadPool]: SQL status: BEGIN in 1.236 seconds
[0m22:41:41.643772 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m22:41:41.643994 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m22:41:41.800437 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.156 seconds
[0m22:41:41.801633 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m22:41:41.949702 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m22:41:41.956212 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:41.956588 [debug] [MainThread]: On master: BEGIN
[0m22:41:41.956786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:43.163178 [debug] [MainThread]: SQL status: BEGIN in 1.206 seconds
[0m22:41:43.164431 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:43.164666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:43.320671 [debug] [MainThread]: SQL status: SELECT 8 in 0.156 seconds
[0m22:41:43.322210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181c82f0>]}
[0m22:41:43.322467 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:43.474466 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:43.474796 [debug] [MainThread]: On master: BEGIN
[0m22:41:43.776641 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m22:41:43.777055 [debug] [MainThread]: On master: COMMIT
[0m22:41:43.777260 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:43.777447 [debug] [MainThread]: On master: COMMIT
[0m22:41:43.925455 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m22:41:43.925885 [debug] [MainThread]: On master: Close
[0m22:41:43.930527 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m22:41:43.930850 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m22:41:43.931115 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m22:41:43.931386 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_stage
[0m22:41:43.931714 [info ] [Thread-1 (]: 1 of 9 START sql view model bitrix.btx_processed_activity ...................... [RUN]
[0m22:41:43.932107 [info ] [Thread-2 (]: 2 of 9 START sql view model bitrix.btx_processed_company ....................... [RUN]
[0m22:41:43.932467 [info ] [Thread-3 (]: 3 of 9 START sql view model bitrix.btx_processed_deal .......................... [RUN]
[0m22:41:43.932812 [info ] [Thread-4 (]: 4 of 9 START sql view model bitrix.btx_processed_deal_stage .................... [RUN]
[0m22:41:43.933118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m22:41:43.933413 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m22:41:43.933677 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m22:41:43.933930 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_stage'
[0m22:41:43.934148 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m22:41:43.934365 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m22:41:43.934562 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m22:41:43.934759 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_stage
[0m22:41:43.939502 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m22:41:43.941810 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m22:41:43.944391 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m22:41:43.946042 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:43.947310 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_stage
[0m22:41:43.947607 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m22:41:43.947838 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m22:41:43.966825 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:43.967149 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m22:41:43.969325 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m22:41:43.971037 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m22:41:43.973050 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m22:41:43.973466 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:43.973786 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: BEGIN
[0m22:41:43.974073 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:43.974298 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:41:43.974518 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:43.974778 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:43.974974 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m22:41:43.975244 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m22:41:43.975439 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m22:41:43.975633 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:41:43.975822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:43.975993 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:41:45.178662 [debug] [Thread-4 (]: SQL status: BEGIN in 1.204 seconds
[0m22:41:45.179010 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:45.179219 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal_stage"
WHERE
  "SUCCESS" = true
  );
[0m22:41:45.182072 [debug] [Thread-1 (]: SQL status: BEGIN in 1.206 seconds
[0m22:41:45.182495 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:45.182817 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m22:41:45.198742 [debug] [Thread-2 (]: SQL status: BEGIN in 1.223 seconds
[0m22:41:45.198959 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:45.199250 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m22:41:45.201011 [debug] [Thread-3 (]: SQL status: BEGIN in 1.225 seconds
[0m22:41:45.201357 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:45.201861 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m22:41:45.336387 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m22:41:45.341244 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:45.341517 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage" rename to "btx_processed_deal_stage__dbt_backup"
[0m22:41:45.341971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m22:41:45.343943 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:45.344171 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m22:41:45.363871 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m22:41:45.365996 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:45.366230 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m22:41:45.367418 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m22:41:45.369241 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:45.369466 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m22:41:45.488898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m22:41:45.491186 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:45.491529 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_tmp" rename to "btx_processed_deal_stage"
[0m22:41:45.492752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:41:45.494691 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:45.494955 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m22:41:45.514387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:41:45.516230 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:45.516436 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m22:41:45.519197 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:41:45.520892 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:45.521089 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m22:41:45.638857 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m22:41:45.647610 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:41:45.647959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m22:41:45.648291 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:45.649185 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:41:45.649388 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: COMMIT
[0m22:41:45.649573 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:45.649907 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m22:41:45.665104 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:41:45.666371 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:41:45.666592 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:45.666774 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m22:41:45.671054 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m22:41:45.671880 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:41:45.672059 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:45.672215 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m22:41:45.798012 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m22:41:45.802276 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup"
[0m22:41:45.802544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m22:41:45.805509 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_stage"
[0m22:41:45.806838 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m22:41:45.807091 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_stage__dbt_backup" cascade
[0m22:41:45.807632 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m22:41:45.807968 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m22:41:45.818531 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m22:41:45.820065 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m22:41:45.820505 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m22:41:45.820862 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m22:41:45.822412 [debug] [Thread-3 (]: SQL status: COMMIT in 0.150 seconds
[0m22:41:45.824741 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m22:41:45.825197 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m22:41:45.825415 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m22:41:45.960748 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:41:45.963578 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_stage: Close
[0m22:41:45.963926 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.156 seconds
[0m22:41:45.965059 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m22:41:45.967983 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777ee10>]}
[0m22:41:45.968329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777d520>]}
[0m22:41:45.968881 [info ] [Thread-4 (]: 4 of 9 OK created sql view model bitrix.btx_processed_deal_stage ............... [[32mCREATE VIEW[0m in 2.03s]
[0m22:41:45.969385 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bitrix.btx_processed_activity ................. [[32mCREATE VIEW[0m in 2.03s]
[0m22:41:45.969822 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_stage
[0m22:41:45.970412 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m22:41:45.970754 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:41:45.971111 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m22:41:45.971451 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.150 seconds
[0m22:41:45.971820 [info ] [Thread-4 (]: 5 of 9 START sql view model bitrix.btx_processed_deal_userfields ............... [RUN]
[0m22:41:45.972260 [info ] [Thread-1 (]: 6 of 9 START sql view model bitrix.btx_processed_dealcategory .................. [RUN]
[0m22:41:45.973260 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m22:41:45.973549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_stage, now model.bdt_transformations.btx_processed_deal_userfields)
[0m22:41:45.973793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m22:41:45.974105 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m22:41:45.974465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185efbc0>]}
[0m22:41:45.974682 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m22:41:45.976950 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:45.977288 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m22:41:45.977594 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bitrix.btx_processed_company .................. [[32mCREATE VIEW[0m in 2.04s]
[0m22:41:45.979498 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:45.980502 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m22:41:45.980874 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m22:41:45.981278 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m22:41:45.981702 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m22:41:45.981991 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185ed010>]}
[0m22:41:45.984307 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:45.984586 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m22:41:45.984891 [info ] [Thread-2 (]: 7 of 9 START sql view model bitrix.btx_processed_product ....................... [RUN]
[0m22:41:45.985268 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bitrix.btx_processed_deal ..................... [[32mCREATE VIEW[0m in 2.05s]
[0m22:41:45.987466 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:45.987809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_product)
[0m22:41:45.988156 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m22:41:45.988452 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:45.988696 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m22:41:45.988951 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m22:41:45.989166 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:45.989417 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m22:41:45.991144 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m22:41:45.991474 [info ] [Thread-3 (]: 8 of 9 START sql view model bitrix.btx_processed_user .......................... [RUN]
[0m22:41:45.991718 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m22:41:45.991934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:45.992231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m22:41:45.992491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:45.992951 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m22:41:45.993140 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m22:41:45.994771 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m22:41:45.996865 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m22:41:45.997570 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:45.997859 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m22:41:45.998126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:45.998344 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m22:41:46.000308 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m22:41:46.000685 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:46.000878 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m22:41:46.001047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:47.193660 [debug] [Thread-2 (]: SQL status: BEGIN in 1.195 seconds
[0m22:41:47.194050 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:47.194316 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m22:41:47.210559 [debug] [Thread-3 (]: SQL status: BEGIN in 1.209 seconds
[0m22:41:47.210920 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:47.211178 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m22:41:47.225154 [debug] [Thread-4 (]: SQL status: BEGIN in 1.233 seconds
[0m22:41:47.225394 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:47.225645 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m22:41:47.227145 [debug] [Thread-1 (]: SQL status: BEGIN in 1.235 seconds
[0m22:41:47.227483 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:47.227721 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m22:41:47.348733 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.154 seconds
[0m22:41:47.351151 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:47.351401 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m22:41:47.373053 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m22:41:47.375187 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:47.375434 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m22:41:47.393343 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m22:41:47.393673 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.168 seconds
[0m22:41:47.396903 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:47.399218 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:47.399514 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m22:41:47.399751 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m22:41:47.500932 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:41:47.503655 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:47.504176 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m22:41:47.524325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:41:47.526673 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:47.526983 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m22:41:47.553830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:41:47.554210 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:41:47.556815 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:47.558932 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:47.559228 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m22:41:47.559507 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m22:41:47.658293 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m22:41:47.659935 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:41:47.660285 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:47.660577 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m22:41:47.676164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m22:41:47.677777 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:41:47.678091 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:47.678360 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m22:41:47.712265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m22:41:47.712795 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m22:41:47.714582 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:41:47.716164 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:41:47.716669 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:47.717006 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:47.717308 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m22:41:47.717602 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m22:41:47.809746 [debug] [Thread-2 (]: SQL status: COMMIT in 0.149 seconds
[0m22:41:47.811909 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m22:41:47.812462 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m22:41:47.812716 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m22:41:47.829437 [debug] [Thread-3 (]: SQL status: COMMIT in 0.151 seconds
[0m22:41:47.831574 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m22:41:47.832201 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m22:41:47.832502 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m22:41:47.880984 [debug] [Thread-4 (]: SQL status: COMMIT in 0.163 seconds
[0m22:41:47.881423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.163 seconds
[0m22:41:47.883519 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m22:41:47.885226 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m22:41:47.885832 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m22:41:47.886371 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m22:41:47.886631 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m22:41:47.886885 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m22:41:47.963773 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m22:41:47.965167 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m22:41:47.965795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184c3650>]}
[0m22:41:47.966296 [info ] [Thread-2 (]: 7 of 9 OK created sql view model bitrix.btx_processed_product .................. [[32mCREATE VIEW[0m in 1.98s]
[0m22:41:47.966705 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m22:41:47.966988 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m22:41:47.967303 [info ] [Thread-2 (]: 9 of 9 START sql table model bitrix.btx_curated_deal ........................... [RUN]
[0m22:41:47.967668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_product, now model.bdt_transformations.btx_curated_deal)
[0m22:41:47.967999 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m22:41:47.970976 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m22:41:47.973591 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m22:41:47.988484 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m22:41:47.988836 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.156 seconds
[0m22:41:47.989958 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m22:41:47.990508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca00230>]}
[0m22:41:47.990787 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:47.991164 [info ] [Thread-3 (]: 8 of 9 OK created sql view model bitrix.btx_processed_user ..................... [[32mCREATE VIEW[0m in 2.00s]
[0m22:41:47.991425 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m22:41:47.991713 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m22:41:47.991916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:48.039776 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:41:48.040117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.153 seconds
[0m22:41:48.041159 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m22:41:48.041966 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m22:41:48.042489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118557fb0>]}
[0m22:41:48.042816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11814ff80>]}
[0m22:41:48.043221 [info ] [Thread-1 (]: 6 of 9 OK created sql view model bitrix.btx_processed_dealcategory ............. [[32mCREATE VIEW[0m in 2.07s]
[0m22:41:48.043629 [info ] [Thread-4 (]: 5 of 9 OK created sql view model bitrix.btx_processed_deal_userfields .......... [[32mCREATE VIEW[0m in 2.07s]
[0m22:41:48.044009 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m22:41:48.044317 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m22:41:49.196211 [debug] [Thread-2 (]: SQL status: BEGIN in 1.204 seconds
[0m22:41:49.196728 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:49.197224 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m22:41:49.446822 [debug] [Thread-2 (]: SQL status: SELECT 226 in 0.249 seconds
[0m22:41:49.448920 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:49.449300 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m22:41:49.597575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m22:41:49.599917 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:49.600180 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m22:41:49.746255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.146 seconds
[0m22:41:49.749678 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m22:41:49.749948 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:49.750143 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m22:41:49.898208 [debug] [Thread-2 (]: SQL status: COMMIT in 0.148 seconds
[0m22:41:49.899815 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m22:41:49.901472 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m22:41:49.901687 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m22:41:50.051239 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.149 seconds
[0m22:41:50.052865 [debug] [Thread-2 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m22:41:50.053603 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b0b40-a762-482c-bb92-5933fd190855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184c1fd0>]}
[0m22:41:50.054182 [info ] [Thread-2 (]: 9 of 9 OK created sql table model bitrix.btx_curated_deal ...................... [[32mSELECT 226[0m in 2.09s]
[0m22:41:50.054677 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m22:41:50.055865 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:50.056200 [debug] [MainThread]: On master: BEGIN
[0m22:41:50.056462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:51.281535 [debug] [MainThread]: SQL status: BEGIN in 1.225 seconds
[0m22:41:51.282093 [debug] [MainThread]: On master: COMMIT
[0m22:41:51.282407 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:51.282675 [debug] [MainThread]: On master: COMMIT
[0m22:41:51.433869 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m22:41:51.434734 [debug] [MainThread]: On master: Close
[0m22:41:51.435697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:51.436181 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m22:41:51.437034 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m22:41:51.437523 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m22:41:51.437879 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_deal_userfields' was properly closed.
[0m22:41:51.438387 [info ] [MainThread]: 
[0m22:41:51.438831 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 12.30 seconds (12.30s).
[0m22:41:51.440741 [debug] [MainThread]: Command end result
[0m22:41:51.462918 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m22:41:51.464696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m22:41:51.469399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m22:41:51.469683 [info ] [MainThread]: 
[0m22:41:51.469981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:51.470204 [info ] [MainThread]: 
[0m22:41:51.470430 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:41:51.472409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.699679, "process_in_blocks": "0", "process_kernel_time": 0.242058, "process_mem_max_rss": "122077184", "process_out_blocks": "0", "process_user_time": 1.294955}
[0m22:41:51.472756 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:51.472696 after 12.70 seconds
[0m22:41:51.473042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072331a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185af230>]}
[0m22:41:51.473295 [debug] [MainThread]: Flushing usage events
[0m22:41:52.411254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:38.180352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107832d80>]}


============================== 23:59:38.183410 | 1f8e2848-ddb2-4bc6-89a8-945c1537a507 ==============================
[0m23:59:38.183410 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:59:38.183755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m23:59:38.283222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f8e2848-ddb2-4bc6-89a8-945c1537a507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f34680>]}
[0m23:59:38.310031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f8e2848-ddb2-4bc6-89a8-945c1537a507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078630b0>]}
[0m23:59:38.310852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:38.368806 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m23:59:38.407541 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:59:38.407864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f8e2848-ddb2-4bc6-89a8-945c1537a507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072537d0>]}
[0m23:59:38.796531 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {% for table in var('bitrix_raw_tables') %}{{ table }}{% if not loop.last %}: Unexpected end of template. Jinja was looking for the following tags: 'elif' or 'else' or 'endif'. The innermost block that needs to be closed is 'if'.
    line 1
      {% for table in var('bitrix_raw_tables') %}{{ table }}{% if not loop.last %}
[0m23:59:38.798387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6565934, "process_in_blocks": "0", "process_kernel_time": 0.164124, "process_mem_max_rss": "108249088", "process_out_blocks": "0", "process_user_time": 1.169119}
[0m23:59:38.798647 [debug] [MainThread]: Command `dbt run` failed at 23:59:38.798596 after 0.66 seconds
[0m23:59:38.798873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106214d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108590440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a3770>]}
[0m23:59:38.799067 [debug] [MainThread]: Flushing usage events
[0m23:59:39.425736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:01.032341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107337140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336d80>]}


============================== 00:14:01.035081 | c48aae2b-a1d8-43f5-a4bd-86a72153c82d ==============================
[0m00:14:01.035081 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:14:01.035430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:14:01.124592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107314440>]}
[0m00:14:01.149455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d7650>]}
[0m00:14:01.150146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:14:01.208595 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:14:01.270396 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m00:14:01.270781 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_raw_errors.sql
[0m00:14:01.270962 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_processed_dealcategory_stage.sql
[0m00:14:01.271393 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/sources.yml
[0m00:14:01.271549 [debug] [MainThread]: Partial parsing: deleted file: bdt_transformations://models/bitrix/btx_processed_deal_stage.sql
[0m00:14:01.447469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfa960>]}
[0m00:14:01.479348 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:14:01.481299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:14:01.492171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfb3b0>]}
[0m00:14:01.492447 [info ] [MainThread]: Found 10 models, 20 sources, 433 macros
[0m00:14:01.492627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf1880>]}
[0m00:14:01.493807 [info ] [MainThread]: 
[0m00:14:01.494081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:01.494240 [info ] [MainThread]: 
[0m00:14:01.494495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:01.496600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:14:01.524545 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:14:01.524805 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:14:01.524972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:02.783070 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.258 seconds
[0m00:14:02.785589 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:14:02.788209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:14:02.794340 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:14:02.794698 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:14:02.794976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:04.036181 [debug] [ThreadPool]: SQL status: BEGIN in 1.241 seconds
[0m00:14:04.036630 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:14:04.036888 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:14:04.200460 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.163 seconds
[0m00:14:04.206341 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:14:04.356857 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:14:04.371438 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:04.372028 [debug] [MainThread]: On master: BEGIN
[0m00:14:04.372358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:05.614568 [debug] [MainThread]: SQL status: BEGIN in 1.242 seconds
[0m00:14:05.617092 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:05.618418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:14:05.807949 [debug] [MainThread]: SQL status: SELECT 8 in 0.188 seconds
[0m00:14:05.809840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110badd60>]}
[0m00:14:05.810135 [debug] [MainThread]: On master: ROLLBACK
[0m00:14:05.965744 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:05.966207 [debug] [MainThread]: On master: BEGIN
[0m00:14:06.281197 [debug] [MainThread]: SQL status: BEGIN in 0.314 seconds
[0m00:14:06.283152 [debug] [MainThread]: On master: COMMIT
[0m00:14:06.283730 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:06.284221 [debug] [MainThread]: On master: COMMIT
[0m00:14:06.436968 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m00:14:06.439425 [debug] [MainThread]: On master: Close
[0m00:14:06.448824 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:14:06.449476 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m00:14:06.450053 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:14:06.450463 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:14:06.451114 [info ] [Thread-1 (]: 1 of 10 START sql view model bitrix.btx_processed_activity ..................... [RUN]
[0m00:14:06.451729 [info ] [Thread-2 (]: 2 of 10 START sql view model bitrix.btx_processed_company ...................... [RUN]
[0m00:14:06.452254 [info ] [Thread-3 (]: 3 of 10 START sql view model bitrix.btx_processed_deal ......................... [RUN]
[0m00:14:06.452762 [info ] [Thread-4 (]: 4 of 10 START sql view model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m00:14:06.453358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m00:14:06.453900 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m00:14:06.454384 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:14:06.454814 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m00:14:06.455163 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:14:06.455507 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m00:14:06.455822 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:14:06.456287 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m00:14:06.464734 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:14:06.467989 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m00:14:06.473733 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:14:06.476099 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:06.478563 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m00:14:06.478898 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m00:14:06.479175 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m00:14:06.493522 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m00:14:06.502547 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m00:14:06.504748 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:06.506610 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m00:14:06.508316 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m00:14:06.508884 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:06.509232 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:06.509495 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m00:14:06.509787 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m00:14:06.510015 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:06.510211 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:06.510409 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:14:06.510598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:14:06.510852 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m00:14:06.511029 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m00:14:06.511387 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:14:06.511588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:07.730769 [debug] [Thread-2 (]: SQL status: BEGIN in 1.218 seconds
[0m00:14:07.733133 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:07.734024 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m00:14:07.742977 [debug] [Thread-4 (]: SQL status: BEGIN in 1.232 seconds
[0m00:14:07.744039 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:07.744739 [debug] [Thread-1 (]: SQL status: BEGIN in 1.233 seconds
[0m00:14:07.745550 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m00:14:07.746299 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:07.747234 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m00:14:07.754656 [debug] [Thread-3 (]: SQL status: BEGIN in 1.244 seconds
[0m00:14:07.755185 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:07.756080 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m00:14:07.950787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.203 seconds
[0m00:14:07.951477 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.205 seconds
[0m00:14:07.951903 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.217 seconds
[0m00:14:07.952390 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.195 seconds
[0m00:14:07.960182 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:07.963033 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:07.965841 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:07.969276 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:07.969613 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m00:14:07.969918 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m00:14:07.970206 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m00:14:07.970493 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m00:14:08.119789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:14:08.120235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:14:08.122991 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:08.123259 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:14:08.125217 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:08.125501 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m00:14:08.127469 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:08.127770 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m00:14:08.128094 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m00:14:08.143283 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.172 seconds
[0m00:14:08.145511 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:08.145789 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m00:14:08.279838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:14:08.281333 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m00:14:08.281959 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m00:14:08.305826 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.160 seconds
[0m00:14:08.308811 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:14:08.310696 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:14:08.312233 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:14:08.313441 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:14:08.313794 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:08.314090 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:08.314357 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:08.314621 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:08.314892 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:14:08.315151 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:14:08.315395 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:14:08.315638 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:14:08.642430 [debug] [Thread-3 (]: SQL status: COMMIT in 0.326 seconds
[0m00:14:08.646806 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m00:14:08.647172 [debug] [Thread-2 (]: SQL status: COMMIT in 0.331 seconds
[0m00:14:08.650034 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:14:08.650263 [debug] [Thread-4 (]: SQL status: COMMIT in 0.334 seconds
[0m00:14:08.650545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.335 seconds
[0m00:14:08.652042 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m00:14:08.652314 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m00:14:08.653431 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m00:14:08.654477 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m00:14:08.654965 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:14:08.655607 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:14:08.656176 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:14:08.656436 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m00:14:08.656659 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m00:14:08.656860 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m00:14:08.813165 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.156 seconds
[0m00:14:08.814825 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m00:14:08.815087 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.158 seconds
[0m00:14:08.815305 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.158 seconds
[0m00:14:08.815494 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.160 seconds
[0m00:14:08.816437 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m00:14:08.818097 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m00:14:08.818777 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m00:14:08.819327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410f770>]}
[0m00:14:08.819568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e66900>]}
[0m00:14:08.819764 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131ce30>]}
[0m00:14:08.819953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131d790>]}
[0m00:14:08.820299 [info ] [Thread-4 (]: 4 of 10 OK created sql view model bitrix.btx_processed_deal_userfields ......... [[32mCREATE VIEW[0m in 2.36s]
[0m00:14:08.820648 [info ] [Thread-1 (]: 1 of 10 OK created sql view model bitrix.btx_processed_activity ................ [[32mCREATE VIEW[0m in 2.37s]
[0m00:14:08.820931 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bitrix.btx_processed_company ................. [[32mCREATE VIEW[0m in 2.37s]
[0m00:14:08.821201 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bitrix.btx_processed_deal .................... [[32mCREATE VIEW[0m in 2.37s]
[0m00:14:08.821488 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:14:08.821733 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:14:08.821966 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m00:14:08.822192 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:14:08.822394 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:14:08.822635 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:14:08.822868 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:14:08.823076 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m00:14:08.823366 [info ] [Thread-4 (]: 5 of 10 START sql view model bitrix.btx_processed_dealcategory ................. [RUN]
[0m00:14:08.823604 [info ] [Thread-1 (]: 6 of 10 START sql view model bitrix.btx_processed_dealcategory_stage ........... [RUN]
[0m00:14:08.823850 [info ] [Thread-2 (]: 7 of 10 START sql view model bitrix.btx_processed_product ...................... [RUN]
[0m00:14:08.824084 [info ] [Thread-3 (]: 8 of 10 START sql view model bitrix.btx_processed_user ......................... [RUN]
[0m00:14:08.824298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_dealcategory)
[0m00:14:08.824498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory_stage)
[0m00:14:08.824682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_product)
[0m00:14:08.824857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m00:14:08.825029 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:14:08.825196 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:14:08.825362 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:14:08.825525 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m00:14:08.827168 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:08.828461 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:08.829825 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:14:08.832603 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m00:14:08.833264 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:14:08.833537 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:14:08.864877 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:08.866739 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:08.866991 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:14:08.867167 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m00:14:08.868966 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:14:08.870670 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m00:14:08.870955 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:08.871156 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:08.871424 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: BEGIN
[0m00:14:08.871638 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:08.871848 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:14:08.872033 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:08.872219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:08.872394 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:14:08.872554 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:08.872718 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m00:14:08.872945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:08.873167 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:10.075883 [debug] [Thread-4 (]: SQL status: BEGIN in 1.202 seconds
[0m00:14:10.078218 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:10.079417 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m00:14:10.084483 [debug] [Thread-2 (]: SQL status: BEGIN in 1.211 seconds
[0m00:14:10.085385 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:10.086124 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m00:14:10.089453 [debug] [Thread-3 (]: SQL status: BEGIN in 1.216 seconds
[0m00:14:10.089977 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:10.090630 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m00:14:10.097293 [debug] [Thread-1 (]: SQL status: BEGIN in 1.225 seconds
[0m00:14:10.097806 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:10.098342 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
WHERE
  "SUCCESS" = true
  );
[0m00:14:10.240124 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m00:14:10.246854 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:10.247522 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m00:14:10.248101 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m00:14:10.252076 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:10.252647 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m00:14:10.253122 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m00:14:10.256418 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:10.256793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m00:14:10.257154 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m00:14:10.260198 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:10.260623 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp" rename to "btx_processed_dealcategory_stage"
[0m00:14:10.400748 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m00:14:10.402472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:14:10.410147 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:10.410889 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:14:10.411453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:14:10.414976 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:10.415468 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m00:14:10.420135 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:10.421616 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:14:10.422018 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m00:14:10.422494 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m00:14:10.422919 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:10.423398 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:14:10.578587 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m00:14:10.580267 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.157 seconds
[0m00:14:10.581423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m00:14:10.582132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.158 seconds
[0m00:14:10.585445 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:14:10.587887 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:14:10.589743 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:14:10.592515 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup"
[0m00:14:10.593014 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:10.593444 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:10.593837 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:10.594702 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:14:10.595055 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:14:10.595390 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:14:10.595717 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:14:10.596054 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup" cascade
[0m00:14:10.746746 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m00:14:10.747873 [debug] [Thread-2 (]: SQL status: COMMIT in 0.151 seconds
[0m00:14:10.748429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:14:10.748952 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m00:14:10.753290 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m00:14:10.756434 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m00:14:10.758287 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: Close
[0m00:14:10.760775 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m00:14:10.761640 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:14:10.762489 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:14:10.763400 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:14:10.764014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ba0c0>]}
[0m00:14:10.764409 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m00:14:10.764776 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m00:14:10.765124 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m00:14:10.765827 [info ] [Thread-1 (]: 6 of 10 OK created sql view model bitrix.btx_processed_dealcategory_stage ...... [[32mCREATE VIEW[0m in 1.94s]
[0m00:14:10.766586 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:14:10.767000 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_raw_errors
[0m00:14:10.767538 [info ] [Thread-1 (]: 9 of 10 START sql table model bitrix.btx_raw_errors ............................ [RUN]
[0m00:14:10.768018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory_stage, now model.bdt_transformations.btx_raw_errors)
[0m00:14:10.768391 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_raw_errors
[0m00:14:10.775959 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_raw_errors"
[0m00:14:10.777183 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_raw_errors
[0m00:14:10.793465 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_raw_errors"
[0m00:14:10.794162 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:14:10.794410 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: BEGIN
[0m00:14:10.794623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:10.920149 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.154 seconds
[0m00:14:10.922516 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:14:10.922997 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.157 seconds
[0m00:14:10.923497 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.157 seconds
[0m00:14:10.925186 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:14:10.925876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11122f890>]}
[0m00:14:10.927179 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m00:14:10.927957 [info ] [Thread-4 (]: 5 of 10 OK created sql view model bitrix.btx_processed_dealcategory ............ [[32mCREATE VIEW[0m in 2.10s]
[0m00:14:10.928505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11122f620>]}
[0m00:14:10.929140 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:14:10.929578 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc92b0>]}
[0m00:14:10.930154 [info ] [Thread-2 (]: 7 of 10 OK created sql view model bitrix.btx_processed_product ................. [[32mCREATE VIEW[0m in 2.10s]
[0m00:14:10.930616 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m00:14:10.931295 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bitrix.btx_processed_user .................... [[32mCREATE VIEW[0m in 2.10s]
[0m00:14:10.931863 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:14:10.932275 [info ] [Thread-4 (]: 10 of 10 START sql table model bitrix.btx_curated_deal ......................... [RUN]
[0m00:14:10.932729 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m00:14:10.933155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory, now model.bdt_transformations.btx_curated_deal)
[0m00:14:10.933543 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m00:14:10.936971 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m00:14:10.939661 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m00:14:10.942891 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m00:14:10.943597 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:10.943877 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m00:14:10.944137 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:12.026387 [debug] [Thread-1 (]: SQL status: BEGIN in 1.231 seconds
[0m00:14:12.028960 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:14:12.030499 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_tmp"
  
  
    as
  
  (
    

select 
    'btx_raw_activity' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_catalog' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_catalog"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company_userfield' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company_userfield"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_contact' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_contact"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_currency' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_currency"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_recurring' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_recurring"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_userfield' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory_stage' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitydirection' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitydirection"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitynotifytype' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitynotifytype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitypriority' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitypriority"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_addresstype' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_addresstype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_ownertype' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_ownertype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_lead' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_lead"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_product' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_status' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_status"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_user' as data_source,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
where "SUCCESS" = FALSE
  );
  
[0m00:14:12.183141 [debug] [Thread-4 (]: SQL status: BEGIN in 1.238 seconds
[0m00:14:12.184659 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:12.185811 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m00:14:12.210649 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.178 seconds
[0m00:14:12.220442 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:14:12.221097 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_tmp" rename to "btx_raw_errors"
[0m00:14:12.376144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m00:14:12.387115 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: COMMIT
[0m00:14:12.387824 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:14:12.388266 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: COMMIT
[0m00:14:12.440814 [debug] [Thread-4 (]: SQL status: SELECT 227 in 0.253 seconds
[0m00:14:12.450438 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:12.450935 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m00:14:12.570945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.177 seconds
[0m00:14:12.576266 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_backup"
[0m00:14:12.581624 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:14:12.582331 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_backup" cascade
[0m00:14:12.605172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m00:14:12.609806 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:12.610375 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m00:14:12.735114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.152 seconds
[0m00:14:12.740387 [debug] [Thread-1 (]: On model.bdt_transformations.btx_raw_errors: Close
[0m00:14:12.741994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111375550>]}
[0m00:14:12.743023 [info ] [Thread-1 (]: 9 of 10 OK created sql table model bitrix.btx_raw_errors ....................... [[32mSELECT 0[0m in 1.97s]
[0m00:14:12.743789 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_raw_errors
[0m00:14:12.758423 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:14:12.761622 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:14:12.762186 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:12.762675 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:14:12.920895 [debug] [Thread-4 (]: SQL status: COMMIT in 0.157 seconds
[0m00:14:12.929760 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m00:14:12.930929 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:14:12.931409 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m00:14:13.094790 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.162 seconds
[0m00:14:13.100339 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m00:14:13.102255 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48aae2b-a1d8-43f5-a4bd-86a72153c82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111374560>]}
[0m00:14:13.103136 [info ] [Thread-4 (]: 10 of 10 OK created sql table model bitrix.btx_curated_deal .................... [[32mSELECT 227[0m in 2.17s]
[0m00:14:13.103734 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m00:14:13.105362 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:13.105710 [debug] [MainThread]: On master: BEGIN
[0m00:14:13.106011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:14.310806 [debug] [MainThread]: SQL status: BEGIN in 1.205 seconds
[0m00:14:14.311225 [debug] [MainThread]: On master: COMMIT
[0m00:14:14.311462 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:14.311653 [debug] [MainThread]: On master: COMMIT
[0m00:14:14.457829 [debug] [MainThread]: SQL status: COMMIT in 0.146 seconds
[0m00:14:14.458436 [debug] [MainThread]: On master: Close
[0m00:14:14.459269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:14.459743 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_raw_errors' was properly closed.
[0m00:14:14.460136 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:14:14.460471 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m00:14:14.460779 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m00:14:14.461233 [info ] [MainThread]: 
[0m00:14:14.461580 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m00:14:14.463219 [debug] [MainThread]: Command end result
[0m00:14:14.490427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:14:14.495426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:14:14.501762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:14:14.502072 [info ] [MainThread]: 
[0m00:14:14.502395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:14.502650 [info ] [MainThread]: 
[0m00:14:14.502904 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:14:14.504929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.504892, "process_in_blocks": "0", "process_kernel_time": 0.258725, "process_mem_max_rss": "131121152", "process_out_blocks": "0", "process_user_time": 1.698415}
[0m00:14:14.508462 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:14.508375 after 13.51 seconds
[0m00:14:14.508977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c48cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113593a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e97620>]}
[0m00:14:14.509304 [debug] [MainThread]: Flushing usage events
[0m00:14:15.439053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:56.028979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881adb0>]}


============================== 00:16:56.031915 | 79002c15-9c82-4805-9477-cc76aa8bc26c ==============================
[0m00:16:56.031915 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:16:56.032296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'send_anonymous_usage_stats': 'True'}
[0m00:16:56.129219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6b470>]}
[0m00:16:56.155500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d5100>]}
[0m00:16:56.156306 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:16:56.215660 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:16:56.280330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:56.280786 [debug] [MainThread]: Partial parsing: updated file: bdt_transformations://models/bitrix/btx_raw_errors.sql
[0m00:16:56.402285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109656a20>]}
[0m00:16:56.436162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:16:56.437985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:16:56.448305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109358a10>]}
[0m00:16:56.448626 [info ] [MainThread]: Found 10 models, 20 sources, 433 macros
[0m00:16:56.448813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e83e0>]}
[0m00:16:56.449835 [info ] [MainThread]: 
[0m00:16:56.450057 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:16:56.450210 [info ] [MainThread]: 
[0m00:16:56.450493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:56.452764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:16:56.480746 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:16:56.481000 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:16:56.481165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:57.754908 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.274 seconds
[0m00:16:57.756755 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:16:57.758742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:16:57.763986 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:16:57.764322 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:16:57.764560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:58.988097 [debug] [ThreadPool]: SQL status: BEGIN in 1.223 seconds
[0m00:16:58.990446 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:16:58.991741 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:16:59.146954 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.154 seconds
[0m00:16:59.152958 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:16:59.303173 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:16:59.318802 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:59.319462 [debug] [MainThread]: On master: BEGIN
[0m00:16:59.319780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:00.537029 [debug] [MainThread]: SQL status: BEGIN in 1.217 seconds
[0m00:17:00.539321 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:00.540610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:00.698971 [debug] [MainThread]: SQL status: SELECT 9 in 0.157 seconds
[0m00:17:00.708681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937c260>]}
[0m00:17:00.709369 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:00.858320 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:00.859377 [debug] [MainThread]: On master: BEGIN
[0m00:17:01.159241 [debug] [MainThread]: SQL status: BEGIN in 0.299 seconds
[0m00:17:01.161571 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.162392 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.162900 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.322546 [debug] [MainThread]: SQL status: COMMIT in 0.159 seconds
[0m00:17:01.325263 [debug] [MainThread]: On master: Close
[0m00:17:01.333625 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:17:01.334290 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_company
[0m00:17:01.334782 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:17:01.335272 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:17:01.335936 [info ] [Thread-1 (]: 1 of 10 START sql view model bitrix.btx_processed_activity ..................... [RUN]
[0m00:17:01.336535 [info ] [Thread-2 (]: 2 of 10 START sql view model bitrix.btx_processed_company ...................... [RUN]
[0m00:17:01.337069 [info ] [Thread-3 (]: 3 of 10 START sql view model bitrix.btx_processed_deal ......................... [RUN]
[0m00:17:01.337590 [info ] [Thread-4 (]: 4 of 10 START sql view model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m00:17:01.338144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_processed_activity)
[0m00:17:01.338698 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m00:17:01.339188 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:17:01.339665 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal_userfields'
[0m00:17:01.340076 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:17:01.340410 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m00:17:01.340723 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:17:01.341036 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m00:17:01.349370 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:17:01.352275 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m00:17:01.355344 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:17:01.359259 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:01.361315 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m00:17:01.361645 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m00:17:01.361895 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m00:17:01.375571 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m00:17:01.385200 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m00:17:01.387465 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m00:17:01.389417 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:01.391339 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m00:17:01.392150 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:01.392612 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m00:17:01.392839 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:01.393061 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:01.393288 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:01.393467 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:01.393662 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m00:17:01.393850 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m00:17:01.394021 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m00:17:01.394279 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:17:01.394463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:01.394631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:02.618375 [debug] [Thread-1 (]: SQL status: BEGIN in 1.222 seconds
[0m00:17:02.620344 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:02.621427 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m00:17:02.622434 [debug] [Thread-4 (]: SQL status: BEGIN in 1.229 seconds
[0m00:17:02.623320 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:02.624025 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m00:17:02.626954 [debug] [Thread-2 (]: SQL status: BEGIN in 1.233 seconds
[0m00:17:02.627475 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:02.628348 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m00:17:02.631779 [debug] [Thread-3 (]: SQL status: BEGIN in 1.237 seconds
[0m00:17:02.632184 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:02.633177 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m00:17:02.786030 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m00:17:02.792496 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:02.792930 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m00:17:02.793267 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m00:17:02.793552 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m00:17:02.796061 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:02.798382 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:02.798763 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m00:17:02.799089 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m00:17:02.801890 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.168 seconds
[0m00:17:02.804271 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:02.804560 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m00:17:02.947152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:17:02.949018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:02.950326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:17:02.956658 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:17:02.957632 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:02.960895 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:02.963726 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:02.966435 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:02.966848 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m00:17:02.967234 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m00:17:02.967572 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m00:17:02.967890 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m00:17:03.116001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m00:17:03.117308 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:03.118744 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:17:03.120114 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:17:03.138781 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:17:03.140583 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:17:03.142204 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:17:03.143695 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:17:03.144045 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:03.144366 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:03.144668 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:03.144962 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:03.145244 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:17:03.145493 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:17:03.145870 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:17:03.146159 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:17:03.296830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m00:17:03.322676 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m00:17:03.323180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.177 seconds
[0m00:17:03.323540 [debug] [Thread-3 (]: SQL status: COMMIT in 0.177 seconds
[0m00:17:03.323855 [debug] [Thread-4 (]: SQL status: COMMIT in 0.177 seconds
[0m00:17:03.327533 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:03.329266 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m00:17:03.330702 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m00:17:03.332095 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m00:17:03.332407 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m00:17:03.332953 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:03.333407 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:03.333845 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:17:03.334129 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m00:17:03.334374 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m00:17:03.334613 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m00:17:03.485165 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.150 seconds
[0m00:17:03.486798 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:17:03.487484 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.153 seconds
[0m00:17:03.488187 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m00:17:03.493004 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m00:17:03.494861 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m00:17:03.496533 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_company: Close
[0m00:17:03.498037 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m00:17:03.502665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e2a20>]}
[0m00:17:03.503109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d3710>]}
[0m00:17:03.503927 [info ] [Thread-4 (]: 4 of 10 OK created sql view model bitrix.btx_processed_deal_userfields ......... [[32mCREATE VIEW[0m in 2.16s]
[0m00:17:03.504313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e29f0>]}
[0m00:17:03.504672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b60ce0>]}
[0m00:17:03.505358 [info ] [Thread-1 (]: 1 of 10 OK created sql view model bitrix.btx_processed_activity ................ [[32mCREATE VIEW[0m in 2.16s]
[0m00:17:03.505983 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:17:03.506476 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bitrix.btx_processed_company ................. [[32mCREATE VIEW[0m in 2.16s]
[0m00:17:03.506964 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bitrix.btx_processed_deal .................... [[32mCREATE VIEW[0m in 2.16s]
[0m00:17:03.507433 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:17:03.507815 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:17:03.508238 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m00:17:03.508726 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:17:03.509061 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:17:03.509514 [info ] [Thread-4 (]: 5 of 10 START sql view model bitrix.btx_processed_dealcategory ................. [RUN]
[0m00:17:03.509915 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:17:03.510284 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_user
[0m00:17:03.510803 [info ] [Thread-1 (]: 6 of 10 START sql view model bitrix.btx_processed_dealcategory_stage ........... [RUN]
[0m00:17:03.511225 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_dealcategory)
[0m00:17:03.511610 [info ] [Thread-2 (]: 7 of 10 START sql view model bitrix.btx_processed_product ...................... [RUN]
[0m00:17:03.512004 [info ] [Thread-3 (]: 8 of 10 START sql view model bitrix.btx_processed_user ......................... [RUN]
[0m00:17:03.512358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory_stage)
[0m00:17:03.512691 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:17:03.513007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_product)
[0m00:17:03.513310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_user)
[0m00:17:03.513612 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:17:03.516638 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:03.516958 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:17:03.517222 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m00:17:03.519376 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:03.522486 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:17:03.526855 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m00:17:03.527221 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:17:03.530445 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:03.530794 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:17:03.531169 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m00:17:03.531365 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:17:03.533862 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:03.536233 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m00:17:03.536535 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:03.538745 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:17:03.539133 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:17:03.539528 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:03.539787 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:03.540017 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:17:03.540259 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: BEGIN
[0m00:17:03.540497 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m00:17:03.540695 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:03.540981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:03.541186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:03.541390 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:17:03.541791 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:04.771175 [debug] [Thread-2 (]: SQL status: BEGIN in 1.229 seconds
[0m00:17:04.771989 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:04.772394 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m00:17:04.773326 [debug] [Thread-1 (]: SQL status: BEGIN in 1.232 seconds
[0m00:17:04.773911 [debug] [Thread-4 (]: SQL status: BEGIN in 1.234 seconds
[0m00:17:04.774509 [debug] [Thread-3 (]: SQL status: BEGIN in 1.233 seconds
[0m00:17:04.775116 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:04.775671 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:04.776166 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:04.776706 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
WHERE
  "SUCCESS" = true
  );
[0m00:17:04.777247 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m00:17:04.777793 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m00:17:04.943707 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m00:17:04.950859 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:04.951540 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.173 seconds
[0m00:17:04.952184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.174 seconds
[0m00:17:04.952769 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m00:17:04.957193 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:04.957847 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.179 seconds
[0m00:17:04.961804 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:04.962560 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m00:17:04.966039 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:04.966430 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage" rename to "btx_processed_dealcategory_stage__dbt_backup"
[0m00:17:04.966854 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m00:17:05.113492 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:17:05.115371 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:17:05.116548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:05.121988 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:05.122600 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m00:17:05.126093 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:05.130606 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:05.131035 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m00:17:05.198786 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:05.199069 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m00:17:05.199270 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp" rename to "btx_processed_dealcategory_stage"
[0m00:17:05.199534 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m00:17:05.348037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:17:05.348696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:05.349132 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:05.351235 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:17:05.352789 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:17:05.354160 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:17:05.354488 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m00:17:05.354882 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:05.355246 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:05.355564 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:05.356993 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:17:05.357326 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:17:05.357752 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:17:05.358069 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:17:05.358369 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:05.358842 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:17:05.508505 [debug] [Thread-4 (]: SQL status: COMMIT in 0.149 seconds
[0m00:17:05.510219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m00:17:05.511305 [debug] [Thread-2 (]: SQL status: COMMIT in 0.153 seconds
[0m00:17:05.517102 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m00:17:05.520049 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup"
[0m00:17:05.522550 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m00:17:05.523455 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:17:05.524162 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:17:05.524856 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:17:05.525238 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m00:17:05.525590 [debug] [Thread-3 (]: SQL status: COMMIT in 0.166 seconds
[0m00:17:05.525941 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup" cascade
[0m00:17:05.526316 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m00:17:05.528577 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m00:17:05.529384 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:17:05.529709 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m00:17:05.679595 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:17:05.681144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:17:05.682020 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:17:05.685353 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:17:05.687423 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: Close
[0m00:17:05.687965 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.159 seconds
[0m00:17:05.689847 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_user: Close
[0m00:17:05.691630 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:17:05.692369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8d130>]}
[0m00:17:05.692875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c9730>]}
[0m00:17:05.693864 [info ] [Thread-4 (]: 5 of 10 OK created sql view model bitrix.btx_processed_dealcategory ............ [[32mCREATE VIEW[0m in 2.18s]
[0m00:17:05.694529 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c9310>]}
[0m00:17:05.695038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af1850>]}
[0m00:17:05.695709 [info ] [Thread-1 (]: 6 of 10 OK created sql view model bitrix.btx_processed_dealcategory_stage ...... [[32mCREATE VIEW[0m in 2.18s]
[0m00:17:05.696292 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:17:05.696852 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bitrix.btx_processed_user .................... [[32mCREATE VIEW[0m in 2.18s]
[0m00:17:05.697400 [info ] [Thread-2 (]: 7 of 10 OK created sql view model bitrix.btx_processed_product ................. [[32mCREATE VIEW[0m in 2.18s]
[0m00:17:05.697918 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:17:05.698339 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_raw_errors
[0m00:17:05.698939 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m00:17:05.699430 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:17:05.699806 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m00:17:05.700306 [info ] [Thread-4 (]: 9 of 10 START sql table model bitrix.btx_raw_errors ............................ [RUN]
[0m00:17:05.700923 [info ] [Thread-1 (]: 10 of 10 START sql table model bitrix.btx_curated_deal ......................... [RUN]
[0m00:17:05.701364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory, now model.bdt_transformations.btx_raw_errors)
[0m00:17:05.701736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory_stage, now model.bdt_transformations.btx_curated_deal)
[0m00:17:05.702045 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_raw_errors
[0m00:17:05.702337 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m00:17:05.710117 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_raw_errors"
[0m00:17:05.712810 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m00:17:05.715420 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m00:17:05.715743 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_raw_errors
[0m00:17:05.730607 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m00:17:05.732881 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_raw_errors"
[0m00:17:05.733511 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:05.733778 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:05.733979 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m00:17:05.734191 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: BEGIN
[0m00:17:05.734401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:05.734602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:17:06.947193 [debug] [Thread-1 (]: SQL status: BEGIN in 1.212 seconds
[0m00:17:06.950388 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:06.951342 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m00:17:06.976989 [debug] [Thread-4 (]: SQL status: BEGIN in 1.242 seconds
[0m00:17:06.979036 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:06.981021 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_tmp"
  
  
    as
  
  (
    

select 
    'btx_raw_activity' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_catalog' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_catalog"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company_userfield"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_contact' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_contact"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_currency' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_currency"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_recurring' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_recurring"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory_stage' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitydirection' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitydirection"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitynotifytype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitynotifytype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitypriority' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitypriority"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_addresstype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_addresstype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_ownertype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_ownertype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_lead' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_lead"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_product' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_status' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_status"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_user' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
where "SUCCESS" = FALSE
  );
  
[0m00:17:07.162883 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.179 seconds
[0m00:17:07.172696 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:07.173637 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_raw_errors" rename to "btx_raw_errors__dbt_backup"
[0m00:17:07.211754 [debug] [Thread-1 (]: SQL status: SELECT 227 in 0.259 seconds
[0m00:17:07.222672 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:07.223210 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m00:17:07.325547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:17:07.334138 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:07.334954 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_tmp" rename to "btx_raw_errors"
[0m00:17:07.372873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:07.380859 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:07.381372 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m00:17:07.490270 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m00:17:07.500979 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: COMMIT
[0m00:17:07.501654 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:07.502096 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: COMMIT
[0m00:17:07.531043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:17:07.533637 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:17:07.534174 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:07.534654 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:17:07.654726 [debug] [Thread-4 (]: SQL status: COMMIT in 0.152 seconds
[0m00:17:07.661617 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_backup"
[0m00:17:07.665672 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_raw_errors"
[0m00:17:07.666135 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_raw_errors"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_raw_errors__dbt_backup" cascade
[0m00:17:07.685054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m00:17:07.688518 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m00:17:07.689703 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:17:07.690220 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m00:17:07.820372 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.154 seconds
[0m00:17:07.821816 [debug] [Thread-4 (]: On model.bdt_transformations.btx_raw_errors: Close
[0m00:17:07.822473 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109adb380>]}
[0m00:17:07.822993 [info ] [Thread-4 (]: 9 of 10 OK created sql table model bitrix.btx_raw_errors ....................... [[32mSELECT 0[0m in 2.12s]
[0m00:17:07.823446 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_raw_errors
[0m00:17:07.841573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.151 seconds
[0m00:17:07.842702 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m00:17:07.843260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79002c15-9c82-4805-9477-cc76aa8bc26c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ea630>]}
[0m00:17:07.843760 [info ] [Thread-1 (]: 10 of 10 OK created sql table model bitrix.btx_curated_deal .................... [[32mSELECT 227[0m in 2.14s]
[0m00:17:07.844215 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m00:17:07.845353 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:07.845715 [debug] [MainThread]: On master: BEGIN
[0m00:17:07.845991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:09.071795 [debug] [MainThread]: SQL status: BEGIN in 1.225 seconds
[0m00:17:09.074212 [debug] [MainThread]: On master: COMMIT
[0m00:17:09.075283 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:09.075851 [debug] [MainThread]: On master: COMMIT
[0m00:17:09.228365 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m00:17:09.231118 [debug] [MainThread]: On master: Close
[0m00:17:09.233520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:09.234305 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m00:17:09.234816 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:17:09.235262 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m00:17:09.235681 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_raw_errors' was properly closed.
[0m00:17:09.236364 [info ] [MainThread]: 
[0m00:17:09.236891 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 12.79 seconds (12.79s).
[0m00:17:09.239297 [debug] [MainThread]: Command end result
[0m00:17:09.264773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:17:09.266514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:17:09.271869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:17:09.272158 [info ] [MainThread]: 
[0m00:17:09.272442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:09.272675 [info ] [MainThread]: 
[0m00:17:09.272909 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:17:09.274879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.280536, "process_in_blocks": "0", "process_kernel_time": 0.260618, "process_mem_max_rss": "129269760", "process_out_blocks": "0", "process_user_time": 1.820594}
[0m00:17:09.275155 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:09.275102 after 13.28 seconds
[0m00:17:09.275396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b63a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108473e60>]}
[0m00:17:09.275628 [debug] [MainThread]: Flushing usage events
[0m00:17:10.255190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:53.594955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1eba0>]}


============================== 00:17:53.597962 | 28886741-917c-4794-9c20-81f4a31893aa ==============================
[0m00:17:53.597962 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:17:53.598344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:53.695936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dde1e0>]}
[0m00:17:53.721757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105122390>]}
[0m00:17:53.722454 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:17:53.782648 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:17:53.843834 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m00:17:53.844216 [debug] [MainThread]: Partial parsing: added file: bdt_transformations://models/bitrix/btx_load_errors.sql
[0m00:17:53.844389 [debug] [MainThread]: Partial parsing: deleted file: bdt_transformations://models/bitrix/btx_raw_errors.sql
[0m00:17:53.965682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5aae0>]}
[0m00:17:53.998585 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:17:54.000464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:17:54.010570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1fa10>]}
[0m00:17:54.010867 [info ] [MainThread]: Found 10 models, 20 sources, 433 macros
[0m00:17:54.011057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4e8a0>]}
[0m00:17:54.012035 [info ] [MainThread]: 
[0m00:17:54.012233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:17:54.012381 [info ] [MainThread]: 
[0m00:17:54.012644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:54.014690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:17:54.042458 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:17:54.042702 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:17:54.042885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:55.296531 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.254 seconds
[0m00:17:55.298014 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:17:55.299686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:17:55.304120 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:17:55.304390 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:17:55.304582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:56.521555 [debug] [ThreadPool]: SQL status: BEGIN in 1.216 seconds
[0m00:17:56.523815 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:17:56.525076 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:17:56.677012 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.151 seconds
[0m00:17:56.682810 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:17:56.833849 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:17:56.849227 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:56.849851 [debug] [MainThread]: On master: BEGIN
[0m00:17:56.850234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:58.112579 [debug] [MainThread]: SQL status: BEGIN in 1.262 seconds
[0m00:17:58.114610 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:58.115911 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:58.277586 [debug] [MainThread]: SQL status: SELECT 9 in 0.160 seconds
[0m00:17:58.286304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105213830>]}
[0m00:17:58.287615 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:58.439089 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:58.439662 [debug] [MainThread]: On master: BEGIN
[0m00:17:58.743312 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m00:17:58.746704 [debug] [MainThread]: On master: COMMIT
[0m00:17:58.747672 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:58.748678 [debug] [MainThread]: On master: COMMIT
[0m00:17:58.900750 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m00:17:58.902633 [debug] [MainThread]: On master: Close
[0m00:17:58.909756 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_load_errors
[0m00:17:58.910393 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:17:58.910940 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_company
[0m00:17:58.911618 [info ] [Thread-1 (]: 1 of 10 START sql table model bitrix.btx_load_errors ........................... [RUN]
[0m00:17:58.912210 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:17:58.912888 [info ] [Thread-2 (]: 2 of 10 START sql view model bitrix.btx_processed_activity ..................... [RUN]
[0m00:17:58.913531 [info ] [Thread-3 (]: 3 of 10 START sql view model bitrix.btx_processed_company ...................... [RUN]
[0m00:17:58.914156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_load_errors)
[0m00:17:58.914719 [info ] [Thread-4 (]: 4 of 10 START sql view model bitrix.btx_processed_deal ......................... [RUN]
[0m00:17:58.915305 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_activity'
[0m00:17:58.915816 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m00:17:58.916182 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_load_errors
[0m00:17:58.916598 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:17:58.916932 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:17:58.917257 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m00:17:58.929817 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_load_errors"
[0m00:17:58.930193 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:17:58.932535 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:17:58.934908 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m00:17:58.939065 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:17:58.940140 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_load_errors
[0m00:17:58.960192 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m00:17:58.963977 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_load_errors"
[0m00:17:58.964212 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m00:17:58.970834 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m00:17:58.974987 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m00:17:58.977139 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m00:17:58.978991 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m00:17:58.979428 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:17:58.980000 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: BEGIN
[0m00:17:58.980223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:58.980728 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:17:58.980960 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:17:58.981167 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:17:58.981332 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m00:17:58.981504 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m00:17:58.981672 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m00:17:58.981842 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:58.982002 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:58.982162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:18:00.205683 [debug] [Thread-4 (]: SQL status: BEGIN in 1.224 seconds
[0m00:18:00.206081 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:18:00.206660 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m00:18:00.207459 [debug] [Thread-2 (]: SQL status: BEGIN in 1.225 seconds
[0m00:18:00.207921 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:18:00.208325 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m00:18:00.223440 [debug] [Thread-3 (]: SQL status: BEGIN in 1.241 seconds
[0m00:18:00.223954 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:18:00.224214 [debug] [Thread-1 (]: SQL status: BEGIN in 1.244 seconds
[0m00:18:00.224631 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m00:18:00.225338 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:18:00.226005 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp"
  
  
    as
  
  (
    

select 
    'btx_raw_activity' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_catalog' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_catalog"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company_userfield"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_contact' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_contact"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_currency' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_currency"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_recurring' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_recurring"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory_stage' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitydirection' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitydirection"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitynotifytype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitynotifytype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitypriority' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitypriority"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_addresstype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_addresstype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_ownertype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_ownertype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_lead' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_lead"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_product' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_status' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_status"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_user' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
where "SUCCESS" = FALSE
  );
  
[0m00:18:00.383764 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.175 seconds
[0m00:18:00.385076 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.177 seconds
[0m00:18:00.395936 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:18:00.396563 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.171 seconds
[0m00:18:00.400074 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:18:00.400477 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.174 seconds
[0m00:18:00.400922 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m00:18:00.403990 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:18:00.404350 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m00:18:00.407632 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:18:00.408094 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m00:18:00.408505 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp" rename to "btx_load_errors"
[0m00:18:00.557439 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:18:00.558306 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:18:00.558979 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:18:00.559604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:18:00.564163 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:18:00.568056 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:18:00.571520 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:18:00.588613 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:18:00.589017 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m00:18:00.589329 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m00:18:00.589610 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m00:18:00.589879 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:18:00.590298 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:18:00.739889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:18:00.745536 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:18:00.746107 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m00:18:00.746547 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m00:18:00.746909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.156 seconds
[0m00:18:00.747324 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:18:00.749421 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:18:00.751221 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:18:00.757701 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup"
[0m00:18:00.758149 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:18:00.758502 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:18:00.758805 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:18:00.763158 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:18:00.763599 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:18:00.763930 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:18:00.764382 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup" cascade
[0m00:18:00.923415 [debug] [Thread-2 (]: SQL status: COMMIT in 0.158 seconds
[0m00:18:00.924386 [debug] [Thread-4 (]: SQL status: COMMIT in 0.161 seconds
[0m00:18:00.924938 [debug] [Thread-3 (]: SQL status: COMMIT in 0.160 seconds
[0m00:18:00.929805 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m00:18:00.933026 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m00:18:00.935529 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m00:18:00.939502 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:18:00.940295 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:18:00.941021 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:18:00.941408 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m00:18:00.941783 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m00:18:00.942147 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m00:18:00.992062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.227 seconds
[0m00:18:00.995600 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: Close
[0m00:18:00.999394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7e30>]}
[0m00:18:01.000083 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bitrix.btx_load_errors ...................... [[32mSELECT 0[0m in 2.08s]
[0m00:18:01.000625 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_load_errors
[0m00:18:01.001009 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:18:01.001537 [info ] [Thread-1 (]: 5 of 10 START sql view model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m00:18:01.001996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_load_errors, now model.bdt_transformations.btx_processed_deal_userfields)
[0m00:18:01.002348 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m00:18:01.005346 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:01.006590 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m00:18:01.009716 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:01.010476 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:01.010770 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m00:18:01.011042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:01.100400 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.158 seconds
[0m00:18:01.101117 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.158 seconds
[0m00:18:01.101753 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.159 seconds
[0m00:18:01.104007 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m00:18:01.105623 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m00:18:01.106907 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: Close
[0m00:18:01.108124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7a270>]}
[0m00:18:01.108729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efeb10>]}
[0m00:18:01.109512 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bitrix.btx_processed_activity ................ [[32mCREATE VIEW[0m in 2.19s]
[0m00:18:01.110050 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efe840>]}
[0m00:18:01.110649 [info ] [Thread-4 (]: 4 of 10 OK created sql view model bitrix.btx_processed_deal .................... [[32mCREATE VIEW[0m in 2.19s]
[0m00:18:01.111242 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:18:01.111776 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bitrix.btx_processed_company ................. [[32mCREATE VIEW[0m in 2.19s]
[0m00:18:01.112250 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:18:01.112630 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:18:01.113161 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m00:18:01.113526 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:18:01.114087 [info ] [Thread-2 (]: 6 of 10 START sql view model bitrix.btx_processed_dealcategory ................. [RUN]
[0m00:18:01.114464 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:18:01.114875 [info ] [Thread-4 (]: 7 of 10 START sql view model bitrix.btx_processed_dealcategory_stage ........... [RUN]
[0m00:18:01.115268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m00:18:01.115665 [info ] [Thread-3 (]: 8 of 10 START sql view model bitrix.btx_processed_product ...................... [RUN]
[0m00:18:01.116011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_dealcategory_stage)
[0m00:18:01.116336 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:18:01.116644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_product)
[0m00:18:01.116952 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:18:01.121829 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:01.122176 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:18:01.124189 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:01.126730 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:18:01.128952 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:18:01.129245 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:18:01.131814 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:01.134216 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:01.134498 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:18:01.136851 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:18:01.137389 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:01.137729 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: BEGIN
[0m00:18:01.138019 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:01.138265 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:01.138493 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:18:01.138719 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:18:01.138937 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:18:01.139239 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:18:01.139452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:02.255300 [debug] [Thread-1 (]: SQL status: BEGIN in 1.243 seconds
[0m00:18:02.257700 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:02.259140 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m00:18:02.361690 [debug] [Thread-2 (]: SQL status: BEGIN in 1.222 seconds
[0m00:18:02.364160 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:02.365356 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m00:18:02.367671 [debug] [Thread-4 (]: SQL status: BEGIN in 1.229 seconds
[0m00:18:02.368228 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:02.368789 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
WHERE
  "SUCCESS" = true
  );
[0m00:18:02.372345 [debug] [Thread-3 (]: SQL status: BEGIN in 1.233 seconds
[0m00:18:02.372846 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:02.373594 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m00:18:02.421738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m00:18:02.431236 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:02.431975 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m00:18:02.522015 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.155 seconds
[0m00:18:02.530928 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:02.531593 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m00:18:02.532230 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m00:18:02.536807 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:02.537373 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m00:18:02.538011 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage" rename to "btx_processed_dealcategory_stage__dbt_backup"
[0m00:18:02.541614 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:02.542119 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m00:18:02.583708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:18:02.587086 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:02.587569 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m00:18:02.685809 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m00:18:02.693233 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:02.693798 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:18:02.694360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:18:02.694857 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m00:18:02.700097 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:02.767505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.180 seconds
[0m00:18:02.768337 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:02.768648 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp" rename to "btx_processed_dealcategory_stage"
[0m00:18:02.769534 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:18:02.769750 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m00:18:02.769981 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:02.770204 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:18:02.918781 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:18:02.919200 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:18:02.919615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:18:02.921508 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:18:02.923078 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:18:02.923444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m00:18:02.925012 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:18:02.925415 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:02.925781 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:02.928151 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m00:18:02.928500 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:02.928803 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:18:02.929097 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:18:02.929711 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:18:02.930014 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:18:02.930497 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m00:18:03.080818 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m00:18:03.082291 [debug] [Thread-2 (]: SQL status: COMMIT in 0.152 seconds
[0m00:18:03.088761 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup"
[0m00:18:03.089180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.158 seconds
[0m00:18:03.089572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.159 seconds
[0m00:18:03.091937 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m00:18:03.092761 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:18:03.094659 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m00:18:03.095914 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m00:18:03.096588 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:18:03.096925 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup" cascade
[0m00:18:03.097542 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:18:03.097950 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m00:18:03.098508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcc950>]}
[0m00:18:03.098917 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m00:18:03.099579 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bitrix.btx_processed_deal_userfields ......... [[32mCREATE VIEW[0m in 2.10s]
[0m00:18:03.100158 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:18:03.100538 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_user
[0m00:18:03.100974 [info ] [Thread-1 (]: 9 of 10 START sql view model bitrix.btx_processed_user ......................... [RUN]
[0m00:18:03.101376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m00:18:03.101730 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m00:18:03.104803 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m00:18:03.106405 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m00:18:03.109561 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m00:18:03.110142 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:03.110452 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m00:18:03.110740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:03.251599 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:18:03.253316 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.155 seconds
[0m00:18:03.254130 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.154 seconds
[0m00:18:03.258957 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:18:03.261443 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: Close
[0m00:18:03.263246 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:18:03.264315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a5820>]}
[0m00:18:03.264943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efee10>]}
[0m00:18:03.265484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ffc830>]}
[0m00:18:03.266386 [info ] [Thread-4 (]: 7 of 10 OK created sql view model bitrix.btx_processed_dealcategory_stage ...... [[32mCREATE VIEW[0m in 2.15s]
[0m00:18:03.267129 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bitrix.btx_processed_dealcategory ............ [[32mCREATE VIEW[0m in 2.15s]
[0m00:18:03.267800 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bitrix.btx_processed_product ................. [[32mCREATE VIEW[0m in 2.15s]
[0m00:18:03.268454 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:18:03.269040 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:18:03.269593 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:18:03.270079 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m00:18:03.270848 [info ] [Thread-4 (]: 10 of 10 START sql table model bitrix.btx_curated_deal ......................... [RUN]
[0m00:18:03.271335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory_stage, now model.bdt_transformations.btx_curated_deal)
[0m00:18:03.271710 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m00:18:03.275854 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m00:18:03.278695 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m00:18:03.282234 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m00:18:03.283020 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:03.283338 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m00:18:03.283624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:18:04.352078 [debug] [Thread-1 (]: SQL status: BEGIN in 1.240 seconds
[0m00:18:04.354508 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:04.355923 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m00:18:04.516733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m00:18:04.525628 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:04.526426 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m00:18:04.531720 [debug] [Thread-4 (]: SQL status: BEGIN in 1.248 seconds
[0m00:18:04.532211 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:04.532979 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m00:18:04.676878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:18:04.686144 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:04.686703 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m00:18:04.784653 [debug] [Thread-4 (]: SQL status: SELECT 227 in 0.250 seconds
[0m00:18:04.791541 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:04.792034 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m00:18:04.839628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:18:04.845417 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:18:04.846087 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:04.846585 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:18:04.942201 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:18:04.951224 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:04.951861 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m00:18:04.997902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.151 seconds
[0m00:18:05.001475 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m00:18:05.002330 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:18:05.002715 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m00:18:05.111633 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m00:18:05.118192 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:18:05.118781 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:05.119186 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:18:05.155817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.153 seconds
[0m00:18:05.158013 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_user: Close
[0m00:18:05.159189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb84d0>]}
[0m00:18:05.160154 [info ] [Thread-1 (]: 9 of 10 OK created sql view model bitrix.btx_processed_user .................... [[32mCREATE VIEW[0m in 2.06s]
[0m00:18:05.160952 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m00:18:05.269057 [debug] [Thread-4 (]: SQL status: COMMIT in 0.149 seconds
[0m00:18:05.271049 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m00:18:05.271668 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:18:05.271970 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m00:18:05.426209 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.154 seconds
[0m00:18:05.428427 [debug] [Thread-4 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m00:18:05.429331 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28886741-917c-4794-9c20-81f4a31893aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eff350>]}
[0m00:18:05.430029 [info ] [Thread-4 (]: 10 of 10 OK created sql table model bitrix.btx_curated_deal .................... [[32mSELECT 227[0m in 2.16s]
[0m00:18:05.430633 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m00:18:05.432114 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:05.432466 [debug] [MainThread]: On master: BEGIN
[0m00:18:05.432758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:06.661669 [debug] [MainThread]: SQL status: BEGIN in 1.228 seconds
[0m00:18:06.663296 [debug] [MainThread]: On master: COMMIT
[0m00:18:06.663835 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:06.664296 [debug] [MainThread]: On master: COMMIT
[0m00:18:06.816080 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m00:18:06.817701 [debug] [MainThread]: On master: Close
[0m00:18:06.819299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:06.819966 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m00:18:06.820363 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m00:18:06.820706 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:18:06.821079 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m00:18:06.821766 [info ] [MainThread]: 
[0m00:18:06.822304 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m00:18:06.824815 [debug] [MainThread]: Command end result
[0m00:18:06.847908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:18:06.849621 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:18:06.854362 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:18:06.854635 [info ] [MainThread]: 
[0m00:18:06.854901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:06.855117 [info ] [MainThread]: 
[0m00:18:06.855336 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:18:06.857323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.296178, "process_in_blocks": "0", "process_kernel_time": 0.267552, "process_mem_max_rss": "129679360", "process_out_blocks": "0", "process_user_time": 1.799435}
[0m00:18:06.857703 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:06.857636 after 13.30 seconds
[0m00:18:06.857993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106031a00>]}
[0m00:18:06.858262 [debug] [MainThread]: Flushing usage events
[0m00:18:07.609179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:15.332515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d6d80>]}


============================== 00:20:15.335893 | 8c1a7f6f-7eac-4b09-9d40-39f7b0017aee ==============================
[0m00:20:15.335893 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:20:15.336292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:20:15.432325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980ba40>]}
[0m00:20:15.458778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e9280>]}
[0m00:20:15.459543 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:20:15.518742 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:20:15.580790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:20:15.581056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:20:15.599670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e8800>]}
[0m00:20:15.635366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:20:15.637060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:20:15.647983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a5fa0>]}
[0m00:20:15.648301 [info ] [MainThread]: Found 10 models, 20 sources, 433 macros
[0m00:20:15.648489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8e6c0>]}
[0m00:20:15.649509 [info ] [MainThread]: 
[0m00:20:15.649737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:15.649904 [info ] [MainThread]: 
[0m00:20:15.650186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:20:15.652259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:20:15.681833 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:20:15.682126 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:20:15.682290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:16.952763 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.270 seconds
[0m00:20:16.955828 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:20:16.958441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:20:16.966028 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:20:16.966472 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:20:16.966808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:18.206052 [debug] [ThreadPool]: SQL status: BEGIN in 1.239 seconds
[0m00:20:18.208430 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:20:18.209481 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:20:18.366264 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.155 seconds
[0m00:20:18.372276 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:20:18.541428 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:20:18.557198 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:18.557783 [debug] [MainThread]: On master: BEGIN
[0m00:20:18.558159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:19.771809 [debug] [MainThread]: SQL status: BEGIN in 1.214 seconds
[0m00:20:19.772195 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:19.772463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:20:19.929108 [debug] [MainThread]: SQL status: SELECT 9 in 0.156 seconds
[0m00:20:19.933013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ea1b0>]}
[0m00:20:19.933669 [debug] [MainThread]: On master: ROLLBACK
[0m00:20:20.083309 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:20.085160 [debug] [MainThread]: On master: BEGIN
[0m00:20:20.387054 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m00:20:20.389571 [debug] [MainThread]: On master: COMMIT
[0m00:20:20.390877 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:20.391654 [debug] [MainThread]: On master: COMMIT
[0m00:20:20.542259 [debug] [MainThread]: SQL status: COMMIT in 0.150 seconds
[0m00:20:20.544742 [debug] [MainThread]: On master: Close
[0m00:20:20.553848 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_load_errors
[0m00:20:20.554484 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:20:20.554982 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_company
[0m00:20:20.555458 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:20:20.556130 [info ] [Thread-1 (]: 1 of 10 START sql table model bitrix.btx_load_errors ........................... [RUN]
[0m00:20:20.556757 [info ] [Thread-2 (]: 2 of 10 START sql view model bitrix.btx_processed_activity ..................... [RUN]
[0m00:20:20.557306 [info ] [Thread-3 (]: 3 of 10 START sql view model bitrix.btx_processed_company ...................... [RUN]
[0m00:20:20.557842 [info ] [Thread-4 (]: 4 of 10 START sql view model bitrix.btx_processed_deal ......................... [RUN]
[0m00:20:20.558444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_load_errors)
[0m00:20:20.559014 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_activity'
[0m00:20:20.559473 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m00:20:20.559883 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:20:20.560229 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_load_errors
[0m00:20:20.560562 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:20:20.560887 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m00:20:20.561208 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:20:20.573303 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_load_errors"
[0m00:20:20.575656 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:20:20.578078 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m00:20:20.580712 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:20:20.582109 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_load_errors
[0m00:20:20.582494 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m00:20:20.582992 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m00:20:20.588883 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m00:20:20.614515 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_load_errors"
[0m00:20:20.617959 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m00:20:20.619814 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m00:20:20.621505 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m00:20:20.622334 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:20.622612 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:20.622939 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: BEGIN
[0m00:20:20.623151 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:20.623365 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:20.623552 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m00:20:20.623737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:20.623913 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m00:20:20.624080 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m00:20:20.624240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:20:20.624490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:20:20.624681 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:20:21.839922 [debug] [Thread-1 (]: SQL status: BEGIN in 1.216 seconds
[0m00:20:21.840321 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:21.840810 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp"
  
  
    as
  
  (
    

select 
    'btx_raw_activity' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_catalog' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_catalog"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company_userfield"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_contact' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_contact"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_currency' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_currency"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_recurring' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_recurring"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory_stage' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitydirection' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitydirection"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitynotifytype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitynotifytype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitypriority' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitypriority"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_addresstype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_addresstype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_ownertype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_ownertype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_lead' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_lead"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_product' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_status' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_status"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_user' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
where "SUCCESS" = FALSE
  );
  
[0m00:20:21.841336 [debug] [Thread-3 (]: SQL status: BEGIN in 1.217 seconds
[0m00:20:21.841622 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:21.842009 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m00:20:21.857040 [debug] [Thread-4 (]: SQL status: BEGIN in 1.233 seconds
[0m00:20:21.857284 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:21.857817 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m00:20:21.862575 [debug] [Thread-2 (]: SQL status: BEGIN in 1.238 seconds
[0m00:20:21.862797 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:21.863090 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m00:20:22.002638 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m00:20:22.012272 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.171 seconds
[0m00:20:22.012997 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:22.016437 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:22.016966 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m00:20:22.017561 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_load_errors" rename to "btx_load_errors__dbt_backup"
[0m00:20:22.021457 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m00:20:22.024374 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:22.024777 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m00:20:22.026272 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m00:20:22.028661 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:22.028965 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m00:20:22.168345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:20:22.168784 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:20:22.171050 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:22.173003 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:22.173299 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:22.173563 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp" rename to "btx_load_errors"
[0m00:20:22.173812 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m00:20:22.175554 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:22.176049 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m00:20:22.177740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:22.179860 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:22.180140 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m00:20:22.324021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:22.331414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m00:20:22.331774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:20:22.339301 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:20:22.340437 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:20:22.340700 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.165 seconds
[0m00:20:22.341724 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:20:22.341985 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:22.342237 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:22.343162 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:20:22.343403 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:22.343629 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:20:22.343846 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:20:22.344049 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:22.344330 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:20:22.344730 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:20:22.494360 [debug] [Thread-3 (]: SQL status: COMMIT in 0.149 seconds
[0m00:20:22.495056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m00:20:22.495539 [debug] [Thread-4 (]: SQL status: COMMIT in 0.151 seconds
[0m00:20:22.501346 [debug] [Thread-2 (]: SQL status: COMMIT in 0.156 seconds
[0m00:20:22.504421 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m00:20:22.506616 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup"
[0m00:20:22.510456 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m00:20:22.512328 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m00:20:22.516582 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:20:22.518727 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:20:22.519334 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:20:22.519918 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:20:22.520225 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m00:20:22.520513 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup" cascade
[0m00:20:22.520795 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m00:20:22.521069 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m00:20:22.673657 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.151 seconds
[0m00:20:22.679903 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m00:20:22.680655 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.159 seconds
[0m00:20:22.681191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.160 seconds
[0m00:20:22.681823 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.160 seconds
[0m00:20:22.684171 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m00:20:22.687587 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: Close
[0m00:20:22.689124 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: Close
[0m00:20:22.689598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108720f80>]}
[0m00:20:22.690664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5883e0>]}
[0m00:20:22.691726 [info ] [Thread-4 (]: 4 of 10 OK created sql view model bitrix.btx_processed_deal .................... [[32mCREATE VIEW[0m in 2.12s]
[0m00:20:22.692397 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bitrix.btx_processed_activity ................ [[32mCREATE VIEW[0m in 2.13s]
[0m00:20:22.692919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b4170>]}
[0m00:20:22.693596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a582690>]}
[0m00:20:22.694361 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:20:22.694919 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:20:22.695584 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bitrix.btx_processed_company ................. [[32mCREATE VIEW[0m in 2.13s]
[0m00:20:22.696192 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bitrix.btx_load_errors ...................... [[32mSELECT 0[0m in 2.14s]
[0m00:20:22.696645 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:20:22.697051 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:20:22.697763 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m00:20:22.698234 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_load_errors
[0m00:20:22.698664 [info ] [Thread-4 (]: 5 of 10 START sql view model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m00:20:22.699084 [info ] [Thread-2 (]: 6 of 10 START sql view model bitrix.btx_processed_dealcategory ................. [RUN]
[0m00:20:22.699458 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:20:22.699828 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:20:22.700239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_deal_userfields)
[0m00:20:22.700577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_dealcategory)
[0m00:20:22.700959 [info ] [Thread-3 (]: 7 of 10 START sql view model bitrix.btx_processed_dealcategory_stage ........... [RUN]
[0m00:20:22.701368 [info ] [Thread-1 (]: 8 of 10 START sql view model bitrix.btx_processed_product ...................... [RUN]
[0m00:20:22.701701 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m00:20:22.701992 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:20:22.702308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_dealcategory_stage)
[0m00:20:22.702613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_load_errors, now model.bdt_transformations.btx_processed_product)
[0m00:20:22.706027 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:22.708127 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:22.708449 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:20:22.708717 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:20:22.711116 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:22.713281 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:20:22.713595 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m00:20:22.713863 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:20:22.716477 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:22.718830 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:22.719212 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:20:22.719455 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:20:22.719827 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:22.722024 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:22.724202 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:20:22.724450 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:22.724705 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m00:20:22.725211 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:20:22.725537 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:20:22.725808 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:22.726054 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:22.726294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:22.726593 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:20:22.726819 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: BEGIN
[0m00:20:22.727115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:22.727333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:20:23.930631 [debug] [Thread-4 (]: SQL status: BEGIN in 1.204 seconds
[0m00:20:23.933522 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:23.934682 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m00:20:23.938912 [debug] [Thread-3 (]: SQL status: BEGIN in 1.211 seconds
[0m00:20:23.940021 [debug] [Thread-2 (]: SQL status: BEGIN in 1.213 seconds
[0m00:20:23.941145 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:23.941741 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:23.942322 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
WHERE
  "SUCCESS" = true
  );
[0m00:20:23.942918 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m00:20:23.962751 [debug] [Thread-1 (]: SQL status: BEGIN in 1.235 seconds
[0m00:20:23.964365 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:23.965022 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m00:20:24.095543 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m00:20:24.107376 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:24.107921 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m00:20:24.110714 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.167 seconds
[0m00:20:24.111118 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.168 seconds
[0m00:20:24.114587 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:24.117667 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:24.118095 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage" rename to "btx_processed_dealcategory_stage__dbt_backup"
[0m00:20:24.118494 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m00:20:24.131591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.166 seconds
[0m00:20:24.134707 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:24.135100 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m00:20:24.256648 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:24.260576 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:24.261068 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m00:20:24.266712 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:24.267224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:24.270263 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:24.273684 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:24.274200 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp" rename to "btx_processed_dealcategory_stage"
[0m00:20:24.274610 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m00:20:24.286001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:20:24.288972 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:24.289373 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m00:20:24.414805 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:20:24.420567 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:20:24.421407 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:24.421989 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:20:24.423257 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:20:24.425151 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:20:24.425588 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:24.425981 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:20:24.434104 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.159 seconds
[0m00:20:24.435887 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:20:24.436307 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:24.436687 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:20:24.441216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:20:24.442955 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:20:24.443368 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:24.443749 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:20:24.571459 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m00:20:24.577985 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m00:20:24.578609 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m00:20:24.579594 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:20:24.582185 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup"
[0m00:20:24.582676 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m00:20:24.583543 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:20:24.584096 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup" cascade
[0m00:20:24.597185 [debug] [Thread-2 (]: SQL status: COMMIT in 0.160 seconds
[0m00:20:24.599652 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m00:20:24.600097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.156 seconds
[0m00:20:24.600873 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:20:24.603232 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m00:20:24.603623 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m00:20:24.606370 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:20:24.606818 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m00:20:24.736126 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.151 seconds
[0m00:20:24.737620 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.153 seconds
[0m00:20:24.739916 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m00:20:24.741673 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: Close
[0m00:20:24.742943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a643980>]}
[0m00:20:24.743557 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61f530>]}
[0m00:20:24.744410 [info ] [Thread-4 (]: 5 of 10 OK created sql view model bitrix.btx_processed_deal_userfields ......... [[32mCREATE VIEW[0m in 2.04s]
[0m00:20:24.745219 [info ] [Thread-3 (]: 7 of 10 OK created sql view model bitrix.btx_processed_dealcategory_stage ...... [[32mCREATE VIEW[0m in 2.04s]
[0m00:20:24.745916 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:20:24.746483 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:20:24.746960 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_user
[0m00:20:24.747498 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m00:20:24.748095 [info ] [Thread-4 (]: 9 of 10 START sql view model bitrix.btx_processed_user ......................... [RUN]
[0m00:20:24.748932 [info ] [Thread-3 (]: 10 of 10 START sql table model bitrix.btx_curated_deal ......................... [RUN]
[0m00:20:24.749654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m00:20:24.750112 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory_stage, now model.bdt_transformations.btx_curated_deal)
[0m00:20:24.750512 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m00:20:24.750857 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m00:20:24.754467 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m00:20:24.757764 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m00:20:24.758150 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m00:20:24.759578 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:20:24.760257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60ac30>]}
[0m00:20:24.760879 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bitrix.btx_processed_dealcategory ............ [[32mCREATE VIEW[0m in 2.06s]
[0m00:20:24.761253 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.154 seconds
[0m00:20:24.761784 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:20:24.762917 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:20:24.763237 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m00:20:24.763525 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m00:20:24.766945 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m00:20:24.767480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dff20>]}
[0m00:20:24.770654 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m00:20:24.771196 [info ] [Thread-1 (]: 8 of 10 OK created sql view model bitrix.btx_processed_product ................. [[32mCREATE VIEW[0m in 2.06s]
[0m00:20:24.771741 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:20:24.772038 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:24.772464 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:24.772844 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m00:20:24.773176 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m00:20:24.773475 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:20:24.773733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:20:26.015393 [debug] [Thread-4 (]: SQL status: BEGIN in 1.241 seconds
[0m00:20:26.016607 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:26.017358 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m00:20:26.023813 [debug] [Thread-3 (]: SQL status: BEGIN in 1.250 seconds
[0m00:20:26.024352 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:26.025305 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m00:20:26.180365 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.162 seconds
[0m00:20:26.188923 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:26.189438 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m00:20:26.293061 [debug] [Thread-3 (]: SQL status: SELECT 227 in 0.266 seconds
[0m00:20:26.300395 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:26.301094 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m00:20:26.341948 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:20:26.349375 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:26.350059 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m00:20:26.459472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m00:20:26.466088 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:26.466827 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m00:20:26.502091 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:20:26.507239 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:20:26.507958 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:26.508486 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:20:26.619950 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.152 seconds
[0m00:20:26.624346 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:20:26.624954 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:26.625428 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:20:26.712877 [debug] [Thread-4 (]: SQL status: COMMIT in 0.203 seconds
[0m00:20:26.718240 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m00:20:26.719455 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:20:26.719990 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m00:20:26.780132 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m00:20:26.786416 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m00:20:26.787836 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:20:26.788332 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m00:20:26.872543 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:20:26.873635 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_user: Close
[0m00:20:26.874155 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42ec90>]}
[0m00:20:26.874572 [info ] [Thread-4 (]: 9 of 10 OK created sql view model bitrix.btx_processed_user .................... [[32mCREATE VIEW[0m in 2.12s]
[0m00:20:26.874921 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m00:20:26.946563 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.158 seconds
[0m00:20:26.947701 [debug] [Thread-3 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m00:20:26.948261 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1a7f6f-7eac-4b09-9d40-39f7b0017aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b9a00>]}
[0m00:20:26.948777 [info ] [Thread-3 (]: 10 of 10 OK created sql table model bitrix.btx_curated_deal .................... [[32mSELECT 227[0m in 2.20s]
[0m00:20:26.949247 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m00:20:26.950483 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:26.950872 [debug] [MainThread]: On master: BEGIN
[0m00:20:26.951182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:28.193653 [debug] [MainThread]: SQL status: BEGIN in 1.242 seconds
[0m00:20:28.196276 [debug] [MainThread]: On master: COMMIT
[0m00:20:28.196940 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:28.197492 [debug] [MainThread]: On master: COMMIT
[0m00:20:28.347776 [debug] [MainThread]: SQL status: COMMIT in 0.149 seconds
[0m00:20:28.349928 [debug] [MainThread]: On master: Close
[0m00:20:28.351291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:28.351795 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:20:28.352450 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m00:20:28.352938 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m00:20:28.353376 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m00:20:28.353953 [info ] [MainThread]: 
[0m00:20:28.354435 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 12.70 seconds (12.70s).
[0m00:20:28.356522 [debug] [MainThread]: Command end result
[0m00:20:28.425541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:20:28.426747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:20:28.430323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:20:28.430539 [info ] [MainThread]: 
[0m00:20:28.430740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:28.430896 [info ] [MainThread]: 
[0m00:20:28.431052 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:20:28.432677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.134909, "process_in_blocks": "0", "process_kernel_time": 0.259812, "process_mem_max_rss": "124731392", "process_out_blocks": "0", "process_user_time": 1.644624}
[0m00:20:28.432896 [debug] [MainThread]: Command `dbt run` succeeded at 00:20:28.432856 after 13.14 seconds
[0m00:20:28.433087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d600b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cbb00>]}
[0m00:20:28.433275 [debug] [MainThread]: Flushing usage events
[0m00:20:29.251548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:41.249599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108137020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108136c60>]}


============================== 00:31:41.252494 | 1c8751eb-cde5-4538-9cd3-407eae736dfe ==============================
[0m00:31:41.252494 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:31:41.252826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --profiles-dir /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt --models bitrix --vars {"target_schema": "bitrix"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:41.347420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070da240>]}
[0m00:31:41.372618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108004cb0>]}
[0m00:31:41.373271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:31:41.430082 [debug] [MainThread]: checksum: cc1b84d605d627321c0d87cdef440e4da93a58b71a69e460419de3e0cdba2bbc, vars: {'target_schema': 'bitrix'}, profile: , target: , version: 1.9.4
[0m00:31:41.492024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:41.492308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:41.508480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d68680>]}
[0m00:31:41.540561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:31:41.542539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:31:41.555125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4a360>]}
[0m00:31:41.555421 [info ] [MainThread]: Found 10 models, 20 sources, 433 macros
[0m00:31:41.555599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d68830>]}
[0m00:31:41.556578 [info ] [MainThread]: 
[0m00:31:41.556767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:41.556912 [info ] [MainThread]: 
[0m00:31:41.557165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:41.559165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bendito_intelligence_dev'
[0m00:31:41.587141 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev"
[0m00:31:41.587366 [debug] [ThreadPool]: On list_bendito_intelligence_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev"} */

    select distinct nspname from pg_namespace
  
[0m00:31:41.587525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:42.829000 [debug] [ThreadPool]: SQL status: SELECT 58 in 1.241 seconds
[0m00:31:42.831223 [debug] [ThreadPool]: On list_bendito_intelligence_dev: Close
[0m00:31:42.833374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev, now list_bendito_intelligence_dev_bitrix)
[0m00:31:42.839126 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:31:42.839464 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: BEGIN
[0m00:31:42.839719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:44.073332 [debug] [ThreadPool]: SQL status: BEGIN in 1.233 seconds
[0m00:31:44.075114 [debug] [ThreadPool]: Using postgres connection "list_bendito_intelligence_dev_bitrix"
[0m00:31:44.075665 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "list_bendito_intelligence_dev_bitrix"} */
select
      'bendito_intelligence_dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bitrix'
    union all
    select
      'bendito_intelligence_dev' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bitrix'
  
[0m00:31:44.232946 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.156 seconds
[0m00:31:44.238027 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: ROLLBACK
[0m00:31:44.391707 [debug] [ThreadPool]: On list_bendito_intelligence_dev_bitrix: Close
[0m00:31:44.406111 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:44.406673 [debug] [MainThread]: On master: BEGIN
[0m00:31:44.407046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:45.623628 [debug] [MainThread]: SQL status: BEGIN in 1.216 seconds
[0m00:31:45.625883 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:45.626772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:45.793041 [debug] [MainThread]: SQL status: SELECT 9 in 0.165 seconds
[0m00:31:45.799319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850fec0>]}
[0m00:31:45.800230 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:45.966721 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:45.968446 [debug] [MainThread]: On master: BEGIN
[0m00:31:46.270758 [debug] [MainThread]: SQL status: BEGIN in 0.300 seconds
[0m00:31:46.272341 [debug] [MainThread]: On master: COMMIT
[0m00:31:46.273279 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:46.273756 [debug] [MainThread]: On master: COMMIT
[0m00:31:46.422982 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m00:31:46.424408 [debug] [MainThread]: On master: Close
[0m00:31:46.433013 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_load_errors
[0m00:31:46.433595 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_activity
[0m00:31:46.434034 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_company
[0m00:31:46.434403 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_deal
[0m00:31:46.435137 [info ] [Thread-1 (]: 1 of 10 START sql table model bitrix.btx_load_errors ........................... [RUN]
[0m00:31:46.435926 [info ] [Thread-2 (]: 2 of 10 START sql view model bitrix.btx_processed_activity ..................... [RUN]
[0m00:31:46.436628 [info ] [Thread-3 (]: 3 of 10 START sql view model bitrix.btx_processed_company ...................... [RUN]
[0m00:31:46.437258 [info ] [Thread-4 (]: 4 of 10 START sql view model bitrix.btx_processed_deal ......................... [RUN]
[0m00:31:46.437892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bendito_intelligence_dev_bitrix, now model.bdt_transformations.btx_load_errors)
[0m00:31:46.438478 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_activity'
[0m00:31:46.438993 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_company'
[0m00:31:46.439420 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bdt_transformations.btx_processed_deal'
[0m00:31:46.439785 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_load_errors
[0m00:31:46.440119 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_activity
[0m00:31:46.440449 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_company
[0m00:31:46.440771 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_deal
[0m00:31:46.453262 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_load_errors"
[0m00:31:46.455572 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_activity"
[0m00:31:46.458066 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_company"
[0m00:31:46.460878 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal"
[0m00:31:46.462078 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_activity
[0m00:31:46.462498 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_load_errors
[0m00:31:46.470166 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_deal
[0m00:31:46.494802 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_activity"
[0m00:31:46.496848 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal"
[0m00:31:46.500016 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_load_errors"
[0m00:31:46.500241 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_company
[0m00:31:46.502217 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_company"
[0m00:31:46.502806 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:46.503031 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:46.503282 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:46.503474 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: BEGIN
[0m00:31:46.503659 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: BEGIN
[0m00:31:46.503844 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:46.504024 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: BEGIN
[0m00:31:46.504201 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:31:46.504380 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:31:46.504553 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: BEGIN
[0m00:31:46.504716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:46.505024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:31:47.731957 [debug] [Thread-2 (]: SQL status: BEGIN in 1.228 seconds
[0m00:31:47.732609 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:47.733028 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 AS id,
  ("CONTENT" ->> 'SUBJECT') AS subject,
  ("CONTENT" ->> 'DESCRIPTION') AS description,
  ("CONTENT" ->> 'TYPE_ID') AS type_id,
  ("CONTENT" ->> 'PROVIDER_ID') AS provider_id,
  ("CONTENT" ->> 'PROVIDER_TYPE_ID') AS provider_type_id,
  ("CONTENT" ->> 'PRIORITY') AS priority,
  NULLIF("CONTENT" ->> 'OWNER_ID', '') :: INTEGER AS owner_id,
  ("CONTENT" ->> 'OWNER_TYPE_ID') AS owner_type_id,
  NULLIF("CONTENT" ->> 'RESPONSIBLE_ID', '') :: INTEGER AS responsible_id,
  NULLIF("CONTENT" ->> 'COMPLETED', '[]') :: BOOLEAN AS completed,
  NULLIF("CONTENT" ->> 'STATUS', '') :: INTEGER AS status,
  NULLIF("CONTENT" ->> 'CREATED', '') :: TIMESTAMP AS created,
  NULLIF("CONTENT" ->> 'LAST_UPDATED', '') :: TIMESTAMP AS last_updated,
  ("CONTENT" ->> 'PROVIDER_GROUP_ID') AS provider_group_id,
  ("CONTENT" ->> 'NOTIFY_VALUE') AS notify_value,
  ("CONTENT" ->> 'EDITOR_ID') AS editor_id,
  ("CONTENT" ->> 'PROVIDER_PARAMS') AS provider_params,
  ("CONTENT" ->> 'LOCATION') AS location,
  ("CONTENT" ->> 'DIRECTION') AS direction,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') AS description_type,
  ("CONTENT" ->> 'DEADLINE') AS deadline,
  ("CONTENT" ->> 'FILES') AS files,
  ("CONTENT" ->> 'RESULT_SOURCE_ID') AS result_source_id,
  ("CONTENT" ->> 'ERROR') AS error,
  ("CONTENT" ->> 'ASSOCIATED_ENTITY_ID') AS associated_entity_id,
  ("CONTENT" ->> 'END_TIME') AS end_time,
  ("CONTENT" ->> 'START_TIME') AS start_time,
  ("CONTENT" ->> 'AUTOCOMPLETE_RULE') AS autocomplete_rule,
  ("CONTENT" ->> 'RESULT_CURRENCY_ID') AS result_currency_id,
  ("CONTENT" ->> 'PROVIDER_DATA') AS provider_data,
  ("CONTENT" ->> 'STATUS_CODE') AS status_code,
  ("CONTENT" ->> 'ORIGIN_ID') AS origin_id,
  ("CONTENT" ->> 'RESULT_SUM') AS result_sum,
  ("CONTENT" ->> 'URL') AS url,
  ("CONTENT" ->> 'RESULT_STATUS') AS result_status,
  ("CONTENT" ->> 'NOTIFY_TYPE') AS notify_type,
  ("CONTENT" ->> 'AUTHOR_ID') AS author_id,
  ("CONTENT" ->> 'RESULT_MARK') AS result_mark,
  ("CONTENT" ->> 'RESULT_STREAM') AS result_stream,
  ("CONTENT" ->> 'SETTINGS') AS settings,
  ("CONTENT" ->> 'ORIGINATOR_ID') AS originator_id,
  ("CONTENT" ->> 'RESULT_VALUE') AS result_value
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
WHERE
  "SUCCESS" = TRUE
  );
[0m00:31:47.737720 [debug] [Thread-4 (]: SQL status: BEGIN in 1.233 seconds
[0m00:31:47.738094 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:47.738710 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'TITLE') :: varchar as title,
  ("CONTENT" ->> 'STAGE_ID') :: varchar as stage_id,
  NULLIF("CONTENT" ->> 'CATEGORY_ID', '') :: int2 as category_id,
  NULLIF("CONTENT" ->> 'OPPORTUNITY', '') :: numeric as opportunity,
  NULLIF("CONTENT" ->> 'COMPANY_ID', '') :: int2 as company_id,
  NULLIF("CONTENT" ->> 'CONTACT_ID', '') :: int2 as contact_id,
  NULLIF("CONTENT" ->> 'ASSIGNED_BY_ID', '') :: int2 as assigned_by_id,
  NULLIF("CONTENT" ->> 'CLOSED', '[]') :: bool as closed,
  NULLIF("CONTENT" ->> 'CLOSEDATE', '') :: timestamptz as close_date,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'DATE_MODIFY', '') :: timestamptz as date_modify,
  NULLIF("CONTENT" ->> 'BEGINDATE', '') :: timestamptz as begin_date,
  NULLIF("CONTENT" ->> 'MOVED_TIME', '') :: timestamptz :: timestamptz as moved_time,
  NULLIF("CONTENT" ->> 'OPENED', '[]') :: bool as opened,
  NULLIF("CONTENT" ->> 'IS_NEW', '[]') :: bool as is_new,
  ("CONTENT" ->> 'LEAD_ID') :: varchar as lead_id,
  ("CONTENT" ->> 'TYPE_ID') :: varchar as type_id,
  ("CONTENT" ->> 'COMMENTS') :: text as comments,
  ("CONTENT" ->> 'QUOTE_ID') :: varchar as quote_id,
  ("CONTENT" ->> 'ORIGIN_ID') :: varchar as origin_id,
  ("CONTENT" ->> 'SOURCE_ID') :: varchar as source_id,
  NULLIF("CONTENT" ->> 'TAX_VALUE', '') :: numeric as tax_value,
  ("CONTENT" ->> 'UTM_MEDIUM') :: varchar as utm_medium,
  ("CONTENT" ->> 'UTM_SOURCE') :: varchar as utm_source,
  ("CONTENT" ->> 'UTM_TERM') :: varchar as utm_term,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'LOCATION_ID') :: varchar as location_id,
  NULLIF("CONTENT" ->> 'MOVED_BY_ID', '') :: int2 as moved_by_id,
  ("CONTENT" ->> 'PROBABILITY') :: varchar as probability,
  ("CONTENT" ->> 'UTM_CONTENT') :: varchar as utm_content,
  ("CONTENT" ->> 'IS_RECURRING') :: bool as is_recurring,
  NULLIF("CONTENT" ->> 'MODIFY_BY_ID', '') :: int2 as modify_by_id,
  ("CONTENT" ->> 'UTM_CAMPAIGN') :: varchar as utm_campaign,
  NULLIF("CONTENT" ->> 'CREATED_BY_ID', '') :: int2 as created_by_id,
  ("CONTENT" ->> 'SOURCE_DESCRIPTION') :: text as source_description,
  ("CONTENT" ->> 'ADDITIONAL_INFO') :: text as additional_info,
  ("CONTENT" ->> 'STAGE_SEMANTIC_ID') :: varchar as stage_semantic_id,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_TIME', '') :: timestamptz as last_activity_time,
  NULLIF("CONTENT" ->> 'LAST_ACTIVITY_BY', '') :: int2 as last_activity_by,
  ("CONTENT" ->> 'ORIGINATOR_ID') :: varchar as originator_id,
  ("CONTENT" ->> 'IS_MANUAL_OPPORTUNITY') :: bool as is_manual_opportunity,
  ("CONTENT" ->> 'IS_RETURN_CUSTOMER') :: bool as is_return_customer,
  ("CONTENT" ->> 'IS_REPEATED_APPROACH') :: bool as is_repeated_approach,
  NULLIF("CONTENT" ->> 'UF_CRM_1718891707656', '') :: int2 as uf_crm_1718891707656,
  ("CONTENT" ->> 'UF_CRM_1718893063318') :: varchar as uf_crm_1718893063318,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895613676', '') :: int2 as uf_crm_1718895613676,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895632531', '') :: int2 as uf_crm_1718895632531,
  NULLIF("CONTENT" ->> 'UF_CRM_1718895837277', '') :: int2 as uf_crm_1718895837277,
  ("CONTENT" ->> 'UF_CRM_1719234554494') :: varchar as uf_crm_1719234554494,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234611470', '') :: int2 as uf_crm_1719234611470,
  NULLIF("CONTENT" ->> 'UF_CRM_1719234653377', '') :: int2 as uf_crm_1719234653377,
  ("CONTENT" ->> 'UF_CRM_1719851689133') :: varchar as uf_crm_1719851689133,
  ("CONTENT" ->> 'UF_CRM_1719851724735') :: varchar as uf_crm_1719851724735,
  ("CONTENT" ->> 'UF_CRM_1719942627227') :: jsonb as uf_crm_1719942627227,
  ("CONTENT" ->> 'UF_CRM_1720015348995') :: jsonb as uf_crm_1720015348995,
  ("CONTENT" ->> 'UF_CRM_1720198477652') :: varchar as uf_crm_1720198477652,
  ("CONTENT" ->> 'UF_CRM_1720198502628') :: varchar as uf_crm_1720198502628,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083795801', '') :: int2 as uf_crm_1721083795801,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083820061', '') :: numeric as uf_crm_1721083820061,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083836488', '') :: numeric as uf_crm_1721083836488,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083849804', '') :: numeric as uf_crm_1721083849804,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083861185', '') :: numeric as uf_crm_1721083861185,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083874978', '') :: numeric as uf_crm_1721083874978,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083894608', '') :: numeric as uf_crm_1721083894608,
  NULLIF("CONTENT" ->> 'UF_CRM_1721083906720', '') :: numeric as uf_crm_1721083906720,
  NULLIF("CONTENT" ->> 'UF_CRM_1721226126', '[]') :: bool as uf_crm_1721226126,
  nullif("CONTENT" ->> 'UF_CRM_1721227124', '[]') :: bool as uf_crm_1721227124,
  ("CONTENT" ->> 'UF_CRM_1721241190') :: varchar as uf_crm_1721241190,
  ("CONTENT" ->> 'UF_CRM_1721243220370') :: varchar as uf_crm_1721243220370,
  ("CONTENT" ->> 'UF_CRM_1721243302036') :: varchar as uf_crm_1721243302036,
  NULLIF("CONTENT" ->> 'UF_CRM_1721243367', '[]') :: bool as uf_crm_1721243367,
  ("CONTENT" ->> 'UF_CRM_1721244413245') :: text as uf_crm_1721244413245,
  ("CONTENT" ->> 'UF_CRM_1721244451568') :: text as uf_crm_1721244451568,
  ("CONTENT" ->> 'UF_CRM_1721244493157') :: text as uf_crm_1721244493157,
  ("CONTENT" ->> 'UF_CRM_1721244526025') :: text as uf_crm_1721244526025,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244560622', '') :: timestamptz as uf_crm_1721244560622,
  NULLIF("CONTENT" ->> 'UF_CRM_1721244826264', '') :: int2 as uf_crm_1721244826264,
  ("CONTENT" ->> 'UF_CRM_1721244999810') :: text as uf_crm_1721244999810,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248388070', '') :: int2 as uf_crm_1721248388070,
  NULLIF("CONTENT" ->> 'UF_CRM_1721248408791', '') :: varchar as uf_crm_1721248408791,
  NULLIF("CONTENT" ->> 'UF_CRM_1721406278811', '') :: timestamptz as uf_crm_1721406278811,
  NULLIF("CONTENT" ->> 'UF_CRM_1724261215', '') :: numeric as uf_crm_1724261215,
  NULLIF("CONTENT" ->> 'UF_CRM_1724264534445', '') :: numeric as uf_crm_1724264534445,
  ("CONTENT" ->> 'UF_CRM_1725574177266') :: varchar as uf_crm_1725574177266,
  ("CONTENT" ->> 'UF_CRM_1725574322') :: varchar as uf_crm_1725574322,
  NULLIF(
    BTRIM("CONTENT" ->> 'UF_CRM_1725548469220', '[]'),
    ''
  ) :: timestamptz as uf_crm_1725548469220,
  ("CONTENT" ->> 'UF_CRM_1726002322164') :: text as uf_crm_1726002322164,
  NULLIF("CONTENT" ->> 'UF_CRM_1726003734', '') :: int2 as uf_crm_1726003734,
  NULLIF("CONTENT" ->> 'UF_CRM_1726007497', '') :: numeric as uf_crm_1726007497,
  NULLIF("CONTENT" ->> 'UF_CRM_1728416073106', '') :: numeric as uf_crm_1728416073106,
  ("CONTENT" ->> 'UF_CRM_1729086829554') :: text as uf_crm_1729086829554,
  NULLIF("CONTENT" ->> 'UF_CRM_1729086887055', '') :: timestamptz as uf_crm_1729086887055,
  NULLIF("CONTENT" ->> 'UF_CRM_1732567021643', '') :: int2 as uf_crm_1732567021643,
  ("CONTENT" ->> 'UF_CRM_1733168617374') :: text as uf_crm_1733168617374,
  ("CONTENT" ->> 'UF_CRM_1733491265514') :: varchar as uf_crm_1733491265514,
  NULLIF("CONTENT" ->> 'UF_CRM_1738931838', '') :: int2 as uf_crm_1738931838,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275511723', '') :: int2 as uf_crm_1741275511723,
  ("CONTENT" ->> 'UF_CRM_1741275566502') :: varchar as uf_crm_1741275566502,
  ("CONTENT" ->> 'UF_CRM_1741275596050') :: text as uf_crm_1741275596050,
  ("CONTENT" ->> 'UF_CRM_1741275610428') :: varchar as uf_crm_1741275610428,
  NULLIF("CONTENT" ->> 'UF_CRM_1741275634394', '') :: numeric as uf_crm_1741275634394,
  ("CONTENT" ->> 'UF_CRM_66D0A6A12E620') :: text as uf_crm_66d0a6a12e620,
  ("CONTENT" ->> 'UF_CRM_66D0A6A146D20') :: text as uf_crm_66d0a6a146d20,
  ("CONTENT" ->> 'UF_CRM_66D0A6A1529FD') :: text as uf_crm_66d0a6a1529fd,
  ("CONTENT" ->> 'UF_CRM_66D0A6A15D94F') :: text as uf_crm_66d0a6a15d94f,
  ("CONTENT" ->> 'UF_CRM_66D0A6A169EDC') :: text as uf_crm_66d0a6a169edc,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1719236124580', '') :: jsonb as uf_crm_deal_1719236124580,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540405848', '') :: int2 as uf_crm_deal_1725540405848,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725540759541', '') :: jsonb as uf_crm_deal_1725540759541,
  ("CONTENT" ->> 'UF_CRM_DEAL_1725569571488') :: text as uf_crm_deal_1725569571488,
  NULLIF("CONTENT" ->> 'UF_CRM_DEAL_1725569886689', '[]') :: jsonb as uf_crm_deal_1725569886689,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374223411') :: varchar as uf_crm_deal_1727374223411,
  ("CONTENT" ->> 'UF_CRM_DEAL_1727374263239') :: varchar as uf_crm_deal_1727374263239,
  ("CONTENT" ->> 'UF_CRM_DEAL_1732567150103') :: text as uf_crm_deal_1732567150103,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069738944') :: varchar as uf_crm_deal_1738069738944,
  ("CONTENT" ->> 'UF_CRM_DEAL_1738069820827') :: text as uf_crm_deal_1738069820827,
  ("CONTENT" ->> 'UF_CRM_DEAL_1722632496832') :: varchar as uf_crm_deal_1722632496832
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
WHERE
  "SUCCESS" = true
  );
[0m00:31:47.747239 [debug] [Thread-3 (]: SQL status: BEGIN in 1.242 seconds
[0m00:31:47.747619 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:47.748032 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp"
    
    
  as (
    
select 
	"ID"::int2 as id,
	("CONTENT"->>'WEB')::jsonb AS web,
	--("CONTENT"->>'LOGO')::text AS logo,
	("CONTENT"->>'TITLE')::varchar AS title,
	NULLIF("CONTENT"->>'OPENED','[]')::bool AS opened,
	--("CONTENT"->>'ADDRESS')::text AS address,
	NULLIF("CONTENT"->>'LEAD_ID','')::int2 AS lead_id,
	NULLIF("CONTENT"->>'REVENUE','')::numeric AS revenue,
	("CONTENT"->>'COMMENTS')::text AS comments,
	--NULLIF("CONTENT"->>'HAS_IMOL','[]')::bool AS has_imol,
	("CONTENT"->>'INDUSTRY')::varchar AS industry,
	--("CONTENT"->>'UTM_TERM') AS utm_term,
    ("CONTENT"->>'ADDRESS_2')::text AS address_2,
    ("CONTENT"->>'EMPLOYEES')::varchar AS employees,
    NULLIF("CONTENT"->>'HAS_EMAIL','[]')::bool AS has_email,
    NULLIF("CONTENT"->>'HAS_PHONE','[]')::bool AS has_phone,
    ("CONTENT"->>'ORIGIN_ID')::varchar AS origin_id,
    --("CONTENT"->>'UTM_MEDIUM')::varchar AS utm_medium,
    --("CONTENT"->>'UTM_SOURCE')::varchar AS utm_source,
    ("CONTENT"->>'CURRENCY_ID')::varchar AS currency_id,
    NULLIF("CONTENT"->>'DATE_CREATE','')::timestamptz AS date_create,
    NULLIF("CONTENT"->>'DATE_MODIFY','')::timestamptz AS date_modify,
    --("CONTENT"->>'REG_ADDRESS') AS reg_address,
    --("CONTENT"->>'UTM_CONTENT') AS utm_content,
    --("CONTENT"->>'ADDRESS_CITY') AS address_city,
    ("CONTENT"->>'COMPANY_TYPE')::varchar AS company_type,
    NULLIF("CONTENT"->>'MODIFY_BY_ID','')::int2 AS modify_by_id,
    --("CONTENT"->>'UTM_CAMPAIGN') AS utm_campaign,
    --("CONTENT"->>'ADDRESS_LEGAL')::varchar AS address_legal,
    NULLIF("CONTENT"->>'CREATED_BY_ID','')::int2 AS created_by_id,
    NULLIF("CONTENT"->>'IS_MY_COMPANY','[]')::bool AS is_my_company,
    --("CONTENT"->>'ORIGINATOR_ID')::varchar AS originator_id,
    --("CONTENT"->>'REG_ADDRESS_2') AS reg_address_2,
    --("CONTENT"->>'ADDRESS_REGION')::varchar AS address_region,
    NULLIF("CONTENT"->>'ASSIGNED_BY_ID','')::int2 AS assigned_by_id,
    --("CONTENT"->>'ORIGIN_VERSION') AS origin_version,
    --("CONTENT"->>'ADDRESS_COUNTRY')::varchar AS address_country,
    --("CONTENT"->>'BANKING_DETAILS') AS banking_details,
    --("CONTENT"->>'ADDRESS_PROVINCE') AS address_province,
    ("CONTENT"->>'LAST_ACTIVITY_BY')::varchar AS last_activity_by,
    --("CONTENT"->>'REG_ADDRESS_CITY') AS reg_address_city,
    ("CONTENT"->>'UF_CRM_1724941360')::varchar AS uf_crm_1724941360,
    ("CONTENT"->>'UF_CRM_1724941486')::varchar AS uf_crm_1724941486,
    ("CONTENT"->>'UF_CRM_1724941613')::varchar AS uf_crm_1724941613,
    NULLIF("CONTENT"->>'LAST_ACTIVITY_TIME','')::timestamptz AS last_activity_time,
    --("CONTENT"->>'REG_ADDRESS_REGION') AS reg_address_region,
    --("CONTENT"->>'ADDRESS_LOC_ADDR_ID') AS address_loc_addr_id,
    --("CONTENT"->>'ADDRESS_POSTAL_CODE') AS address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY') AS reg_address_country,
    --("CONTENT"->>'ADDRESS_COUNTRY_CODE') AS address_country_code,
    --("CONTENT"->>'REG_ADDRESS_PROVINCE') AS reg_address_province,
    ("CONTENT"->>'UF_CRM_1720548388015')::varchar AS uf_crm_1720548388015,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169541171','false',''),'')::varchar AS uf_crm_1726169541171,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169579580','false',''),'')::int2 AS uf_crm_1726169579580,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169611418','false',''),'')::int2 AS uf_crm_1726169611418,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169646823','false',''),'')::varchar AS uf_crm_1726169646823,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726169666589','false',''),'')::varchar AS uf_crm_1726169666589,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173756398','false',''),'')::varchar AS uf_crm_1726173756398,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726173773647','false',''),'')::int2 AS uf_crm_1726173773647,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_1726940183689','false',''),'')::varchar AS uf_crm_1726940183689,
    --("CONTENT"->>'REG_ADDRESS_LOC_ADDR_ID') AS reg_address_loc_addr_id,
    --("CONTENT"->>'REG_ADDRESS_POSTAL_CODE') AS reg_address_postal_code,
    --("CONTENT"->>'REG_ADDRESS_COUNTRY_CODE') AS reg_address_country_code,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1720014986901','false',''),'')::varchar AS uf_crm_company_1720014986901,
    NULLIF(REPLACE("CONTENT"->>'UF_CRM_COMPANY_1738069980122','false',''),'')::int2 AS uf_crm_company_1738069980122
from   "bendito_intelligence_dev"."bitrix"."btx_raw_company"
WHERE "SUCCESS" = true
  );
[0m00:31:47.755820 [debug] [Thread-1 (]: SQL status: BEGIN in 1.251 seconds
[0m00:31:47.756036 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:47.756460 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp"
  
  
    as
  
  (
    

select 
    'btx_raw_activity' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_activity"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_catalog' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_catalog"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_company_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_company_userfield"
where "SUCCESS" = FALSE

union all

select
    'btx_raw_contact' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_contact"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_currency' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_currency"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_recurring' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_recurring"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_deal_userfield' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_dealcategory_stage' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitydirection' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitydirection"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitynotifytype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitynotifytype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_activitypriority' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_activitypriority"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_addresstype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_addresstype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_enum_ownertype' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_enum_ownertype"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_lead' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_lead"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_product' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_product"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_status' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_status"
where "SUCCESS" = FALSE

union all

select 
    'btx_raw_user' as data_source,
    now() as checked_at,
    "ID" as id,
    "CONTENT" ->> 'ERROR' as mensagem,
    "CONTENT" ->> 'URL' as url,
    "CONTENT" ->> 'STATUS_CODE' AS status_code
from "bendito_intelligence_dev"."bitrix"."btx_raw_user"
where "SUCCESS" = FALSE
  );
  
[0m00:31:47.892785 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m00:31:47.902852 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:47.903270 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.164 seconds
[0m00:31:47.903718 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity" rename to "btx_processed_activity__dbt_backup"
[0m00:31:47.906600 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:47.907064 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal" rename to "btx_processed_deal__dbt_backup"
[0m00:31:47.913258 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m00:31:47.915946 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:47.916292 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company" rename to "btx_processed_company__dbt_backup"
[0m00:31:47.922174 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.165 seconds
[0m00:31:47.924580 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:47.924907 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_load_errors" rename to "btx_load_errors__dbt_backup"
[0m00:31:48.056907 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:31:48.060855 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:48.061442 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m00:31:48.062029 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_tmp" rename to "btx_processed_activity"
[0m00:31:48.065622 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:48.066010 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:31:48.066545 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_tmp" rename to "btx_processed_deal"
[0m00:31:48.069294 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:48.069753 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_tmp" rename to "btx_processed_company"
[0m00:31:48.082996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m00:31:48.085657 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:48.086026 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_tmp" rename to "btx_load_errors"
[0m00:31:48.213778 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.147 seconds
[0m00:31:48.227332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m00:31:48.235402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.165 seconds
[0m00:31:48.236888 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:31:48.237256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:31:48.238821 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:31:48.240189 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:31:48.240571 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:48.244478 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:31:48.244812 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:48.245107 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:48.245384 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: COMMIT
[0m00:31:48.245651 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:48.245909 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: COMMIT
[0m00:31:48.246156 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: COMMIT
[0m00:31:48.246487 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: COMMIT
[0m00:31:48.396497 [debug] [Thread-2 (]: SQL status: COMMIT in 0.149 seconds
[0m00:31:48.407003 [debug] [Thread-4 (]: SQL status: COMMIT in 0.160 seconds
[0m00:31:48.407559 [debug] [Thread-3 (]: SQL status: COMMIT in 0.161 seconds
[0m00:31:48.408011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.161 seconds
[0m00:31:48.411417 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup"
[0m00:31:48.413825 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup"
[0m00:31:48.417898 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup"
[0m00:31:48.419791 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup"
[0m00:31:48.424394 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_activity"
[0m00:31:48.425129 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal"
[0m00:31:48.425767 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_company"
[0m00:31:48.427984 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_load_errors"
[0m00:31:48.428335 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_activity"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_activity__dbt_backup" cascade
[0m00:31:48.428659 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal__dbt_backup" cascade
[0m00:31:48.428970 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_company"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_company__dbt_backup" cascade
[0m00:31:48.429278 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_load_errors"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_load_errors__dbt_backup" cascade
[0m00:31:48.581045 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.151 seconds
[0m00:31:48.582729 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.153 seconds
[0m00:31:48.584281 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.154 seconds
[0m00:31:48.589251 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_activity: Close
[0m00:31:48.589949 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.160 seconds
[0m00:31:48.591711 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_deal: Close
[0m00:31:48.593216 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_company: Close
[0m00:31:48.594813 [debug] [Thread-1 (]: On model.bdt_transformations.btx_load_errors: Close
[0m00:31:48.597677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a70e0>]}
[0m00:31:48.598183 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109439f40>]}
[0m00:31:48.598581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fe300>]}
[0m00:31:48.598967 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a6ea0>]}
[0m00:31:48.599690 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bitrix.btx_processed_activity ................ [[32mCREATE VIEW[0m in 2.16s]
[0m00:31:48.600416 [info ] [Thread-4 (]: 4 of 10 OK created sql view model bitrix.btx_processed_deal .................... [[32mCREATE VIEW[0m in 2.16s]
[0m00:31:48.601014 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bitrix.btx_load_errors ...................... [[32mSELECT 0[0m in 2.16s]
[0m00:31:48.601649 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bitrix.btx_processed_company ................. [[32mCREATE VIEW[0m in 2.16s]
[0m00:31:48.602299 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_activity
[0m00:31:48.602825 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_deal
[0m00:31:48.603353 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_load_errors
[0m00:31:48.603799 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_company
[0m00:31:48.604190 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:31:48.604632 [debug] [Thread-4 (]: Began running node model.bdt_transformations.btx_processed_dealcategory
[0m00:31:48.605117 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:31:48.605516 [debug] [Thread-3 (]: Began running node model.bdt_transformations.btx_processed_product
[0m00:31:48.605944 [info ] [Thread-2 (]: 5 of 10 START sql view model bitrix.btx_processed_deal_userfields .............. [RUN]
[0m00:31:48.606358 [info ] [Thread-4 (]: 6 of 10 START sql view model bitrix.btx_processed_dealcategory ................. [RUN]
[0m00:31:48.606755 [info ] [Thread-1 (]: 7 of 10 START sql view model bitrix.btx_processed_dealcategory_stage ........... [RUN]
[0m00:31:48.607133 [info ] [Thread-3 (]: 8 of 10 START sql view model bitrix.btx_processed_product ...................... [RUN]
[0m00:31:48.607526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_activity, now model.bdt_transformations.btx_processed_deal_userfields)
[0m00:31:48.607865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal, now model.bdt_transformations.btx_processed_dealcategory)
[0m00:31:48.608184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_load_errors, now model.bdt_transformations.btx_processed_dealcategory_stage)
[0m00:31:48.608494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_company, now model.bdt_transformations.btx_processed_product)
[0m00:31:48.608809 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_deal_userfields
[0m00:31:48.609112 [debug] [Thread-4 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory
[0m00:31:48.609410 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:31:48.609700 [debug] [Thread-3 (]: Began compiling node model.bdt_transformations.btx_processed_product
[0m00:31:48.612924 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:48.615065 [debug] [Thread-4 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:48.617102 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:48.619180 [debug] [Thread-3 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_product"
[0m00:31:48.620223 [debug] [Thread-4 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory
[0m00:31:48.620502 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_deal_userfields
[0m00:31:48.620763 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:31:48.623314 [debug] [Thread-4 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:48.625637 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:48.625887 [debug] [Thread-3 (]: Began executing node model.bdt_transformations.btx_processed_product
[0m00:31:48.628150 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:48.630539 [debug] [Thread-3 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_product"
[0m00:31:48.630982 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:48.631250 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:48.631542 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: BEGIN
[0m00:31:48.631777 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:48.632037 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: BEGIN
[0m00:31:48.632281 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:48.632503 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:48.632738 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: BEGIN
[0m00:31:48.632951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:48.633243 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: BEGIN
[0m00:31:48.633481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:48.633775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:49.852808 [debug] [Thread-2 (]: SQL status: BEGIN in 1.219 seconds
[0m00:31:49.854892 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:49.855783 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp"
    
    
  as (
    
select
	"ID" :: int4 as id,
	("CONTENT" ->> 'FIELD_NAME') :: varchar as field_name,
	NULLIF(REPLACE("CONTENT" ->> 'LIST', '''', '"'),'None') :: jsonb as list,
	NULLIF("CONTENT" ->> 'SORT', '') :: int2 as sort,
	NULLIF("CONTENT" ->> 'XML_ID', '') :: text as xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'MULTIPLE','[]',''),'') :: bool as multiple,
	NULLIF(REPLACE("CONTENT" ->> 'SETTINGS', '''', '"'),'None') :: jsonb as settings,
	("CONTENT" ->> 'ENTITY_ID') :: varchar as entity_id,
	NULLIF(REPLACE("CONTENT" ->> 'MANDATORY','[]',''),'')  :: bool as mandatory,
	("CONTENT" ->> 'SHOW_FILTER') :: varchar as show_filter,
	NULLIF(REPLACE("CONTENT" ->> 'EDIT_IN_LIST','[]',''),'') :: bool as edit_in_list,
	NULLIF(REPLACE("CONTENT" ->> 'SHOW_IN_LIST','[]',''),'') :: bool as show_in_list,
	("CONTENT" ->> 'USER_TYPE_ID') :: varchar as user_type_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_SEARCHABLE','[]',''),'') :: bool as is_searchable,
	NULLIF("CONTENT" ->> 'EDIT_FORM_LABEL', '') :: jsonb as edit_form_label,
	NULLIF("CONTENT" ->> 'ERROR_MESSAGE', '') :: jsonb as error_message,
	NULLIF("CONTENT" ->> 'HELP_MESSAGE', '') :: jsonb as help_message,
	NULLIF("CONTENT" ->> 'LIST_COLUMN_LABEL', '') :: jsonb as list_column_label,
	NULLIF("CONTENT" ->> 'LIST_FILTER_LABEL', '') :: jsonb as list_filter_label
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_deal_userfield"
WHERE
	"SUCCESS" = true
  );
[0m00:31:49.867015 [debug] [Thread-1 (]: SQL status: BEGIN in 1.233 seconds
[0m00:31:49.868526 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:49.869214 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  ("CONTENT" ->> 'STATUS_ID') :: varchar as status_id
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory_stage"
WHERE
  "SUCCESS" = true
  );
[0m00:31:49.875798 [debug] [Thread-3 (]: SQL status: BEGIN in 1.242 seconds
[0m00:31:49.877334 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:49.878127 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" :: int4 as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'CREATED_BY', '') :: int2 as created_by,
  NULLIF("CONTENT" ->> 'DATE_CREATE', '') :: timestamptz as date_create,
  NULLIF("CONTENT" ->> 'MODIFIED_BY', '') :: int2 as modified_by,
  NULLIF(REPLACE("CONTENT" ->> 'ACTIVE', '[]', ''), '') :: bool as active,
  NULLIF("CONTENT" ->> 'CATALOG_ID', '') :: int2 as catalog_id,
  ("CONTENT" ->> 'CODE') :: varchar as code,
  ("CONTENT" ->> 'CURRENCY_ID') :: varchar as currency_id,
  ("CONTENT" ->> 'DESCRIPTION') :: text as description,
  ("CONTENT" ->> 'DESCRIPTION_TYPE') :: varchar as description_type,
  ("CONTENT" ->> 'DETAIL_PICTURE') :: text as detail_picture,
  ("CONTENT" ->> 'PREVIEW_PICTURE') :: text as preview_picture,
  NULLIF("CONTENT" ->> 'MEASURE','') :: int2 as measure,
  NULLIF("CONTENT" ->> 'PRICE','') :: numeric as price,
  ("CONTENT" ->> 'PROPERTY_45') :: text as property_45,
  ("CONTENT" ->> 'SECTION_ID') :: varchar as section_id,
  NULLIF("CONTENT" ->> 'SORT','') :: int2 as sort,
  ("CONTENT" ->> 'TIMESTAMP_X') :: timestamptz as timestamp_x,
  NULLIF("CONTENT" ->> 'VAT_ID', '') :: int2 as vat_id,
  NULLIF(REPLACE("CONTENT" ->> 'VAT_INCLUDED', '[]', ''), '') :: bool as vat_included,
  ("CONTENT" ->> 'XML_ID') :: int2 as xml_id
FROM
  "bendito_intelligence_dev"."bitrix"."btx_raw_product"
WHERE
  "SUCCESS" = true
  );
[0m00:31:50.013883 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m00:31:50.022543 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:50.023097 [debug] [Thread-4 (]: SQL status: BEGIN in 1.391 seconds
[0m00:31:50.023723 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields" rename to "btx_processed_deal_userfields__dbt_backup"
[0m00:31:50.024213 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:50.024811 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp"
    
    
  as (
    
SELECT
  "ID" as id,
  ("CONTENT" ->> 'NAME') :: varchar as name,
  NULLIF("CONTENT" ->> 'SORT', '') :: int4 as sort,
  NULLIF("CONTENT" ->> 'CREATED_DATE', '') :: timestamp as created_date
from
  "bendito_intelligence_dev"."bitrix"."btx_raw_dealcategory"
WHERE
  "SUCCESS" = true
  );
[0m00:31:50.027275 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m00:31:50.032544 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:50.032968 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage" rename to "btx_processed_dealcategory_stage__dbt_backup"
[0m00:31:50.038444 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.160 seconds
[0m00:31:50.041445 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:50.041822 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product" rename to "btx_processed_product__dbt_backup"
[0m00:31:50.173782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:31:50.181270 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:50.181938 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_tmp" rename to "btx_processed_deal_userfields"
[0m00:31:50.183418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:31:50.183976 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m00:31:50.188067 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:50.192120 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:50.192609 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_tmp" rename to "btx_processed_dealcategory_stage"
[0m00:31:50.193061 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory" rename to "btx_processed_dealcategory__dbt_backup"
[0m00:31:50.193478 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.151 seconds
[0m00:31:50.197028 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:50.197452 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_tmp" rename to "btx_processed_product"
[0m00:31:50.331285 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:31:50.336211 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:31:50.337161 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:50.337852 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: COMMIT
[0m00:31:50.342044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:31:50.342571 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:31:50.345007 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:31:50.348597 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:50.349050 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:50.349487 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_tmp" rename to "btx_processed_dealcategory"
[0m00:31:50.349909 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: COMMIT
[0m00:31:50.350809 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.153 seconds
[0m00:31:50.352652 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:31:50.353101 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:50.353488 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: COMMIT
[0m00:31:50.488597 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m00:31:50.497534 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup"
[0m00:31:50.498624 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_deal_userfields"
[0m00:31:50.499149 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_deal_userfields"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_deal_userfields__dbt_backup" cascade
[0m00:31:50.499675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.149 seconds
[0m00:31:50.501970 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:31:50.502462 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:50.502852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.152 seconds
[0m00:31:50.503234 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: COMMIT
[0m00:31:50.505765 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup"
[0m00:31:50.506181 [debug] [Thread-3 (]: SQL status: COMMIT in 0.152 seconds
[0m00:31:50.507026 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory_stage"
[0m00:31:50.509057 [debug] [Thread-3 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup"
[0m00:31:50.509438 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory_stage"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory_stage__dbt_backup" cascade
[0m00:31:50.510129 [debug] [Thread-3 (]: Using postgres connection "model.bdt_transformations.btx_processed_product"
[0m00:31:50.510536 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_product"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_product__dbt_backup" cascade
[0m00:31:50.651181 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.150 seconds
[0m00:31:50.656157 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_deal_userfields: Close
[0m00:31:50.656926 [debug] [Thread-4 (]: SQL status: COMMIT in 0.150 seconds
[0m00:31:50.657640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935a5d0>]}
[0m00:31:50.660396 [debug] [Thread-4 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup"
[0m00:31:50.661233 [info ] [Thread-2 (]: 5 of 10 OK created sql view model bitrix.btx_processed_deal_userfields ......... [[32mCREATE VIEW[0m in 2.05s]
[0m00:31:50.662187 [debug] [Thread-4 (]: Using postgres connection "model.bdt_transformations.btx_processed_dealcategory"
[0m00:31:50.662609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:31:50.663226 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_deal_userfields
[0m00:31:50.663623 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_dealcategory"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_dealcategory__dbt_backup" cascade
[0m00:31:50.664933 [debug] [Thread-1 (]: On model.bdt_transformations.btx_processed_dealcategory_stage: Close
[0m00:31:50.665289 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.154 seconds
[0m00:31:50.665718 [debug] [Thread-2 (]: Began running node model.bdt_transformations.btx_processed_user
[0m00:31:50.667178 [debug] [Thread-3 (]: On model.bdt_transformations.btx_processed_product: Close
[0m00:31:50.667655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109482a20>]}
[0m00:31:50.668103 [info ] [Thread-2 (]: 9 of 10 START sql view model bitrix.btx_processed_user ......................... [RUN]
[0m00:31:50.668757 [info ] [Thread-1 (]: 7 of 10 OK created sql view model bitrix.btx_processed_dealcategory_stage ...... [[32mCREATE VIEW[0m in 2.06s]
[0m00:31:50.669226 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092db290>]}
[0m00:31:50.669639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_deal_userfields, now model.bdt_transformations.btx_processed_user)
[0m00:31:50.670091 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory_stage
[0m00:31:50.670549 [info ] [Thread-3 (]: 8 of 10 OK created sql view model bitrix.btx_processed_product ................. [[32mCREATE VIEW[0m in 2.06s]
[0m00:31:50.670897 [debug] [Thread-2 (]: Began compiling node model.bdt_transformations.btx_processed_user
[0m00:31:50.671230 [debug] [Thread-1 (]: Began running node model.bdt_transformations.btx_curated_deal
[0m00:31:50.671649 [debug] [Thread-3 (]: Finished running node model.bdt_transformations.btx_processed_product
[0m00:31:50.674762 [debug] [Thread-2 (]: Writing injected SQL for node "model.bdt_transformations.btx_processed_user"
[0m00:31:50.675191 [info ] [Thread-1 (]: 10 of 10 START sql table model bitrix.btx_curated_deal ......................... [RUN]
[0m00:31:50.675746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bdt_transformations.btx_processed_dealcategory_stage, now model.bdt_transformations.btx_curated_deal)
[0m00:31:50.676063 [debug] [Thread-1 (]: Began compiling node model.bdt_transformations.btx_curated_deal
[0m00:31:50.680628 [debug] [Thread-1 (]: Writing injected SQL for node "model.bdt_transformations.btx_curated_deal"
[0m00:31:50.681189 [debug] [Thread-2 (]: Began executing node model.bdt_transformations.btx_processed_user
[0m00:31:50.683973 [debug] [Thread-2 (]: Writing runtime sql for node "model.bdt_transformations.btx_processed_user"
[0m00:31:50.684458 [debug] [Thread-1 (]: Began executing node model.bdt_transformations.btx_curated_deal
[0m00:31:50.686968 [debug] [Thread-1 (]: Writing runtime sql for node "model.bdt_transformations.btx_curated_deal"
[0m00:31:50.687384 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:50.687662 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: BEGIN
[0m00:31:50.687898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:50.688137 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:50.688474 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: BEGIN
[0m00:31:50.688700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:50.817901 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.151 seconds
[0m00:31:50.822424 [debug] [Thread-4 (]: On model.bdt_transformations.btx_processed_dealcategory: Close
[0m00:31:50.824008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109407fe0>]}
[0m00:31:50.825117 [info ] [Thread-4 (]: 6 of 10 OK created sql view model bitrix.btx_processed_dealcategory ............ [[32mCREATE VIEW[0m in 2.22s]
[0m00:31:50.825971 [debug] [Thread-4 (]: Finished running node model.bdt_transformations.btx_processed_dealcategory
[0m00:31:51.915174 [debug] [Thread-1 (]: SQL status: BEGIN in 1.226 seconds
[0m00:31:51.916604 [debug] [Thread-2 (]: SQL status: BEGIN in 1.229 seconds
[0m00:31:51.917720 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:51.918402 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:51.919616 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */

  
    

  create  table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp"
  
  
    as
  
  (
    
SELECT
	id,
	title AS titulo,
	stage_id AS id_estagio,
	category_id as id_categoria, -- nenhum deal possui este campo preenchido
	opportunity AS mrr,
	company_id as id_empresa,
	contact_id as id_contato,
	assigned_by_id AS id_atribuido_por,
	opened AS aberto,
	begin_date AS data_de_inicio,
	closed AS encerrado,
	close_date AS data_de_encerramento,
	date_create AS criado_em,
	created_by_id AS criado_por,
	date_modify AS id_modificado_em,
	modify_by_id AS id_modificdo_por,
	moved_time AS movido_em,
	moved_by_id AS id_movido_por,
	last_activity_time AS ultima_atividade_em,
	last_activity_by AS id_ultima_atividade_por,
	is_new as recente, -- provavelmente indica se o deal é recente
	lead_id AS id_lead,
	type_id AS id_tipo,
	comments AS comentarios,
	quote_id, -- provavelmente o id do orçamento
	origin_id, -- nenhum valor preenchido
	source_id id_da_fonte,
	source_description as descricao_da_fonte, -- não utilizado
	tax_value as valor_imposto, -- valor do imposto
	currency_id AS moeda,
	location_id as id_localizacao, -- não utilizado
	probability as chance_fechamento, -- provavelmente probabilidade de fechamento, não utilizado
	is_recurring AS recorrente,
	additional_info as informacoes_adicionais, -- não utilizado
	--stage_semantic_id, -- não utilizado
	--originator_id, -- não utilizado
	is_manual_opportunity as oportunidade_manual,
	is_return_customer as cliente_retorno,
	is_repeated_approach as abordagem_repetida,
	uf_crm_1718891707656 AS quantidade_de_usuarios,
	uf_crm_1718893063318 AS ponto_focal,
	uf_crm_1721248408791 AS email_ponto_focal,
	uf_crm_1718895613676 AS erp,
	uf_crm_1718895632531 AS segmento,
	uf_crm_1718895837277 AS perfil,
	uf_crm_1719234554494 AS email_financeiro,
	uf_crm_1719234611470 AS forma_pgto_implementacao,
	uf_crm_1719234653377 AS forma_pgto_recorrencia,
	uf_crm_1719851689133 AS vr_negociado_recorrencia,
	uf_crm_1719851724735 AS vr_negociado_implementacao,
	uf_crm_1719942627227 AS anexar_o_contrato,
	uf_crm_1720015348995 AS contrato_do_setup,
	uf_crm_1720198477652 AS valor_negociado_ativacao,
	uf_crm_1720198502628 AS valor_negociado_integracao,
	uf_crm_1721083795801 AS quantidade_usuarios_ativos,
	uf_crm_1721083820061 AS vr_transacionado_em_janeiro,
	uf_crm_1721083836488 AS vr_transacionado_em_fevereiro,
	uf_crm_1721083849804 AS vr_transacionado_em_marco,
	uf_crm_1721083861185 AS vr_transacionado_em_abril,
	uf_crm_1721083874978 AS vr_transacionado_em_maio,
	uf_crm_1721083894608 AS vr_transacionado_em_junho,
	uf_crm_1721083906720 AS vr_transacionado_em_julho,
	uf_crm_1724264534445 AS vr_transacionado_em_agosto,
	uf_crm_1726007497 AS vr_transacionado_em_setembro,
	uf_crm_1728416073106 AS vr_transacionado_em_outubro,
	uf_crm_1733168617374 AS vr_transacionado_novembro,
	uf_crm_1721226126 AS modulo_do_sistema,
	uf_crm_1721227124 AS ambiente,
	uf_crm_1721241190 AS classificacao_do_atendimento,
	uf_crm_1721243220370 AS area,
	uf_crm_1721243302036 AS descricao,
	uf_crm_1721243367 AS arquivos,
	uf_crm_1721244413245 AS carro_chefe,
	uf_crm_1721244451568 AS faturamento_medio_mensal,
	uf_crm_1721244493157 AS qtd_media_pedidos_mes,
	uf_crm_1721244526025 AS vendedor_destaque,
	uf_crm_1721244560622 AS pretende_estar_operando_em,
	uf_crm_1721244826264 AS motivo_do_cancelamento,
	uf_crm_1721244999810 AS o_que_poderia_ter_sido_diferente,
	uf_crm_1721248388070 AS tipo_de_aumento_de_receita,
	uf_crm_1721406278811 AS data_do_churn,
	uf_crm_1724261215 AS media_de_faturamento,
	uf_crm_1725574177266 AS id_asaas,
	uf_crm_1725574322 AS status_do_pagamento,
	uf_crm_1725548469220 AS data_solicitacao_upsell,
	uf_crm_1726002322164 AS expectativa_com_o_projeto,
	uf_crm_1726003734 AS status_do_projeto,
	uf_crm_1729086829554 AS detalhes_motivo_cancelamento,
	uf_crm_1729086887055 AS data_solicitacao_cancelamento,
	uf_crm_1732567021643 AS como_avalia_implantacao_bendito,
	uf_crm_1733491265514 AS novo_valor,
	uf_crm_1738931838 AS cliente_ja_possui_base_bendito,
	uf_crm_1741275511723 AS quantidade_de_pedidos,
	uf_crm_1741275566502 AS valor_faturado,
	uf_crm_1741275596050 AS produto,
	uf_crm_1741275610428 AS valor_vendido,
	uf_crm_1741275634394 AS qtd_vendida,
	--uf_crm_66d0a6a12e620, -- não é usado
	--uf_crm_66d0a6a146d20, -- não é usado
	--uf_crm_66d0a6a1529fd, -- não é usado
	--uf_crm_66d0a6a15d94f, -- não é usado
	--uf_crm_66d0a6a169edc, -- não é usado
	uf_crm_deal_1719236124580 AS plano,
	uf_crm_deal_1725540405848 AS tem_desenvolvimento_bendito,
	uf_crm_deal_1725540759541 AS tipo_de_desenvolvimento,
	uf_crm_deal_1725569571488 AS expectativa_valor_recorrencia,
	uf_crm_deal_1725569886689 AS pessoa_responsavel_pelo_lead,
	uf_crm_deal_1727374223411 AS qual_a_dor_do_cliente,
	uf_crm_deal_1727374263239 AS ja_utilizavam_solucao,
	uf_crm_deal_1732567150103 AS conta_pra_gente_porque,
	uf_crm_deal_1738069738944 AS tipo_de_produto_que_a_empresa_vende,
	uf_crm_deal_1738069820827 AS como_fazem_gestao_de_pedidos_hj,
	uf_crm_deal_1722632496832 AS email_da_pessoa_ponto_focal --,
	--utm_medium, --não é usado
	--utm_source, --não é usado
	--utm_term, -- não é usado
	--utm_content, -- não é usado
	--utm_campaign -- não é usado
FROM
	"bendito_intelligence_dev"."bitrix"."btx_processed_deal"
  );
  
[0m00:31:51.921138 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */

  create view "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp"
    
    
  as (
    
SELECT
	"ID" :: int2 AS id,
	("CONTENT" ->> 'NAME') :: varchar AS name,
	("CONTENT" ->> 'LAST_NAME') :: varchar AS last_name,
	("CONTENT" ->> 'EMAIL') :: varchar AS email,
	NULLIF(REPLACE("CONTENT" ->> 'ACTIVE','[]',''), '[]') :: bool AS active,
	("CONTENT" ->> 'XML_ID') :: varchar AS xml_id,
	NULLIF(REPLACE("CONTENT" ->> 'IS_ONLINE','[]',''), '[]') :: bool AS is_online,
	("CONTENT" ->> 'TIME_ZONE') :: varchar AS time_zone,
	("CONTENT" ->> 'USER_TYPE') :: varchar AS user_type,
	NULLIF("CONTENT" ->> 'LAST_LOGIN', '') :: timestamptz AS last_login,
	("CONTENT" ->> 'WORK_PHONE') :: varchar AS work_phone,
	NULLIF("CONTENT" ->> 'TIMESTAMP_X', '') :: jsonb AS timestamp_x,
	("CONTENT" ->> 'PERSONAL_WWW') :: varchar AS personal_www,
	NULLIF("CONTENT" ->> 'DATE_REGISTER', '') :: timestamptz AS date_register,
	("CONTENT" ->> 'PERSONAL_CITY') :: varchar AS personal_city,
	NULLIF("CONTENT" ->> 'UF_DEPARTMENT', '') :: json AS uf_department,
	("CONTENT" ->> 'WORK_POSITION') :: varchar AS work_position,
	("CONTENT" ->> 'PERSONAL_PHOTO') :: text AS personal_photo,
	NULLIF("CONTENT" ->> 'UF_PHONE_INNER', '') :: int2 AS uf_phone_number,
	("CONTENT" ->> 'PERSONAL_GENDER') :: varchar AS personal_gender,
	("CONTENT" ->> 'PERSONAL_MOBILE') :: varchar AS personal_mobile,
	NULLIF("CONTENT" ->> 'TIME_ZONE_OFFSET','') :: int4 AS time_zone_offset,
	("CONTENT" ->> 'PERSONAL_BIRTHDAY') :: varchar AS personal_birthday,
	NULLIF("CONTENT" ->> 'LAST_ACTIVITY_DATE','') :: jsonb AS last_activity_date,
	("CONTENT" ->> 'UF_EMPLOYMENT_DATE') :: varchar AS uf_employment_date
from
	"bendito_intelligence_dev"."bitrix"."btx_raw_user"
WHERE
	"SUCCESS" = true
  );
[0m00:31:52.085476 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m00:31:52.093648 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:52.094294 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user" rename to "btx_processed_user__dbt_backup"
[0m00:31:52.178226 [debug] [Thread-1 (]: SQL status: SELECT 227 in 0.256 seconds
[0m00:31:52.185684 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:52.186313 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal" rename to "btx_curated_deal__dbt_backup"
[0m00:31:52.245873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:31:52.253492 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:52.254016 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_tmp" rename to "btx_processed_user"
[0m00:31:52.340441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:31:52.346708 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:52.347371 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
alter table "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_tmp" rename to "btx_curated_deal"
[0m00:31:52.404864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m00:31:52.413203 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:31:52.415025 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:52.415752 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: COMMIT
[0m00:31:52.497017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m00:31:52.502927 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:31:52.503515 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:52.503996 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: COMMIT
[0m00:31:52.567334 [debug] [Thread-2 (]: SQL status: COMMIT in 0.150 seconds
[0m00:31:52.572082 [debug] [Thread-2 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup"
[0m00:31:52.573167 [debug] [Thread-2 (]: Using postgres connection "model.bdt_transformations.btx_processed_user"
[0m00:31:52.573662 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_processed_user"} */
drop view if exists "bendito_intelligence_dev"."bitrix"."btx_processed_user__dbt_backup" cascade
[0m00:31:52.654872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.150 seconds
[0m00:31:52.659549 [debug] [Thread-1 (]: Applying DROP to: "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup"
[0m00:31:52.660661 [debug] [Thread-1 (]: Using postgres connection "model.bdt_transformations.btx_curated_deal"
[0m00:31:52.661123 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "bdt_transformations", "target_name": "dev", "node_id": "model.bdt_transformations.btx_curated_deal"} */
drop table if exists "bendito_intelligence_dev"."bitrix"."btx_curated_deal__dbt_backup" cascade
[0m00:31:52.726334 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.152 seconds
[0m00:31:52.731311 [debug] [Thread-2 (]: On model.bdt_transformations.btx_processed_user: Close
[0m00:31:52.732690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109511970>]}
[0m00:31:52.733675 [info ] [Thread-2 (]: 9 of 10 OK created sql view model bitrix.btx_processed_user .................... [[32mCREATE VIEW[0m in 2.06s]
[0m00:31:52.734476 [debug] [Thread-2 (]: Finished running node model.bdt_transformations.btx_processed_user
[0m00:31:52.818573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.157 seconds
[0m00:31:52.819760 [debug] [Thread-1 (]: On model.bdt_transformations.btx_curated_deal: Close
[0m00:31:52.820307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8751eb-cde5-4538-9cd3-407eae736dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109406540>]}
[0m00:31:52.820754 [info ] [Thread-1 (]: 10 of 10 OK created sql table model bitrix.btx_curated_deal .................... [[32mSELECT 227[0m in 2.14s]
[0m00:31:52.821136 [debug] [Thread-1 (]: Finished running node model.bdt_transformations.btx_curated_deal
[0m00:31:52.822057 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:52.822296 [debug] [MainThread]: On master: BEGIN
[0m00:31:52.822494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:54.041545 [debug] [MainThread]: SQL status: BEGIN in 1.218 seconds
[0m00:31:54.043817 [debug] [MainThread]: On master: COMMIT
[0m00:31:54.044926 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:54.046081 [debug] [MainThread]: On master: COMMIT
[0m00:31:54.198150 [debug] [MainThread]: SQL status: COMMIT in 0.151 seconds
[0m00:31:54.199953 [debug] [MainThread]: On master: Close
[0m00:31:54.201174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:54.201685 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_curated_deal' was properly closed.
[0m00:31:54.202117 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_user' was properly closed.
[0m00:31:54.202517 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_product' was properly closed.
[0m00:31:54.202889 [debug] [MainThread]: Connection 'model.bdt_transformations.btx_processed_dealcategory' was properly closed.
[0m00:31:54.203521 [info ] [MainThread]: 
[0m00:31:54.204047 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 12.65 seconds (12.65s).
[0m00:31:54.206090 [debug] [MainThread]: Command end result
[0m00:31:54.281474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/manifest.json
[0m00:31:54.282550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/semantic_manifest.json
[0m00:31:54.286013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cauemausec/Documents/code/workspace/bdt_data_integration/dbt/target/run_results.json
[0m00:31:54.286217 [info ] [MainThread]: 
[0m00:31:54.286414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:54.286596 [info ] [MainThread]: 
[0m00:31:54.286777 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:31:54.288177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.074321, "process_in_blocks": "0", "process_kernel_time": 0.24891, "process_mem_max_rss": "123830272", "process_out_blocks": "0", "process_user_time": 1.670172}
[0m00:31:54.288451 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:54.288403 after 13.07 seconds
[0m00:31:54.288651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10099edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a00f80>]}
[0m00:31:54.288840 [debug] [MainThread]: Flushing usage events
[0m00:31:55.298700 [debug] [MainThread]: An error was encountered while trying to flush usage events
