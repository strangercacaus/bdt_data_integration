{{ config(
    materialized='ephemeral',
) }}

SELECT 
  -- ID no topo
  "ID"::int4 as id,
  
  -- Campos mais utilizados (baseado na sua lista)
  ("CONTENT"->>'TITLE') as title,
  ("CONTENT"->>'STAGE_ID') as stage_id,
  ("CONTENT"->>'CATEGORY_ID') as category_id,
  ("CONTENT"->>'OPPORTUNITY') as opportunity,
  ("CONTENT"->>'COMPANY_ID') as company_id,
  ("CONTENT"->>'CONTACT_ID') as contact_id,
  ("CONTENT"->>'ASSIGNED_BY_ID') as assigned_by_id,
  ("CONTENT"->>'CLOSED') as closed,
  ("CONTENT"->>'CLOSEDATE') as close_date,
  ("CONTENT"->>'DATE_CREATE') as date_create,
  ("CONTENT"->>'DATE_MODIFY') as date_modify,
  ("CONTENT"->>'BEGINDATE') as begin_date,
  
  -- Campos normais
  ("CONTENT"->>'OPENED') as opened,
  ("CONTENT"->>'IS_NEW') as is_new,
  ("CONTENT"->>'LEAD_ID') as lead_id,
  ("CONTENT"->>'TYPE_ID') as type_id,
  ("CONTENT"->>'COMMENTS') as comments,
  ("CONTENT"->>'QUOTE_ID') as quote_id,
  ("CONTENT"->>'ORIGIN_ID') as origin_id,
  ("CONTENT"->>'SOURCE_ID') as source_id,
  ("CONTENT"->>'TAX_VALUE') as tax_value,
  ("CONTENT"->>'MOVED_TIME') as moved_time,
  ("CONTENT"->>'UTM_MEDIUM') as utm_medium,
  ("CONTENT"->>'UTM_SOURCE') as utm_source,
  ("CONTENT"->>'UTM_TERM') as utm_term,
  ("CONTENT"->>'CURRENCY_ID') as currency_id,
  ("CONTENT"->>'LOCATION_ID') as location_id,
  ("CONTENT"->>'MOVED_BY_ID') as moved_by_id,
  ("CONTENT"->>'PROBABILITY') as probability,
  ("CONTENT"->>'UTM_CONTENT') as utm_content,
  ("CONTENT"->>'IS_RECURRING') as is_recurring,
  ("CONTENT"->>'MODIFY_BY_ID') as modify_by_id,
  ("CONTENT"->>'UTM_CAMPAIGN') as utm_campaign,
  ("CONTENT"->>'CREATED_BY_ID') as created_by_id,
  ("CONTENT"->>'SOURCE_DESCRIPTION') as source_description,
  ("CONTENT"->>'ADDITIONAL_INFO') as additional_info,
  ("CONTENT"->>'STAGE_SEMANTIC_ID') as stage_semantic_id,
  ("CONTENT"->>'LAST_ACTIVITY_TIME') as last_activity_time,
  ("CONTENT"->>'LAST_ACTIVITY_BY') as last_activity_by,
  ("CONTENT"->>'ORIGINATOR_ID') as originator_id,
  ("CONTENT"->>'IS_MANUAL_OPPORTUNITY') as is_manual_opportunity,
  ("CONTENT"->>'IS_RETURN_CUSTOMER') as is_return_customer,
  ("CONTENT"->>'IS_REPEATED_APPROACH') as is_repeated_approach,
  
  -- Campos personalizados (UF_*)
  ("CONTENT"->>'UF_CRM_1718891707656') as uf_crm_1718891707656,
  ("CONTENT"->>'UF_CRM_1718893063318') as uf_crm_1718893063318,
  ("CONTENT"->>'UF_CRM_1718895613676') as uf_crm_1718895613676,
  ("CONTENT"->>'UF_CRM_1718895632531') as uf_crm_1718895632531,
  ("CONTENT"->>'UF_CRM_1718895837277') as uf_crm_1718895837277,
  ("CONTENT"->>'UF_CRM_1719234554494') as uf_crm_1719234554494,
  ("CONTENT"->>'UF_CRM_1719234611470') as uf_crm_1719234611470,
  ("CONTENT"->>'UF_CRM_1719234653377') as uf_crm_1719234653377,
  ("CONTENT"->>'UF_CRM_1719851689133') as uf_crm_1719851689133,
  ("CONTENT"->>'UF_CRM_1719851724735') as uf_crm_1719851724735,
  ("CONTENT"->>'UF_CRM_1719942627227') as uf_crm_1719942627227,
  ("CONTENT"->>'UF_CRM_1720015348995') as uf_crm_1720015348995,
  ("CONTENT"->>'UF_CRM_1720198477652') as uf_crm_1720198477652,
  ("CONTENT"->>'UF_CRM_1720198502628') as uf_crm_1720198502628,
  ("CONTENT"->>'UF_CRM_1721083795801') as uf_crm_1721083795801,
  ("CONTENT"->>'UF_CRM_1721083820061') as uf_crm_1721083820061,
  ("CONTENT"->>'UF_CRM_1721083836488') as uf_crm_1721083836488,
  ("CONTENT"->>'UF_CRM_1721083849804') as uf_crm_1721083849804,
  ("CONTENT"->>'UF_CRM_1721083861185') as uf_crm_1721083861185,
  ("CONTENT"->>'UF_CRM_1721083874978') as uf_crm_1721083874978,
  ("CONTENT"->>'UF_CRM_1721083894608') as uf_crm_1721083894608,
  ("CONTENT"->>'UF_CRM_1721083906720') as uf_crm_1721083906720,
  ("CONTENT"->>'UF_CRM_1721226126') as uf_crm_1721226126,
  ("CONTENT"->>'UF_CRM_1721227124') as uf_crm_1721227124,
  ("CONTENT"->>'UF_CRM_1721241190') as uf_crm_1721241190,
  ("CONTENT"->>'UF_CRM_1721243220370') as uf_crm_1721243220370,
  ("CONTENT"->>'UF_CRM_1721243302036') as uf_crm_1721243302036,
  ("CONTENT"->>'UF_CRM_1721243367') as uf_crm_1721243367,
  ("CONTENT"->>'UF_CRM_1721244413245') as uf_crm_1721244413245,
  ("CONTENT"->>'UF_CRM_1721244451568') as uf_crm_1721244451568,
  ("CONTENT"->>'UF_CRM_1721244493157') as uf_crm_1721244493157,
  ("CONTENT"->>'UF_CRM_1721244526025') as uf_crm_1721244526025,
  ("CONTENT"->>'UF_CRM_1721244560622') as uf_crm_1721244560622,
  ("CONTENT"->>'UF_CRM_1721244826264') as uf_crm_1721244826264,
  ("CONTENT"->>'UF_CRM_1721244999810') as uf_crm_1721244999810,
  ("CONTENT"->>'UF_CRM_1721248388070') as uf_crm_1721248388070,
  ("CONTENT"->>'UF_CRM_1721248408791') as uf_crm_1721248408791,
  ("CONTENT"->>'UF_CRM_1721406278811') as uf_crm_1721406278811,
  ("CONTENT"->>'UF_CRM_1724261215') as uf_crm_1724261215,
  ("CONTENT"->>'UF_CRM_1724264534445') as uf_crm_1724264534445,
  ("CONTENT"->>'UF_CRM_1725574177266') as uf_crm_1725574177266,
  ("CONTENT"->>'UF_CRM_1725574322') as uf_crm_1725574322,
  ("CONTENT"->>'UF_CRM_1725548469220') as uf_crm_1725548469220,
  ("CONTENT"->>'UF_CRM_1726002322164') as uf_crm_1726002322164,
  ("CONTENT"->>'UF_CRM_1726003734') as uf_crm_1726003734,
  ("CONTENT"->>'UF_CRM_1726007497') as uf_crm_1726007497,
  ("CONTENT"->>'UF_CRM_1728416073106') as uf_crm_1728416073106,
  ("CONTENT"->>'UF_CRM_1729086829554') as uf_crm_1729086829554,
  ("CONTENT"->>'UF_CRM_1729086887055') as uf_crm_1729086887055,
  ("CONTENT"->>'UF_CRM_1732567021643') as uf_crm_1732567021643,
  ("CONTENT"->>'UF_CRM_1733168617374') as uf_crm_1733168617374,
  ("CONTENT"->>'UF_CRM_1733491265514') as uf_crm_1733491265514,
  ("CONTENT"->>'UF_CRM_1738931838') as uf_crm_1738931838,
  ("CONTENT"->>'UF_CRM_1741275511723') as uf_crm_1741275511723,
  ("CONTENT"->>'UF_CRM_1741275566502') as uf_crm_1741275566502,
  ("CONTENT"->>'UF_CRM_1741275596050') as uf_crm_1741275596050,
  ("CONTENT"->>'UF_CRM_1741275610428') as uf_crm_1741275610428,
  ("CONTENT"->>'UF_CRM_1741275634394') as uf_crm_1741275634394,
  ("CONTENT"->>'UF_CRM_66D0A6A12E620') as uf_crm_66d0a6a12e620,
  ("CONTENT"->>'UF_CRM_66D0A6A146D20') as uf_crm_66d0a6a146d20,
  ("CONTENT"->>'UF_CRM_66D0A6A1529FD') as uf_crm_66d0a6a1529fd,
  ("CONTENT"->>'UF_CRM_66D0A6A15D94F') as uf_crm_66d0a6a15d94f,
  ("CONTENT"->>'UF_CRM_66D0A6A169EDC') as uf_crm_66d0a6a169edc,
  ("CONTENT"->>'UF_CRM_DEAL_1719236124580') as uf_crm_deal_1719236124580,
  ("CONTENT"->>'UF_CRM_DEAL_1725540405848') as uf_crm_deal_1725540405848,
  ("CONTENT"->>'UF_CRM_DEAL_1725540759541') as uf_crm_deal_1725540759541,
  ("CONTENT"->>'UF_CRM_DEAL_1725569571488') as uf_crm_deal_1725569571488,
  ("CONTENT"->>'UF_CRM_DEAL_1725569886689') as uf_crm_deal_1725569886689,
  ("CONTENT"->>'UF_CRM_DEAL_1727374223411') as uf_crm_deal_1727374223411,
  ("CONTENT"->>'UF_CRM_DEAL_1727374263239') as uf_crm_deal_1727374263239,
  ("CONTENT"->>'UF_CRM_DEAL_1732567150103') as uf_crm_deal_1732567150103,
  ("CONTENT"->>'UF_CRM_DEAL_1738069738944') as uf_crm_deal_1738069738944,
  ("CONTENT"->>'UF_CRM_DEAL_1738069820827') as uf_crm_deal_1738069820827,
  ("CONTENT"->>'UF_CRM_DEAL_1722632496832') as uf_crm_deal_1722632496832

FROM raw.btx_raw_deal